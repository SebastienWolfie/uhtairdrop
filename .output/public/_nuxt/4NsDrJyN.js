import{_ as $}from"./CohZIaU4.js";import{u as z}from"./BqACKYKw.js";import{r as p,V as F,P as C,o as j,c as T,b as k,d as m,k as R,e as a,u as l,S as H,O as D,R as L,j as b,l as O,M as P,N as Y,i as q,T as W,n as G,m as J,q as K}from"./BLqpxtBP.js";import{_ as Q}from"./B0PwvC0I.js";import{g as X,c as Z,d as ee}from"./DjOLoqGw.js";import{t as te,m as ae}from"./zGrFUsMF.js";import{_ as E}from"./DlAUqK2U.js";import"./CigPq3WD.js";import"./N-IBRvSD.js";import"./rx5cLQAs.js";const B=S=>(J("data-v-7b7479d1"),S=S(),K(),S),oe={class:"body"},se={class:"container"},le=B(()=>a("header",null,[a("div",{class:"uht-mark"},[a("img",{src:Q,alt:"Stake Logo",onerror:"this.src='https://dummyimage.com/96x96/6a44ff/ffffff&text=UHT'"}),a("div",null,[a("div",{class:"brand-title"},"Stake UHT"),a("span",{class:"badge"},[a("small",null,"Stake Your Tokens â€¢ Earn Hash Rate")])])])],-1)),ne={key:0,class:"coming-soon"},ce={key:0,class:"locked-alert"},de={class:"staking-tabs"},ie={key:1,class:"text-red-400 font-semibold my-2"},re={class:"stake-card"},ue={class:"stake-info"},ke={class:"stake-action"},me=["max"],ve=["disabled"],fe={class:"stakes-list"},_e={key:0},pe=["onClick","disabled"],be={class:"hashrate-bar"},he=B(()=>a("footer",null," Â© 2025 UHT â€¢ Universal Health Token â€” Stake & Boost Rewards. ",-1)),Se={__name:"index",setup(S){const f=z(),g=p(!0),x=p(!1),y=p(-1),r=p(""),e=F({walletAddress:"",balance:0,flexibleStaked:0,lockedStaked:0,hashRate:0,isLocked:!1}),n=p(0),v=p("flexible"),_=p([]);C(()=>[f.value.walletAddress,f.value.uhtbalance],A),C(()=>n.value,()=>r.value=""),j(A);async function A(){e.walletAddress=f.value.walletAddress,e.balance=Number(f.value.uhtbalance.toFixed(2)),e.hashRate=0;const i=await X(f.value.walletAddress)||[];_.value=i.map(t=>{const c=t.type==="locked"&&t.start?new window.Date(t.start).getTime()+2592e6:null;return{...t,unlockReady:t.type==="flexible"?!0:c?window.Date.now()>=c:!1,unlockDate:c?new window.Date(c).toDateString():null}}),e.flexibleStaked=_.value.filter(t=>t.type==="flexible").reduce((t,c)=>t+c.amount,0),e.lockedStaked=_.value.filter(t=>t.type==="locked").reduce((t,c)=>t+c.amount,0),e.balance=Math.max(0,e.balance-(e.flexibleStaked+e.lockedStaked))}T(()=>(e.flexibleStaked*.3+e.lockedStaked*.6).toFixed(2));const N=T(()=>v.value==="flexible"?e.flexibleStaked:e.lockedStaked),V=T(()=>{const i=e.balance+e.flexibleStaked+e.lockedStaked||1;return(N.value+n.value)/i*100});async function I(){var i,t,c,d,u,h,w;if(!(n.value<=0||n.value>e.balance))try{x.value=!0,await te(n.value);const s={type:v.value,amount:n.value,address:f.value.walletAddress,start:v.value==="locked"?new window.Date().toISOString():null};await Z(s),_.value.push(s),v.value==="flexible"?e.flexibleStaked+=n.value:e.lockedStaked+=n.value,e.balance=Math.max(0,e.balance-n.value),n.value=0,x.value=!1}catch(s){((t=(i=s==null?void 0:s.info)==null?void 0:i.error)==null?void 0:t.code)==-32e3||((c=s==null?void 0:s.error)==null?void 0:c.code)==-32046?r.value="Slippage tolerance high. Add Eth to cover gwei charge":((u=(d=s==null?void 0:s.info)==null?void 0:d.error)==null?void 0:u.code)==4001||((w=(h=s==null?void 0:s.info)==null?void 0:h.error)==null?void 0:w.code)==5e3?r.value="Transaction rejected":r.value="An error occured",x.value=!1,console.log(s)}}async function M(i){var t,c,d,u,h,w,s;try{const o=_.value[i];if(o.type==="locked"){const U=o.start?new window.Date(o.start).getTime()+2592e6:null;if(!U||window.Date.now()<U){alert("Locked stake not yet unlocked.");return}}y.value=i,await ae(o.amount,2e-5),e.balance+=o.amount,o.type==="flexible"?e.flexibleStaked-=o.amount:e.lockedStaked-=o.amount,await ee(o.id),_.value.splice(i,1),y.value=-1}catch(o){((c=(t=o==null?void 0:o.info)==null?void 0:t.error)==null?void 0:c.code)==-32e3||((d=o==null?void 0:o.error)==null?void 0:d.code)==-32046?r.value="Slippage tolerance high. Add Eth to cover gwei charge":((h=(u=o==null?void 0:o.info)==null?void 0:u.error)==null?void 0:h.code)==4001||((s=(w=o==null?void 0:o.info)==null?void 0:w.error)==null?void 0:s.code)==5e3?r.value="Transaction rejected":r.value="An error occured",console.log(o),y.value=-1}}return(i,t)=>{const c=$;return k(),m("div",oe,[R(c,{class:"md:mx-[10%] mx-[2%] sticky top-[10px] z-50"}),a("div",se,[le,l(g)?(k(),m(H,{key:1},[l(e).isLocked?(k(),m("section",ce," âš ï¸ Your account has been locked due to rule violation. ")):D("",!0),a("div",de,[a("button",{class:L(["tab-btn",{active:l(v)==="flexible"}]),onClick:t[0]||(t[0]=d=>v.value="flexible")}," Flexible ",2),a("button",{class:L(["tab-btn",{active:l(v)==="locked"}]),onClick:t[1]||(t[1]=d=>v.value="locked")}," Locked (30 Days) ",2)]),l(r)?(k(),m("p",ie,b(l(r)),1)):D("",!0),a("section",re,[a("div",ue,[a("p",null,[O("Balance: "),a("strong",null,b(l(e).balance)+" UHT",1)])]),a("div",ke,[P(a("input",{type:"number","onUpdate:modelValue":t[2]||(t[2]=d=>q(n)?n.value=d:null),max:l(e).balance,placeholder:"Enter UHT to stake",class:"stake-input"},null,8,me),[[Y,l(n),void 0,{number:!0}]]),a("button",{class:"stake-btn",onClick:I,disabled:l(n)<=0||l(n)>l(e).balance},b(l(x)?"Staking...":l(n)>0?"Stake":"Enter Amount"),9,ve)]),a("div",fe,[(k(!0),m(H,null,W(l(_),(d,u)=>(k(),m("div",{key:u,class:"stake-item"},[a("span",null,b(d.type.toUpperCase())+" Stake: "+b(d.amount)+" UHT",1),d.type==="locked"?(k(),m("span",_e," | Unlocks: "+b(d.unlockDate),1)):D("",!0),a("button",{class:"unstake-btn",onClick:h=>M(u),disabled:d.type==="locked"&&!d.unlockReady},b(l(y)==u?"Loading...":"Withdraw"),9,pe)]))),128))]),a("div",be,[a("div",{class:"progress",style:G({width:l(V)+"%"})},null,4)])])],64)):(k(),m("section",ne," ðŸš€ Staking Coming Soon â€” Stay Tuned! ")),he])])}}},we=E(Se,[["__scopeId","data-v-7b7479d1"]]),xe={};function ye(S,f){const g=we;return k(),m("div",null,[R(g)])}const Be=E(xe,[["render",ye]]);export{Be as default};
