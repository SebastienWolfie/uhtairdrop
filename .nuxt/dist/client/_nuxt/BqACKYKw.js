const __vite__fileDeps=["./CdyUX1yU.js","./BLqpxtBP.js","./entry.BlV8NLmW.css","./rx5cLQAs.js","./D4WHiZ3d.js","./C6UJIyST.js","./pA-L5z5-.js","./DpLUDbId.js","./CaRtpF6T.js","./DxvyqeoR.js","./rLYoUjrC.js","./cdYEHJZT.js","./DMVJ8XfO.js","./PbVS3gXm.js","./Br4_VEbT.js","./B3FXzDs5.js","./CrIyovLo.js","./aOGguEi-.js","./DE1B9N49.js","./bBwRRaMY.js","./ClytJu1B.js","./CbthURU1.js","./9yaQbRaA.js","./JeMB2mxP.js","./DmWAW4_1.js","./BYPxFd3C.js","./DRHY8nG-.js","./jG-zQou1.js","./Dmg8YACJ.js","./kmJXdH0Q.js","./DTcjRPMt.js","./D_nYlboR.js","./BH4sU5EC.js","./DfM8Jnjg.js","./Cm1mjpfd.js","./CCiuKp_a.js","./DIn8CNX7.js","./Co7jFVce.js","./Bf9iuFdd.js","./CpB0YzUV.js","./BQgDJuww.js","./C44XKz1d.js","./B28QA65d.js","./CUiKheE-.js","./Dv57VTr3.js","./B8bSwCll.js","./DCciz4xf.js","./K1QTFBCJ.js","./C2ioQq8y.js","./CPYRf6CO.js","./GByAiexX.js","./D3qyTeKh.js","./D1m4Z2XG.js","./PRu-nwta.js","./Cy1GOJZA.js","./iB-xP0jJ.js","./-PZ8JFYE.js","./BEzOdVLG.js"],__vite__mapDeps=i=>i.map(i=>__vite__fileDeps[i]);
var U6=Object.defineProperty;var $6=(n,e,t)=>e in n?U6(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var B=(n,e,t)=>($6(n,typeof e!="symbol"?e+"":e,t),t),dv=(n,e,t)=>{if(!e.has(n))throw TypeError("Cannot "+t)};var y=(n,e,t)=>(dv(n,e,"read from private field"),t?t.call(n):e.get(n)),F=(n,e,t)=>{if(e.has(n))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(n):e.set(n,t)},_=(n,e,t,r)=>(dv(n,e,"write to private field"),r?r.call(n,t):e.set(n,t),t);var Qf=(n,e,t,r)=>({set _(s){_(n,e,s,t)},get _(){return y(n,e,r)}}),Z=(n,e,t)=>(dv(n,e,"access private method"),t);import{a3 as FI,a0 as Nk,a4 as Hy,$ as Sn,a2 as so}from"./BLqpxtBP.js";import{u as M6}from"./rx5cLQAs.js";class Du extends Error{}class L6 extends Du{constructor(e){super(`Invalid DateTime: ${e.toMessage()}`)}}class B6 extends Du{constructor(e){super(`Invalid Interval: ${e.toMessage()}`)}}class F6 extends Du{constructor(e){super(`Invalid Duration: ${e.toMessage()}`)}}class Uh extends Du{}class Ok extends Du{constructor(e){super(`Invalid unit ${e}`)}}class rs extends Du{}class Ta extends Du{constructor(){super("Zone is an abstract class")}}const oe="numeric",Pi="short",Ts="long",b0={year:oe,month:oe,day:oe},xk={year:oe,month:Pi,day:oe},j6={year:oe,month:Pi,day:oe,weekday:Pi},Rk={year:oe,month:Ts,day:oe},Pk={year:oe,month:Ts,day:oe,weekday:Ts},kk={hour:oe,minute:oe},Dk={hour:oe,minute:oe,second:oe},Uk={hour:oe,minute:oe,second:oe,timeZoneName:Pi},$k={hour:oe,minute:oe,second:oe,timeZoneName:Ts},Mk={hour:oe,minute:oe,hourCycle:"h23"},Lk={hour:oe,minute:oe,second:oe,hourCycle:"h23"},Bk={hour:oe,minute:oe,second:oe,hourCycle:"h23",timeZoneName:Pi},Fk={hour:oe,minute:oe,second:oe,hourCycle:"h23",timeZoneName:Ts},jk={year:oe,month:oe,day:oe,hour:oe,minute:oe},Hk={year:oe,month:oe,day:oe,hour:oe,minute:oe,second:oe},Vk={year:oe,month:Pi,day:oe,hour:oe,minute:oe},qk={year:oe,month:Pi,day:oe,hour:oe,minute:oe,second:oe},H6={year:oe,month:Pi,day:oe,weekday:Pi,hour:oe,minute:oe},zk={year:oe,month:Ts,day:oe,hour:oe,minute:oe,timeZoneName:Pi},Wk={year:oe,month:Ts,day:oe,hour:oe,minute:oe,second:oe,timeZoneName:Pi},Gk={year:oe,month:Ts,day:oe,weekday:Ts,hour:oe,minute:oe,timeZoneName:Ts},Kk={year:oe,month:Ts,day:oe,weekday:Ts,hour:oe,minute:oe,second:oe,timeZoneName:Ts};class ey{get type(){throw new Ta}get name(){throw new Ta}get ianaName(){return this.name}get isUniversal(){throw new Ta}offsetName(e,t){throw new Ta}formatOffset(e,t){throw new Ta}offset(e){throw new Ta}equals(e){throw new Ta}get isValid(){throw new Ta}}let fv=null;class Bb extends ey{static get instance(){return fv===null&&(fv=new Bb),fv}get type(){return"system"}get name(){return new Intl.DateTimeFormat().resolvedOptions().timeZone}get isUniversal(){return!1}offsetName(e,{format:t,locale:r}){return rD(e,t,r)}formatOffset(e,t){return Hp(this.offset(e),t)}offset(e){return-new Date(e).getTimezoneOffset()}equals(e){return e.type==="system"}get isValid(){return!0}}let Vw={};function V6(n){return Vw[n]||(Vw[n]=new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:n,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",era:"short"})),Vw[n]}const q6={year:0,month:1,day:2,era:3,hour:4,minute:5,second:6};function z6(n,e){const t=n.format(e).replace(/\u200E/g,""),r=/(\d+)\/(\d+)\/(\d+) (AD|BC),? (\d+):(\d+):(\d+)/.exec(t),[,s,i,o,a,c,l,u]=r;return[o,s,i,a,c,l,u]}function W6(n,e){const t=n.formatToParts(e),r=[];for(let s=0;s<t.length;s++){const{type:i,value:o}=t[s],a=q6[i];i==="era"?r[a]=o:Be(a)||(r[a]=parseInt(o,10))}return r}let Vy={};class ga extends ey{static create(e){return Vy[e]||(Vy[e]=new ga(e)),Vy[e]}static resetCache(){Vy={},Vw={}}static isValidSpecifier(e){return this.isValidZone(e)}static isValidZone(e){if(!e)return!1;try{return new Intl.DateTimeFormat("en-US",{timeZone:e}).format(),!0}catch{return!1}}constructor(e){super(),this.zoneName=e,this.valid=ga.isValidZone(e)}get type(){return"iana"}get name(){return this.zoneName}get isUniversal(){return!1}offsetName(e,{format:t,locale:r}){return rD(e,t,r,this.name)}formatOffset(e,t){return Hp(this.offset(e),t)}offset(e){const t=new Date(e);if(isNaN(t))return NaN;const r=V6(this.name);let[s,i,o,a,c,l,u]=r.formatToParts?W6(r,t):z6(r,t);a==="BC"&&(s=-Math.abs(s)+1);const d=jb({year:s,month:i,day:o,hour:c===24?0:c,minute:l,second:u,millisecond:0});let f=+t;const p=f%1e3;return f-=p>=0?p:1e3+p,(d-f)/(60*1e3)}equals(e){return e.type==="iana"&&e.name===this.name}get isValid(){return this.valid}}let UT={};function G6(n,e={}){const t=JSON.stringify([n,e]);let r=UT[t];return r||(r=new Intl.ListFormat(n,e),UT[t]=r),r}let aA={};function cA(n,e={}){const t=JSON.stringify([n,e]);let r=aA[t];return r||(r=new Intl.DateTimeFormat(n,e),aA[t]=r),r}let lA={};function K6(n,e={}){const t=JSON.stringify([n,e]);let r=lA[t];return r||(r=new Intl.NumberFormat(n,e),lA[t]=r),r}let uA={};function Y6(n,e={}){const{base:t,...r}=e,s=JSON.stringify([n,r]);let i=uA[s];return i||(i=new Intl.RelativeTimeFormat(n,e),uA[s]=i),i}let _p=null;function Q6(){return _p||(_p=new Intl.DateTimeFormat().resolvedOptions().locale,_p)}let $T={};function Z6(n){let e=$T[n];if(!e){const t=new Intl.Locale(n);e="getWeekInfo"in t?t.getWeekInfo():t.weekInfo,$T[n]=e}return e}function J6(n){const e=n.indexOf("-x-");e!==-1&&(n=n.substring(0,e));const t=n.indexOf("-u-");if(t===-1)return[n];{let r,s;try{r=cA(n).resolvedOptions(),s=n}catch{const c=n.substring(0,t);r=cA(c).resolvedOptions(),s=c}const{numberingSystem:i,calendar:o}=r;return[s,i,o]}}function X6(n,e,t){return(t||e)&&(n.includes("-u-")||(n+="-u"),t&&(n+=`-ca-${t}`),e&&(n+=`-nu-${e}`)),n}function e8(n){const e=[];for(let t=1;t<=12;t++){const r=Le.utc(2009,t,1);e.push(n(r))}return e}function t8(n){const e=[];for(let t=1;t<=7;t++){const r=Le.utc(2016,11,13+t);e.push(n(r))}return e}function qy(n,e,t,r){const s=n.listingMode();return s==="error"?null:s==="en"?t(e):r(e)}function n8(n){return n.numberingSystem&&n.numberingSystem!=="latn"?!1:n.numberingSystem==="latn"||!n.locale||n.locale.startsWith("en")||new Intl.DateTimeFormat(n.intl).resolvedOptions().numberingSystem==="latn"}class r8{constructor(e,t,r){this.padTo=r.padTo||0,this.floor=r.floor||!1;const{padTo:s,floor:i,...o}=r;if(!t||Object.keys(o).length>0){const a={useGrouping:!1,...r};r.padTo>0&&(a.minimumIntegerDigits=r.padTo),this.inf=K6(e,a)}}format(e){if(this.inf){const t=this.floor?Math.floor(e):e;return this.inf.format(t)}else{const t=this.floor?Math.floor(e):qI(e,3);return hn(t,this.padTo)}}}class s8{constructor(e,t,r){this.opts=r,this.originalZone=void 0;let s;if(this.opts.timeZone)this.dt=e;else if(e.zone.type==="fixed"){const o=-1*(e.offset/60),a=o>=0?`Etc/GMT+${o}`:`Etc/GMT${o}`;e.offset!==0&&ga.create(a).valid?(s=a,this.dt=e):(s="UTC",this.dt=e.offset===0?e:e.setZone("UTC").plus({minutes:e.offset}),this.originalZone=e.zone)}else e.zone.type==="system"?this.dt=e:e.zone.type==="iana"?(this.dt=e,s=e.zone.name):(s="UTC",this.dt=e.setZone("UTC").plus({minutes:e.offset}),this.originalZone=e.zone);const i={...this.opts};i.timeZone=i.timeZone||s,this.dtf=cA(t,i)}format(){return this.originalZone?this.formatToParts().map(({value:e})=>e).join(""):this.dtf.format(this.dt.toJSDate())}formatToParts(){const e=this.dtf.formatToParts(this.dt.toJSDate());return this.originalZone?e.map(t=>{if(t.type==="timeZoneName"){const r=this.originalZone.offsetName(this.dt.ts,{locale:this.dt.locale,format:this.opts.timeZoneName});return{...t,value:r}}else return t}):e}resolvedOptions(){return this.dtf.resolvedOptions()}}class i8{constructor(e,t,r){this.opts={style:"long",...r},!t&&tD()&&(this.rtf=Y6(e,r))}format(e,t){return this.rtf?this.rtf.format(e,t):_8(t,e,this.opts.numeric,this.opts.style!=="long")}formatToParts(e,t){return this.rtf?this.rtf.formatToParts(e,t):[]}}const o8={firstDay:1,minimalDays:4,weekend:[6,7]};class Pt{static fromOpts(e){return Pt.create(e.locale,e.numberingSystem,e.outputCalendar,e.weekSettings,e.defaultToEN)}static create(e,t,r,s,i=!1){const o=e||Xt.defaultLocale,a=o||(i?"en-US":Q6()),c=t||Xt.defaultNumberingSystem,l=r||Xt.defaultOutputCalendar,u=hA(s)||Xt.defaultWeekSettings;return new Pt(a,c,l,u,o)}static resetCache(){_p=null,aA={},lA={},uA={}}static fromObject({locale:e,numberingSystem:t,outputCalendar:r,weekSettings:s}={}){return Pt.create(e,t,r,s)}constructor(e,t,r,s,i){const[o,a,c]=J6(e);this.locale=o,this.numberingSystem=t||a||null,this.outputCalendar=r||c||null,this.weekSettings=s,this.intl=X6(this.locale,this.numberingSystem,this.outputCalendar),this.weekdaysCache={format:{},standalone:{}},this.monthsCache={format:{},standalone:{}},this.meridiemCache=null,this.eraCache={},this.specifiedLocale=i,this.fastNumbersCached=null}get fastNumbers(){return this.fastNumbersCached==null&&(this.fastNumbersCached=n8(this)),this.fastNumbersCached}listingMode(){const e=this.isEnglish(),t=(this.numberingSystem===null||this.numberingSystem==="latn")&&(this.outputCalendar===null||this.outputCalendar==="gregory");return e&&t?"en":"intl"}clone(e){return!e||Object.getOwnPropertyNames(e).length===0?this:Pt.create(e.locale||this.specifiedLocale,e.numberingSystem||this.numberingSystem,e.outputCalendar||this.outputCalendar,hA(e.weekSettings)||this.weekSettings,e.defaultToEN||!1)}redefaultToEN(e={}){return this.clone({...e,defaultToEN:!0})}redefaultToSystem(e={}){return this.clone({...e,defaultToEN:!1})}months(e,t=!1){return qy(this,e,oD,()=>{const r=t?{month:e,day:"numeric"}:{month:e},s=t?"format":"standalone";return this.monthsCache[s][e]||(this.monthsCache[s][e]=e8(i=>this.extract(i,r,"month"))),this.monthsCache[s][e]})}weekdays(e,t=!1){return qy(this,e,lD,()=>{const r=t?{weekday:e,year:"numeric",month:"long",day:"numeric"}:{weekday:e},s=t?"format":"standalone";return this.weekdaysCache[s][e]||(this.weekdaysCache[s][e]=t8(i=>this.extract(i,r,"weekday"))),this.weekdaysCache[s][e]})}meridiems(){return qy(this,void 0,()=>uD,()=>{if(!this.meridiemCache){const e={hour:"numeric",hourCycle:"h12"};this.meridiemCache=[Le.utc(2016,11,13,9),Le.utc(2016,11,13,19)].map(t=>this.extract(t,e,"dayperiod"))}return this.meridiemCache})}eras(e){return qy(this,e,hD,()=>{const t={era:e};return this.eraCache[e]||(this.eraCache[e]=[Le.utc(-40,1,1),Le.utc(2017,1,1)].map(r=>this.extract(r,t,"era"))),this.eraCache[e]})}extract(e,t,r){const s=this.dtFormatter(e,t),i=s.formatToParts(),o=i.find(a=>a.type.toLowerCase()===r);return o?o.value:null}numberFormatter(e={}){return new r8(this.intl,e.forceSimple||this.fastNumbers,e)}dtFormatter(e,t={}){return new s8(e,this.intl,t)}relFormatter(e={}){return new i8(this.intl,this.isEnglish(),e)}listFormatter(e={}){return G6(this.intl,e)}isEnglish(){return this.locale==="en"||this.locale.toLowerCase()==="en-us"||new Intl.DateTimeFormat(this.intl).resolvedOptions().locale.startsWith("en-us")}getWeekSettings(){return this.weekSettings?this.weekSettings:nD()?Z6(this.locale):o8}getStartOfWeek(){return this.getWeekSettings().firstDay}getMinDaysInFirstWeek(){return this.getWeekSettings().minimalDays}getWeekendDays(){return this.getWeekSettings().weekend}equals(e){return this.locale===e.locale&&this.numberingSystem===e.numberingSystem&&this.outputCalendar===e.outputCalendar}}let pv=null;class Or extends ey{static get utcInstance(){return pv===null&&(pv=new Or(0)),pv}static instance(e){return e===0?Or.utcInstance:new Or(e)}static parseSpecifier(e){if(e){const t=e.match(/^utc(?:([+-]\d{1,2})(?::(\d{2}))?)?$/i);if(t)return new Or(Hb(t[1],t[2]))}return null}constructor(e){super(),this.fixed=e}get type(){return"fixed"}get name(){return this.fixed===0?"UTC":`UTC${Hp(this.fixed,"narrow")}`}get ianaName(){return this.fixed===0?"Etc/UTC":`Etc/GMT${Hp(-this.fixed,"narrow")}`}offsetName(){return this.name}formatOffset(e,t){return Hp(this.fixed,t)}get isUniversal(){return!0}offset(){return this.fixed}equals(e){return e.type==="fixed"&&e.fixed===this.fixed}get isValid(){return!0}}class a8 extends ey{constructor(e){super(),this.zoneName=e}get type(){return"invalid"}get name(){return this.zoneName}get isUniversal(){return!1}offsetName(){return null}formatOffset(){return""}offset(){return NaN}equals(){return!1}get isValid(){return!1}}function tc(n,e){if(Be(n)||n===null)return e;if(n instanceof ey)return n;if(u8(n)){const t=n.toLowerCase();return t==="default"?e:t==="local"||t==="system"?Bb.instance:t==="utc"||t==="gmt"?Or.utcInstance:Or.parseSpecifier(t)||ga.create(n)}else return ru(n)?Or.instance(n):typeof n=="object"&&"offset"in n&&typeof n.offset=="function"?n:new a8(n)}let MT=()=>Date.now(),LT="system",BT=null,FT=null,jT=null,HT=60,VT,qT=null;class Xt{static get now(){return MT}static set now(e){MT=e}static set defaultZone(e){LT=e}static get defaultZone(){return tc(LT,Bb.instance)}static get defaultLocale(){return BT}static set defaultLocale(e){BT=e}static get defaultNumberingSystem(){return FT}static set defaultNumberingSystem(e){FT=e}static get defaultOutputCalendar(){return jT}static set defaultOutputCalendar(e){jT=e}static get defaultWeekSettings(){return qT}static set defaultWeekSettings(e){qT=hA(e)}static get twoDigitCutoffYear(){return HT}static set twoDigitCutoffYear(e){HT=e%100}static get throwOnInvalid(){return VT}static set throwOnInvalid(e){VT=e}static resetCaches(){Pt.resetCache(),ga.resetCache()}}class _i{constructor(e,t){this.reason=e,this.explanation=t}toMessage(){return this.explanation?`${this.reason}: ${this.explanation}`:this.reason}}const Yk=[0,31,59,90,120,151,181,212,243,273,304,334],Qk=[0,31,60,91,121,152,182,213,244,274,305,335];function Xs(n,e){return new _i("unit out of range",`you specified ${e} (of type ${typeof e}) as a ${n}, which is invalid`)}function jI(n,e,t){const r=new Date(Date.UTC(n,e-1,t));n<100&&n>=0&&r.setUTCFullYear(r.getUTCFullYear()-1900);const s=r.getUTCDay();return s===0?7:s}function Zk(n,e,t){return t+(ty(n)?Qk:Yk)[e-1]}function Jk(n,e){const t=ty(n)?Qk:Yk,r=t.findIndex(i=>i<e),s=e-t[r];return{month:r+1,day:s}}function HI(n,e){return(n-e+7)%7+1}function E0(n,e=4,t=1){const{year:r,month:s,day:i}=n,o=Zk(r,s,i),a=HI(jI(r,s,i),t);let c=Math.floor((o-a+14-e)/7),l;return c<1?(l=r-1,c=fg(l,e,t)):c>fg(r,e,t)?(l=r+1,c=1):l=r,{weekYear:l,weekNumber:c,weekday:a,...Vb(n)}}function zT(n,e=4,t=1){const{weekYear:r,weekNumber:s,weekday:i}=n,o=HI(jI(r,1,e),t),a=Gh(r);let c=s*7+i-o-7+e,l;c<1?(l=r-1,c+=Gh(l)):c>a?(l=r+1,c-=Gh(r)):l=r;const{month:u,day:h}=Jk(l,c);return{year:l,month:u,day:h,...Vb(n)}}function gv(n){const{year:e,month:t,day:r}=n,s=Zk(e,t,r);return{year:e,ordinal:s,...Vb(n)}}function WT(n){const{year:e,ordinal:t}=n,{month:r,day:s}=Jk(e,t);return{year:e,month:r,day:s,...Vb(n)}}function GT(n,e){if(!Be(n.localWeekday)||!Be(n.localWeekNumber)||!Be(n.localWeekYear)){if(!Be(n.weekday)||!Be(n.weekNumber)||!Be(n.weekYear))throw new Uh("Cannot mix locale-based week fields with ISO-based week fields");return Be(n.localWeekday)||(n.weekday=n.localWeekday),Be(n.localWeekNumber)||(n.weekNumber=n.localWeekNumber),Be(n.localWeekYear)||(n.weekYear=n.localWeekYear),delete n.localWeekday,delete n.localWeekNumber,delete n.localWeekYear,{minDaysInFirstWeek:e.getMinDaysInFirstWeek(),startOfWeek:e.getStartOfWeek()}}else return{minDaysInFirstWeek:4,startOfWeek:1}}function c8(n,e=4,t=1){const r=Fb(n.weekYear),s=ei(n.weekNumber,1,fg(n.weekYear,e,t)),i=ei(n.weekday,1,7);return r?s?i?!1:Xs("weekday",n.weekday):Xs("week",n.weekNumber):Xs("weekYear",n.weekYear)}function l8(n){const e=Fb(n.year),t=ei(n.ordinal,1,Gh(n.year));return e?t?!1:Xs("ordinal",n.ordinal):Xs("year",n.year)}function Xk(n){const e=Fb(n.year),t=ei(n.month,1,12),r=ei(n.day,1,v0(n.year,n.month));return e?t?r?!1:Xs("day",n.day):Xs("month",n.month):Xs("year",n.year)}function eD(n){const{hour:e,minute:t,second:r,millisecond:s}=n,i=ei(e,0,23)||e===24&&t===0&&r===0&&s===0,o=ei(t,0,59),a=ei(r,0,59),c=ei(s,0,999);return i?o?a?c?!1:Xs("millisecond",s):Xs("second",r):Xs("minute",t):Xs("hour",e)}function Be(n){return typeof n>"u"}function ru(n){return typeof n=="number"}function Fb(n){return typeof n=="number"&&n%1===0}function u8(n){return typeof n=="string"}function h8(n){return Object.prototype.toString.call(n)==="[object Date]"}function tD(){try{return typeof Intl<"u"&&!!Intl.RelativeTimeFormat}catch{return!1}}function nD(){try{return typeof Intl<"u"&&!!Intl.Locale&&("weekInfo"in Intl.Locale.prototype||"getWeekInfo"in Intl.Locale.prototype)}catch{return!1}}function d8(n){return Array.isArray(n)?n:[n]}function KT(n,e,t){if(n.length!==0)return n.reduce((r,s)=>{const i=[e(s),s];return r&&t(r[0],i[0])===r[0]?r:i},null)[1]}function f8(n,e){return e.reduce((t,r)=>(t[r]=n[r],t),{})}function Zd(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function hA(n){if(n==null)return null;if(typeof n!="object")throw new rs("Week settings must be an object");if(!ei(n.firstDay,1,7)||!ei(n.minimalDays,1,7)||!Array.isArray(n.weekend)||n.weekend.some(e=>!ei(e,1,7)))throw new rs("Invalid week settings");return{firstDay:n.firstDay,minimalDays:n.minimalDays,weekend:Array.from(n.weekend)}}function ei(n,e,t){return Fb(n)&&n>=e&&n<=t}function p8(n,e){return n-e*Math.floor(n/e)}function hn(n,e=2){const t=n<0;let r;return t?r="-"+(""+-n).padStart(e,"0"):r=(""+n).padStart(e,"0"),r}function Ya(n){if(!(Be(n)||n===null||n===""))return parseInt(n,10)}function Xc(n){if(!(Be(n)||n===null||n===""))return parseFloat(n)}function VI(n){if(!(Be(n)||n===null||n==="")){const e=parseFloat("0."+n)*1e3;return Math.floor(e)}}function qI(n,e,t=!1){const r=10**e;return(t?Math.trunc:Math.round)(n*r)/r}function ty(n){return n%4===0&&(n%100!==0||n%400===0)}function Gh(n){return ty(n)?366:365}function v0(n,e){const t=p8(e-1,12)+1,r=n+(e-t)/12;return t===2?ty(r)?29:28:[31,null,31,30,31,30,31,31,30,31,30,31][t-1]}function jb(n){let e=Date.UTC(n.year,n.month-1,n.day,n.hour,n.minute,n.second,n.millisecond);return n.year<100&&n.year>=0&&(e=new Date(e),e.setUTCFullYear(n.year,n.month-1,n.day)),+e}function YT(n,e,t){return-HI(jI(n,1,e),t)+e-1}function fg(n,e=4,t=1){const r=YT(n,e,t),s=YT(n+1,e,t);return(Gh(n)-r+s)/7}function dA(n){return n>99?n:n>Xt.twoDigitCutoffYear?1900+n:2e3+n}function rD(n,e,t,r=null){const s=new Date(n),i={hourCycle:"h23",year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"};r&&(i.timeZone=r);const o={timeZoneName:e,...i},a=new Intl.DateTimeFormat(t,o).formatToParts(s).find(c=>c.type.toLowerCase()==="timezonename");return a?a.value:null}function Hb(n,e){let t=parseInt(n,10);Number.isNaN(t)&&(t=0);const r=parseInt(e,10)||0,s=t<0||Object.is(t,-0)?-r:r;return t*60+s}function sD(n){const e=Number(n);if(typeof n=="boolean"||n===""||Number.isNaN(e))throw new rs(`Invalid unit value ${n}`);return e}function A0(n,e){const t={};for(const r in n)if(Zd(n,r)){const s=n[r];if(s==null)continue;t[e(r)]=sD(s)}return t}function Hp(n,e){const t=Math.trunc(Math.abs(n/60)),r=Math.trunc(Math.abs(n%60)),s=n>=0?"+":"-";switch(e){case"short":return`${s}${hn(t,2)}:${hn(r,2)}`;case"narrow":return`${s}${t}${r>0?`:${r}`:""}`;case"techie":return`${s}${hn(t,2)}${hn(r,2)}`;default:throw new RangeError(`Value format ${e} is out of range for property format`)}}function Vb(n){return f8(n,["hour","minute","second","millisecond"])}const g8=["January","February","March","April","May","June","July","August","September","October","November","December"],iD=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],m8=["J","F","M","A","M","J","J","A","S","O","N","D"];function oD(n){switch(n){case"narrow":return[...m8];case"short":return[...iD];case"long":return[...g8];case"numeric":return["1","2","3","4","5","6","7","8","9","10","11","12"];case"2-digit":return["01","02","03","04","05","06","07","08","09","10","11","12"];default:return null}}const aD=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],cD=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],y8=["M","T","W","T","F","S","S"];function lD(n){switch(n){case"narrow":return[...y8];case"short":return[...cD];case"long":return[...aD];case"numeric":return["1","2","3","4","5","6","7"];default:return null}}const uD=["AM","PM"],w8=["Before Christ","Anno Domini"],b8=["BC","AD"],E8=["B","A"];function hD(n){switch(n){case"narrow":return[...E8];case"short":return[...b8];case"long":return[...w8];default:return null}}function v8(n){return uD[n.hour<12?0:1]}function A8(n,e){return lD(e)[n.weekday-1]}function C8(n,e){return oD(e)[n.month-1]}function I8(n,e){return hD(e)[n.year<0?0:1]}function _8(n,e,t="always",r=!1){const s={years:["year","yr."],quarters:["quarter","qtr."],months:["month","mo."],weeks:["week","wk."],days:["day","day","days"],hours:["hour","hr."],minutes:["minute","min."],seconds:["second","sec."]},i=["hours","minutes","seconds"].indexOf(n)===-1;if(t==="auto"&&i){const h=n==="days";switch(e){case 1:return h?"tomorrow":`next ${s[n][0]}`;case-1:return h?"yesterday":`last ${s[n][0]}`;case 0:return h?"today":`this ${s[n][0]}`}}const o=Object.is(e,-0)||e<0,a=Math.abs(e),c=a===1,l=s[n],u=r?c?l[1]:l[2]||l[1]:c?s[n][0]:n;return o?`${a} ${u} ago`:`in ${a} ${u}`}function QT(n,e){let t="";for(const r of n)r.literal?t+=r.val:t+=e(r.val);return t}const S8={D:b0,DD:xk,DDD:Rk,DDDD:Pk,t:kk,tt:Dk,ttt:Uk,tttt:$k,T:Mk,TT:Lk,TTT:Bk,TTTT:Fk,f:jk,ff:Vk,fff:zk,ffff:Gk,F:Hk,FF:qk,FFF:Wk,FFFF:Kk};class dr{static create(e,t={}){return new dr(e,t)}static parseFormat(e){let t=null,r="",s=!1;const i=[];for(let o=0;o<e.length;o++){const a=e.charAt(o);a==="'"?(r.length>0&&i.push({literal:s||/^\s+$/.test(r),val:r}),t=null,r="",s=!s):s||a===t?r+=a:(r.length>0&&i.push({literal:/^\s+$/.test(r),val:r}),r=a,t=a)}return r.length>0&&i.push({literal:s||/^\s+$/.test(r),val:r}),i}static macroTokenToFormatOpts(e){return S8[e]}constructor(e,t){this.opts=t,this.loc=e,this.systemLoc=null}formatWithSystemDefault(e,t){return this.systemLoc===null&&(this.systemLoc=this.loc.redefaultToSystem()),this.systemLoc.dtFormatter(e,{...this.opts,...t}).format()}dtFormatter(e,t={}){return this.loc.dtFormatter(e,{...this.opts,...t})}formatDateTime(e,t){return this.dtFormatter(e,t).format()}formatDateTimeParts(e,t){return this.dtFormatter(e,t).formatToParts()}formatInterval(e,t){return this.dtFormatter(e.start,t).dtf.formatRange(e.start.toJSDate(),e.end.toJSDate())}resolvedOptions(e,t){return this.dtFormatter(e,t).resolvedOptions()}num(e,t=0){if(this.opts.forceSimple)return hn(e,t);const r={...this.opts};return t>0&&(r.padTo=t),this.loc.numberFormatter(r).format(e)}formatDateTimeFromString(e,t){const r=this.loc.listingMode()==="en",s=this.loc.outputCalendar&&this.loc.outputCalendar!=="gregory",i=(f,p)=>this.loc.extract(e,f,p),o=f=>e.isOffsetFixed&&e.offset===0&&f.allowZ?"Z":e.isValid?e.zone.formatOffset(e.ts,f.format):"",a=()=>r?v8(e):i({hour:"numeric",hourCycle:"h12"},"dayperiod"),c=(f,p)=>r?C8(e,f):i(p?{month:f}:{month:f,day:"numeric"},"month"),l=(f,p)=>r?A8(e,f):i(p?{weekday:f}:{weekday:f,month:"long",day:"numeric"},"weekday"),u=f=>{const p=dr.macroTokenToFormatOpts(f);return p?this.formatWithSystemDefault(e,p):f},h=f=>r?I8(e,f):i({era:f},"era"),d=f=>{switch(f){case"S":return this.num(e.millisecond);case"u":case"SSS":return this.num(e.millisecond,3);case"s":return this.num(e.second);case"ss":return this.num(e.second,2);case"uu":return this.num(Math.floor(e.millisecond/10),2);case"uuu":return this.num(Math.floor(e.millisecond/100));case"m":return this.num(e.minute);case"mm":return this.num(e.minute,2);case"h":return this.num(e.hour%12===0?12:e.hour%12);case"hh":return this.num(e.hour%12===0?12:e.hour%12,2);case"H":return this.num(e.hour);case"HH":return this.num(e.hour,2);case"Z":return o({format:"narrow",allowZ:this.opts.allowZ});case"ZZ":return o({format:"short",allowZ:this.opts.allowZ});case"ZZZ":return o({format:"techie",allowZ:this.opts.allowZ});case"ZZZZ":return e.zone.offsetName(e.ts,{format:"short",locale:this.loc.locale});case"ZZZZZ":return e.zone.offsetName(e.ts,{format:"long",locale:this.loc.locale});case"z":return e.zoneName;case"a":return a();case"d":return s?i({day:"numeric"},"day"):this.num(e.day);case"dd":return s?i({day:"2-digit"},"day"):this.num(e.day,2);case"c":return this.num(e.weekday);case"ccc":return l("short",!0);case"cccc":return l("long",!0);case"ccccc":return l("narrow",!0);case"E":return this.num(e.weekday);case"EEE":return l("short",!1);case"EEEE":return l("long",!1);case"EEEEE":return l("narrow",!1);case"L":return s?i({month:"numeric",day:"numeric"},"month"):this.num(e.month);case"LL":return s?i({month:"2-digit",day:"numeric"},"month"):this.num(e.month,2);case"LLL":return c("short",!0);case"LLLL":return c("long",!0);case"LLLLL":return c("narrow",!0);case"M":return s?i({month:"numeric"},"month"):this.num(e.month);case"MM":return s?i({month:"2-digit"},"month"):this.num(e.month,2);case"MMM":return c("short",!1);case"MMMM":return c("long",!1);case"MMMMM":return c("narrow",!1);case"y":return s?i({year:"numeric"},"year"):this.num(e.year);case"yy":return s?i({year:"2-digit"},"year"):this.num(e.year.toString().slice(-2),2);case"yyyy":return s?i({year:"numeric"},"year"):this.num(e.year,4);case"yyyyyy":return s?i({year:"numeric"},"year"):this.num(e.year,6);case"G":return h("short");case"GG":return h("long");case"GGGGG":return h("narrow");case"kk":return this.num(e.weekYear.toString().slice(-2),2);case"kkkk":return this.num(e.weekYear,4);case"W":return this.num(e.weekNumber);case"WW":return this.num(e.weekNumber,2);case"n":return this.num(e.localWeekNumber);case"nn":return this.num(e.localWeekNumber,2);case"ii":return this.num(e.localWeekYear.toString().slice(-2),2);case"iiii":return this.num(e.localWeekYear,4);case"o":return this.num(e.ordinal);case"ooo":return this.num(e.ordinal,3);case"q":return this.num(e.quarter);case"qq":return this.num(e.quarter,2);case"X":return this.num(Math.floor(e.ts/1e3));case"x":return this.num(e.ts);default:return u(f)}};return QT(dr.parseFormat(t),d)}formatDurationFromString(e,t){const r=c=>{switch(c[0]){case"S":return"millisecond";case"s":return"second";case"m":return"minute";case"h":return"hour";case"d":return"day";case"w":return"week";case"M":return"month";case"y":return"year";default:return null}},s=c=>l=>{const u=r(l);return u?this.num(c.get(u),l.length):l},i=dr.parseFormat(t),o=i.reduce((c,{literal:l,val:u})=>l?c:c.concat(u),[]),a=e.shiftTo(...o.map(r).filter(c=>c));return QT(i,s(a))}}const dD=/[A-Za-z_+-]{1,256}(?::?\/[A-Za-z0-9_+-]{1,256}(?:\/[A-Za-z0-9_+-]{1,256})?)?/;function Tf(...n){const e=n.reduce((t,r)=>t+r.source,"");return RegExp(`^${e}$`)}function Nf(...n){return e=>n.reduce(([t,r,s],i)=>{const[o,a,c]=i(e,s);return[{...t,...o},a||r,c]},[{},null,1]).slice(0,2)}function Of(n,...e){if(n==null)return[null,null];for(const[t,r]of e){const s=t.exec(n);if(s)return r(s)}return[null,null]}function fD(...n){return(e,t)=>{const r={};let s;for(s=0;s<n.length;s++)r[n[s]]=Ya(e[t+s]);return[r,null,t+s]}}const pD=/(?:(Z)|([+-]\d\d)(?::?(\d\d))?)/,T8=`(?:${pD.source}?(?:\\[(${dD.source})\\])?)?`,zI=/(\d\d)(?::?(\d\d)(?::?(\d\d)(?:[.,](\d{1,30}))?)?)?/,gD=RegExp(`${zI.source}${T8}`),WI=RegExp(`(?:T${gD.source})?`),N8=/([+-]\d{6}|\d{4})(?:-?(\d\d)(?:-?(\d\d))?)?/,O8=/(\d{4})-?W(\d\d)(?:-?(\d))?/,x8=/(\d{4})-?(\d{3})/,R8=fD("weekYear","weekNumber","weekDay"),P8=fD("year","ordinal"),k8=/(\d{4})-(\d\d)-(\d\d)/,mD=RegExp(`${zI.source} ?(?:${pD.source}|(${dD.source}))?`),D8=RegExp(`(?: ${mD.source})?`);function Kh(n,e,t){const r=n[e];return Be(r)?t:Ya(r)}function U8(n,e){return[{year:Kh(n,e),month:Kh(n,e+1,1),day:Kh(n,e+2,1)},null,e+3]}function xf(n,e){return[{hours:Kh(n,e,0),minutes:Kh(n,e+1,0),seconds:Kh(n,e+2,0),milliseconds:VI(n[e+3])},null,e+4]}function ny(n,e){const t=!n[e]&&!n[e+1],r=Hb(n[e+1],n[e+2]),s=t?null:Or.instance(r);return[{},s,e+3]}function ry(n,e){const t=n[e]?ga.create(n[e]):null;return[{},t,e+1]}const $8=RegExp(`^T?${zI.source}$`),M8=/^-?P(?:(?:(-?\d{1,20}(?:\.\d{1,20})?)Y)?(?:(-?\d{1,20}(?:\.\d{1,20})?)M)?(?:(-?\d{1,20}(?:\.\d{1,20})?)W)?(?:(-?\d{1,20}(?:\.\d{1,20})?)D)?(?:T(?:(-?\d{1,20}(?:\.\d{1,20})?)H)?(?:(-?\d{1,20}(?:\.\d{1,20})?)M)?(?:(-?\d{1,20})(?:[.,](-?\d{1,20}))?S)?)?)$/;function L8(n){const[e,t,r,s,i,o,a,c,l]=n,u=e[0]==="-",h=c&&c[0]==="-",d=(f,p=!1)=>f!==void 0&&(p||f&&u)?-f:f;return[{years:d(Xc(t)),months:d(Xc(r)),weeks:d(Xc(s)),days:d(Xc(i)),hours:d(Xc(o)),minutes:d(Xc(a)),seconds:d(Xc(c),c==="-0"),milliseconds:d(VI(l),h)}]}const B8={GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function GI(n,e,t,r,s,i,o){const a={year:e.length===2?dA(Ya(e)):Ya(e),month:iD.indexOf(t)+1,day:Ya(r),hour:Ya(s),minute:Ya(i)};return o&&(a.second=Ya(o)),n&&(a.weekday=n.length>3?aD.indexOf(n)+1:cD.indexOf(n)+1),a}const F8=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|(?:([+-]\d\d)(\d\d)))$/;function j8(n){const[,e,t,r,s,i,o,a,c,l,u,h]=n,d=GI(e,s,r,t,i,o,a);let f;return c?f=B8[c]:l?f=0:f=Hb(u,h),[d,new Or(f)]}function H8(n){return n.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").trim()}const V8=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), (\d\d) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) (\d{4}) (\d\d):(\d\d):(\d\d) GMT$/,q8=/^(Monday|Tuesday|Wednesday|Thursday|Friday|Saturday|Sunday), (\d\d)-(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)-(\d\d) (\d\d):(\d\d):(\d\d) GMT$/,z8=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) ( \d|\d\d) (\d\d):(\d\d):(\d\d) (\d{4})$/;function ZT(n){const[,e,t,r,s,i,o,a]=n;return[GI(e,s,r,t,i,o,a),Or.utcInstance]}function W8(n){const[,e,t,r,s,i,o,a]=n;return[GI(e,a,t,r,s,i,o),Or.utcInstance]}const G8=Tf(N8,WI),K8=Tf(O8,WI),Y8=Tf(x8,WI),Q8=Tf(gD),yD=Nf(U8,xf,ny,ry),Z8=Nf(R8,xf,ny,ry),J8=Nf(P8,xf,ny,ry),X8=Nf(xf,ny,ry);function eF(n){return Of(n,[G8,yD],[K8,Z8],[Y8,J8],[Q8,X8])}function tF(n){return Of(H8(n),[F8,j8])}function nF(n){return Of(n,[V8,ZT],[q8,ZT],[z8,W8])}function rF(n){return Of(n,[M8,L8])}const sF=Nf(xf);function iF(n){return Of(n,[$8,sF])}const oF=Tf(k8,D8),aF=Tf(mD),cF=Nf(xf,ny,ry);function lF(n){return Of(n,[oF,yD],[aF,cF])}const JT="Invalid Duration",wD={weeks:{days:7,hours:7*24,minutes:7*24*60,seconds:7*24*60*60,milliseconds:7*24*60*60*1e3},days:{hours:24,minutes:24*60,seconds:24*60*60,milliseconds:24*60*60*1e3},hours:{minutes:60,seconds:60*60,milliseconds:60*60*1e3},minutes:{seconds:60,milliseconds:60*1e3},seconds:{milliseconds:1e3}},uF={years:{quarters:4,months:12,weeks:52,days:365,hours:365*24,minutes:365*24*60,seconds:365*24*60*60,milliseconds:365*24*60*60*1e3},quarters:{months:3,weeks:13,days:91,hours:91*24,minutes:91*24*60,seconds:91*24*60*60,milliseconds:91*24*60*60*1e3},months:{weeks:4,days:30,hours:30*24,minutes:30*24*60,seconds:30*24*60*60,milliseconds:30*24*60*60*1e3},...wD},ks=146097/400,Yu=146097/4800,hF={years:{quarters:4,months:12,weeks:ks/7,days:ks,hours:ks*24,minutes:ks*24*60,seconds:ks*24*60*60,milliseconds:ks*24*60*60*1e3},quarters:{months:3,weeks:ks/28,days:ks/4,hours:ks*24/4,minutes:ks*24*60/4,seconds:ks*24*60*60/4,milliseconds:ks*24*60*60*1e3/4},months:{weeks:Yu/7,days:Yu,hours:Yu*24,minutes:Yu*24*60,seconds:Yu*24*60*60,milliseconds:Yu*24*60*60*1e3},...wD},El=["years","quarters","months","weeks","days","hours","minutes","seconds","milliseconds"],dF=El.slice(0).reverse();function Na(n,e,t=!1){const r={values:t?e.values:{...n.values,...e.values||{}},loc:n.loc.clone(e.loc),conversionAccuracy:e.conversionAccuracy||n.conversionAccuracy,matrix:e.matrix||n.matrix};return new ct(r)}function bD(n,e){let t=e.milliseconds??0;for(const r of dF.slice(1))e[r]&&(t+=e[r]*n[r].milliseconds);return t}function XT(n,e){const t=bD(n,e)<0?-1:1;El.reduceRight((r,s)=>{if(Be(e[s]))return r;if(r){const i=e[r]*t,o=n[s][r],a=Math.floor(i/o);e[s]+=a*t,e[r]-=a*o*t}return s},null),El.reduce((r,s)=>{if(Be(e[s]))return r;if(r){const i=e[r]%1;e[r]-=i,e[s]+=i*n[r][s]}return s},null)}function fF(n){const e={};for(const[t,r]of Object.entries(n))r!==0&&(e[t]=r);return e}class ct{constructor(e){const t=e.conversionAccuracy==="longterm"||!1;let r=t?hF:uF;e.matrix&&(r=e.matrix),this.values=e.values,this.loc=e.loc||Pt.create(),this.conversionAccuracy=t?"longterm":"casual",this.invalid=e.invalid||null,this.matrix=r,this.isLuxonDuration=!0}static fromMillis(e,t){return ct.fromObject({milliseconds:e},t)}static fromObject(e,t={}){if(e==null||typeof e!="object")throw new rs(`Duration.fromObject: argument expected to be an object, got ${e===null?"null":typeof e}`);return new ct({values:A0(e,ct.normalizeUnit),loc:Pt.fromObject(t),conversionAccuracy:t.conversionAccuracy,matrix:t.matrix})}static fromDurationLike(e){if(ru(e))return ct.fromMillis(e);if(ct.isDuration(e))return e;if(typeof e=="object")return ct.fromObject(e);throw new rs(`Unknown duration argument ${e} of type ${typeof e}`)}static fromISO(e,t){const[r]=rF(e);return r?ct.fromObject(r,t):ct.invalid("unparsable",`the input "${e}" can't be parsed as ISO 8601`)}static fromISOTime(e,t){const[r]=iF(e);return r?ct.fromObject(r,t):ct.invalid("unparsable",`the input "${e}" can't be parsed as ISO 8601`)}static invalid(e,t=null){if(!e)throw new rs("need to specify a reason the Duration is invalid");const r=e instanceof _i?e:new _i(e,t);if(Xt.throwOnInvalid)throw new F6(r);return new ct({invalid:r})}static normalizeUnit(e){const t={year:"years",years:"years",quarter:"quarters",quarters:"quarters",month:"months",months:"months",week:"weeks",weeks:"weeks",day:"days",days:"days",hour:"hours",hours:"hours",minute:"minutes",minutes:"minutes",second:"seconds",seconds:"seconds",millisecond:"milliseconds",milliseconds:"milliseconds"}[e&&e.toLowerCase()];if(!t)throw new Ok(e);return t}static isDuration(e){return e&&e.isLuxonDuration||!1}get locale(){return this.isValid?this.loc.locale:null}get numberingSystem(){return this.isValid?this.loc.numberingSystem:null}toFormat(e,t={}){const r={...t,floor:t.round!==!1&&t.floor!==!1};return this.isValid?dr.create(this.loc,r).formatDurationFromString(this,e):JT}toHuman(e={}){if(!this.isValid)return JT;const t=El.map(r=>{const s=this.values[r];return Be(s)?null:this.loc.numberFormatter({style:"unit",unitDisplay:"long",...e,unit:r.slice(0,-1)}).format(s)}).filter(r=>r);return this.loc.listFormatter({type:"conjunction",style:e.listStyle||"narrow",...e}).format(t)}toObject(){return this.isValid?{...this.values}:{}}toISO(){if(!this.isValid)return null;let e="P";return this.years!==0&&(e+=this.years+"Y"),(this.months!==0||this.quarters!==0)&&(e+=this.months+this.quarters*3+"M"),this.weeks!==0&&(e+=this.weeks+"W"),this.days!==0&&(e+=this.days+"D"),(this.hours!==0||this.minutes!==0||this.seconds!==0||this.milliseconds!==0)&&(e+="T"),this.hours!==0&&(e+=this.hours+"H"),this.minutes!==0&&(e+=this.minutes+"M"),(this.seconds!==0||this.milliseconds!==0)&&(e+=qI(this.seconds+this.milliseconds/1e3,3)+"S"),e==="P"&&(e+="T0S"),e}toISOTime(e={}){if(!this.isValid)return null;const t=this.toMillis();return t<0||t>=864e5?null:(e={suppressMilliseconds:!1,suppressSeconds:!1,includePrefix:!1,format:"extended",...e,includeOffset:!1},Le.fromMillis(t,{zone:"UTC"}).toISOTime(e))}toJSON(){return this.toISO()}toString(){return this.toISO()}[Symbol.for("nodejs.util.inspect.custom")](){return this.isValid?`Duration { values: ${JSON.stringify(this.values)} }`:`Duration { Invalid, reason: ${this.invalidReason} }`}toMillis(){return this.isValid?bD(this.matrix,this.values):NaN}valueOf(){return this.toMillis()}plus(e){if(!this.isValid)return this;const t=ct.fromDurationLike(e),r={};for(const s of El)(Zd(t.values,s)||Zd(this.values,s))&&(r[s]=t.get(s)+this.get(s));return Na(this,{values:r},!0)}minus(e){if(!this.isValid)return this;const t=ct.fromDurationLike(e);return this.plus(t.negate())}mapUnits(e){if(!this.isValid)return this;const t={};for(const r of Object.keys(this.values))t[r]=sD(e(this.values[r],r));return Na(this,{values:t},!0)}get(e){return this[ct.normalizeUnit(e)]}set(e){if(!this.isValid)return this;const t={...this.values,...A0(e,ct.normalizeUnit)};return Na(this,{values:t})}reconfigure({locale:e,numberingSystem:t,conversionAccuracy:r,matrix:s}={}){const o={loc:this.loc.clone({locale:e,numberingSystem:t}),matrix:s,conversionAccuracy:r};return Na(this,o)}as(e){return this.isValid?this.shiftTo(e).get(e):NaN}normalize(){if(!this.isValid)return this;const e=this.toObject();return XT(this.matrix,e),Na(this,{values:e},!0)}rescale(){if(!this.isValid)return this;const e=fF(this.normalize().shiftToAll().toObject());return Na(this,{values:e},!0)}shiftTo(...e){if(!this.isValid)return this;if(e.length===0)return this;e=e.map(o=>ct.normalizeUnit(o));const t={},r={},s=this.toObject();let i;for(const o of El)if(e.indexOf(o)>=0){i=o;let a=0;for(const l in r)a+=this.matrix[l][o]*r[l],r[l]=0;ru(s[o])&&(a+=s[o]);const c=Math.trunc(a);t[o]=c,r[o]=(a*1e3-c*1e3)/1e3}else ru(s[o])&&(r[o]=s[o]);for(const o in r)r[o]!==0&&(t[i]+=o===i?r[o]:r[o]/this.matrix[i][o]);return XT(this.matrix,t),Na(this,{values:t},!0)}shiftToAll(){return this.isValid?this.shiftTo("years","months","weeks","days","hours","minutes","seconds","milliseconds"):this}negate(){if(!this.isValid)return this;const e={};for(const t of Object.keys(this.values))e[t]=this.values[t]===0?0:-this.values[t];return Na(this,{values:e},!0)}get years(){return this.isValid?this.values.years||0:NaN}get quarters(){return this.isValid?this.values.quarters||0:NaN}get months(){return this.isValid?this.values.months||0:NaN}get weeks(){return this.isValid?this.values.weeks||0:NaN}get days(){return this.isValid?this.values.days||0:NaN}get hours(){return this.isValid?this.values.hours||0:NaN}get minutes(){return this.isValid?this.values.minutes||0:NaN}get seconds(){return this.isValid?this.values.seconds||0:NaN}get milliseconds(){return this.isValid?this.values.milliseconds||0:NaN}get isValid(){return this.invalid===null}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}equals(e){if(!this.isValid||!e.isValid||!this.loc.equals(e.loc))return!1;function t(r,s){return r===void 0||r===0?s===void 0||s===0:r===s}for(const r of El)if(!t(this.values[r],e.values[r]))return!1;return!0}}const Qu="Invalid Interval";function pF(n,e){return!n||!n.isValid?Qt.invalid("missing or invalid start"):!e||!e.isValid?Qt.invalid("missing or invalid end"):e<n?Qt.invalid("end before start",`The end of an interval must be after its start, but you had start=${n.toISO()} and end=${e.toISO()}`):null}class Qt{constructor(e){this.s=e.start,this.e=e.end,this.invalid=e.invalid||null,this.isLuxonInterval=!0}static invalid(e,t=null){if(!e)throw new rs("need to specify a reason the Interval is invalid");const r=e instanceof _i?e:new _i(e,t);if(Xt.throwOnInvalid)throw new B6(r);return new Qt({invalid:r})}static fromDateTimes(e,t){const r=Jf(e),s=Jf(t),i=pF(r,s);return i??new Qt({start:r,end:s})}static after(e,t){const r=ct.fromDurationLike(t),s=Jf(e);return Qt.fromDateTimes(s,s.plus(r))}static before(e,t){const r=ct.fromDurationLike(t),s=Jf(e);return Qt.fromDateTimes(s.minus(r),s)}static fromISO(e,t){const[r,s]=(e||"").split("/",2);if(r&&s){let i,o;try{i=Le.fromISO(r,t),o=i.isValid}catch{o=!1}let a,c;try{a=Le.fromISO(s,t),c=a.isValid}catch{c=!1}if(o&&c)return Qt.fromDateTimes(i,a);if(o){const l=ct.fromISO(s,t);if(l.isValid)return Qt.after(i,l)}else if(c){const l=ct.fromISO(r,t);if(l.isValid)return Qt.before(a,l)}}return Qt.invalid("unparsable",`the input "${e}" can't be parsed as ISO 8601`)}static isInterval(e){return e&&e.isLuxonInterval||!1}get start(){return this.isValid?this.s:null}get end(){return this.isValid?this.e:null}get isValid(){return this.invalidReason===null}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}length(e="milliseconds"){return this.isValid?this.toDuration(e).get(e):NaN}count(e="milliseconds",t){if(!this.isValid)return NaN;const r=this.start.startOf(e,t);let s;return t!=null&&t.useLocaleWeeks?s=this.end.reconfigure({locale:r.locale}):s=this.end,s=s.startOf(e,t),Math.floor(s.diff(r,e).get(e))+(s.valueOf()!==this.end.valueOf())}hasSame(e){return this.isValid?this.isEmpty()||this.e.minus(1).hasSame(this.s,e):!1}isEmpty(){return this.s.valueOf()===this.e.valueOf()}isAfter(e){return this.isValid?this.s>e:!1}isBefore(e){return this.isValid?this.e<=e:!1}contains(e){return this.isValid?this.s<=e&&this.e>e:!1}set({start:e,end:t}={}){return this.isValid?Qt.fromDateTimes(e||this.s,t||this.e):this}splitAt(...e){if(!this.isValid)return[];const t=e.map(Jf).filter(o=>this.contains(o)).sort((o,a)=>o.toMillis()-a.toMillis()),r=[];let{s}=this,i=0;for(;s<this.e;){const o=t[i]||this.e,a=+o>+this.e?this.e:o;r.push(Qt.fromDateTimes(s,a)),s=a,i+=1}return r}splitBy(e){const t=ct.fromDurationLike(e);if(!this.isValid||!t.isValid||t.as("milliseconds")===0)return[];let{s:r}=this,s=1,i;const o=[];for(;r<this.e;){const a=this.start.plus(t.mapUnits(c=>c*s));i=+a>+this.e?this.e:a,o.push(Qt.fromDateTimes(r,i)),r=i,s+=1}return o}divideEqually(e){return this.isValid?this.splitBy(this.length()/e).slice(0,e):[]}overlaps(e){return this.e>e.s&&this.s<e.e}abutsStart(e){return this.isValid?+this.e==+e.s:!1}abutsEnd(e){return this.isValid?+e.e==+this.s:!1}engulfs(e){return this.isValid?this.s<=e.s&&this.e>=e.e:!1}equals(e){return!this.isValid||!e.isValid?!1:this.s.equals(e.s)&&this.e.equals(e.e)}intersection(e){if(!this.isValid)return this;const t=this.s>e.s?this.s:e.s,r=this.e<e.e?this.e:e.e;return t>=r?null:Qt.fromDateTimes(t,r)}union(e){if(!this.isValid)return this;const t=this.s<e.s?this.s:e.s,r=this.e>e.e?this.e:e.e;return Qt.fromDateTimes(t,r)}static merge(e){const[t,r]=e.sort((s,i)=>s.s-i.s).reduce(([s,i],o)=>i?i.overlaps(o)||i.abutsStart(o)?[s,i.union(o)]:[s.concat([i]),o]:[s,o],[[],null]);return r&&t.push(r),t}static xor(e){let t=null,r=0;const s=[],i=e.map(c=>[{time:c.s,type:"s"},{time:c.e,type:"e"}]),o=Array.prototype.concat(...i),a=o.sort((c,l)=>c.time-l.time);for(const c of a)r+=c.type==="s"?1:-1,r===1?t=c.time:(t&&+t!=+c.time&&s.push(Qt.fromDateTimes(t,c.time)),t=null);return Qt.merge(s)}difference(...e){return Qt.xor([this].concat(e)).map(t=>this.intersection(t)).filter(t=>t&&!t.isEmpty())}toString(){return this.isValid?`[${this.s.toISO()} – ${this.e.toISO()})`:Qu}[Symbol.for("nodejs.util.inspect.custom")](){return this.isValid?`Interval { start: ${this.s.toISO()}, end: ${this.e.toISO()} }`:`Interval { Invalid, reason: ${this.invalidReason} }`}toLocaleString(e=b0,t={}){return this.isValid?dr.create(this.s.loc.clone(t),e).formatInterval(this):Qu}toISO(e){return this.isValid?`${this.s.toISO(e)}/${this.e.toISO(e)}`:Qu}toISODate(){return this.isValid?`${this.s.toISODate()}/${this.e.toISODate()}`:Qu}toISOTime(e){return this.isValid?`${this.s.toISOTime(e)}/${this.e.toISOTime(e)}`:Qu}toFormat(e,{separator:t=" – "}={}){return this.isValid?`${this.s.toFormat(e)}${t}${this.e.toFormat(e)}`:Qu}toDuration(e,t){return this.isValid?this.e.diff(this.s,e,t):ct.invalid(this.invalidReason)}mapEndpoints(e){return Qt.fromDateTimes(e(this.s),e(this.e))}}class zy{static hasDST(e=Xt.defaultZone){const t=Le.now().setZone(e).set({month:12});return!e.isUniversal&&t.offset!==t.set({month:6}).offset}static isValidIANAZone(e){return ga.isValidZone(e)}static normalizeZone(e){return tc(e,Xt.defaultZone)}static getStartOfWeek({locale:e=null,locObj:t=null}={}){return(t||Pt.create(e)).getStartOfWeek()}static getMinimumDaysInFirstWeek({locale:e=null,locObj:t=null}={}){return(t||Pt.create(e)).getMinDaysInFirstWeek()}static getWeekendWeekdays({locale:e=null,locObj:t=null}={}){return(t||Pt.create(e)).getWeekendDays().slice()}static months(e="long",{locale:t=null,numberingSystem:r=null,locObj:s=null,outputCalendar:i="gregory"}={}){return(s||Pt.create(t,r,i)).months(e)}static monthsFormat(e="long",{locale:t=null,numberingSystem:r=null,locObj:s=null,outputCalendar:i="gregory"}={}){return(s||Pt.create(t,r,i)).months(e,!0)}static weekdays(e="long",{locale:t=null,numberingSystem:r=null,locObj:s=null}={}){return(s||Pt.create(t,r,null)).weekdays(e)}static weekdaysFormat(e="long",{locale:t=null,numberingSystem:r=null,locObj:s=null}={}){return(s||Pt.create(t,r,null)).weekdays(e,!0)}static meridiems({locale:e=null}={}){return Pt.create(e).meridiems()}static eras(e="short",{locale:t=null}={}){return Pt.create(t,null,"gregory").eras(e)}static features(){return{relative:tD(),localeWeek:nD()}}}function eN(n,e){const t=s=>s.toUTC(0,{keepLocalTime:!0}).startOf("day").valueOf(),r=t(e)-t(n);return Math.floor(ct.fromMillis(r).as("days"))}function gF(n,e,t){const r=[["years",(c,l)=>l.year-c.year],["quarters",(c,l)=>l.quarter-c.quarter+(l.year-c.year)*4],["months",(c,l)=>l.month-c.month+(l.year-c.year)*12],["weeks",(c,l)=>{const u=eN(c,l);return(u-u%7)/7}],["days",eN]],s={},i=n;let o,a;for(const[c,l]of r)t.indexOf(c)>=0&&(o=c,s[c]=l(n,e),a=i.plus(s),a>e?(s[c]--,n=i.plus(s),n>e&&(a=n,s[c]--,n=i.plus(s))):n=a);return[n,s,a,o]}function mF(n,e,t,r){let[s,i,o,a]=gF(n,e,t);const c=e-s,l=t.filter(h=>["hours","minutes","seconds","milliseconds"].indexOf(h)>=0);l.length===0&&(o<e&&(o=s.plus({[a]:1})),o!==s&&(i[a]=(i[a]||0)+c/(o-s)));const u=ct.fromObject(i,r);return l.length>0?ct.fromMillis(c,r).shiftTo(...l).plus(u):u}const KI={arab:"[٠-٩]",arabext:"[۰-۹]",bali:"[᭐-᭙]",beng:"[০-৯]",deva:"[०-९]",fullwide:"[０-９]",gujr:"[૦-૯]",hanidec:"[〇|一|二|三|四|五|六|七|八|九]",khmr:"[០-៩]",knda:"[೦-೯]",laoo:"[໐-໙]",limb:"[᥆-᥏]",mlym:"[൦-൯]",mong:"[᠐-᠙]",mymr:"[၀-၉]",orya:"[୦-୯]",tamldec:"[௦-௯]",telu:"[౦-౯]",thai:"[๐-๙]",tibt:"[༠-༩]",latn:"\\d"},tN={arab:[1632,1641],arabext:[1776,1785],bali:[6992,7001],beng:[2534,2543],deva:[2406,2415],fullwide:[65296,65303],gujr:[2790,2799],khmr:[6112,6121],knda:[3302,3311],laoo:[3792,3801],limb:[6470,6479],mlym:[3430,3439],mong:[6160,6169],mymr:[4160,4169],orya:[2918,2927],tamldec:[3046,3055],telu:[3174,3183],thai:[3664,3673],tibt:[3872,3881]},yF=KI.hanidec.replace(/[\[|\]]/g,"").split("");function wF(n){let e=parseInt(n,10);if(isNaN(e)){e="";for(let t=0;t<n.length;t++){const r=n.charCodeAt(t);if(n[t].search(KI.hanidec)!==-1)e+=yF.indexOf(n[t]);else for(const s in tN){const[i,o]=tN[s];r>=i&&r<=o&&(e+=r-i)}}return parseInt(e,10)}else return e}function ci({numberingSystem:n},e=""){return new RegExp(`${KI[n||"latn"]}${e}`)}const bF="missing Intl.DateTimeFormat.formatToParts support";function bt(n,e=t=>t){return{regex:n,deser:([t])=>e(wF(t))}}const EF=" ",ED=`[ ${EF}]`,vD=new RegExp(ED,"g");function vF(n){return n.replace(/\./g,"\\.?").replace(vD,ED)}function nN(n){return n.replace(/\./g,"").replace(vD," ").toLowerCase()}function li(n,e){return n===null?null:{regex:RegExp(n.map(vF).join("|")),deser:([t])=>n.findIndex(r=>nN(t)===nN(r))+e}}function rN(n,e){return{regex:n,deser:([,t,r])=>Hb(t,r),groups:e}}function Wy(n){return{regex:n,deser:([e])=>e}}function AF(n){return n.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function CF(n,e){const t=ci(e),r=ci(e,"{2}"),s=ci(e,"{3}"),i=ci(e,"{4}"),o=ci(e,"{6}"),a=ci(e,"{1,2}"),c=ci(e,"{1,3}"),l=ci(e,"{1,6}"),u=ci(e,"{1,9}"),h=ci(e,"{2,4}"),d=ci(e,"{4,6}"),f=m=>({regex:RegExp(AF(m.val)),deser:([w])=>w,literal:!0}),g=(m=>{if(n.literal)return f(m);switch(m.val){case"G":return li(e.eras("short"),0);case"GG":return li(e.eras("long"),0);case"y":return bt(l);case"yy":return bt(h,dA);case"yyyy":return bt(i);case"yyyyy":return bt(d);case"yyyyyy":return bt(o);case"M":return bt(a);case"MM":return bt(r);case"MMM":return li(e.months("short",!0),1);case"MMMM":return li(e.months("long",!0),1);case"L":return bt(a);case"LL":return bt(r);case"LLL":return li(e.months("short",!1),1);case"LLLL":return li(e.months("long",!1),1);case"d":return bt(a);case"dd":return bt(r);case"o":return bt(c);case"ooo":return bt(s);case"HH":return bt(r);case"H":return bt(a);case"hh":return bt(r);case"h":return bt(a);case"mm":return bt(r);case"m":return bt(a);case"q":return bt(a);case"qq":return bt(r);case"s":return bt(a);case"ss":return bt(r);case"S":return bt(c);case"SSS":return bt(s);case"u":return Wy(u);case"uu":return Wy(a);case"uuu":return bt(t);case"a":return li(e.meridiems(),0);case"kkkk":return bt(i);case"kk":return bt(h,dA);case"W":return bt(a);case"WW":return bt(r);case"E":case"c":return bt(t);case"EEE":return li(e.weekdays("short",!1),1);case"EEEE":return li(e.weekdays("long",!1),1);case"ccc":return li(e.weekdays("short",!0),1);case"cccc":return li(e.weekdays("long",!0),1);case"Z":case"ZZ":return rN(new RegExp(`([+-]${a.source})(?::(${r.source}))?`),2);case"ZZZ":return rN(new RegExp(`([+-]${a.source})(${r.source})?`),2);case"z":return Wy(/[a-z_+-/]{1,256}?/i);case" ":return Wy(/[^\S\n\r]/);default:return f(m)}})(n)||{invalidReason:bF};return g.token=n,g}const IF={year:{"2-digit":"yy",numeric:"yyyyy"},month:{numeric:"M","2-digit":"MM",short:"MMM",long:"MMMM"},day:{numeric:"d","2-digit":"dd"},weekday:{short:"EEE",long:"EEEE"},dayperiod:"a",dayPeriod:"a",hour12:{numeric:"h","2-digit":"hh"},hour24:{numeric:"H","2-digit":"HH"},minute:{numeric:"m","2-digit":"mm"},second:{numeric:"s","2-digit":"ss"},timeZoneName:{long:"ZZZZZ",short:"ZZZ"}};function _F(n,e,t){const{type:r,value:s}=n;if(r==="literal"){const c=/^\s+$/.test(s);return{literal:!c,val:c?" ":s}}const i=e[r];let o=r;r==="hour"&&(e.hour12!=null?o=e.hour12?"hour12":"hour24":e.hourCycle!=null?e.hourCycle==="h11"||e.hourCycle==="h12"?o="hour12":o="hour24":o=t.hour12?"hour12":"hour24");let a=IF[o];if(typeof a=="object"&&(a=a[i]),a)return{literal:!1,val:a}}function SF(n){return[`^${n.map(t=>t.regex).reduce((t,r)=>`${t}(${r.source})`,"")}$`,n]}function TF(n,e,t){const r=n.match(e);if(r){const s={};let i=1;for(const o in t)if(Zd(t,o)){const a=t[o],c=a.groups?a.groups+1:1;!a.literal&&a.token&&(s[a.token.val[0]]=a.deser(r.slice(i,i+c))),i+=c}return[r,s]}else return[r,{}]}function NF(n){const e=i=>{switch(i){case"S":return"millisecond";case"s":return"second";case"m":return"minute";case"h":case"H":return"hour";case"d":return"day";case"o":return"ordinal";case"L":case"M":return"month";case"y":return"year";case"E":case"c":return"weekday";case"W":return"weekNumber";case"k":return"weekYear";case"q":return"quarter";default:return null}};let t=null,r;return Be(n.z)||(t=ga.create(n.z)),Be(n.Z)||(t||(t=new Or(n.Z)),r=n.Z),Be(n.q)||(n.M=(n.q-1)*3+1),Be(n.h)||(n.h<12&&n.a===1?n.h+=12:n.h===12&&n.a===0&&(n.h=0)),n.G===0&&n.y&&(n.y=-n.y),Be(n.u)||(n.S=VI(n.u)),[Object.keys(n).reduce((i,o)=>{const a=e(o);return a&&(i[a]=n[o]),i},{}),t,r]}let mv=null;function OF(){return mv||(mv=Le.fromMillis(1555555555555)),mv}function xF(n,e){if(n.literal)return n;const t=dr.macroTokenToFormatOpts(n.val),r=ID(t,e);return r==null||r.includes(void 0)?n:r}function AD(n,e){return Array.prototype.concat(...n.map(t=>xF(t,e)))}function CD(n,e,t){const r=AD(dr.parseFormat(t),n),s=r.map(o=>CF(o,n)),i=s.find(o=>o.invalidReason);if(i)return{input:e,tokens:r,invalidReason:i.invalidReason};{const[o,a]=SF(s),c=RegExp(o,"i"),[l,u]=TF(e,c,a),[h,d,f]=u?NF(u):[null,null,void 0];if(Zd(u,"a")&&Zd(u,"H"))throw new Uh("Can't include meridiem when specifying 24-hour format");return{input:e,tokens:r,regex:c,rawMatches:l,matches:u,result:h,zone:d,specificOffset:f}}}function RF(n,e,t){const{result:r,zone:s,specificOffset:i,invalidReason:o}=CD(n,e,t);return[r,s,i,o]}function ID(n,e){if(!n)return null;const r=dr.create(e,n).dtFormatter(OF()),s=r.formatToParts(),i=r.resolvedOptions();return s.map(o=>_F(o,n,i))}const yv="Invalid DateTime",sN=864e13;function Gy(n){return new _i("unsupported zone",`the zone "${n.name}" is not supported`)}function wv(n){return n.weekData===null&&(n.weekData=E0(n.c)),n.weekData}function bv(n){return n.localWeekData===null&&(n.localWeekData=E0(n.c,n.loc.getMinDaysInFirstWeek(),n.loc.getStartOfWeek())),n.localWeekData}function el(n,e){const t={ts:n.ts,zone:n.zone,c:n.c,o:n.o,loc:n.loc,invalid:n.invalid};return new Le({...t,...e,old:t})}function _D(n,e,t){let r=n-e*60*1e3;const s=t.offset(r);if(e===s)return[r,e];r-=(s-e)*60*1e3;const i=t.offset(r);return s===i?[r,s]:[n-Math.min(s,i)*60*1e3,Math.max(s,i)]}function Ky(n,e){n+=e*60*1e3;const t=new Date(n);return{year:t.getUTCFullYear(),month:t.getUTCMonth()+1,day:t.getUTCDate(),hour:t.getUTCHours(),minute:t.getUTCMinutes(),second:t.getUTCSeconds(),millisecond:t.getUTCMilliseconds()}}function qw(n,e,t){return _D(jb(n),e,t)}function iN(n,e){const t=n.o,r=n.c.year+Math.trunc(e.years),s=n.c.month+Math.trunc(e.months)+Math.trunc(e.quarters)*3,i={...n.c,year:r,month:s,day:Math.min(n.c.day,v0(r,s))+Math.trunc(e.days)+Math.trunc(e.weeks)*7},o=ct.fromObject({years:e.years-Math.trunc(e.years),quarters:e.quarters-Math.trunc(e.quarters),months:e.months-Math.trunc(e.months),weeks:e.weeks-Math.trunc(e.weeks),days:e.days-Math.trunc(e.days),hours:e.hours,minutes:e.minutes,seconds:e.seconds,milliseconds:e.milliseconds}).as("milliseconds"),a=jb(i);let[c,l]=_D(a,t,n.zone);return o!==0&&(c+=o,l=n.zone.offset(c)),{ts:c,o:l}}function Zf(n,e,t,r,s,i){const{setZone:o,zone:a}=t;if(n&&Object.keys(n).length!==0||e){const c=e||a,l=Le.fromObject(n,{...t,zone:c,specificOffset:i});return o?l:l.setZone(a)}else return Le.invalid(new _i("unparsable",`the input "${s}" can't be parsed as ${r}`))}function Yy(n,e,t=!0){return n.isValid?dr.create(Pt.create("en-US"),{allowZ:t,forceSimple:!0}).formatDateTimeFromString(n,e):null}function Ev(n,e){const t=n.c.year>9999||n.c.year<0;let r="";return t&&n.c.year>=0&&(r+="+"),r+=hn(n.c.year,t?6:4),e?(r+="-",r+=hn(n.c.month),r+="-",r+=hn(n.c.day)):(r+=hn(n.c.month),r+=hn(n.c.day)),r}function oN(n,e,t,r,s,i){let o=hn(n.c.hour);return e?(o+=":",o+=hn(n.c.minute),(n.c.millisecond!==0||n.c.second!==0||!t)&&(o+=":")):o+=hn(n.c.minute),(n.c.millisecond!==0||n.c.second!==0||!t)&&(o+=hn(n.c.second),(n.c.millisecond!==0||!r)&&(o+=".",o+=hn(n.c.millisecond,3))),s&&(n.isOffsetFixed&&n.offset===0&&!i?o+="Z":n.o<0?(o+="-",o+=hn(Math.trunc(-n.o/60)),o+=":",o+=hn(Math.trunc(-n.o%60))):(o+="+",o+=hn(Math.trunc(n.o/60)),o+=":",o+=hn(Math.trunc(n.o%60)))),i&&(o+="["+n.zone.ianaName+"]"),o}const SD={month:1,day:1,hour:0,minute:0,second:0,millisecond:0},PF={weekNumber:1,weekday:1,hour:0,minute:0,second:0,millisecond:0},kF={ordinal:1,hour:0,minute:0,second:0,millisecond:0},TD=["year","month","day","hour","minute","second","millisecond"],DF=["weekYear","weekNumber","weekday","hour","minute","second","millisecond"],UF=["year","ordinal","hour","minute","second","millisecond"];function $F(n){const e={year:"year",years:"year",month:"month",months:"month",day:"day",days:"day",hour:"hour",hours:"hour",minute:"minute",minutes:"minute",quarter:"quarter",quarters:"quarter",second:"second",seconds:"second",millisecond:"millisecond",milliseconds:"millisecond",weekday:"weekday",weekdays:"weekday",weeknumber:"weekNumber",weeksnumber:"weekNumber",weeknumbers:"weekNumber",weekyear:"weekYear",weekyears:"weekYear",ordinal:"ordinal"}[n.toLowerCase()];if(!e)throw new Ok(n);return e}function aN(n){switch(n.toLowerCase()){case"localweekday":case"localweekdays":return"localWeekday";case"localweeknumber":case"localweeknumbers":return"localWeekNumber";case"localweekyear":case"localweekyears":return"localWeekYear";default:return $F(n)}}function cN(n,e){const t=tc(e.zone,Xt.defaultZone),r=Pt.fromObject(e),s=Xt.now();let i,o;if(Be(n.year))i=s;else{for(const l of TD)Be(n[l])&&(n[l]=SD[l]);const a=Xk(n)||eD(n);if(a)return Le.invalid(a);const c=t.offset(s);[i,o]=qw(n,c,t)}return new Le({ts:i,zone:t,loc:r,o})}function lN(n,e,t){const r=Be(t.round)?!0:t.round,s=(o,a)=>(o=qI(o,r||t.calendary?0:2,!0),e.loc.clone(t).relFormatter(t).format(o,a)),i=o=>t.calendary?e.hasSame(n,o)?0:e.startOf(o).diff(n.startOf(o),o).get(o):e.diff(n,o).get(o);if(t.unit)return s(i(t.unit),t.unit);for(const o of t.units){const a=i(o);if(Math.abs(a)>=1)return s(a,o)}return s(n>e?-0:0,t.units[t.units.length-1])}function uN(n){let e={},t;return n.length>0&&typeof n[n.length-1]=="object"?(e=n[n.length-1],t=Array.from(n).slice(0,n.length-1)):t=Array.from(n),[e,t]}class Le{constructor(e){const t=e.zone||Xt.defaultZone;let r=e.invalid||(Number.isNaN(e.ts)?new _i("invalid input"):null)||(t.isValid?null:Gy(t));this.ts=Be(e.ts)?Xt.now():e.ts;let s=null,i=null;if(!r)if(e.old&&e.old.ts===this.ts&&e.old.zone.equals(t))[s,i]=[e.old.c,e.old.o];else{const a=t.offset(this.ts);s=Ky(this.ts,a),r=Number.isNaN(s.year)?new _i("invalid input"):null,s=r?null:s,i=r?null:a}this._zone=t,this.loc=e.loc||Pt.create(),this.invalid=r,this.weekData=null,this.localWeekData=null,this.c=s,this.o=i,this.isLuxonDateTime=!0}static now(){return new Le({})}static local(){const[e,t]=uN(arguments),[r,s,i,o,a,c,l]=t;return cN({year:r,month:s,day:i,hour:o,minute:a,second:c,millisecond:l},e)}static utc(){const[e,t]=uN(arguments),[r,s,i,o,a,c,l]=t;return e.zone=Or.utcInstance,cN({year:r,month:s,day:i,hour:o,minute:a,second:c,millisecond:l},e)}static fromJSDate(e,t={}){const r=h8(e)?e.valueOf():NaN;if(Number.isNaN(r))return Le.invalid("invalid input");const s=tc(t.zone,Xt.defaultZone);return s.isValid?new Le({ts:r,zone:s,loc:Pt.fromObject(t)}):Le.invalid(Gy(s))}static fromMillis(e,t={}){if(ru(e))return e<-sN||e>sN?Le.invalid("Timestamp out of range"):new Le({ts:e,zone:tc(t.zone,Xt.defaultZone),loc:Pt.fromObject(t)});throw new rs(`fromMillis requires a numerical input, but received a ${typeof e} with value ${e}`)}static fromSeconds(e,t={}){if(ru(e))return new Le({ts:e*1e3,zone:tc(t.zone,Xt.defaultZone),loc:Pt.fromObject(t)});throw new rs("fromSeconds requires a numerical input")}static fromObject(e,t={}){e=e||{};const r=tc(t.zone,Xt.defaultZone);if(!r.isValid)return Le.invalid(Gy(r));const s=Pt.fromObject(t),i=A0(e,aN),{minDaysInFirstWeek:o,startOfWeek:a}=GT(i,s),c=Xt.now(),l=Be(t.specificOffset)?r.offset(c):t.specificOffset,u=!Be(i.ordinal),h=!Be(i.year),d=!Be(i.month)||!Be(i.day),f=h||d,p=i.weekYear||i.weekNumber;if((f||u)&&p)throw new Uh("Can't mix weekYear/weekNumber units with year/month/day or ordinals");if(d&&u)throw new Uh("Can't mix ordinal dates with month/day");const g=p||i.weekday&&!f;let m,w,v=Ky(c,l);g?(m=DF,w=PF,v=E0(v,o,a)):u?(m=UF,w=kF,v=gv(v)):(m=TD,w=SD);let A=!1;for(const $ of m){const P=i[$];Be(P)?A?i[$]=w[$]:i[$]=v[$]:A=!0}const T=g?c8(i,o,a):u?l8(i):Xk(i),N=T||eD(i);if(N)return Le.invalid(N);const R=g?zT(i,o,a):u?WT(i):i,[M,D]=qw(R,l,r),S=new Le({ts:M,zone:r,o:D,loc:s});return i.weekday&&f&&e.weekday!==S.weekday?Le.invalid("mismatched weekday",`you can't specify both a weekday of ${i.weekday} and a date of ${S.toISO()}`):S}static fromISO(e,t={}){const[r,s]=eF(e);return Zf(r,s,t,"ISO 8601",e)}static fromRFC2822(e,t={}){const[r,s]=tF(e);return Zf(r,s,t,"RFC 2822",e)}static fromHTTP(e,t={}){const[r,s]=nF(e);return Zf(r,s,t,"HTTP",t)}static fromFormat(e,t,r={}){if(Be(e)||Be(t))throw new rs("fromFormat requires an input string and a format");const{locale:s=null,numberingSystem:i=null}=r,o=Pt.fromOpts({locale:s,numberingSystem:i,defaultToEN:!0}),[a,c,l,u]=RF(o,e,t);return u?Le.invalid(u):Zf(a,c,r,`format ${t}`,e,l)}static fromString(e,t,r={}){return Le.fromFormat(e,t,r)}static fromSQL(e,t={}){const[r,s]=lF(e);return Zf(r,s,t,"SQL",e)}static invalid(e,t=null){if(!e)throw new rs("need to specify a reason the DateTime is invalid");const r=e instanceof _i?e:new _i(e,t);if(Xt.throwOnInvalid)throw new L6(r);return new Le({invalid:r})}static isDateTime(e){return e&&e.isLuxonDateTime||!1}static parseFormatForOpts(e,t={}){const r=ID(e,Pt.fromObject(t));return r?r.map(s=>s?s.val:null).join(""):null}static expandFormat(e,t={}){return AD(dr.parseFormat(e),Pt.fromObject(t)).map(s=>s.val).join("")}get(e){return this[e]}get isValid(){return this.invalid===null}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}get locale(){return this.isValid?this.loc.locale:null}get numberingSystem(){return this.isValid?this.loc.numberingSystem:null}get outputCalendar(){return this.isValid?this.loc.outputCalendar:null}get zone(){return this._zone}get zoneName(){return this.isValid?this.zone.name:null}get year(){return this.isValid?this.c.year:NaN}get quarter(){return this.isValid?Math.ceil(this.c.month/3):NaN}get month(){return this.isValid?this.c.month:NaN}get day(){return this.isValid?this.c.day:NaN}get hour(){return this.isValid?this.c.hour:NaN}get minute(){return this.isValid?this.c.minute:NaN}get second(){return this.isValid?this.c.second:NaN}get millisecond(){return this.isValid?this.c.millisecond:NaN}get weekYear(){return this.isValid?wv(this).weekYear:NaN}get weekNumber(){return this.isValid?wv(this).weekNumber:NaN}get weekday(){return this.isValid?wv(this).weekday:NaN}get isWeekend(){return this.isValid&&this.loc.getWeekendDays().includes(this.weekday)}get localWeekday(){return this.isValid?bv(this).weekday:NaN}get localWeekNumber(){return this.isValid?bv(this).weekNumber:NaN}get localWeekYear(){return this.isValid?bv(this).weekYear:NaN}get ordinal(){return this.isValid?gv(this.c).ordinal:NaN}get monthShort(){return this.isValid?zy.months("short",{locObj:this.loc})[this.month-1]:null}get monthLong(){return this.isValid?zy.months("long",{locObj:this.loc})[this.month-1]:null}get weekdayShort(){return this.isValid?zy.weekdays("short",{locObj:this.loc})[this.weekday-1]:null}get weekdayLong(){return this.isValid?zy.weekdays("long",{locObj:this.loc})[this.weekday-1]:null}get offset(){return this.isValid?+this.o:NaN}get offsetNameShort(){return this.isValid?this.zone.offsetName(this.ts,{format:"short",locale:this.locale}):null}get offsetNameLong(){return this.isValid?this.zone.offsetName(this.ts,{format:"long",locale:this.locale}):null}get isOffsetFixed(){return this.isValid?this.zone.isUniversal:null}get isInDST(){return this.isOffsetFixed?!1:this.offset>this.set({month:1,day:1}).offset||this.offset>this.set({month:5}).offset}getPossibleOffsets(){if(!this.isValid||this.isOffsetFixed)return[this];const e=864e5,t=6e4,r=jb(this.c),s=this.zone.offset(r-e),i=this.zone.offset(r+e),o=this.zone.offset(r-s*t),a=this.zone.offset(r-i*t);if(o===a)return[this];const c=r-o*t,l=r-a*t,u=Ky(c,o),h=Ky(l,a);return u.hour===h.hour&&u.minute===h.minute&&u.second===h.second&&u.millisecond===h.millisecond?[el(this,{ts:c}),el(this,{ts:l})]:[this]}get isInLeapYear(){return ty(this.year)}get daysInMonth(){return v0(this.year,this.month)}get daysInYear(){return this.isValid?Gh(this.year):NaN}get weeksInWeekYear(){return this.isValid?fg(this.weekYear):NaN}get weeksInLocalWeekYear(){return this.isValid?fg(this.localWeekYear,this.loc.getMinDaysInFirstWeek(),this.loc.getStartOfWeek()):NaN}resolvedLocaleOptions(e={}){const{locale:t,numberingSystem:r,calendar:s}=dr.create(this.loc.clone(e),e).resolvedOptions(this);return{locale:t,numberingSystem:r,outputCalendar:s}}toUTC(e=0,t={}){return this.setZone(Or.instance(e),t)}toLocal(){return this.setZone(Xt.defaultZone)}setZone(e,{keepLocalTime:t=!1,keepCalendarTime:r=!1}={}){if(e=tc(e,Xt.defaultZone),e.equals(this.zone))return this;if(e.isValid){let s=this.ts;if(t||r){const i=e.offset(this.ts),o=this.toObject();[s]=qw(o,i,e)}return el(this,{ts:s,zone:e})}else return Le.invalid(Gy(e))}reconfigure({locale:e,numberingSystem:t,outputCalendar:r}={}){const s=this.loc.clone({locale:e,numberingSystem:t,outputCalendar:r});return el(this,{loc:s})}setLocale(e){return this.reconfigure({locale:e})}set(e){if(!this.isValid)return this;const t=A0(e,aN),{minDaysInFirstWeek:r,startOfWeek:s}=GT(t,this.loc),i=!Be(t.weekYear)||!Be(t.weekNumber)||!Be(t.weekday),o=!Be(t.ordinal),a=!Be(t.year),c=!Be(t.month)||!Be(t.day),l=a||c,u=t.weekYear||t.weekNumber;if((l||o)&&u)throw new Uh("Can't mix weekYear/weekNumber units with year/month/day or ordinals");if(c&&o)throw new Uh("Can't mix ordinal dates with month/day");let h;i?h=zT({...E0(this.c,r,s),...t},r,s):Be(t.ordinal)?(h={...this.toObject(),...t},Be(t.day)&&(h.day=Math.min(v0(h.year,h.month),h.day))):h=WT({...gv(this.c),...t});const[d,f]=qw(h,this.o,this.zone);return el(this,{ts:d,o:f})}plus(e){if(!this.isValid)return this;const t=ct.fromDurationLike(e);return el(this,iN(this,t))}minus(e){if(!this.isValid)return this;const t=ct.fromDurationLike(e).negate();return el(this,iN(this,t))}startOf(e,{useLocaleWeeks:t=!1}={}){if(!this.isValid)return this;const r={},s=ct.normalizeUnit(e);switch(s){case"years":r.month=1;case"quarters":case"months":r.day=1;case"weeks":case"days":r.hour=0;case"hours":r.minute=0;case"minutes":r.second=0;case"seconds":r.millisecond=0;break}if(s==="weeks")if(t){const i=this.loc.getStartOfWeek(),{weekday:o}=this;o<i&&(r.weekNumber=this.weekNumber-1),r.weekday=i}else r.weekday=1;if(s==="quarters"){const i=Math.ceil(this.month/3);r.month=(i-1)*3+1}return this.set(r)}endOf(e,t){return this.isValid?this.plus({[e]:1}).startOf(e,t).minus(1):this}toFormat(e,t={}){return this.isValid?dr.create(this.loc.redefaultToEN(t)).formatDateTimeFromString(this,e):yv}toLocaleString(e=b0,t={}){return this.isValid?dr.create(this.loc.clone(t),e).formatDateTime(this):yv}toLocaleParts(e={}){return this.isValid?dr.create(this.loc.clone(e),e).formatDateTimeParts(this):[]}toISO({format:e="extended",suppressSeconds:t=!1,suppressMilliseconds:r=!1,includeOffset:s=!0,extendedZone:i=!1}={}){if(!this.isValid)return null;const o=e==="extended";let a=Ev(this,o);return a+="T",a+=oN(this,o,t,r,s,i),a}toISODate({format:e="extended"}={}){return this.isValid?Ev(this,e==="extended"):null}toISOWeekDate(){return Yy(this,"kkkk-'W'WW-c")}toISOTime({suppressMilliseconds:e=!1,suppressSeconds:t=!1,includeOffset:r=!0,includePrefix:s=!1,extendedZone:i=!1,format:o="extended"}={}){return this.isValid?(s?"T":"")+oN(this,o==="extended",t,e,r,i):null}toRFC2822(){return Yy(this,"EEE, dd LLL yyyy HH:mm:ss ZZZ",!1)}toHTTP(){return Yy(this.toUTC(),"EEE, dd LLL yyyy HH:mm:ss 'GMT'")}toSQLDate(){return this.isValid?Ev(this,!0):null}toSQLTime({includeOffset:e=!0,includeZone:t=!1,includeOffsetSpace:r=!0}={}){let s="HH:mm:ss.SSS";return(t||e)&&(r&&(s+=" "),t?s+="z":e&&(s+="ZZ")),Yy(this,s,!0)}toSQL(e={}){return this.isValid?`${this.toSQLDate()} ${this.toSQLTime(e)}`:null}toString(){return this.isValid?this.toISO():yv}[Symbol.for("nodejs.util.inspect.custom")](){return this.isValid?`DateTime { ts: ${this.toISO()}, zone: ${this.zone.name}, locale: ${this.locale} }`:`DateTime { Invalid, reason: ${this.invalidReason} }`}valueOf(){return this.toMillis()}toMillis(){return this.isValid?this.ts:NaN}toSeconds(){return this.isValid?this.ts/1e3:NaN}toUnixInteger(){return this.isValid?Math.floor(this.ts/1e3):NaN}toJSON(){return this.toISO()}toBSON(){return this.toJSDate()}toObject(e={}){if(!this.isValid)return{};const t={...this.c};return e.includeConfig&&(t.outputCalendar=this.outputCalendar,t.numberingSystem=this.loc.numberingSystem,t.locale=this.loc.locale),t}toJSDate(){return new Date(this.isValid?this.ts:NaN)}diff(e,t="milliseconds",r={}){if(!this.isValid||!e.isValid)return ct.invalid("created by diffing an invalid DateTime");const s={locale:this.locale,numberingSystem:this.numberingSystem,...r},i=d8(t).map(ct.normalizeUnit),o=e.valueOf()>this.valueOf(),a=o?this:e,c=o?e:this,l=mF(a,c,i,s);return o?l.negate():l}diffNow(e="milliseconds",t={}){return this.diff(Le.now(),e,t)}until(e){return this.isValid?Qt.fromDateTimes(this,e):this}hasSame(e,t,r){if(!this.isValid)return!1;const s=e.valueOf(),i=this.setZone(e.zone,{keepLocalTime:!0});return i.startOf(t,r)<=s&&s<=i.endOf(t,r)}equals(e){return this.isValid&&e.isValid&&this.valueOf()===e.valueOf()&&this.zone.equals(e.zone)&&this.loc.equals(e.loc)}toRelative(e={}){if(!this.isValid)return null;const t=e.base||Le.fromObject({},{zone:this.zone}),r=e.padding?this<t?-e.padding:e.padding:0;let s=["years","months","days","hours","minutes","seconds"],i=e.unit;return Array.isArray(e.unit)&&(s=e.unit,i=void 0),lN(t,this.plus(r),{...e,numeric:"always",units:s,unit:i})}toRelativeCalendar(e={}){return this.isValid?lN(e.base||Le.fromObject({},{zone:this.zone}),this,{...e,numeric:"auto",units:["years","months","days"],calendary:!0}):null}static min(...e){if(!e.every(Le.isDateTime))throw new rs("min requires all arguments be DateTimes");return KT(e,t=>t.valueOf(),Math.min)}static max(...e){if(!e.every(Le.isDateTime))throw new rs("max requires all arguments be DateTimes");return KT(e,t=>t.valueOf(),Math.max)}static fromFormatExplain(e,t,r={}){const{locale:s=null,numberingSystem:i=null}=r,o=Pt.fromOpts({locale:s,numberingSystem:i,defaultToEN:!0});return CD(o,e,t)}static fromStringExplain(e,t,r={}){return Le.fromFormatExplain(e,t,r)}static get DATE_SHORT(){return b0}static get DATE_MED(){return xk}static get DATE_MED_WITH_WEEKDAY(){return j6}static get DATE_FULL(){return Rk}static get DATE_HUGE(){return Pk}static get TIME_SIMPLE(){return kk}static get TIME_WITH_SECONDS(){return Dk}static get TIME_WITH_SHORT_OFFSET(){return Uk}static get TIME_WITH_LONG_OFFSET(){return $k}static get TIME_24_SIMPLE(){return Mk}static get TIME_24_WITH_SECONDS(){return Lk}static get TIME_24_WITH_SHORT_OFFSET(){return Bk}static get TIME_24_WITH_LONG_OFFSET(){return Fk}static get DATETIME_SHORT(){return jk}static get DATETIME_SHORT_WITH_SECONDS(){return Hk}static get DATETIME_MED(){return Vk}static get DATETIME_MED_WITH_SECONDS(){return qk}static get DATETIME_MED_WITH_WEEKDAY(){return H6}static get DATETIME_FULL(){return zk}static get DATETIME_FULL_WITH_SECONDS(){return Wk}static get DATETIME_HUGE(){return Gk}static get DATETIME_HUGE_WITH_SECONDS(){return Kk}}function Jf(n){if(Le.isDateTime(n))return n;if(n&&n.valueOf&&ru(n.valueOf()))return Le.fromJSDate(n);if(n&&typeof n=="object")return Le.fromObject(n);throw new rs(`Unknown datetime argument: ${n}, of type ${typeof n}`)}let ND=class OD{constructor(e){B(this,"toString",()=>this.date.toString());this.date=e?Le.fromISO(e):Le.local()}setLocale(e){return this.date.setLocale(e),this}toJSON(){return this.date.toJSON()}setMillis(e){return this.date=Le.fromISO(convertLongToString(e)),this}getMillis(){return this.date.toMillis()}format(e){return this.date.toFormat(e)}addDays(e){return e<0?this.date=this.date.minus({days:Math.abs(e)}):this.date=this.date.plus({days:Math.abs(e)}),this}addYears(e){return e<0?this.date=this.date.minus({years:Math.abs(e)}):this.date=this.date.plus({years:Math.abs(e)}),this}addMonths(e){return e<0?this.date=this.date.minus({months:Math.abs(e)}):this.date=this.date.plus({months:Math.abs(e)}),this}addHours(e){return e<0?this.date=this.date.minus({hours:Math.abs(e)}):this.date=this.date.plus({hours:Math.abs(e)}),this}addMinutes(e){return e<0?this.date=this.date.minus({minutes:Math.abs(e)}):this.date=this.date.plus({minutes:Math.abs(e)}),this}addSeconds(e){return e<0?this.date=this.date.minus({seconds:Math.abs(e)}):this.date=this.date.plus({seconds:Math.abs(e)}),this}addMilliSeconds(e){return e<0?this.date=this.date.minus({milliseconds:Math.abs(e)}):this.date=this.date.plus({milliseconds:Math.abs(e)}),this}setYear(e){return this.date=this.date.set({year:e}),this}setMonth(e){return e>=1&&e<12&&(this.date=this.date.set({month:e})),this}setDay(e){return e>=1&&e<31&&(this.date=this.date.set({day:e})),this}setHour(e){return e>=0&&e<24&&(this.date=this.date.set({hour:e})),this}setMinute(e){return e>=0&&e<59&&(this.date=this.date.set({minute:e})),this}setSecond(e){return e>=0&&e<59&&(this.date=this.date.set({second:e})),this}setMilliSecond(e){return e>=0&&e<999&&(this.date=this.date.set({millisecond:e})),this}compareTo(e){return e.getMillis()===this.getMillis()?0:e.getMillis()>this.getMillis()?-1:1}diffSeconds(e){return this.date.diff(e.date,["seconds"]).toObject().seconds}diffMinutes(e){return this.date.diff(e.date,["minutes"]).toObject().minutes}diffHours(e){return this.date.diff(e.date,["hours"]).toObject().hours}diffDays(e){return this.date.diff(e.date,["days"]).toObject().days}diffMonths(e){return this.date.diff(e.date,["months"]).toObject().months}diffYears(e){return this.date.diff(e.date,["years"]).toObject().years}get(e){return this.date.get(e)}convertLongToString(e){let t=new OD;t.setTime(e);let r=t.getFullYear(),s=t.getMonth()+1,i=t.getDate();return s<10&&(s=`0${s}`),i<10&&(i=`0${i}`),`${r}-${s}-${i}`}};const Zs=()=>M6(()=>({uhtbalance:0,claimedAddresses:[],walletAddress:"",isWalletConnected:!1,hasMintedNFT:!0,hasClaimedPoints:!1,hasClaimedNFTMintBonus:!1,hasClaimedSeptember25Gift:!1,points:0,allocation:0,isAirdropEligible:!1,lastAnsweredQuestionID:null,lastAnswerID:null,email:"p",username:"",nominationCountSlot:0,referrals:[],lastDailyClaimAt:null,addressSignature:null,testAddress:""}),"$vuSkebpfZQ"),MF=Symbol(),hN=Object.getPrototypeOf,fA=new WeakMap,LF=n=>n&&(fA.has(n)?fA.get(n):hN(n)===Object.prototype||hN(n)===Array.prototype),BF=n=>LF(n)&&n[MF]||null,dN=(n,e=!0)=>{fA.set(n,e)};var C0={BASE_URL:"./",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const YI=n=>typeof n=="object"&&n!==null,FF=n=>YI(n)&&!sy.has(n)&&(Array.isArray(n)||!(Symbol.iterator in n))&&!(n instanceof WeakMap)&&!(n instanceof WeakSet)&&!(n instanceof Error)&&!(n instanceof Number)&&!(n instanceof Date)&&!(n instanceof String)&&!(n instanceof RegExp)&&!(n instanceof ArrayBuffer)&&!(n instanceof Promise),xD=(n,e)=>{const t=pA.get(n);if((t==null?void 0:t[0])===e)return t[1];const r=Array.isArray(n)?[]:Object.create(Object.getPrototypeOf(n));return dN(r,!0),pA.set(n,[e,r]),Reflect.ownKeys(n).forEach(s=>{if(Object.getOwnPropertyDescriptor(r,s))return;const i=Reflect.get(n,s),{enumerable:o}=Reflect.getOwnPropertyDescriptor(n,s),a={value:i,enumerable:o,configurable:!0};if(sy.has(i))dN(i,!1);else if(Uc.has(i)){const[c,l]=Uc.get(i);a.value=xD(c,l())}Object.defineProperty(r,s,a)}),Object.preventExtensions(r)},jF=(n,e,t,r)=>({deleteProperty(s,i){const o=Reflect.get(s,i);t(i);const a=Reflect.deleteProperty(s,i);return a&&r(["delete",[i],o]),a},set(s,i,o,a){const c=!n()&&Reflect.has(s,i),l=Reflect.get(s,i,a);if(c&&(fN(l,o)||pg.has(o)&&fN(l,pg.get(o))))return!0;t(i),YI(o)&&(o=BF(o)||o);const u=!Uc.has(o)&&VF(o)?Vt(o):o;return e(i,u),Reflect.set(s,i,u,a),r(["set",[i],o,l]),!0}}),Uc=new WeakMap,sy=new WeakSet,pA=new WeakMap,Sp=[1,1],pg=new WeakMap;let fN=Object.is,HF=(n,e)=>new Proxy(n,e),VF=FF,qF=xD,zF=jF;function Vt(n={}){if(!YI(n))throw new Error("object required");const e=pg.get(n);if(e)return e;let t=Sp[0];const r=new Set,s=(m,w=++Sp[0])=>{t!==w&&(t=w,r.forEach(v=>v(m,w)))};let i=Sp[1];const o=(m=++Sp[1])=>(i!==m&&!r.size&&(i=m,c.forEach(([w])=>{const v=w[1](m);v>t&&(t=v)})),t),a=m=>(w,v)=>{const A=[...w];A[1]=[m,...A[1]],s(A,v)},c=new Map,l=(m,w)=>{const v=!sy.has(w)&&Uc.get(w);if(v){if((C0?"production":void 0)!=="production"&&c.has(m))throw new Error("prop listener already exists");if(r.size){const A=v[2](a(m));c.set(m,[v,A])}else c.set(m,[v])}},u=m=>{var w;const v=c.get(m);v&&(c.delete(m),(w=v[1])==null||w.call(v))},h=m=>(r.add(m),r.size===1&&c.forEach(([v,A],T)=>{if((C0?"production":void 0)!=="production"&&A)throw new Error("remove already exists");const N=v[2](a(T));c.set(T,[v,N])}),()=>{r.delete(m),r.size===0&&c.forEach(([v,A],T)=>{A&&(A(),c.set(T,[v]))})});let d=!0;const f=zF(()=>d,l,u,s),p=HF(n,f);pg.set(n,p);const g=[n,o,h];return Uc.set(p,g),Reflect.ownKeys(n).forEach(m=>{const w=Object.getOwnPropertyDescriptor(n,m);"value"in w&&w.writable&&(p[m]=n[m])}),d=!1,p}function Lr(n,e,t){const r=Uc.get(n);(C0?"production":void 0)!=="production"&&!r&&console.warn("Please use proxy object");let s;const i=[],o=r[2];let a=!1;const l=o(u=>{i.push(u),s||(s=Promise.resolve().then(()=>{s=void 0,a&&e(i.splice(0))}))});return a=!0,()=>{a=!1,l()}}function gg(n){const e=Uc.get(n);(C0?"production":void 0)!=="production"&&!e&&console.warn("Please use proxy object");const[t,r]=e;return qF(t,r())}function Jd(n){return sy.add(n),n}function WF(){return{proxyStateMap:Uc,refSet:sy,snapCache:pA,versionHolder:Sp,proxyCache:pg}}function Fr(n,e,t,r){let s=n[e];return Lr(n,()=>{const i=n[e];Object.is(s,i)||t(s=i)})}const{proxyStateMap:GF,snapCache:KF}=WF(),Qy=n=>GF.has(n);function YF(n){const e=[];let t=0;const r=new Map,s=new WeakMap,i=()=>{const l=KF.get(a),u=l==null?void 0:l[1];if(u&&!s.has(u)){const h=new Map(r);s.set(u,h)}},o=l=>s.get(l)||r,a={data:e,index:t,epoch:0,get size(){return Qy(this)||i(),o(this).size},get(l){const h=o(this).get(l);if(h===void 0){this.epoch;return}return this.data[h]},has(l){const u=o(this);return this.epoch,u.has(l)},set(l,u){if(!Qy(this))throw new Error("Cannot perform mutations on a snapshot");const h=r.get(l);return h===void 0?(r.set(l,this.index),this.data[this.index++]=u):this.data[h]=u,this.epoch++,this},delete(l){if(!Qy(this))throw new Error("Cannot perform mutations on a snapshot");const u=r.get(l);return u===void 0?!1:(delete this.data[u],r.delete(l),this.epoch++,!0)},clear(){if(!Qy(this))throw new Error("Cannot perform mutations on a snapshot");this.data.length=0,this.index=0,this.epoch++,r.clear()},forEach(l){this.epoch,o(this).forEach((h,d)=>{l(this.data[h],d,this)})},*entries(){this.epoch;const l=o(this);for(const[u,h]of l)yield[u,this.data[h]]},*keys(){this.epoch;const l=o(this);for(const u of l.keys())yield u},*values(){this.epoch;const l=o(this);for(const u of l.values())yield this.data[u]},[Symbol.iterator](){return this.entries()},get[Symbol.toStringTag](){return"Map"},toJSON(){return new Map(this.entries())}},c=Vt(a);return Object.defineProperties(c,{size:{enumerable:!1},index:{enumerable:!1},epoch:{enumerable:!1},data:{enumerable:!1},toJSON:{enumerable:!1}}),Object.seal(c),c}var pN={};const H={WC_NAME_SUFFIX:".reown.id",WC_NAME_SUFFIX_LEGACY:".wcn.id",BLOCKCHAIN_API_RPC_URL:"https://rpc.walletconnect.org",PULSE_API_URL:"https://pulse.walletconnect.org",W3M_API_URL:"https://api.web3modal.org",CONNECTOR_ID:{WALLET_CONNECT:"walletConnect",INJECTED:"injected",WALLET_STANDARD:"announced",COINBASE:"coinbaseWallet",COINBASE_SDK:"coinbaseWalletSDK",SAFE:"safe",LEDGER:"ledger",OKX:"okx",EIP6963:"eip6963",AUTH:"ID_AUTH"},CONNECTOR_NAMES:{AUTH:"Auth"},AUTH_CONNECTOR_SUPPORTED_CHAINS:["eip155","solana"],LIMITS:{PENDING_TRANSACTIONS:99},CHAIN:{EVM:"eip155",SOLANA:"solana",POLKADOT:"polkadot",BITCOIN:"bip122"},CHAIN_NAME_MAP:{eip155:"EVM Networks",solana:"Solana",polkadot:"Polkadot",bip122:"Bitcoin",cosmos:"Cosmos",sui:"Sui",stacks:"Stacks"},ADAPTER_TYPES:{BITCOIN:"bitcoin",SOLANA:"solana",WAGMI:"wagmi",ETHERS:"ethers",ETHERS5:"ethers5"},USDT_CONTRACT_ADDRESSES:["0xdac17f958d2ee523a2206206994597c13d831ec7","0xc2132d05d31c914a87c6611c10748aeb04b58e8f","0x9702230a8ea53601f5cd2dc00fdbc13d4df4a8c7","0x919C1c267BC06a7039e03fcc2eF738525769109c","0x48065fbBE25f71C9282ddf5e1cD6D6A887483D5e","0x55d398326f99059fF775485246999027B3197955","0xfd086bc7cd5c481dcc9c85ebe478a1c0b69fcbb9"],HTTP_STATUS_CODES:{SERVER_ERROR:500,TOO_MANY_REQUESTS:429,SERVICE_UNAVAILABLE:503,FORBIDDEN:403},UNSUPPORTED_NETWORK_NAME:"Unknown Network",SECURE_SITE_SDK_ORIGIN:(typeof process<"u"&&typeof pN<"u"?pN.NEXT_PUBLIC_SECURE_SITE_ORIGIN:void 0)||"https://secure.walletconnect.org",REMOTE_FEATURES_ALERTS:{MULTI_WALLET_NOT_ENABLED:{DEFAULT:{displayMessage:"Multi-Wallet Not Enabled",debugMessage:"Multi-wallet support is not enabled. Please enable it in your AppKit configuration at cloud.reown.com."},CONNECTIONS_HOOK:{displayMessage:"Multi-Wallet Not Enabled",debugMessage:"Multi-wallet support is not enabled. Please enable it in your AppKit configuration at cloud.reown.com to use the useAppKitConnections hook."},CONNECTION_HOOK:{displayMessage:"Multi-Wallet Not Enabled",debugMessage:"Multi-wallet support is not enabled. Please enable it in your AppKit configuration at cloud.reown.com to use the useAppKitConnection hook."}}}},RD={caipNetworkIdToNumber(n){return n?Number(n.split(":")[1]):void 0},parseEvmChainId(n){return typeof n=="string"?this.caipNetworkIdToNumber(n):n},getNetworksByNamespace(n,e){return(n==null?void 0:n.filter(t=>t.chainNamespace===e))||[]},getFirstNetworkByNamespace(n,e){return this.getNetworksByNamespace(n,e)[0]},getNetworkNameByCaipNetworkId(n,e){var s;if(!e)return;const t=n.find(i=>i.caipNetworkId===e);if(t)return t.name;const[r]=e.split(":");return((s=H.CHAIN_NAME_MAP)==null?void 0:s[r])||void 0}},PD=["eip155","solana","polkadot","bip122","cosmos","sui","stacks"];var QF=20,ZF=1,du=1e6,gN=1e6,JF=-7,XF=21,e9=!1,iy="[big.js] ",Uu=iy+"Invalid ",qb=Uu+"decimal places",t9=Uu+"rounding mode",kD=iy+"Division by zero",St={},mo=void 0,n9=/^-?(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i;function DD(){function n(e){var t=this;if(!(t instanceof n))return e===mo?DD():new n(e);if(e instanceof n)t.s=e.s,t.e=e.e,t.c=e.c.slice();else{if(typeof e!="string"){if(n.strict===!0&&typeof e!="bigint")throw TypeError(Uu+"value");e=e===0&&1/e<0?"-0":String(e)}r9(t,e)}t.constructor=n}return n.prototype=St,n.DP=QF,n.RM=ZF,n.NE=JF,n.PE=XF,n.strict=e9,n.roundDown=0,n.roundHalfUp=1,n.roundHalfEven=2,n.roundUp=3,n}function r9(n,e){var t,r,s;if(!n9.test(e))throw Error(Uu+"number");for(n.s=e.charAt(0)=="-"?(e=e.slice(1),-1):1,(t=e.indexOf("."))>-1&&(e=e.replace(".","")),(r=e.search(/e/i))>0?(t<0&&(t=r),t+=+e.slice(r+1),e=e.substring(0,r)):t<0&&(t=e.length),s=e.length,r=0;r<s&&e.charAt(r)=="0";)++r;if(r==s)n.c=[n.e=0];else{for(;s>0&&e.charAt(--s)=="0";);for(n.e=t-r-1,n.c=[],t=0;r<=s;)n.c[t++]=+e.charAt(r++)}return n}function $u(n,e,t,r){var s=n.c;if(t===mo&&(t=n.constructor.RM),t!==0&&t!==1&&t!==2&&t!==3)throw Error(t9);if(e<1)r=t===3&&(r||!!s[0])||e===0&&(t===1&&s[0]>=5||t===2&&(s[0]>5||s[0]===5&&(r||s[1]!==mo))),s.length=1,r?(n.e=n.e-e+1,s[0]=1):s[0]=n.e=0;else if(e<s.length){if(r=t===1&&s[e]>=5||t===2&&(s[e]>5||s[e]===5&&(r||s[e+1]!==mo||s[e-1]&1))||t===3&&(r||!!s[0]),s.length=e,r){for(;++s[--e]>9;)if(s[e]=0,e===0){++n.e,s.unshift(1);break}}for(e=s.length;!s[--e];)s.pop()}return n}function Mu(n,e,t){var r=n.e,s=n.c.join(""),i=s.length;if(e)s=s.charAt(0)+(i>1?"."+s.slice(1):"")+(r<0?"e":"e+")+r;else if(r<0){for(;++r;)s="0"+s;s="0."+s}else if(r>0)if(++r>i)for(r-=i;r--;)s+="0";else r<i&&(s=s.slice(0,r)+"."+s.slice(r));else i>1&&(s=s.charAt(0)+"."+s.slice(1));return n.s<0&&t?"-"+s:s}St.abs=function(){var n=new this.constructor(this);return n.s=1,n};St.cmp=function(n){var e,t=this,r=t.c,s=(n=new t.constructor(n)).c,i=t.s,o=n.s,a=t.e,c=n.e;if(!r[0]||!s[0])return r[0]?i:s[0]?-o:0;if(i!=o)return i;if(e=i<0,a!=c)return a>c^e?1:-1;for(o=(a=r.length)<(c=s.length)?a:c,i=-1;++i<o;)if(r[i]!=s[i])return r[i]>s[i]^e?1:-1;return a==c?0:a>c^e?1:-1};St.div=function(n){var e=this,t=e.constructor,r=e.c,s=(n=new t(n)).c,i=e.s==n.s?1:-1,o=t.DP;if(o!==~~o||o<0||o>du)throw Error(qb);if(!s[0])throw Error(kD);if(!r[0])return n.s=i,n.c=[n.e=0],n;var a,c,l,u,h,d=s.slice(),f=a=s.length,p=r.length,g=r.slice(0,a),m=g.length,w=n,v=w.c=[],A=0,T=o+(w.e=e.e-n.e)+1;for(w.s=i,i=T<0?0:T,d.unshift(0);m++<a;)g.push(0);do{for(l=0;l<10;l++){if(a!=(m=g.length))u=a>m?1:-1;else for(h=-1,u=0;++h<a;)if(s[h]!=g[h]){u=s[h]>g[h]?1:-1;break}if(u<0){for(c=m==a?s:d;m;){if(g[--m]<c[m]){for(h=m;h&&!g[--h];)g[h]=9;--g[h],g[m]+=10}g[m]-=c[m]}for(;!g[0];)g.shift()}else break}v[A++]=u?l:++l,g[0]&&u?g[m]=r[f]||0:g=[r[f]]}while((f++<p||g[0]!==mo)&&i--);return!v[0]&&A!=1&&(v.shift(),w.e--,T--),A>T&&$u(w,T,t.RM,g[0]!==mo),w};St.eq=function(n){return this.cmp(n)===0};St.gt=function(n){return this.cmp(n)>0};St.gte=function(n){return this.cmp(n)>-1};St.lt=function(n){return this.cmp(n)<0};St.lte=function(n){return this.cmp(n)<1};St.minus=St.sub=function(n){var e,t,r,s,i=this,o=i.constructor,a=i.s,c=(n=new o(n)).s;if(a!=c)return n.s=-c,i.plus(n);var l=i.c.slice(),u=i.e,h=n.c,d=n.e;if(!l[0]||!h[0])return h[0]?n.s=-c:l[0]?n=new o(i):n.s=1,n;if(a=u-d){for((s=a<0)?(a=-a,r=l):(d=u,r=h),r.reverse(),c=a;c--;)r.push(0);r.reverse()}else for(t=((s=l.length<h.length)?l:h).length,a=c=0;c<t;c++)if(l[c]!=h[c]){s=l[c]<h[c];break}if(s&&(r=l,l=h,h=r,n.s=-n.s),(c=(t=h.length)-(e=l.length))>0)for(;c--;)l[e++]=0;for(c=e;t>a;){if(l[--t]<h[t]){for(e=t;e&&!l[--e];)l[e]=9;--l[e],l[t]+=10}l[t]-=h[t]}for(;l[--c]===0;)l.pop();for(;l[0]===0;)l.shift(),--d;return l[0]||(n.s=1,l=[d=0]),n.c=l,n.e=d,n};St.mod=function(n){var e,t=this,r=t.constructor,s=t.s,i=(n=new r(n)).s;if(!n.c[0])throw Error(kD);return t.s=n.s=1,e=n.cmp(t)==1,t.s=s,n.s=i,e?new r(t):(s=r.DP,i=r.RM,r.DP=r.RM=0,t=t.div(n),r.DP=s,r.RM=i,this.minus(t.times(n)))};St.neg=function(){var n=new this.constructor(this);return n.s=-n.s,n};St.plus=St.add=function(n){var e,t,r,s=this,i=s.constructor;if(n=new i(n),s.s!=n.s)return n.s=-n.s,s.minus(n);var o=s.e,a=s.c,c=n.e,l=n.c;if(!a[0]||!l[0])return l[0]||(a[0]?n=new i(s):n.s=s.s),n;if(a=a.slice(),e=o-c){for(e>0?(c=o,r=l):(e=-e,r=a),r.reverse();e--;)r.push(0);r.reverse()}for(a.length-l.length<0&&(r=l,l=a,a=r),e=l.length,t=0;e;a[e]%=10)t=(a[--e]=a[e]+l[e]+t)/10|0;for(t&&(a.unshift(t),++c),e=a.length;a[--e]===0;)a.pop();return n.c=a,n.e=c,n};St.pow=function(n){var e=this,t=new e.constructor("1"),r=t,s=n<0;if(n!==~~n||n<-gN||n>gN)throw Error(Uu+"exponent");for(s&&(n=-n);n&1&&(r=r.times(e)),n>>=1,!!n;)e=e.times(e);return s?t.div(r):r};St.prec=function(n,e){if(n!==~~n||n<1||n>du)throw Error(Uu+"precision");return $u(new this.constructor(this),n,e)};St.round=function(n,e){if(n===mo)n=0;else if(n!==~~n||n<-du||n>du)throw Error(qb);return $u(new this.constructor(this),n+this.e+1,e)};St.sqrt=function(){var n,e,t,r=this,s=r.constructor,i=r.s,o=r.e,a=new s("0.5");if(!r.c[0])return new s(r);if(i<0)throw Error(iy+"No square root");i=Math.sqrt(+Mu(r,!0,!0)),i===0||i===1/0?(e=r.c.join(""),e.length+o&1||(e+="0"),i=Math.sqrt(e),o=((o+1)/2|0)-(o<0||o&1),n=new s((i==1/0?"5e":(i=i.toExponential()).slice(0,i.indexOf("e")+1))+o)):n=new s(i+""),o=n.e+(s.DP+=4);do t=n,n=a.times(t.plus(r.div(t)));while(t.c.slice(0,o).join("")!==n.c.slice(0,o).join(""));return $u(n,(s.DP-=4)+n.e+1,s.RM)};St.times=St.mul=function(n){var e,t=this,r=t.constructor,s=t.c,i=(n=new r(n)).c,o=s.length,a=i.length,c=t.e,l=n.e;if(n.s=t.s==n.s?1:-1,!s[0]||!i[0])return n.c=[n.e=0],n;for(n.e=c+l,o<a&&(e=s,s=i,i=e,l=o,o=a,a=l),e=new Array(l=o+a);l--;)e[l]=0;for(c=a;c--;){for(a=0,l=o+c;l>c;)a=e[l]+i[c]*s[l-c-1]+a,e[l--]=a%10,a=a/10|0;e[l]=a}for(a?++n.e:e.shift(),c=e.length;!e[--c];)e.pop();return n.c=e,n};St.toExponential=function(n,e){var t=this,r=t.c[0];if(n!==mo){if(n!==~~n||n<0||n>du)throw Error(qb);for(t=$u(new t.constructor(t),++n,e);t.c.length<n;)t.c.push(0)}return Mu(t,!0,!!r)};St.toFixed=function(n,e){var t=this,r=t.c[0];if(n!==mo){if(n!==~~n||n<0||n>du)throw Error(qb);for(t=$u(new t.constructor(t),n+t.e+1,e),n=n+t.e+1;t.c.length<n;)t.c.push(0)}return Mu(t,!1,!!r)};St[Symbol.for("nodejs.util.inspect.custom")]=St.toJSON=St.toString=function(){var n=this,e=n.constructor;return Mu(n,n.e<=e.NE||n.e>=e.PE,!!n.c[0])};St.toNumber=function(){var n=+Mu(this,!0,!0);if(this.constructor.strict===!0&&!this.eq(n.toString()))throw Error(iy+"Imprecise conversion");return n};St.toPrecision=function(n,e){var t=this,r=t.constructor,s=t.c[0];if(n!==mo){if(n!==~~n||n<1||n>du)throw Error(Uu+"precision");for(t=$u(new r(t),n,e);t.c.length<n;)t.c.push(0)}return Mu(t,n<=t.e||t.e<=r.NE||t.e>=r.PE,!!s)};St.valueOf=function(){var n=this,e=n.constructor;if(e.strict===!0)throw Error(iy+"valueOf disallowed");return Mu(n,n.e<=e.NE||n.e>=e.PE,!0)};var s9=DD();const Oa=s9,i9={bigNumber(n){return n?new Oa(n):new Oa(0)},multiply(n,e){if(n===void 0||e===void 0)return new Oa(0);const t=new Oa(n),r=new Oa(e);return t.times(r)},toFixed(n,e=2){return n===void 0||n===""?new Oa(0).toFixed(e):new Oa(n).toFixed(e)},formatNumberToLocalString(n,e=2){return n===void 0||n===""?"0.00":typeof n=="number"?n.toLocaleString("en-US",{maximumFractionDigits:e,minimumFractionDigits:e,roundingMode:"floor"}):parseFloat(n).toLocaleString("en-US",{maximumFractionDigits:e,minimumFractionDigits:e,roundingMode:"floor"})},parseLocalStringToNumber(n){if(n===void 0||n==="")return 0;const e=n.replace(/,/gu,"");return new Oa(e).toNumber()}},o9=[{type:"function",name:"transfer",stateMutability:"nonpayable",inputs:[{name:"_to",type:"address"},{name:"_value",type:"uint256"}],outputs:[{name:"",type:"bool"}]},{type:"function",name:"transferFrom",stateMutability:"nonpayable",inputs:[{name:"_from",type:"address"},{name:"_to",type:"address"},{name:"_value",type:"uint256"}],outputs:[{name:"",type:"bool"}]}],a9=[{type:"function",name:"approve",stateMutability:"nonpayable",inputs:[{name:"spender",type:"address"},{name:"amount",type:"uint256"}],outputs:[{type:"bool"}]}],c9=[{type:"function",name:"transfer",stateMutability:"nonpayable",inputs:[{name:"recipient",type:"address"},{name:"amount",type:"uint256"}],outputs:[]},{type:"function",name:"transferFrom",stateMutability:"nonpayable",inputs:[{name:"sender",type:"address"},{name:"recipient",type:"address"},{name:"amount",type:"uint256"}],outputs:[{name:"",type:"bool"}]}],l9={getERC20Abi:n=>H.USDT_CONTRACT_ADDRESSES.includes(n)?c9:o9,getSwapAbi:()=>a9},Tr={validateCaipAddress(n){var e;if(((e=n.split(":"))==null?void 0:e.length)!==3)throw new Error("Invalid CAIP Address");return n},parseCaipAddress(n){const e=n.split(":");if(e.length!==3)throw new Error(`Invalid CAIP-10 address: ${n}`);const[t,r,s]=e;if(!t||!r||!s)throw new Error(`Invalid CAIP-10 address: ${n}`);return{chainNamespace:t,chainId:r,address:s}},parseCaipNetworkId(n){const e=n.split(":");if(e.length!==2)throw new Error(`Invalid CAIP-2 network id: ${n}`);const[t,r]=e;if(!t||!r)throw new Error(`Invalid CAIP-2 network id: ${n}`);return{chainNamespace:t,chainId:r}}},Ne={WALLET_ID:"@appkit/wallet_id",WALLET_NAME:"@appkit/wallet_name",SOLANA_WALLET:"@appkit/solana_wallet",SOLANA_CAIP_CHAIN:"@appkit/solana_caip_chain",ACTIVE_CAIP_NETWORK_ID:"@appkit/active_caip_network_id",CONNECTED_SOCIAL:"@appkit/connected_social",CONNECTED_SOCIAL_USERNAME:"@appkit-wallet/SOCIAL_USERNAME",RECENT_WALLETS:"@appkit/recent_wallets",DEEPLINK_CHOICE:"WALLETCONNECT_DEEPLINK_CHOICE",ACTIVE_NAMESPACE:"@appkit/active_namespace",CONNECTED_NAMESPACES:"@appkit/connected_namespaces",CONNECTION_STATUS:"@appkit/connection_status",SIWX_AUTH_TOKEN:"@appkit/siwx-auth-token",SIWX_NONCE_TOKEN:"@appkit/siwx-nonce-token",TELEGRAM_SOCIAL_PROVIDER:"@appkit/social_provider",NATIVE_BALANCE_CACHE:"@appkit/native_balance_cache",PORTFOLIO_CACHE:"@appkit/portfolio_cache",ENS_CACHE:"@appkit/ens_cache",IDENTITY_CACHE:"@appkit/identity_cache",PREFERRED_ACCOUNT_TYPES:"@appkit/preferred_account_types",CONNECTIONS:"@appkit/connections",DISCONNECTED_CONNECTOR_IDS:"@appkit/disconnected_connector_ids",HISTORY_TRANSACTIONS_CACHE:"@appkit/history_transactions_cache",TOKEN_PRICE_CACHE:"@appkit/token_price_cache",RECENT_EMAILS:"@appkit/recent_emails"};function vv(n){if(!n)throw new Error("Namespace is required for CONNECTED_CONNECTOR_ID");return`@appkit/${n}:connected_connector_id`}const _e={setItem(n,e){$h()&&e!==void 0&&localStorage.setItem(n,e)},getItem(n){if($h())return localStorage.getItem(n)||void 0},removeItem(n){$h()&&localStorage.removeItem(n)},clear(){$h()&&localStorage.clear()}};function $h(){return typeof window<"u"&&typeof localStorage<"u"}function ia(n,e){return e==="light"?{"--w3m-accent":(n==null?void 0:n["--w3m-accent"])||"hsla(231, 100%, 70%, 1)","--w3m-background":"#fff"}:{"--w3m-accent":(n==null?void 0:n["--w3m-accent"])||"hsla(230, 100%, 67%, 1)","--w3m-background":"#121313"}}var mN={};const Av=(typeof process<"u"&&typeof mN<"u"?mN.NEXT_PUBLIC_SECURE_SITE_ORIGIN:void 0)||"https://secure.walletconnect.org",UD=[{label:"Meld.io",name:"meld",feeRange:"1-2%",url:"https://meldcrypto.com",supportedChains:["eip155","solana"]}],u9="WXETMuFUQmqqybHuRkSgxv:25B8LJHSfpG6LVjR2ytU5Cwh7Z4Sch2ocoU",st={FOUR_MINUTES_MS:24e4,TEN_SEC_MS:1e4,FIVE_SEC_MS:5e3,THREE_SEC_MS:3e3,ONE_SEC_MS:1e3,SECURE_SITE:Av,SECURE_SITE_DASHBOARD:`${Av}/dashboard`,SECURE_SITE_FAVICON:`${Av}/images/favicon.png`,RESTRICTED_TIMEZONES:["ASIA/SHANGHAI","ASIA/URUMQI","ASIA/CHONGQING","ASIA/HARBIN","ASIA/KASHGAR","ASIA/MACAU","ASIA/HONG_KONG","ASIA/MACAO","ASIA/BEIJING","ASIA/HARBIN"],SWAP_SUGGESTED_TOKENS:["ETH","UNI","1INCH","AAVE","SOL","ADA","AVAX","DOT","LINK","NITRO","GAIA","MILK","TRX","NEAR","GNO","WBTC","DAI","WETH","USDC","USDT","ARB","BAL","BICO","CRV","ENS","MATIC","OP"],SWAP_POPULAR_TOKENS:["ETH","UNI","1INCH","AAVE","SOL","ADA","AVAX","DOT","LINK","NITRO","GAIA","MILK","TRX","NEAR","GNO","WBTC","DAI","WETH","USDC","USDT","ARB","BAL","BICO","CRV","ENS","MATIC","OP","METAL","DAI","CHAMP","WOLF","SALE","BAL","BUSD","MUST","BTCpx","ROUTE","HEX","WELT","amDAI","VSQ","VISION","AURUM","pSP","SNX","VC","LINK","CHP","amUSDT","SPHERE","FOX","GIDDY","GFC","OMEN","OX_OLD","DE","WNT"],BALANCE_SUPPORTED_CHAINS:[H.CHAIN.EVM,H.CHAIN.SOLANA],SWAP_SUPPORTED_NETWORKS:["eip155:1","eip155:42161","eip155:10","eip155:324","eip155:8453","eip155:56","eip155:137","eip155:100","eip155:43114","eip155:250","eip155:8217","eip155:1313161554"],NAMES_SUPPORTED_CHAIN_NAMESPACES:[H.CHAIN.EVM],ONRAMP_SUPPORTED_CHAIN_NAMESPACES:[H.CHAIN.EVM,H.CHAIN.SOLANA],ACTIVITY_ENABLED_CHAIN_NAMESPACES:[H.CHAIN.EVM],NATIVE_TOKEN_ADDRESS:{eip155:"0xeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee",solana:"So11111111111111111111111111111111111111111",polkadot:"0x",bip122:"0x",cosmos:"0x",sui:"0x",stacks:"0x"},CONVERT_SLIPPAGE_TOLERANCE:1,CONNECT_LABELS:{MOBILE:"Open and continue in the wallet app",WEB:"Open and continue in the wallet app"},SEND_SUPPORTED_NAMESPACES:[H.CHAIN.EVM,H.CHAIN.SOLANA],DEFAULT_REMOTE_FEATURES:{swaps:["1inch"],onramp:["meld"],email:!0,socials:["google","x","discord","farcaster","github","apple","facebook"],activity:!0,reownBranding:!0,multiWallet:!1,emailCapture:!1,payWithExchange:!1,payments:!1,reownAuthentication:!1},DEFAULT_REMOTE_FEATURES_DISABLED:{email:!1,socials:!1,swaps:!1,onramp:!1,activity:!1,reownBranding:!1,emailCapture:!1,reownAuthentication:!1},DEFAULT_FEATURES:{receive:!0,send:!0,emailShowWallets:!0,connectorTypeOrder:["walletConnect","recent","injected","featured","custom","external","recommended"],analytics:!0,allWallets:!0,legalCheckbox:!1,smartSessions:!1,collapseWallets:!1,walletFeaturesOrder:["onramp","swaps","receive","send"],connectMethodsOrder:void 0,pay:!1,reownAuthentication:!1},DEFAULT_SOCIALS:["google","x","farcaster","discord","apple","github","facebook"],DEFAULT_ACCOUNT_TYPES:{bip122:"payment",eip155:"smartAccount",polkadot:"eoa",solana:"eoa"},ADAPTER_TYPES:{UNIVERSAL:"universal",SOLANA:"solana",WAGMI:"wagmi",ETHERS:"ethers",ETHERS5:"ethers5",BITCOIN:"bitcoin"},SIWX_DEFAULTS:{signOutOnDisconnect:!0}},Q={cacheExpiry:{portfolio:3e4,nativeBalance:3e4,ens:3e5,identity:3e5,transactionsHistory:15e3,tokenPrice:15e3},isCacheExpired(n,e){return Date.now()-n>e},getActiveNetworkProps(){const n=Q.getActiveNamespace(),e=Q.getActiveCaipNetworkId(),t=e?e.split(":")[1]:void 0,r=t?isNaN(Number(t))?t:Number(t):void 0;return{namespace:n,caipNetworkId:e,chainId:r}},setWalletConnectDeepLink({name:n,href:e}){try{_e.setItem(Ne.DEEPLINK_CHOICE,JSON.stringify({href:e,name:n}))}catch{console.info("Unable to set WalletConnect deep link")}},getWalletConnectDeepLink(){try{const n=_e.getItem(Ne.DEEPLINK_CHOICE);if(n)return JSON.parse(n)}catch{console.info("Unable to get WalletConnect deep link")}},deleteWalletConnectDeepLink(){try{_e.removeItem(Ne.DEEPLINK_CHOICE)}catch{console.info("Unable to delete WalletConnect deep link")}},setActiveNamespace(n){try{_e.setItem(Ne.ACTIVE_NAMESPACE,n)}catch{console.info("Unable to set active namespace")}},setActiveCaipNetworkId(n){try{_e.setItem(Ne.ACTIVE_CAIP_NETWORK_ID,n),Q.setActiveNamespace(n.split(":")[0])}catch{console.info("Unable to set active caip network id")}},getActiveCaipNetworkId(){try{return _e.getItem(Ne.ACTIVE_CAIP_NETWORK_ID)}catch{console.info("Unable to get active caip network id");return}},deleteActiveCaipNetworkId(){try{_e.removeItem(Ne.ACTIVE_CAIP_NETWORK_ID)}catch{console.info("Unable to delete active caip network id")}},deleteConnectedConnectorId(n){try{const e=vv(n);_e.removeItem(e)}catch{console.info("Unable to delete connected connector id")}},setAppKitRecent(n){try{const e=Q.getRecentWallets();e.find(r=>r.id===n.id)||(e.unshift(n),e.length>2&&e.pop(),_e.setItem(Ne.RECENT_WALLETS,JSON.stringify(e)))}catch{console.info("Unable to set AppKit recent")}},getRecentWallets(){try{const n=_e.getItem(Ne.RECENT_WALLETS);return n?JSON.parse(n):[]}catch{console.info("Unable to get AppKit recent")}return[]},setConnectedConnectorId(n,e){try{const t=vv(n);_e.setItem(t,e)}catch{console.info("Unable to set Connected Connector Id")}},getActiveNamespace(){try{return _e.getItem(Ne.ACTIVE_NAMESPACE)}catch{console.info("Unable to get active namespace")}},getConnectedConnectorId(n){if(n)try{const e=vv(n);return _e.getItem(e)}catch{console.info("Unable to get connected connector id in namespace",n)}},setConnectedSocialProvider(n){try{_e.setItem(Ne.CONNECTED_SOCIAL,n)}catch{console.info("Unable to set connected social provider")}},getConnectedSocialProvider(){try{return _e.getItem(Ne.CONNECTED_SOCIAL)}catch{console.info("Unable to get connected social provider")}},deleteConnectedSocialProvider(){try{_e.removeItem(Ne.CONNECTED_SOCIAL)}catch{console.info("Unable to delete connected social provider")}},getConnectedSocialUsername(){try{return _e.getItem(Ne.CONNECTED_SOCIAL_USERNAME)}catch{console.info("Unable to get connected social username")}},getStoredActiveCaipNetworkId(){var t;const n=_e.getItem(Ne.ACTIVE_CAIP_NETWORK_ID);return(t=n==null?void 0:n.split(":"))==null?void 0:t[1]},setConnectionStatus(n){try{_e.setItem(Ne.CONNECTION_STATUS,n)}catch{console.info("Unable to set connection status")}},getConnectionStatus(){try{return _e.getItem(Ne.CONNECTION_STATUS)}catch{return}},getConnectedNamespaces(){try{const n=_e.getItem(Ne.CONNECTED_NAMESPACES);return n!=null&&n.length?n.split(","):[]}catch{return[]}},setConnectedNamespaces(n){try{const e=Array.from(new Set(n));_e.setItem(Ne.CONNECTED_NAMESPACES,e.join(","))}catch{console.info("Unable to set namespaces in storage")}},addConnectedNamespace(n){try{const e=Q.getConnectedNamespaces();e.includes(n)||(e.push(n),Q.setConnectedNamespaces(e))}catch{console.info("Unable to add connected namespace")}},removeConnectedNamespace(n){try{const e=Q.getConnectedNamespaces(),t=e.indexOf(n);t>-1&&(e.splice(t,1),Q.setConnectedNamespaces(e))}catch{console.info("Unable to remove connected namespace")}},getTelegramSocialProvider(){try{return _e.getItem(Ne.TELEGRAM_SOCIAL_PROVIDER)}catch{return console.info("Unable to get telegram social provider"),null}},setTelegramSocialProvider(n){try{_e.setItem(Ne.TELEGRAM_SOCIAL_PROVIDER,n)}catch{console.info("Unable to set telegram social provider")}},removeTelegramSocialProvider(){try{_e.removeItem(Ne.TELEGRAM_SOCIAL_PROVIDER)}catch{console.info("Unable to remove telegram social provider")}},getBalanceCache(){let n={};try{const e=_e.getItem(Ne.PORTFOLIO_CACHE);n=e?JSON.parse(e):{}}catch{console.info("Unable to get balance cache")}return n},removeAddressFromBalanceCache(n){try{const e=Q.getBalanceCache();_e.setItem(Ne.PORTFOLIO_CACHE,JSON.stringify({...e,[n]:void 0}))}catch{console.info("Unable to remove address from balance cache",n)}},getBalanceCacheForCaipAddress(n){try{const t=Q.getBalanceCache()[n];if(t&&!this.isCacheExpired(t.timestamp,this.cacheExpiry.portfolio))return t.balance;Q.removeAddressFromBalanceCache(n)}catch{console.info("Unable to get balance cache for address",n)}},updateBalanceCache(n){try{const e=Q.getBalanceCache();e[n.caipAddress]=n,_e.setItem(Ne.PORTFOLIO_CACHE,JSON.stringify(e))}catch{console.info("Unable to update balance cache",n)}},getNativeBalanceCache(){let n={};try{const e=_e.getItem(Ne.NATIVE_BALANCE_CACHE);n=e?JSON.parse(e):{}}catch{console.info("Unable to get balance cache")}return n},removeAddressFromNativeBalanceCache(n){try{const e=Q.getBalanceCache();_e.setItem(Ne.NATIVE_BALANCE_CACHE,JSON.stringify({...e,[n]:void 0}))}catch{console.info("Unable to remove address from balance cache",n)}},getNativeBalanceCacheForCaipAddress(n){try{const t=Q.getNativeBalanceCache()[n];if(t&&!this.isCacheExpired(t.timestamp,this.cacheExpiry.nativeBalance))return t;console.info("Discarding cache for address",n),Q.removeAddressFromBalanceCache(n)}catch{console.info("Unable to get balance cache for address",n)}},updateNativeBalanceCache(n){try{const e=Q.getNativeBalanceCache();e[n.caipAddress]=n,_e.setItem(Ne.NATIVE_BALANCE_CACHE,JSON.stringify(e))}catch{console.info("Unable to update balance cache",n)}},getEnsCache(){let n={};try{const e=_e.getItem(Ne.ENS_CACHE);n=e?JSON.parse(e):{}}catch{console.info("Unable to get ens name cache")}return n},getEnsFromCacheForAddress(n){try{const t=Q.getEnsCache()[n];if(t&&!this.isCacheExpired(t.timestamp,this.cacheExpiry.ens))return t.ens;Q.removeEnsFromCache(n)}catch{console.info("Unable to get ens name from cache",n)}},updateEnsCache(n){try{const e=Q.getEnsCache();e[n.address]=n,_e.setItem(Ne.ENS_CACHE,JSON.stringify(e))}catch{console.info("Unable to update ens name cache",n)}},removeEnsFromCache(n){try{const e=Q.getEnsCache();_e.setItem(Ne.ENS_CACHE,JSON.stringify({...e,[n]:void 0}))}catch{console.info("Unable to remove ens name from cache",n)}},getIdentityCache(){let n={};try{const e=_e.getItem(Ne.IDENTITY_CACHE);n=e?JSON.parse(e):{}}catch{console.info("Unable to get identity cache")}return n},getIdentityFromCacheForAddress(n){try{const t=Q.getIdentityCache()[n];if(t&&!this.isCacheExpired(t.timestamp,this.cacheExpiry.identity))return t.identity;Q.removeIdentityFromCache(n)}catch{console.info("Unable to get identity from cache",n)}},updateIdentityCache(n){try{const e=Q.getIdentityCache();e[n.address]={identity:n.identity,timestamp:n.timestamp},_e.setItem(Ne.IDENTITY_CACHE,JSON.stringify(e))}catch{console.info("Unable to update identity cache",n)}},removeIdentityFromCache(n){try{const e=Q.getIdentityCache();_e.setItem(Ne.IDENTITY_CACHE,JSON.stringify({...e,[n]:void 0}))}catch{console.info("Unable to remove identity from cache",n)}},clearAddressCache(){try{_e.removeItem(Ne.PORTFOLIO_CACHE),_e.removeItem(Ne.NATIVE_BALANCE_CACHE),_e.removeItem(Ne.ENS_CACHE),_e.removeItem(Ne.IDENTITY_CACHE),_e.removeItem(Ne.HISTORY_TRANSACTIONS_CACHE)}catch{console.info("Unable to clear address cache")}},setPreferredAccountTypes(n){try{_e.setItem(Ne.PREFERRED_ACCOUNT_TYPES,JSON.stringify(n))}catch{console.info("Unable to set preferred account types",n)}},getPreferredAccountTypes(){try{const n=_e.getItem(Ne.PREFERRED_ACCOUNT_TYPES);return n?JSON.parse(n):{}}catch{console.info("Unable to get preferred account types")}return{}},setConnections(n,e){try{const t=Q.getConnections(),r=t[e]??[],s=new Map;for(const o of r)s.set(o.connectorId,{...o});for(const o of n){const a=s.get(o.connectorId),c=o.connectorId===H.CONNECTOR_ID.AUTH;if(a&&!c){const l=new Set(a.accounts.map(h=>h.address.toLowerCase())),u=o.accounts.filter(h=>!l.has(h.address.toLowerCase()));a.accounts.push(...u)}else s.set(o.connectorId,{...o})}const i={...t,[e]:Array.from(s.values())};_e.setItem(Ne.CONNECTIONS,JSON.stringify(i))}catch(t){console.error("Unable to sync connections to storage",t)}},getConnections(){try{const n=_e.getItem(Ne.CONNECTIONS);return n?JSON.parse(n):{}}catch(n){return console.error("Unable to get connections from storage",n),{}}},deleteAddressFromConnection({connectorId:n,address:e,namespace:t}){try{const r=Q.getConnections(),s=r[t]??[],i=new Map(s.map(a=>[a.connectorId,a])),o=i.get(n);o&&(o.accounts.filter(c=>c.address.toLowerCase()!==e.toLowerCase()).length===0?i.delete(n):i.set(n,{...o,accounts:o.accounts.filter(c=>c.address.toLowerCase()!==e.toLowerCase())})),_e.setItem(Ne.CONNECTIONS,JSON.stringify({...r,[t]:Array.from(i.values())}))}catch{console.error(`Unable to remove address "${e}" from connector "${n}" in namespace "${t}"`)}},getDisconnectedConnectorIds(){try{const n=_e.getItem(Ne.DISCONNECTED_CONNECTOR_IDS);return n?JSON.parse(n):{}}catch{console.info("Unable to get disconnected connector ids")}return{}},addDisconnectedConnectorId(n,e){try{const t=Q.getDisconnectedConnectorIds(),r=t[e]??[];r.push(n),_e.setItem(Ne.DISCONNECTED_CONNECTOR_IDS,JSON.stringify({...t,[e]:Array.from(new Set(r))}))}catch{console.error(`Unable to set disconnected connector id "${n}" for namespace "${e}"`)}},removeDisconnectedConnectorId(n,e){try{const t=Q.getDisconnectedConnectorIds();let r=t[e]??[];r=r.filter(s=>s.toLowerCase()!==n.toLowerCase()),_e.setItem(Ne.DISCONNECTED_CONNECTOR_IDS,JSON.stringify({...t,[e]:Array.from(new Set(r))}))}catch{console.error(`Unable to remove disconnected connector id "${n}" for namespace "${e}"`)}},isConnectorDisconnected(n,e){try{return(Q.getDisconnectedConnectorIds()[e]??[]).some(s=>s.toLowerCase()===n.toLowerCase())}catch{console.info(`Unable to get disconnected connector id "${n}" for namespace "${e}"`)}return!1},getTransactionsCache(){try{const n=_e.getItem(Ne.HISTORY_TRANSACTIONS_CACHE);return n?JSON.parse(n):{}}catch{console.info("Unable to get transactions cache")}return{}},getTransactionsCacheForAddress({address:n,chainId:e=""}){var t;try{const s=(t=Q.getTransactionsCache()[n])==null?void 0:t[e];if(s&&!this.isCacheExpired(s.timestamp,this.cacheExpiry.transactionsHistory))return s.transactions;Q.removeTransactionsCache({address:n,chainId:e})}catch{console.info("Unable to get transactions cache")}},updateTransactionsCache({address:n,chainId:e="",timestamp:t,transactions:r}){try{const s=Q.getTransactionsCache();s[n]={...s[n],[e]:{timestamp:t,transactions:r}},_e.setItem(Ne.HISTORY_TRANSACTIONS_CACHE,JSON.stringify(s))}catch{console.info("Unable to update transactions cache",{address:n,chainId:e,timestamp:t,transactions:r})}},removeTransactionsCache({address:n,chainId:e}){try{const t=Q.getTransactionsCache(),r=(t==null?void 0:t[n])||{},{[e]:s,...i}=r;_e.setItem(Ne.HISTORY_TRANSACTIONS_CACHE,JSON.stringify({...t,[n]:i}))}catch{console.info("Unable to remove transactions cache",{address:n,chainId:e})}},getTokenPriceCache(){try{const n=_e.getItem(Ne.TOKEN_PRICE_CACHE);return n?JSON.parse(n):{}}catch{console.info("Unable to get token price cache")}return{}},getTokenPriceCacheForAddresses(n){try{const t=Q.getTokenPriceCache()[n.join(",")];if(t&&!this.isCacheExpired(t.timestamp,this.cacheExpiry.tokenPrice))return t.tokenPrice;Q.removeTokenPriceCache(n)}catch{console.info("Unable to get token price cache for addresses",n)}},updateTokenPriceCache(n){try{const e=Q.getTokenPriceCache();e[n.addresses.join(",")]={timestamp:n.timestamp,tokenPrice:n.tokenPrice},_e.setItem(Ne.TOKEN_PRICE_CACHE,JSON.stringify(e))}catch{console.info("Unable to update token price cache",n)}},removeTokenPriceCache(n){try{const e=Q.getTokenPriceCache();_e.setItem(Ne.TOKEN_PRICE_CACHE,JSON.stringify({...e,[n.join(",")]:void 0}))}catch{console.info("Unable to remove token price cache",n)}}},ye={isMobile(){var n;return this.isClient()?!!(window!=null&&window.matchMedia&&typeof window.matchMedia=="function"&&((n=window.matchMedia("(pointer:coarse)"))!=null&&n.matches)||/Android|webOS|iPhone|iPad|iPod|BlackBerry|Opera Mini/u.test(navigator.userAgent)):!1},checkCaipNetwork(n,e=""){return n==null?void 0:n.caipNetworkId.toLocaleLowerCase().includes(e.toLowerCase())},isAndroid(){if(!this.isMobile())return!1;const n=window==null?void 0:window.navigator.userAgent.toLowerCase();return ye.isMobile()&&n.includes("android")},isIos(){if(!this.isMobile())return!1;const n=window==null?void 0:window.navigator.userAgent.toLowerCase();return n.includes("iphone")||n.includes("ipad")},isSafari(){return this.isClient()?(window==null?void 0:window.navigator.userAgent.toLowerCase()).includes("safari"):!1},isClient(){return typeof window<"u"},isPairingExpired(n){return n?n-Date.now()<=st.TEN_SEC_MS:!0},isAllowedRetry(n,e=st.ONE_SEC_MS){return Date.now()-n>=e},copyToClopboard(n){navigator.clipboard.writeText(n)},isIframe(){try{return(window==null?void 0:window.self)!==(window==null?void 0:window.top)}catch{return!1}},isSafeApp(){var n,e;if(ye.isClient()&&window.self!==window.top)try{const t=(e=(n=window==null?void 0:window.location)==null?void 0:n.ancestorOrigins)==null?void 0:e[0],r="https://app.safe.global";if(t){const s=new URL(t),i=new URL(r);return s.hostname===i.hostname}}catch{return!1}return!1},getPairingExpiry(){return Date.now()+st.FOUR_MINUTES_MS},getNetworkId(n){return n==null?void 0:n.split(":")[1]},getPlainAddress(n){return n==null?void 0:n.split(":")[2]},async wait(n){return new Promise(e=>{setTimeout(e,n)})},debounce(n,e=500){let t;return(...r)=>{function s(){n(...r)}t&&clearTimeout(t),t=setTimeout(s,e)}},isHttpUrl(n){return n.startsWith("http://")||n.startsWith("https://")},formatNativeUrl(n,e,t=null){if(ye.isHttpUrl(n))return this.formatUniversalUrl(n,e);let r=n,s=t;r.includes("://")||(r=n.replaceAll("/","").replaceAll(":",""),r=`${r}://`),r.endsWith("/")||(r=`${r}/`),s&&!(s!=null&&s.endsWith("/"))&&(s=`${s}/`),this.isTelegram()&&this.isAndroid()&&(e=encodeURIComponent(e));const i=encodeURIComponent(e);return{redirect:`${r}wc?uri=${i}`,redirectUniversalLink:s?`${s}wc?uri=${i}`:void 0,href:r}},formatUniversalUrl(n,e){if(!ye.isHttpUrl(n))return this.formatNativeUrl(n,e);let t=n;t.endsWith("/")||(t=`${t}/`);const r=encodeURIComponent(e);return{redirect:`${t}wc?uri=${r}`,href:t}},getOpenTargetForPlatform(n){return n==="popupWindow"?n:this.isTelegram()?Q.getTelegramSocialProvider()?"_top":"_blank":n},openHref(n,e,t){window==null||window.open(n,this.getOpenTargetForPlatform(e),t||"noreferrer noopener")},returnOpenHref(n,e,t){return window==null?void 0:window.open(n,this.getOpenTargetForPlatform(e),t||"noreferrer noopener")},isTelegram(){return typeof window<"u"&&(!!window.TelegramWebviewProxy||!!window.Telegram||!!window.TelegramWebviewProxyProto)},isPWA(){var t,r;if(typeof window>"u")return!1;const n=window!=null&&window.matchMedia&&typeof window.matchMedia=="function"?(t=window.matchMedia("(display-mode: standalone)"))==null?void 0:t.matches:!1,e=(r=window==null?void 0:window.navigator)==null?void 0:r.standalone;return!!(n||e)},async preloadImage(n){const e=new Promise((t,r)=>{const s=new Image;s.onload=t,s.onerror=r,s.crossOrigin="anonymous",s.src=n});return Promise.race([e,ye.wait(2e3)])},formatBalance(n,e){let t="0.000";if(typeof n=="string"){const r=Number(n);if(r){const s=Math.floor(r*1e3)/1e3;s&&(t=s.toString())}}return`${t}${e?` ${e}`:""}`},getApiUrl(){return H.W3M_API_URL},getBlockchainApiUrl(){return H.BLOCKCHAIN_API_RPC_URL},getAnalyticsUrl(){return H.PULSE_API_URL},getUUID(){return crypto!=null&&crypto.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/gu,n=>{const e=Math.random()*16|0;return(n==="x"?e:e&3|8).toString(16)})},parseError(n){var e,t;return typeof n=="string"?n:typeof((t=(e=n==null?void 0:n.issues)==null?void 0:e[0])==null?void 0:t.message)=="string"?n.issues[0].message:n instanceof Error?n.message:"Unknown error"},sortRequestedNetworks(n,e=[]){const t={};return e&&n&&(n.forEach((r,s)=>{t[r]=s}),e.sort((r,s)=>{const i=t[r.id],o=t[s.id];return i!==void 0&&o!==void 0?i-o:i!==void 0?-1:o!==void 0?1:0})),e},calculateBalance(n){let e=0;for(const t of n)e+=t.value??0;return e},formatTokenBalance(n){const e=n.toFixed(2),[t,r]=e.split(".");return{dollars:t,pennies:r}},isAddress(n,e="eip155"){switch(e){case"eip155":if(/^(?:0x)?[0-9a-f]{40}$/iu.test(n)){if(/^(?:0x)?[0-9a-f]{40}$/iu.test(n)||/^(?:0x)?[0-9A-F]{40}$/iu.test(n))return!0}else return!1;return!1;case"solana":return/[1-9A-HJ-NP-Za-km-z]{32,44}$/iu.test(n);default:return!1}},uniqueBy(n,e){const t=new Set;return n.filter(r=>{const s=r[e];return t.has(s)?!1:(t.add(s),!0)})},generateSdkVersion(n,e,t){const s=n.length===0?st.ADAPTER_TYPES.UNIVERSAL:n.map(i=>i.adapterType).join(",");return`${e}-${s}-${t}`},createAccount(n,e,t,r,s){return{namespace:n,address:e,type:t,publicKey:r,path:s}},isCaipAddress(n){if(typeof n!="string")return!1;const e=n.split(":"),t=e[0];return e.filter(Boolean).length===3&&t in H.CHAIN_NAME_MAP},getAccount(n){return n?typeof n=="string"?{address:n,chainId:void 0}:{address:n.address,chainId:n.chainId}:{address:void 0,chainId:void 0}},isMac(){const n=window==null?void 0:window.navigator.userAgent.toLowerCase();return n.includes("macintosh")&&!n.includes("safari")},formatTelegramSocialLoginUrl(n){const e=`--${encodeURIComponent(window==null?void 0:window.location.href)}`,t="state=";if(new URL(n).host==="auth.magic.link"){const s="provider_authorization_url=",i=n.substring(n.indexOf(s)+s.length),o=this.injectIntoUrl(decodeURIComponent(i),t,e);return n.replace(i,encodeURIComponent(o))}return this.injectIntoUrl(n,t,e)},injectIntoUrl(n,e,t){const r=n.indexOf(e);if(r===-1)throw new Error(`${e} parameter not found in the URL: ${n}`);const s=n.indexOf("&",r),i=e.length,o=s!==-1?s:n.length,a=n.substring(0,r+i),c=n.substring(r+i,o),l=n.substring(s),u=c+t;return a+u+l}};async function Xf(...n){const e=await fetch(...n);if(!e.ok)throw new Error(`HTTP status code: ${e.status}`,{cause:e});return e}class oy{constructor({baseUrl:e,clientId:t}){this.baseUrl=e,this.clientId=t}async get({headers:e,signal:t,cache:r,...s}){const i=this.createUrl(s);return(await Xf(i,{method:"GET",headers:e,signal:t,cache:r})).json()}async getBlob({headers:e,signal:t,...r}){const s=this.createUrl(r);return(await Xf(s,{method:"GET",headers:e,signal:t})).blob()}async post({body:e,headers:t,signal:r,...s}){const i=this.createUrl(s);return(await Xf(i,{method:"POST",headers:t,body:e?JSON.stringify(e):void 0,signal:r})).json()}async put({body:e,headers:t,signal:r,...s}){const i=this.createUrl(s);return(await Xf(i,{method:"PUT",headers:t,body:e?JSON.stringify(e):void 0,signal:r})).json()}async delete({body:e,headers:t,signal:r,...s}){const i=this.createUrl(s);return(await Xf(i,{method:"DELETE",headers:t,body:e?JSON.stringify(e):void 0,signal:r})).json()}createUrl({path:e,params:t}){const r=new URL(e,this.baseUrl);return t&&Object.entries(t).forEach(([s,i])=>{i&&r.searchParams.append(s,i)}),this.clientId&&r.searchParams.append("clientId",this.clientId),r}}const h9={getFeatureValue(n,e){const t=e==null?void 0:e[n];return t===void 0?st.DEFAULT_FEATURES[n]:t},filterSocialsByPlatform(n){if(!n||!n.length)return n;if(ye.isTelegram()){if(ye.isIos())return n.filter(e=>e!=="google");if(ye.isMac())return n.filter(e=>e!=="x");if(ye.isAndroid())return n.filter(e=>!["facebook","x"].includes(e))}return n}},Ce=Vt({features:st.DEFAULT_FEATURES,projectId:"",sdkType:"appkit",sdkVersion:"html-wagmi-undefined",defaultAccountTypes:st.DEFAULT_ACCOUNT_TYPES,enableNetworkSwitch:!0,experimental_preferUniversalLinks:!1,remoteFeatures:{}}),z={state:Ce,subscribeKey(n,e){return Fr(Ce,n,e)},setOptions(n){Object.assign(Ce,n)},setRemoteFeatures(n){var t,r;if(!n)return;const e={...Ce.remoteFeatures,...n};Ce.remoteFeatures=e,(t=Ce.remoteFeatures)!=null&&t.socials&&(Ce.remoteFeatures.socials=h9.filterSocialsByPlatform(Ce.remoteFeatures.socials)),(r=Ce.features)!=null&&r.pay&&(Ce.remoteFeatures.email=!1,Ce.remoteFeatures.socials=!1)},setFeatures(n){var t;if(!n)return;Ce.features||(Ce.features=st.DEFAULT_FEATURES);const e={...Ce.features,...n};Ce.features=e,(t=Ce.features)!=null&&t.pay&&Ce.remoteFeatures&&(Ce.remoteFeatures.email=!1,Ce.remoteFeatures.socials=!1)},setProjectId(n){Ce.projectId=n},setCustomRpcUrls(n){Ce.customRpcUrls=n},setAllWallets(n){Ce.allWallets=n},setIncludeWalletIds(n){Ce.includeWalletIds=n},setExcludeWalletIds(n){Ce.excludeWalletIds=n},setFeaturedWalletIds(n){Ce.featuredWalletIds=n},setTokens(n){Ce.tokens=n},setTermsConditionsUrl(n){Ce.termsConditionsUrl=n},setPrivacyPolicyUrl(n){Ce.privacyPolicyUrl=n},setCustomWallets(n){Ce.customWallets=n},setIsSiweEnabled(n){Ce.isSiweEnabled=n},setIsUniversalProvider(n){Ce.isUniversalProvider=n},setSdkVersion(n){Ce.sdkVersion=n},setMetadata(n){Ce.metadata=n},setDisableAppend(n){Ce.disableAppend=n},setEIP6963Enabled(n){Ce.enableEIP6963=n},setDebug(n){Ce.debug=n},setEnableWalletConnect(n){Ce.enableWalletConnect=n},setEnableWalletGuide(n){Ce.enableWalletGuide=n},setEnableAuthLogger(n){Ce.enableAuthLogger=n},setEnableWallets(n){Ce.enableWallets=n},setPreferUniversalLinks(n){Ce.experimental_preferUniversalLinks=n},setSIWX(n){if(n)for(const[e,t]of Object.entries(st.SIWX_DEFAULTS))n[e]??(n[e]=t);Ce.siwx=n},setConnectMethodsOrder(n){Ce.features={...Ce.features,connectMethodsOrder:n}},setWalletFeaturesOrder(n){Ce.features={...Ce.features,walletFeaturesOrder:n}},setSocialsOrder(n){Ce.remoteFeatures={...Ce.remoteFeatures,socials:n}},setCollapseWallets(n){Ce.features={...Ce.features,collapseWallets:n}},setEnableEmbedded(n){Ce.enableEmbedded=n},setAllowUnsupportedChain(n){Ce.allowUnsupportedChain=n},setManualWCControl(n){Ce.manualWCControl=n},setEnableNetworkSwitch(n){Ce.enableNetworkSwitch=n},setEnableReconnect(n){Ce.enableReconnect=n},setDefaultAccountTypes(n={}){Object.entries(n).forEach(([e,t])=>{t&&(Ce.defaultAccountTypes[e]=t)})},setUniversalProviderConfigOverride(n){Ce.universalProviderConfigOverride=n},getUniversalProviderConfigOverride(){return Ce.universalProviderConfigOverride},getSnapshot(){return gg(Ce)}},d9=Object.freeze({enabled:!0,events:[]}),f9=new oy({baseUrl:ye.getAnalyticsUrl(),clientId:null}),p9=5,g9=60*1e3,xa=Vt({...d9}),m9={state:xa,subscribeKey(n,e){return Fr(xa,n,e)},async sendError(n,e){if(!xa.enabled)return;const t=Date.now();if(xa.events.filter(i=>{const o=new Date(i.properties.timestamp||"").getTime();return t-o<g9}).length>=p9)return;const s={type:"error",event:e,properties:{errorType:n.name,errorMessage:n.message,stackTrace:n.stack,timestamp:new Date().toISOString()}};xa.events.push(s);try{if(typeof window>"u")return;const{projectId:i,sdkType:o,sdkVersion:a}=z.state;await f9.post({path:"/e",params:{projectId:i,st:o,sv:a||"html-wagmi-4.2.2"},body:{eventId:ye.getUUID(),url:window.location.href,domain:window.location.hostname,timestamp:new Date().toISOString(),props:{type:"error",event:e,errorType:n.name,errorMessage:n.message,stackTrace:n.stack}}})}catch{}},enable(){xa.enabled=!0},disable(){xa.enabled=!1},clearEvents(){xa.events=[]}};class Xd extends Error{constructor(e,t,r){super(e),this.name="AppKitError",this.category=t,this.originalError=r,Object.setPrototypeOf(this,Xd.prototype);let s=!1;if(r instanceof Error&&typeof r.stack=="string"&&r.stack){const i=r.stack,o=i.indexOf(`
`);if(o>-1){const a=i.substring(o+1);this.stack=`${this.name}: ${this.message}
${a}`,s=!0}}s||(Error.captureStackTrace?Error.captureStackTrace(this,Xd):this.stack||(this.stack=`${this.name}: ${this.message}`))}}function yN(n,e){let t="";try{n instanceof Error?t=n.message:typeof n=="string"?t=n:typeof n=="object"&&n!==null?t=JSON.stringify(n):t=String(n)}catch(s){t="Unknown error",console.error("Error parsing error message",s)}const r=n instanceof Xd?n:new Xd(t,e,n);throw m9.sendError(r,r.category),r}function Rs(n,e="INTERNAL_SDK_ERROR"){const t={};return Object.keys(n).forEach(r=>{const s=n[r];if(typeof s=="function"){let i=s;s.constructor.name==="AsyncFunction"?i=async(...o)=>{try{return await s(...o)}catch(a){return yN(a,e)}}:i=(...o)=>{try{return s(...o)}catch(a){return yN(a,e)}},t[r]=i}else t[r]=s}),t}var ef={};const y9="https://secure.walletconnect.org/sdk",w9=(typeof process<"u"&&typeof ef<"u"?ef.NEXT_PUBLIC_SECURE_SITE_SDK_URL:void 0)||y9,b9=(typeof process<"u"&&typeof ef<"u"?ef.NEXT_PUBLIC_DEFAULT_LOG_LEVEL:void 0)||"error",E9=(typeof process<"u"&&typeof ef<"u"?ef.NEXT_PUBLIC_SECURE_SITE_SDK_VERSION:void 0)||"4",ve={APP_EVENT_KEY:"@w3m-app/",FRAME_EVENT_KEY:"@w3m-frame/",RPC_METHOD_KEY:"RPC_",STORAGE_KEY:"@appkit-wallet/",SESSION_TOKEN_KEY:"SESSION_TOKEN_KEY",EMAIL_LOGIN_USED_KEY:"EMAIL_LOGIN_USED_KEY",LAST_USED_CHAIN_KEY:"LAST_USED_CHAIN_KEY",LAST_EMAIL_LOGIN_TIME:"LAST_EMAIL_LOGIN_TIME",EMAIL:"EMAIL",PREFERRED_ACCOUNT_TYPE:"PREFERRED_ACCOUNT_TYPE",SMART_ACCOUNT_ENABLED:"SMART_ACCOUNT_ENABLED",SMART_ACCOUNT_ENABLED_NETWORKS:"SMART_ACCOUNT_ENABLED_NETWORKS",SOCIAL_USERNAME:"SOCIAL_USERNAME",APP_SWITCH_NETWORK:"@w3m-app/SWITCH_NETWORK",APP_CONNECT_EMAIL:"@w3m-app/CONNECT_EMAIL",APP_CONNECT_DEVICE:"@w3m-app/CONNECT_DEVICE",APP_CONNECT_OTP:"@w3m-app/CONNECT_OTP",APP_CONNECT_SOCIAL:"@w3m-app/CONNECT_SOCIAL",APP_GET_SOCIAL_REDIRECT_URI:"@w3m-app/GET_SOCIAL_REDIRECT_URI",APP_GET_USER:"@w3m-app/GET_USER",APP_SIGN_OUT:"@w3m-app/SIGN_OUT",APP_IS_CONNECTED:"@w3m-app/IS_CONNECTED",APP_GET_CHAIN_ID:"@w3m-app/GET_CHAIN_ID",APP_RPC_REQUEST:"@w3m-app/RPC_REQUEST",APP_UPDATE_EMAIL:"@w3m-app/UPDATE_EMAIL",APP_UPDATE_EMAIL_PRIMARY_OTP:"@w3m-app/UPDATE_EMAIL_PRIMARY_OTP",APP_UPDATE_EMAIL_SECONDARY_OTP:"@w3m-app/UPDATE_EMAIL_SECONDARY_OTP",APP_AWAIT_UPDATE_EMAIL:"@w3m-app/AWAIT_UPDATE_EMAIL",APP_SYNC_THEME:"@w3m-app/SYNC_THEME",APP_SYNC_DAPP_DATA:"@w3m-app/SYNC_DAPP_DATA",APP_GET_SMART_ACCOUNT_ENABLED_NETWORKS:"@w3m-app/GET_SMART_ACCOUNT_ENABLED_NETWORKS",APP_INIT_SMART_ACCOUNT:"@w3m-app/INIT_SMART_ACCOUNT",APP_SET_PREFERRED_ACCOUNT:"@w3m-app/SET_PREFERRED_ACCOUNT",APP_CONNECT_FARCASTER:"@w3m-app/CONNECT_FARCASTER",APP_GET_FARCASTER_URI:"@w3m-app/GET_FARCASTER_URI",APP_RELOAD:"@w3m-app/RELOAD",APP_RPC_ABORT:"@w3m-app/RPC_ABORT",FRAME_SWITCH_NETWORK_ERROR:"@w3m-frame/SWITCH_NETWORK_ERROR",FRAME_SWITCH_NETWORK_SUCCESS:"@w3m-frame/SWITCH_NETWORK_SUCCESS",FRAME_CONNECT_EMAIL_ERROR:"@w3m-frame/CONNECT_EMAIL_ERROR",FRAME_CONNECT_EMAIL_SUCCESS:"@w3m-frame/CONNECT_EMAIL_SUCCESS",FRAME_CONNECT_DEVICE_ERROR:"@w3m-frame/CONNECT_DEVICE_ERROR",FRAME_CONNECT_DEVICE_SUCCESS:"@w3m-frame/CONNECT_DEVICE_SUCCESS",FRAME_CONNECT_OTP_SUCCESS:"@w3m-frame/CONNECT_OTP_SUCCESS",FRAME_CONNECT_OTP_ERROR:"@w3m-frame/CONNECT_OTP_ERROR",FRAME_CONNECT_SOCIAL_SUCCESS:"@w3m-frame/CONNECT_SOCIAL_SUCCESS",FRAME_CONNECT_SOCIAL_ERROR:"@w3m-frame/CONNECT_SOCIAL_ERROR",FRAME_CONNECT_FARCASTER_SUCCESS:"@w3m-frame/CONNECT_FARCASTER_SUCCESS",FRAME_CONNECT_FARCASTER_ERROR:"@w3m-frame/CONNECT_FARCASTER_ERROR",FRAME_GET_FARCASTER_URI_SUCCESS:"@w3m-frame/GET_FARCASTER_URI_SUCCESS",FRAME_GET_FARCASTER_URI_ERROR:"@w3m-frame/GET_FARCASTER_URI_ERROR",FRAME_GET_SOCIAL_REDIRECT_URI_SUCCESS:"@w3m-frame/GET_SOCIAL_REDIRECT_URI_SUCCESS",FRAME_GET_SOCIAL_REDIRECT_URI_ERROR:"@w3m-frame/GET_SOCIAL_REDIRECT_URI_ERROR",FRAME_GET_USER_SUCCESS:"@w3m-frame/GET_USER_SUCCESS",FRAME_GET_USER_ERROR:"@w3m-frame/GET_USER_ERROR",FRAME_SIGN_OUT_SUCCESS:"@w3m-frame/SIGN_OUT_SUCCESS",FRAME_SIGN_OUT_ERROR:"@w3m-frame/SIGN_OUT_ERROR",FRAME_IS_CONNECTED_SUCCESS:"@w3m-frame/IS_CONNECTED_SUCCESS",FRAME_IS_CONNECTED_ERROR:"@w3m-frame/IS_CONNECTED_ERROR",FRAME_GET_CHAIN_ID_SUCCESS:"@w3m-frame/GET_CHAIN_ID_SUCCESS",FRAME_GET_CHAIN_ID_ERROR:"@w3m-frame/GET_CHAIN_ID_ERROR",FRAME_RPC_REQUEST_SUCCESS:"@w3m-frame/RPC_REQUEST_SUCCESS",FRAME_RPC_REQUEST_ERROR:"@w3m-frame/RPC_REQUEST_ERROR",FRAME_SESSION_UPDATE:"@w3m-frame/SESSION_UPDATE",FRAME_UPDATE_EMAIL_SUCCESS:"@w3m-frame/UPDATE_EMAIL_SUCCESS",FRAME_UPDATE_EMAIL_ERROR:"@w3m-frame/UPDATE_EMAIL_ERROR",FRAME_UPDATE_EMAIL_PRIMARY_OTP_SUCCESS:"@w3m-frame/UPDATE_EMAIL_PRIMARY_OTP_SUCCESS",FRAME_UPDATE_EMAIL_PRIMARY_OTP_ERROR:"@w3m-frame/UPDATE_EMAIL_PRIMARY_OTP_ERROR",FRAME_UPDATE_EMAIL_SECONDARY_OTP_SUCCESS:"@w3m-frame/UPDATE_EMAIL_SECONDARY_OTP_SUCCESS",FRAME_UPDATE_EMAIL_SECONDARY_OTP_ERROR:"@w3m-frame/UPDATE_EMAIL_SECONDARY_OTP_ERROR",FRAME_SYNC_THEME_SUCCESS:"@w3m-frame/SYNC_THEME_SUCCESS",FRAME_SYNC_THEME_ERROR:"@w3m-frame/SYNC_THEME_ERROR",FRAME_SYNC_DAPP_DATA_SUCCESS:"@w3m-frame/SYNC_DAPP_DATA_SUCCESS",FRAME_SYNC_DAPP_DATA_ERROR:"@w3m-frame/SYNC_DAPP_DATA_ERROR",FRAME_GET_SMART_ACCOUNT_ENABLED_NETWORKS_SUCCESS:"@w3m-frame/GET_SMART_ACCOUNT_ENABLED_NETWORKS_SUCCESS",FRAME_GET_SMART_ACCOUNT_ENABLED_NETWORKS_ERROR:"@w3m-frame/GET_SMART_ACCOUNT_ENABLED_NETWORKS_ERROR",FRAME_INIT_SMART_ACCOUNT_SUCCESS:"@w3m-frame/INIT_SMART_ACCOUNT_SUCCESS",FRAME_INIT_SMART_ACCOUNT_ERROR:"@w3m-frame/INIT_SMART_ACCOUNT_ERROR",FRAME_SET_PREFERRED_ACCOUNT_SUCCESS:"@w3m-frame/SET_PREFERRED_ACCOUNT_SUCCESS",FRAME_SET_PREFERRED_ACCOUNT_ERROR:"@w3m-frame/SET_PREFERRED_ACCOUNT_ERROR",FRAME_READY:"@w3m-frame/READY",FRAME_RELOAD_SUCCESS:"@w3m-frame/RELOAD_SUCCESS",FRAME_RELOAD_ERROR:"@w3m-frame/RELOAD_ERROR",FRAME_RPC_ABORT_SUCCESS:"@w3m-frame/RPC_ABORT_SUCCESS",FRAME_RPC_ABORT_ERROR:"@w3m-frame/RPC_ABORT_ERROR",RPC_RESPONSE_TYPE_ERROR:"RPC_RESPONSE_ERROR",RPC_RESPONSE_TYPE_TX:"RPC_RESPONSE_TRANSACTION_HASH",RPC_RESPONSE_TYPE_OBJECT:"RPC_RESPONSE_OBJECT"},vn={SAFE_RPC_METHODS:["eth_accounts","eth_blockNumber","eth_call","eth_chainId","eth_estimateGas","eth_feeHistory","eth_gasPrice","eth_getAccount","eth_getBalance","eth_getBlockByHash","eth_getBlockByNumber","eth_getBlockReceipts","eth_getBlockTransactionCountByHash","eth_getBlockTransactionCountByNumber","eth_getCode","eth_getFilterChanges","eth_getFilterLogs","eth_getLogs","eth_getProof","eth_getStorageAt","eth_getTransactionByBlockHashAndIndex","eth_getTransactionByBlockNumberAndIndex","eth_getTransactionByHash","eth_getTransactionCount","eth_getTransactionReceipt","eth_getUncleCountByBlockHash","eth_getUncleCountByBlockNumber","eth_maxPriorityFeePerGas","eth_newBlockFilter","eth_newFilter","eth_newPendingTransactionFilter","eth_sendRawTransaction","eth_syncing","eth_uninstallFilter","wallet_getCapabilities","wallet_getCallsStatus","eth_getUserOperationReceipt","eth_estimateUserOperationGas","eth_getUserOperationByHash","eth_supportedEntryPoints","wallet_getAssets"],NOT_SAFE_RPC_METHODS:["personal_sign","eth_signTypedData_v4","eth_sendTransaction","solana_signMessage","solana_signTransaction","solana_signAllTransactions","solana_signAndSendTransaction","wallet_sendCalls","wallet_grantPermissions","wallet_revokePermissions","eth_sendUserOperation"],GET_CHAIN_ID:"eth_chainId",RPC_METHOD_NOT_ALLOWED_MESSAGE:"Requested RPC call is not allowed",RPC_METHOD_NOT_ALLOWED_UI_MESSAGE:"Action not allowed",ACCOUNT_TYPES:{EOA:"eoa",SMART_ACCOUNT:"smartAccount"}},_r={PHANTOM:{id:"a797aa35c0fadbfc1a53e7f675162ed5226968b44a19ee3d24385c64d1d3c393",url:"https://phantom.app"},SOLFLARE:{id:"1ca0bdd4747578705b1939af023d120677c64fe6ca76add81fda36e350605e79",url:"https://solflare.com"},COINBASE:{id:"fd20dc426fb37566d803205b19bbc1d4096b248ac04548e3cfb6b3a38bd033aa",url:"https://go.cb-w.com"},BINANCE:{id:"2fafea35bb471d22889ccb49c08d99dd0a18a37982602c33f696a5723934ba25",appId:"yFK5FCqYprrXDiVFbhyRx7",deeplink:"bnc://app.binance.com/mp/app",url:"https://app.binance.com/en/download"}},v9={handleMobileDeeplinkRedirect(n,e){const t=window.location.href,r=encodeURIComponent(t);if(n===_r.PHANTOM.id&&!("phantom"in window)){const s=t.startsWith("https")?"https":"http",i=t.split("/")[2],o=encodeURIComponent(`${s}://${i}`);window.location.href=`${_r.PHANTOM.url}/ul/browse/${r}?ref=${o}`}if(n===_r.SOLFLARE.id&&!("solflare"in window)&&(window.location.href=`${_r.SOLFLARE.url}/ul/v1/browse/${r}?ref=${r}`),e===H.CHAIN.SOLANA&&n===_r.COINBASE.id&&!("coinbaseSolana"in window)&&(window.location.href=`${_r.COINBASE.url}/dapp?cb_url=${r}`),e===H.CHAIN.BITCOIN&&n===_r.BINANCE.id&&!("binancew3w"in window)){const s=I.state.activeCaipNetwork,i=window.btoa("/pages/browser/index"),o=window.btoa(`url=${r}&defaultChainId=${(s==null?void 0:s.id)??1}`),a=new URL(_r.BINANCE.deeplink);a.searchParams.set("appId",_r.BINANCE.appId),a.searchParams.set("startPagePath",i),a.searchParams.set("startPageQuery",o);const c=new URL(_r.BINANCE.url);c.searchParams.set("_dp",window.btoa(a.toString())),window.location.href=c.toString()}}},fs=Vt({walletImages:{},networkImages:{},chainImages:{},connectorImages:{},tokenImages:{},currencyImages:{}}),A9={state:fs,subscribeNetworkImages(n){return Lr(fs.networkImages,()=>n(fs.networkImages))},subscribeKey(n,e){return Fr(fs,n,e)},subscribe(n){return Lr(fs,()=>n(fs))},setWalletImage(n,e){fs.walletImages[n]=e},setNetworkImage(n,e){fs.networkImages[n]=e},setChainImage(n,e){fs.chainImages[n]=e},setConnectorImage(n,e){fs.connectorImages={...fs.connectorImages,[n]:e}},setTokenImage(n,e){fs.tokenImages[n]=e},setCurrencyImage(n,e){fs.currencyImages[n]=e}},Ci=Rs(A9),C9={eip155:"ba0ba0cd-17c6-4806-ad93-f9d174f17900",solana:"a1b58899-f671-4276-6a5e-56ca5bd59700",polkadot:"",bip122:"0b4838db-0161-4ffe-022d-532bf03dba00",cosmos:"",sui:"",stacks:""},Cv=Vt({networkImagePromises:{}}),$D={async fetchWalletImage(n){if(n)return await Se._fetchWalletImage(n),this.getWalletImageById(n)},async fetchNetworkImage(n){if(!n)return;const e=this.getNetworkImageById(n);return e||(Cv.networkImagePromises[n]||(Cv.networkImagePromises[n]=Se._fetchNetworkImage(n)),await Cv.networkImagePromises[n],this.getNetworkImageById(n))},getWalletImageById(n){if(n)return Ci.state.walletImages[n]},getWalletImage(n){if(n!=null&&n.image_url)return n==null?void 0:n.image_url;if(n!=null&&n.image_id)return Ci.state.walletImages[n.image_id]},getNetworkImage(n){var e,t,r;if((e=n==null?void 0:n.assets)!=null&&e.imageUrl)return(t=n==null?void 0:n.assets)==null?void 0:t.imageUrl;if((r=n==null?void 0:n.assets)!=null&&r.imageId)return Ci.state.networkImages[n.assets.imageId]},getNetworkImageById(n){if(n)return Ci.state.networkImages[n]},getConnectorImage(n){var e;if(n!=null&&n.imageUrl)return n.imageUrl;if((e=n==null?void 0:n.info)!=null&&e.icon)return n.info.icon;if(n!=null&&n.imageId)return Ci.state.connectorImages[n.imageId]},getChainImage(n){return Ci.state.networkImages[C9[n]]}},Ra=Vt({message:"",variant:"info",open:!1}),I9={state:Ra,subscribeKey(n,e){return Fr(Ra,n,e)},open(n,e){const{debug:t}=z.state,{code:r,displayMessage:s,debugMessage:i}=n;s&&t&&(Ra.message=s,Ra.variant=e,Ra.open=!0),i&&console.error(typeof i=="function"?i():i,r?{code:r}:void 0)},close(){Ra.open=!1,Ra.message="",Ra.variant="info"}},wn=Rs(I9),_9=ye.getAnalyticsUrl(),S9=new oy({baseUrl:_9,clientId:null}),T9=["MODAL_CREATED"],Oo=Vt({timestamp:Date.now(),reportedErrors:{},data:{type:"track",event:"MODAL_CREATED"}}),ut={state:Oo,subscribe(n){return Lr(Oo,()=>n(Oo))},getSdkProperties(){const{projectId:n,sdkType:e,sdkVersion:t}=z.state;return{projectId:n,st:e,sv:t||"html-wagmi-4.2.2"}},async _sendAnalyticsEvent(n){var e;try{let t=ge.state.address;if("address"in n.data&&n.data.address&&(t=n.data.address),T9.includes(n.data.event)||typeof window>"u")return;const r=(e=I.getActiveCaipNetwork())==null?void 0:e.caipNetworkId;await S9.post({path:"/e",params:ut.getSdkProperties(),body:{eventId:ye.getUUID(),url:window.location.href,domain:window.location.hostname,timestamp:n.timestamp,props:{...n.data,address:t,properties:{..."properties"in n.data?n.data.properties:{},caipNetworkId:r}}}}),Oo.reportedErrors.FORBIDDEN=!1}catch(t){t instanceof Error&&t.cause instanceof Response&&t.cause.status===H.HTTP_STATUS_CODES.FORBIDDEN&&!Oo.reportedErrors.FORBIDDEN&&(wn.open({displayMessage:"Invalid App Configuration",debugMessage:`Origin ${$h()?window.origin:"uknown"} not found on Allowlist - update configuration on cloud.reown.com`},"error"),Oo.reportedErrors.FORBIDDEN=!0)}},sendEvent(n){var t;Oo.timestamp=Date.now(),Oo.data=n;const e=["INITIALIZE","CONNECT_SUCCESS","SOCIAL_LOGIN_SUCCESS"];((t=z.state.features)!=null&&t.analytics||e.includes(n.event))&&ut._sendAnalyticsEvent(Oo)}},N9=ye.getApiUrl(),Hr=new oy({baseUrl:N9,clientId:null}),O9=40,wN=4,x9=20,He=Vt({promises:{},page:1,count:0,featured:[],allFeatured:[],recommended:[],allRecommended:[],wallets:[],filteredWallets:[],search:[],isAnalyticsEnabled:!1,excludedWallets:[],isFetchingRecommendedWallets:!1}),Se={state:He,subscribeKey(n,e){return Fr(He,n,e)},_getSdkProperties(){const{projectId:n,sdkType:e,sdkVersion:t}=z.state;return{projectId:n,st:e||"appkit",sv:t||"html-wagmi-4.2.2"}},_filterOutExtensions(n){return z.state.isUniversalProvider?n.filter(e=>!!(e.mobile_link||e.desktop_link||e.webapp_link)):n},async _fetchWalletImage(n){const e=`${Hr.baseUrl}/getWalletImage/${n}`,t=await Hr.getBlob({path:e,params:Se._getSdkProperties()});Ci.setWalletImage(n,URL.createObjectURL(t))},async _fetchNetworkImage(n){const e=`${Hr.baseUrl}/public/getAssetImage/${n}`,t=await Hr.getBlob({path:e,params:Se._getSdkProperties()});Ci.setNetworkImage(n,URL.createObjectURL(t))},async _fetchConnectorImage(n){const e=`${Hr.baseUrl}/public/getAssetImage/${n}`,t=await Hr.getBlob({path:e,params:Se._getSdkProperties()});Ci.setConnectorImage(n,URL.createObjectURL(t))},async _fetchCurrencyImage(n){const e=`${Hr.baseUrl}/public/getCurrencyImage/${n}`,t=await Hr.getBlob({path:e,params:Se._getSdkProperties()});Ci.setCurrencyImage(n,URL.createObjectURL(t))},async _fetchTokenImage(n){const e=`${Hr.baseUrl}/public/getTokenImage/${n}`,t=await Hr.getBlob({path:e,params:Se._getSdkProperties()});Ci.setTokenImage(n,URL.createObjectURL(t))},_filterWalletsByPlatform(n){return ye.isMobile()?n==null?void 0:n.filter(t=>t.mobile_link||t.id===_r.COINBASE.id||t.id===_r.BINANCE.id?!0:I.state.activeChain==="solana"&&(t.id===_r.SOLFLARE.id||t.id===_r.PHANTOM.id)):n},async fetchProjectConfig(){return(await Hr.get({path:"/appkit/v1/config",params:Se._getSdkProperties()})).features},async fetchAllowedOrigins(){try{const{allowedOrigins:n}=await Hr.get({path:"/projects/v1/origins",params:Se._getSdkProperties()});return n}catch(n){if(n instanceof Error&&n.cause instanceof Response){const e=n.cause.status;if(e===H.HTTP_STATUS_CODES.TOO_MANY_REQUESTS)throw new Error("RATE_LIMITED",{cause:n});if(e>=H.HTTP_STATUS_CODES.SERVER_ERROR&&e<600)throw new Error("SERVER_ERROR",{cause:n});return[]}return[]}},async fetchNetworkImages(){const n=I.getAllRequestedCaipNetworks(),e=n==null?void 0:n.map(({assets:t})=>t==null?void 0:t.imageId).filter(Boolean).filter(t=>!$D.getNetworkImageById(t));e&&await Promise.allSettled(e.map(t=>Se._fetchNetworkImage(t)))},async fetchConnectorImages(){const{connectors:n}=se.state,e=n.map(({imageId:t})=>t).filter(Boolean);await Promise.allSettled(e.map(t=>Se._fetchConnectorImage(t)))},async fetchCurrencyImages(n=[]){await Promise.allSettled(n.map(e=>Se._fetchCurrencyImage(e)))},async fetchTokenImages(n=[]){await Promise.allSettled(n.map(e=>Se._fetchTokenImage(e)))},async fetchWallets(n){var i;const e=n.exclude??[];Se._getSdkProperties().sv.startsWith("html-core-")&&e.push(...Object.values(_r).map(o=>o.id));const r=await Hr.get({path:"/getWallets",params:{...Se._getSdkProperties(),...n,page:String(n.page),entries:String(n.entries),include:(i=n.include)==null?void 0:i.join(","),exclude:e.join(",")}});return{data:Se._filterWalletsByPlatform(r==null?void 0:r.data)||[],count:r==null?void 0:r.count}},async fetchFeaturedWallets(){const{featuredWalletIds:n}=z.state;if(n!=null&&n.length){const e={...Se._getSdkProperties(),page:1,entries:(n==null?void 0:n.length)??wN,include:n},{data:t}=await Se.fetchWallets(e),r=[...t].sort((i,o)=>n.indexOf(i.id)-n.indexOf(o.id)),s=r.map(i=>i.image_id).filter(Boolean);await Promise.allSettled(s.map(i=>Se._fetchWalletImage(i))),He.featured=r,He.allFeatured=r}},async fetchRecommendedWallets(){try{He.isFetchingRecommendedWallets=!0;const{includeWalletIds:n,excludeWalletIds:e,featuredWalletIds:t}=z.state,r=[...e??[],...t??[]].filter(Boolean),s=I.getRequestedCaipNetworkIds().join(","),i={page:1,entries:wN,include:n,exclude:r,chains:s},{data:o,count:a}=await Se.fetchWallets(i),c=Q.getRecentWallets(),l=o.map(h=>h.image_id).filter(Boolean),u=c.map(h=>h.image_id).filter(Boolean);await Promise.allSettled([...l,...u].map(h=>Se._fetchWalletImage(h))),He.recommended=o,He.allRecommended=o,He.count=a??0}catch{}finally{He.isFetchingRecommendedWallets=!1}},async fetchWalletsByPage({page:n}){const{includeWalletIds:e,excludeWalletIds:t,featuredWalletIds:r}=z.state,s=I.getRequestedCaipNetworkIds().join(","),i=[...He.recommended.map(({id:u})=>u),...t??[],...r??[]].filter(Boolean),o={page:n,entries:O9,include:e,exclude:i,chains:s},{data:a,count:c}=await Se.fetchWallets(o),l=a.slice(0,x9).map(u=>u.image_id).filter(Boolean);await Promise.allSettled(l.map(u=>Se._fetchWalletImage(u))),He.wallets=ye.uniqueBy([...He.wallets,...Se._filterOutExtensions(a)],"id").filter(u=>{var h;return(h=u.chains)==null?void 0:h.some(d=>s.includes(d))}),He.count=c>He.count?c:He.count,He.page=n},async initializeExcludedWallets({ids:n}){const e={page:1,entries:n.length,include:n},{data:t}=await Se.fetchWallets(e);t&&t.forEach(r=>{He.excludedWallets.push({rdns:r.rdns,name:r.name})})},async searchWallet({search:n,badge:e}){const{includeWalletIds:t,excludeWalletIds:r}=z.state,s=I.getRequestedCaipNetworkIds().join(",");He.search=[];const i={page:1,entries:100,search:n==null?void 0:n.trim(),badge_type:e,include:t,exclude:r,chains:s},{data:o}=await Se.fetchWallets(i);ut.sendEvent({type:"track",event:"SEARCH_WALLET",properties:{badge:e??"",search:n??""}});const a=o.map(c=>c.image_id).filter(Boolean);await Promise.allSettled([...a.map(c=>Se._fetchWalletImage(c)),ye.wait(300)]),He.search=Se._filterOutExtensions(o)},initPromise(n,e){const t=He.promises[n];return t||(He.promises[n]=e())},prefetch({fetchConnectorImages:n=!0,fetchFeaturedWallets:e=!0,fetchRecommendedWallets:t=!0,fetchNetworkImages:r=!0}={}){const s=[n&&Se.initPromise("connectorImages",Se.fetchConnectorImages),e&&Se.initPromise("featuredWallets",Se.fetchFeaturedWallets),t&&Se.initPromise("recommendedWallets",Se.fetchRecommendedWallets),r&&Se.initPromise("networkImages",Se.fetchNetworkImages)].filter(Boolean);return Promise.allSettled(s)},prefetchAnalyticsConfig(){var n;(n=z.state.features)!=null&&n.analytics&&Se.fetchAnalyticsConfig()},async fetchAnalyticsConfig(){try{const{isAnalyticsEnabled:n}=await Hr.get({path:"/getAnalyticsConfig",params:Se._getSdkProperties()});z.setFeatures({analytics:n})}catch{z.setFeatures({analytics:!1})}},filterByNamespaces(n){if(!(n!=null&&n.length)){He.featured=He.allFeatured,He.recommended=He.allRecommended;return}const e=I.getRequestedCaipNetworkIds().join(",");He.featured=He.allFeatured.filter(t=>{var r;return(r=t.chains)==null?void 0:r.some(s=>e.includes(s))}),He.recommended=He.allRecommended.filter(t=>{var r;return(r=t.chains)==null?void 0:r.some(s=>e.includes(s))}),He.filteredWallets=He.wallets.filter(t=>{var r;return(r=t.chains)==null?void 0:r.some(s=>e.includes(s))})},clearFilterByNamespaces(){He.filteredWallets=[]},setFilterByNamespace(n){if(!n){He.featured=He.allFeatured,He.recommended=He.allRecommended;return}const e=I.getRequestedCaipNetworkIds().join(",");He.featured=He.allFeatured.filter(t=>{var r;return(r=t.chains)==null?void 0:r.some(s=>e.includes(s))}),He.recommended=He.allRecommended.filter(t=>{var r;return(r=t.chains)==null?void 0:r.some(s=>e.includes(s))}),He.filteredWallets=He.wallets.filter(t=>{var r;return(r=t.chains)==null?void 0:r.some(s=>e.includes(s))})}},xt=Vt({view:"Connect",history:["Connect"],transactionStack:[]}),R9={state:xt,subscribeKey(n,e){return Fr(xt,n,e)},pushTransactionStack(n){xt.transactionStack.push(n)},popTransactionStack(n){const e=xt.transactionStack.pop();if(!e)return;const{onSuccess:t,onError:r,onCancel:s}=e;switch(n){case"success":t==null||t();break;case"error":r==null||r(),Pe.goBack();break;case"cancel":s==null||s(),Pe.goBack();break}},push(n,e){n!==xt.view&&(xt.view=n,xt.history.push(n),xt.data=e)},reset(n,e){xt.view=n,xt.history=[n],xt.data=e},replace(n,e){xt.history.at(-1)===n||(xt.view=n,xt.history[xt.history.length-1]=n,xt.data=e)},goBack(){var r;const n=I.state.activeCaipAddress,e=Pe.state.view==="ConnectingFarcaster",t=!n&&e;if(xt.history.length>1){xt.history.pop();const[s]=xt.history.slice(-1);s&&(n&&s==="Connect"?xt.view="Account":xt.view=s)}else tt.close();(r=xt.data)!=null&&r.wallet&&(xt.data.wallet=void 0),setTimeout(()=>{var s,i,o;if(t){ge.setFarcasterUrl(void 0,I.state.activeChain);const a=se.getAuthConnector();(s=a==null?void 0:a.provider)==null||s.reload();const c=gg(z.state);(o=(i=a==null?void 0:a.provider)==null?void 0:i.syncDappData)==null||o.call(i,{metadata:c.metadata,sdkVersion:c.sdkVersion,projectId:c.projectId,sdkType:c.sdkType})}},100)},goBackToIndex(n){if(xt.history.length>1){xt.history=xt.history.slice(0,n+1);const[e]=xt.history.slice(-1);e&&(xt.view=e)}},goBackOrCloseModal(){Pe.state.history.length>1?Pe.goBack():tt.close()}},Pe=Rs(R9),xo=Vt({themeMode:"dark",themeVariables:{},w3mThemeVariables:void 0}),gA={state:xo,subscribe(n){return Lr(xo,()=>n(xo))},setThemeMode(n){xo.themeMode=n;try{const e=se.getAuthConnector();if(e){const t=gA.getSnapshot().themeVariables;e.provider.syncTheme({themeMode:n,themeVariables:t,w3mThemeVariables:ia(t,n)})}}catch{console.info("Unable to sync theme to auth connector")}},setThemeVariables(n){xo.themeVariables={...xo.themeVariables,...n};try{const e=se.getAuthConnector();if(e){const t=gA.getSnapshot().themeVariables;e.provider.syncTheme({themeVariables:t,w3mThemeVariables:ia(xo.themeVariables,xo.themeMode)})}}catch{console.info("Unable to sync theme to auth connector")}},getSnapshot(){return gg(xo)}},Jr=Rs(gA),MD=Object.fromEntries(PD.map(n=>[n,void 0])),P9=Object.fromEntries(PD.map(n=>[n,!0])),ht=Vt({allConnectors:[],connectors:[],activeConnector:void 0,filterByNamespace:void 0,activeConnectorIds:MD,filterByNamespaceMap:P9}),k9={state:ht,subscribe(n){return Lr(ht,()=>{n(ht)})},subscribeKey(n,e){return Fr(ht,n,e)},initialize(n){n.forEach(e=>{const t=Q.getConnectedConnectorId(e);t&&se.setConnectorId(t,e)})},setActiveConnector(n){n&&(ht.activeConnector=Jd(n))},setConnectors(n){n.filter(s=>!ht.allConnectors.some(i=>i.id===s.id&&se.getConnectorName(i.name)===se.getConnectorName(s.name)&&i.chain===s.chain)).forEach(s=>{s.type!=="MULTI_CHAIN"&&ht.allConnectors.push(Jd(s))});const t=se.getEnabledNamespaces(),r=se.getEnabledConnectors(t);ht.connectors=se.mergeMultiChainConnectors(r)},filterByNamespaces(n){Object.keys(ht.filterByNamespaceMap).forEach(e=>{ht.filterByNamespaceMap[e]=!1}),n.forEach(e=>{ht.filterByNamespaceMap[e]=!0}),se.updateConnectorsForEnabledNamespaces()},filterByNamespace(n,e){ht.filterByNamespaceMap[n]=e,se.updateConnectorsForEnabledNamespaces()},updateConnectorsForEnabledNamespaces(){const n=se.getEnabledNamespaces(),e=se.getEnabledConnectors(n),t=se.areAllNamespacesEnabled();ht.connectors=se.mergeMultiChainConnectors(e),t?Se.clearFilterByNamespaces():Se.filterByNamespaces(n)},getEnabledNamespaces(){return Object.entries(ht.filterByNamespaceMap).filter(([n,e])=>e).map(([n])=>n)},getEnabledConnectors(n){return ht.allConnectors.filter(e=>n.includes(e.chain))},areAllNamespacesEnabled(){return Object.values(ht.filterByNamespaceMap).every(n=>n)},mergeMultiChainConnectors(n){const e=se.generateConnectorMapByName(n),t=[];return e.forEach(r=>{const s=r[0],i=(s==null?void 0:s.id)===H.CONNECTOR_ID.AUTH;r.length>1&&s?t.push({name:s.name,imageUrl:s.imageUrl,imageId:s.imageId,connectors:[...r],type:i?"AUTH":"MULTI_CHAIN",chain:"eip155",id:(s==null?void 0:s.id)||""}):s&&t.push(s)}),t},generateConnectorMapByName(n){const e=new Map;return n.forEach(t=>{const{name:r}=t,s=se.getConnectorName(r);if(!s)return;const i=e.get(s)||[];i.find(a=>a.chain===t.chain)||i.push(t),e.set(s,i)}),e},getConnectorName(n){return n&&({"Trust Wallet":"Trust"}[n]||n)},getUniqueConnectorsByName(n){const e=[];return n.forEach(t=>{e.find(r=>r.chain===t.chain)||e.push(t)}),e},addConnector(n){var e,t,r;if(n.id===H.CONNECTOR_ID.AUTH){const s=n,i=gg(z.state),o=Jr.getSnapshot().themeMode,a=Jr.getSnapshot().themeVariables;(t=(e=s==null?void 0:s.provider)==null?void 0:e.syncDappData)==null||t.call(e,{metadata:i.metadata,sdkVersion:i.sdkVersion,projectId:i.projectId,sdkType:i.sdkType}),(r=s==null?void 0:s.provider)==null||r.syncTheme({themeMode:o,themeVariables:a,w3mThemeVariables:ia(a,o)}),se.setConnectors([n])}else se.setConnectors([n])},getAuthConnector(n){var r;const e=n||I.state.activeChain,t=ht.connectors.find(s=>s.id===H.CONNECTOR_ID.AUTH);if(t)return(r=t==null?void 0:t.connectors)!=null&&r.length?t.connectors.find(i=>i.chain===e):t},getAnnouncedConnectorRdns(){return ht.connectors.filter(n=>n.type==="ANNOUNCED").map(n=>{var e;return(e=n.info)==null?void 0:e.rdns})},getConnectorById(n){return ht.allConnectors.find(e=>e.id===n)},getConnector({id:n,rdns:e,namespace:t}){const r=t||I.state.activeChain;return ht.allConnectors.filter(i=>i.chain===r).find(i=>{var o;return i.explorerId===n||((o=i.info)==null?void 0:o.rdns)===e})},syncIfAuthConnector(n){var i,o;if(n.id!=="ID_AUTH")return;const e=n,t=gg(z.state),r=Jr.getSnapshot().themeMode,s=Jr.getSnapshot().themeVariables;(o=(i=e==null?void 0:e.provider)==null?void 0:i.syncDappData)==null||o.call(i,{metadata:t.metadata,sdkVersion:t.sdkVersion,sdkType:t.sdkType,projectId:t.projectId}),e.provider.syncTheme({themeMode:r,themeVariables:s,w3mThemeVariables:ia(s,r)})},getConnectorsByNamespace(n){const e=ht.allConnectors.filter(t=>t.chain===n);return se.mergeMultiChainConnectors(e)},canSwitchToSmartAccount(n){return I.checkIfSmartAccountEnabled()&&Ns(n)===vn.ACCOUNT_TYPES.EOA},selectWalletConnector(n){const e=se.getConnector({id:n.id,rdns:n.rdns});v9.handleMobileDeeplinkRedirect((e==null?void 0:e.explorerId)||n.id,I.state.activeChain),e?Pe.push("ConnectingExternal",{connector:e,wallet:n}):Pe.push("ConnectingWalletConnect",{wallet:n})},getConnectors(n){return n?se.getConnectorsByNamespace(n):se.mergeMultiChainConnectors(ht.allConnectors)},setFilterByNamespace(n){ht.filterByNamespace=n,ht.connectors=se.getConnectors(n),Se.setFilterByNamespace(n)},setConnectorId(n,e){n&&(ht.activeConnectorIds={...ht.activeConnectorIds,[e]:n},Q.setConnectedConnectorId(e,n))},removeConnectorId(n){ht.activeConnectorIds={...ht.activeConnectorIds,[n]:void 0},Q.deleteConnectedConnectorId(n)},getConnectorId(n){if(n)return ht.activeConnectorIds[n]},isConnected(n){return n?!!ht.activeConnectorIds[n]:Object.values(ht.activeConnectorIds).some(e=>!!e)},resetConnectorIds(){ht.activeConnectorIds={...MD}}},se=Rs(k9),D9=1e3,ep={checkNamespaceConnectorId(n,e){return se.getConnectorId(n)===e},isSocialProvider(n){return st.DEFAULT_REMOTE_FEATURES.socials.includes(n)},connectWalletConnect({walletConnect:n,connector:e,closeModalOnConnect:t=!0,redirectViewOnModalClose:r="Connect",onOpen:s,onConnect:i}){return new Promise((o,a)=>{if(n&&se.setActiveConnector(e),s==null||s(ye.isMobile()&&n),r){const l=tt.subscribeKey("open",u=>{u||(Pe.state.view!==r&&Pe.replace(r),l(),a(new Error("Modal closed")))})}const c=I.subscribeKey("activeCaipAddress",l=>{l&&(i==null||i(),t&&tt.close(),c(),o(Tr.parseCaipAddress(l)))})})},connectExternal(n){return new Promise((e,t)=>{const r=I.subscribeKey("activeCaipAddress",s=>{s&&(tt.close(),r(),e(Tr.parseCaipAddress(s)))});ie.connectExternal(n,n.chain).catch(()=>{r(),t(new Error("Connection rejected"))})})},connectSocial({social:n,namespace:e,closeModalOnConnect:t=!0,onOpenFarcaster:r,onConnect:s}){let i=ge.state.socialWindow,o=ge.state.socialProvider,a=!1,c=null;const l=e||I.state.activeChain,u=I.subscribeKey("activeCaipAddress",h=>{h&&(t&&tt.close(),u())});return new Promise((h,d)=>{async function f(g){var m;if((m=g.data)!=null&&m.resultUri)if(g.origin===H.SECURE_SITE_SDK_ORIGIN){window.removeEventListener("message",f,!1);try{const w=se.getAuthConnector(l);if(w&&!a){i&&(i.close(),ge.setSocialWindow(void 0,l),i=ge.state.socialWindow),a=!0;const v=g.data.resultUri;if(o&&ut.sendEvent({type:"track",event:"SOCIAL_LOGIN_REQUEST_USER_DATA",properties:{provider:o}}),o){Q.setConnectedSocialProvider(o),await ie.connectExternal({id:w.id,type:w.type,socialUri:v},w.chain);const A=I.state.activeCaipAddress;if(!A){d(new Error("Failed to connect"));return}h(Tr.parseCaipAddress(A)),ut.sendEvent({type:"track",event:"SOCIAL_LOGIN_SUCCESS",properties:{provider:o}})}}}catch{o&&ut.sendEvent({type:"track",event:"SOCIAL_LOGIN_ERROR",properties:{provider:o}}),d(new Error("Failed to connect"))}}else o&&ut.sendEvent({type:"track",event:"SOCIAL_LOGIN_ERROR",properties:{provider:o}})}async function p(){if(n&&(ge.setSocialProvider(n,l),o=ge.state.socialProvider,ut.sendEvent({type:"track",event:"SOCIAL_LOGIN_STARTED",properties:{provider:o}})),o==="farcaster"){r==null||r();const g=tt.subscribeKey("open",w=>{!w&&n==="farcaster"&&(d(new Error("Popup closed")),s==null||s(),g())}),m=se.getAuthConnector();if(m&&!ge.state.farcasterUrl)try{const{url:w}=await m.provider.getFarcasterUri();ge.setFarcasterUrl(w,l)}catch{d(new Error("Failed to connect to farcaster"))}}else{const g=se.getAuthConnector();c=ye.returnOpenHref(`${H.SECURE_SITE_SDK_ORIGIN}/loading`,"popupWindow","width=600,height=800,scrollbars=yes");try{if(g&&o){const{uri:m}=await g.provider.getSocialRedirectUri({provider:o});if(c&&m){ge.setSocialWindow(c,l),i=ge.state.socialWindow,c.location.href=m;const w=setInterval(()=>{i!=null&&i.closed&&!a&&(d(new Error("Popup closed")),clearInterval(w))},1e3);window.addEventListener("message",f,!1)}else c==null||c.close(),d(new Error("Failed to initiate social connection"))}}catch{d(new Error("Failed to initiate social connection")),c==null||c.close()}}}p()})},connectEmail({closeModalOnConnect:n=!0,redirectViewOnModalClose:e="Connect",onOpen:t,onConnect:r}){return new Promise((s,i)=>{if(t==null||t(),e){const a=tt.subscribeKey("open",c=>{c||(Pe.state.view!==e&&Pe.replace(e),a(),i(new Error("Modal closed")))})}const o=I.subscribeKey("activeCaipAddress",a=>{a&&(r==null||r(),n&&tt.close(),o(),s(Tr.parseCaipAddress(a)))})})},async updateEmail(){const n=Q.getConnectedConnectorId(I.state.activeChain),e=se.getAuthConnector();if(!e)throw new Error("No auth connector found");if(n!==H.CONNECTOR_ID.AUTH)throw new Error("Not connected to email or social");const t=e.provider.getEmail()??"";return await tt.open({view:"UpdateEmailWallet",data:{email:t,redirectView:void 0}}),new Promise((r,s)=>{const i=setInterval(()=>{const a=e.provider.getEmail()??"";a!==t&&(tt.close(),clearInterval(i),o(),r({email:a}))},D9),o=tt.subscribeKey("open",a=>{a||(Pe.state.view!=="Connect"&&Pe.push("Connect"),clearInterval(i),o(),s(new Error("Modal closed")))})})},canSwitchToSmartAccount(n){return I.checkIfSmartAccountEnabled()&&Ns(n)===vn.ACCOUNT_TYPES.EOA}};function LD(){var r,s;const n=((r=I.state.activeCaipNetwork)==null?void 0:r.chainNamespace)||"eip155",e=((s=I.state.activeCaipNetwork)==null?void 0:s.id)||1,t=st.NATIVE_TOKEN_ADDRESS[n];return`${n}:${e}:${t}`}function Ns(n){var t;return(t=I.getAccountData(n))==null?void 0:t.preferredAccountType}function Tp(n){var e,t;return n?(t=(e=I.state.chains.get(n))==null?void 0:e.networkState)==null?void 0:t.caipNetwork:I.state.activeCaipNetwork}const I0={getConnectionStatus(n,e){const t=se.state.activeConnectorIds[e],r=ie.getConnections(e);return!!t&&n.connectorId===t?"connected":r.some(o=>o.connectorId.toLowerCase()===n.connectorId.toLowerCase())?"active":"disconnected"},excludeConnectorAddressFromConnections({connections:n,connectorId:e,addresses:t}){return n.map(r=>{if((e?r.connectorId.toLowerCase()===e.toLowerCase():!1)&&t){const i=r.accounts.filter(o=>!t.some(c=>c.toLowerCase()===o.address.toLowerCase()));return{...r,accounts:i}}return r})},excludeExistingConnections(n,e){const t=new Set(n);return e.filter(r=>!t.has(r.connectorId))},getConnectionsByConnectorId(n,e){return n.filter(t=>t.connectorId.toLowerCase()===e.toLowerCase())},getConnectionsData(n){var a;const e=!!((a=z.state.remoteFeatures)!=null&&a.multiWallet),t=se.state.activeConnectorIds[n],r=ie.getConnections(n),i=(ie.state.recentConnections.get(n)??[]).filter(c=>se.getConnectorById(c.connectorId)),o=I0.excludeExistingConnections([...r.map(c=>c.connectorId),...t?[t]:[]],i);return e?{connections:r,recentConnections:o}:{connections:r.filter(c=>c.connectorId.toLowerCase()===(t==null?void 0:t.toLowerCase())),recentConnections:[]}}},cl=Object.freeze({message:"",variant:"success",svg:void 0,open:!1,autoClose:!0}),mn=Vt({...cl}),U9={state:mn,subscribeKey(n,e){return Fr(mn,n,e)},showLoading(n,e={}){this._showMessage({message:n,variant:"loading",...e})},showSuccess(n){this._showMessage({message:n,variant:"success"})},showSvg(n,e){this._showMessage({message:n,svg:e})},showError(n){const e=ye.parseError(n);this._showMessage({message:e,variant:"error"})},hide(){mn.message=cl.message,mn.variant=cl.variant,mn.svg=cl.svg,mn.open=cl.open,mn.autoClose=cl.autoClose},_showMessage({message:n,svg:e,variant:t="success",autoClose:r=cl.autoClose}){mn.open?(mn.open=!1,setTimeout(()=>{mn.message=n,mn.variant=t,mn.svg=e,mn.open=!0,mn.autoClose=r},150)):(mn.message=n,mn.variant=t,mn.svg=e,mn.open=!0,mn.autoClose=r)}},uo=U9,qt=Vt({transactions:[],transactionsByYear:{},lastNetworkInView:void 0,loading:!1,empty:!1,next:void 0}),$9={state:qt,subscribe(n){return Lr(qt,()=>n(qt))},setLastNetworkInView(n){qt.lastNetworkInView=n},async fetchTransactions(n){var e;if(!n)throw new Error("Transactions can't be fetched without an accountAddress");qt.loading=!0;try{const t=await xe.fetchTransactions({account:n,cursor:qt.next,chainId:(e=I.state.activeCaipNetwork)==null?void 0:e.caipNetworkId}),r=zw.filterSpamTransactions(t.data),s=zw.filterByConnectedChain(r),i=[...qt.transactions,...s];qt.loading=!1,qt.transactions=i,qt.transactionsByYear=zw.groupTransactionsByYearAndMonth(qt.transactionsByYear,s),qt.empty=i.length===0,qt.next=t.next?t.next:void 0}catch{const r=I.state.activeChain;ut.sendEvent({type:"track",event:"ERROR_FETCH_TRANSACTIONS",properties:{address:n,projectId:z.state.projectId,cursor:qt.next,isSmartAccount:Ns(r)===vn.ACCOUNT_TYPES.SMART_ACCOUNT}}),uo.showError("Failed to fetch transactions"),qt.loading=!1,qt.empty=!0,qt.next=void 0}},groupTransactionsByYearAndMonth(n={},e=[]){const t=n;return e.forEach(r=>{const s=new Date(r.metadata.minedAt).getFullYear(),i=new Date(r.metadata.minedAt).getMonth(),o=t[s]??{},c=(o[i]??[]).filter(l=>l.id!==r.id);t[s]={...o,[i]:[...c,r].sort((l,u)=>new Date(u.metadata.minedAt).getTime()-new Date(l.metadata.minedAt).getTime())}}),t},filterSpamTransactions(n){return n.filter(e=>!e.transfers.every(r=>{var s;return((s=r.nft_info)==null?void 0:s.flags.is_spam)===!0}))},filterByConnectedChain(n){var r;const e=(r=I.state.activeCaipNetwork)==null?void 0:r.caipNetworkId;return n.filter(s=>s.metadata.chain===e)},clearCursor(){qt.next=void 0},resetTransactions(){qt.transactions=[],qt.transactionsByYear={},qt.lastNetworkInView=void 0,qt.loading=!1,qt.empty=!1,qt.next=void 0}},zw=Rs($9,"API_ERROR"),nt=Vt({connections:new Map,recentConnections:new Map,isSwitchingConnection:!1,wcError:!1,buffering:!1,status:"disconnected"});let tl;const M9={state:nt,subscribe(n){return Lr(nt,()=>n(nt))},subscribeKey(n,e){return Fr(nt,n,e)},_getClient(){return nt._client},setClient(n){nt._client=Jd(n)},initialize(n){const e=n.filter(t=>!!t.namespace).map(t=>t.namespace);ie.syncStorageConnections(e)},syncStorageConnections(n){const e=Q.getConnections(),t=n??Array.from(I.state.chains.keys());for(const r of t){const s=e[r]??[],i=new Map(nt.recentConnections);i.set(r,s),nt.recentConnections=i}},getConnections(n){return n?nt.connections.get(n)??[]:[]},hasAnyConnection(n){const e=ie.state.connections;return Array.from(e.values()).flatMap(t=>t).some(({connectorId:t})=>t===n)},async connectWalletConnect({cache:n="auto"}={}){var t,r,s,i;const e=ye.isTelegram()||ye.isSafari()&&ye.isIos();if(n==="always"||n==="auto"&&e){if(tl){await tl,tl=void 0;return}if(!ye.isPairingExpired(nt==null?void 0:nt.wcPairingExpiry)){const o=nt.wcUri;nt.wcUri=o;return}tl=(r=(t=ie._getClient())==null?void 0:t.connectWalletConnect)==null?void 0:r.call(t).catch(()=>{}),ie.state.status="connecting",await tl,tl=void 0,nt.wcPairingExpiry=void 0,ie.state.status="connected"}else await((i=(s=ie._getClient())==null?void 0:s.connectWalletConnect)==null?void 0:i.call(s))},async connectExternal(n,e,t=!0){var s,i;const r=await((i=(s=ie._getClient())==null?void 0:s.connectExternal)==null?void 0:i.call(s,n));return t&&I.setActiveNamespace(e),r},async reconnectExternal(n){var t,r;await((r=(t=ie._getClient())==null?void 0:t.reconnectExternal)==null?void 0:r.call(t,n));const e=n.chain||I.state.activeChain;e&&se.setConnectorId(n.id,e)},async setPreferredAccountType(n,e){var r;if(!e)return;tt.setLoading(!0,I.state.activeChain);const t=se.getAuthConnector();t&&(ge.setPreferredAccountType(n,e),await t.provider.setPreferredAccount(n),Q.setPreferredAccountTypes(Object.entries(I.state.chains).reduce((s,[i,o])=>{const a=i,c=Ns(a);return c!==void 0&&(s[a]=c),s},{})),await ie.reconnectExternal(t),tt.setLoading(!1,I.state.activeChain),ut.sendEvent({type:"track",event:"SET_PREFERRED_ACCOUNT_TYPE",properties:{accountType:n,network:((r=I.state.activeCaipNetwork)==null?void 0:r.caipNetworkId)||""}}))},async signMessage(n){var e;return(e=ie._getClient())==null?void 0:e.signMessage(n)},parseUnits(n,e){var t;return(t=ie._getClient())==null?void 0:t.parseUnits(n,e)},formatUnits(n,e){var t;return(t=ie._getClient())==null?void 0:t.formatUnits(n,e)},async sendTransaction(n){var e;return(e=ie._getClient())==null?void 0:e.sendTransaction(n)},async getCapabilities(n){var e;return(e=ie._getClient())==null?void 0:e.getCapabilities(n)},async grantPermissions(n){var e;return(e=ie._getClient())==null?void 0:e.grantPermissions(n)},async walletGetAssets(n){var e;return((e=ie._getClient())==null?void 0:e.walletGetAssets(n))??{}},async estimateGas(n){var e;return(e=ie._getClient())==null?void 0:e.estimateGas(n)},async writeContract(n){var e;return(e=ie._getClient())==null?void 0:e.writeContract(n)},async getEnsAddress(n){var e;return(e=ie._getClient())==null?void 0:e.getEnsAddress(n)},async getEnsAvatar(n){var e;return(e=ie._getClient())==null?void 0:e.getEnsAvatar(n)},checkInstalled(n){var e,t;return((t=(e=ie._getClient())==null?void 0:e.checkInstalled)==null?void 0:t.call(e,n))||!1},resetWcConnection(){nt.wcUri=void 0,nt.wcPairingExpiry=void 0,nt.wcLinking=void 0,nt.recentWallet=void 0,nt.status="disconnected",zw.resetTransactions(),Q.deleteWalletConnectDeepLink()},resetUri(){nt.wcUri=void 0,nt.wcPairingExpiry=void 0,tl=void 0},finalizeWcConnection(n){var r,s;const{wcLinking:e,recentWallet:t}=ie.state;e&&Q.setWalletConnectDeepLink(e),t&&Q.setAppKitRecent(t),ut.sendEvent({type:"track",event:"CONNECT_SUCCESS",address:n,properties:{method:e?"mobile":"qrcode",name:((s=(r=Pe.state.data)==null?void 0:r.wallet)==null?void 0:s.name)||"Unknown"}})},setWcBasic(n){nt.wcBasic=n},setUri(n){nt.wcUri=n,nt.wcPairingExpiry=ye.getPairingExpiry()},setWcLinking(n){nt.wcLinking=n},setWcError(n){nt.wcError=n,nt.buffering=!1},setRecentWallet(n){nt.recentWallet=n},setBuffering(n){nt.buffering=n},setStatus(n){nt.status=n},setIsSwitchingConnection(n){nt.isSwitchingConnection=n},async disconnect({id:n,namespace:e,initialDisconnect:t}={}){var r;try{await((r=ie._getClient())==null?void 0:r.disconnect({id:n,chainNamespace:e,initialDisconnect:t}))}catch(s){throw new Xd("Failed to disconnect","INTERNAL_SDK_ERROR",s)}},setConnections(n,e){const t=new Map(nt.connections);t.set(e,n),nt.connections=t},async handleAuthAccountSwitch({address:n,namespace:e}){var s,i;const t=(i=(s=ge.state.user)==null?void 0:s.accounts)==null?void 0:i.find(o=>o.type==="smartAccount"),r=t&&t.address.toLowerCase()===n.toLowerCase()&&ep.canSwitchToSmartAccount(e)?"smartAccount":"eoa";await ie.setPreferredAccountType(r,e)},async handleActiveConnection({connection:n,namespace:e,address:t}){const r=se.getConnectorById(n.connectorId),s=n.connectorId===H.CONNECTOR_ID.AUTH;if(!r)throw new Error(`No connector found for connection: ${n.connectorId}`);if(s)s&&t&&await ie.handleAuthAccountSwitch({address:t,namespace:e});else{const i=await ie.connectExternal({id:r.id,type:r.type,provider:r.provider,address:t,chain:e},e);return i==null?void 0:i.address}return t},async handleDisconnectedConnection({connection:n,namespace:e,address:t,closeModalOnConnect:r}){var l,u;const s=se.getConnectorById(n.connectorId),i=(u=(l=n.auth)==null?void 0:l.name)==null?void 0:u.toLowerCase(),o=n.connectorId===H.CONNECTOR_ID.AUTH,a=n.connectorId===H.CONNECTOR_ID.WALLET_CONNECT;if(!s)throw new Error(`No connector found for connection: ${n.connectorId}`);let c;if(o)if(i&&ep.isSocialProvider(i)){const{address:h}=await ep.connectSocial({social:i,closeModalOnConnect:r,onOpenFarcaster(){tt.open({view:"ConnectingFarcaster"})},onConnect(){Pe.replace("ProfileWallets")}});c=h}else{const{address:h}=await ep.connectEmail({closeModalOnConnect:r,onOpen(){tt.open({view:"EmailLogin"})},onConnect(){Pe.replace("ProfileWallets")}});c=h}else if(a){const{address:h}=await ep.connectWalletConnect({walletConnect:!0,connector:s,closeModalOnConnect:r,onOpen(d){const f=d?"AllWallets":"ConnectingWalletConnect";tt.state.open?Pe.push(f):tt.open({view:f})},onConnect(){Pe.replace("ProfileWallets")}});c=h}else{const h=await ie.connectExternal({id:s.id,type:s.type,provider:s.provider,chain:e},e);h&&(c=h.address)}return o&&t&&await ie.handleAuthAccountSwitch({address:t,namespace:e}),c},async switchConnection({connection:n,address:e,namespace:t,closeModalOnConnect:r,onChange:s}){let i;const o=ge.getCaipAddress(t);if(o){const{address:c}=Tr.parseCaipAddress(o);i=c}const a=I0.getConnectionStatus(n,t);switch(a){case"connected":case"active":{const c=await ie.handleActiveConnection({connection:n,namespace:t,address:e});if(i&&c){const l=c.toLowerCase()!==i.toLowerCase();s==null||s({address:c,namespace:t,hasSwitchedAccount:l,hasSwitchedWallet:a==="active"})}break}case"disconnected":{const c=await ie.handleDisconnectedConnection({connection:n,namespace:t,address:e,closeModalOnConnect:r});c&&(s==null||s({address:c,namespace:t,hasSwitchedAccount:!0,hasSwitchedWallet:!0}));break}default:throw new Error(`Invalid connection status: ${a}`)}}},ie=Rs(M9),Zu=Vt({loading:!1,open:!1,selectedNetworkId:void 0,activeChain:void 0,initialized:!1}),Si={state:Zu,subscribe(n){return Lr(Zu,()=>n(Zu))},subscribeOpen(n){return Fr(Zu,"open",n)},set(n){Object.assign(Zu,{...Zu,...n})}},L9={async getTokenList(n){var r;const e=await xe.fetchSwapTokens({chainId:n});return((r=e==null?void 0:e.tokens)==null?void 0:r.map(s=>({...s,eip2612:!1,quantity:{decimals:"0",numeric:"0"},price:0,value:0})))||[]},async fetchGasPrice(){var e;const n=I.state.activeCaipNetwork;if(!n)return null;try{switch(n.chainNamespace){case"solana":const t=(e=await(ie==null?void 0:ie.estimateGas({chainNamespace:"solana"})))==null?void 0:e.toString();return{standard:t,fast:t,instant:t};case"eip155":default:return await xe.fetchGasPrice({chainId:n.caipNetworkId})}}catch{return null}},async fetchSwapAllowance({tokenAddress:n,userAddress:e,sourceTokenAmount:t,sourceTokenDecimals:r}){const s=await xe.fetchSwapAllowance({tokenAddress:n,userAddress:e});if(s!=null&&s.allowance&&t&&r){const i=ie.parseUnits(t,r)||0;return BigInt(s.allowance)>=i}return!1},async getMyTokensWithBalance(n){const e=await XI.getMyTokensWithBalance(n);return ge.setTokenBalance(e,I.state.activeChain),this.mapBalancesToSwapTokens(e)},mapBalancesToSwapTokens(n){return(n==null?void 0:n.map(e=>({...e,address:e!=null&&e.address?e.address:LD(),decimals:parseInt(e.quantity.decimals,10),logoUri:e.iconUrl,eip2612:!1})))||[]}},It=Vt({tokenBalances:[],loading:!1}),B9={state:It,subscribe(n){return Lr(It,()=>n(It))},subscribeKey(n,e){return Fr(It,n,e)},setToken(n){n&&(It.token=Jd(n))},setTokenAmount(n){It.sendTokenAmount=n},setReceiverAddress(n){It.receiverAddress=n},setReceiverProfileImageUrl(n){It.receiverProfileImageUrl=n},setReceiverProfileName(n){It.receiverProfileName=n},setNetworkBalanceInUsd(n){It.networkBalanceInUSD=n},setLoading(n){It.loading=n},async sendToken(){var n;try{switch(Et.setLoading(!0),(n=I.state.activeCaipNetwork)==null?void 0:n.chainNamespace){case"eip155":await Et.sendEvmToken();return;case"solana":await Et.sendSolanaToken();return;default:throw new Error("Unsupported chain")}}finally{Et.setLoading(!1)}},async sendEvmToken(){var t,r,s;const n=I.state.activeChain;if(!n)throw new Error("SendController:sendEvmToken - activeChainNamespace is required");const e=Ns(n);if(!Et.state.sendTokenAmount||!Et.state.receiverAddress)throw new Error("An amount and receiver address are required");if(!Et.state.token)throw new Error("A token is required");(t=Et.state.token)!=null&&t.address?(ut.sendEvent({type:"track",event:"SEND_INITIATED",properties:{isSmartAccount:e===vn.ACCOUNT_TYPES.SMART_ACCOUNT,token:Et.state.token.address,amount:Et.state.sendTokenAmount,network:((r=I.state.activeCaipNetwork)==null?void 0:r.caipNetworkId)||""}}),await Et.sendERC20Token({receiverAddress:Et.state.receiverAddress,tokenAddress:Et.state.token.address,sendTokenAmount:Et.state.sendTokenAmount,decimals:Et.state.token.quantity.decimals})):(ut.sendEvent({type:"track",event:"SEND_INITIATED",properties:{isSmartAccount:e===vn.ACCOUNT_TYPES.SMART_ACCOUNT,token:Et.state.token.symbol||"",amount:Et.state.sendTokenAmount,network:((s=I.state.activeCaipNetwork)==null?void 0:s.caipNetworkId)||""}}),await Et.sendNativeToken({receiverAddress:Et.state.receiverAddress,sendTokenAmount:Et.state.sendTokenAmount,decimals:Et.state.token.quantity.decimals}))},async fetchTokenBalance(n){var o,a;It.loading=!0;const e=I.state.activeChain,t=(o=I.state.activeCaipNetwork)==null?void 0:o.caipNetworkId,r=(a=I.state.activeCaipNetwork)==null?void 0:a.chainNamespace,s=ge.getCaipAddress(e)??I.state.activeCaipAddress,i=s?ye.getPlainAddress(s):void 0;if(It.lastRetry&&!ye.isAllowedRetry(It.lastRetry,30*st.ONE_SEC_MS))return It.loading=!1,[];try{if(i&&t&&r){const c=await XI.getMyTokensWithBalance();return It.tokenBalances=c,It.lastRetry=void 0,c}}catch(c){It.lastRetry=Date.now(),n==null||n(c),uo.showError("Token Balance Unavailable")}finally{It.loading=!1}return[]},fetchNetworkBalance(){if(It.tokenBalances.length===0)return;const n=L9.mapBalancesToSwapTokens(It.tokenBalances);if(!n)return;const e=n.find(t=>t.address===LD());e&&(It.networkBalanceInUSD=e?i9.multiply(e.quantity.numeric,e.price).toString():"0")},async sendNativeToken(n){var i,o,a;Pe.pushTransactionStack({});const e=n.receiverAddress,t=ge.state.address,r=ie.parseUnits(n.sendTokenAmount.toString(),Number(n.decimals));await ie.sendTransaction({chainNamespace:H.CHAIN.EVM,to:e,address:t,data:"0x",value:r??BigInt(0)}),ut.sendEvent({type:"track",event:"SEND_SUCCESS",properties:{isSmartAccount:Ns("eip155")===vn.ACCOUNT_TYPES.SMART_ACCOUNT,token:((i=Et.state.token)==null?void 0:i.symbol)||"",amount:n.sendTokenAmount,network:((o=I.state.activeCaipNetwork)==null?void 0:o.caipNetworkId)||""}}),(a=ie._getClient())==null||a.updateBalance("eip155"),Et.resetSend()},async sendERC20Token(n){Pe.pushTransactionStack({onSuccess(){Pe.replace("Account")}});const e=ie.parseUnits(n.sendTokenAmount.toString(),Number(n.decimals));if(ge.state.address&&n.sendTokenAmount&&n.receiverAddress&&n.tokenAddress){const t=ye.getPlainAddress(n.tokenAddress);if(!t)throw new Error("SendController:sendERC20Token - tokenAddress is required");await ie.writeContract({fromAddress:ge.state.address,tokenAddress:t,args:[n.receiverAddress,e??BigInt(0)],method:"transfer",abi:l9.getERC20Abi(t),chainNamespace:H.CHAIN.EVM}),Et.resetSend()}},async sendSolanaToken(){var n;if(!Et.state.sendTokenAmount||!Et.state.receiverAddress)throw new Error("An amount and receiver address are required");Pe.pushTransactionStack({onSuccess(){Pe.replace("Account")}}),await ie.sendTransaction({chainNamespace:"solana",to:Et.state.receiverAddress,value:Et.state.sendTokenAmount}),(n=ie._getClient())==null||n.updateBalance("solana"),Et.resetSend()},resetSend(){It.token=void 0,It.sendTokenAmount=void 0,It.receiverAddress=void 0,It.receiverProfileImageUrl=void 0,It.receiverProfileName=void 0,It.loading=!1,It.tokenBalances=[]}},Et=Rs(B9),Iv={currentTab:0,tokenBalance:[],smartAccountDeployed:!1,addressLabels:new Map,user:void 0,preferredAccountType:void 0},Zy={caipNetwork:void 0,supportsAllNetworks:!0,smartAccountEnabledNetworks:[]},le=Vt({chains:YF(),activeCaipAddress:void 0,activeChain:void 0,activeCaipNetwork:void 0,noAdapters:!1,universalAdapter:{networkControllerClient:void 0,connectionControllerClient:void 0},isSwitchingNamespace:!1}),F9={state:le,subscribe(n){return Lr(le,()=>{n(le)})},subscribeKey(n,e){return Fr(le,n,e)},subscribeChainProp(n,e,t){let r;return Lr(le.chains,()=>{var i;const s=t||le.activeChain;if(s){const o=(i=le.chains.get(s))==null?void 0:i[n];r!==o&&(r=o,e(o))}})},initialize(n,e,t){const{chainId:r,namespace:s}=Q.getActiveNetworkProps(),i=e==null?void 0:e.find(u=>u.id.toString()===(r==null?void 0:r.toString())),a=n.find(u=>(u==null?void 0:u.namespace)===s)||(n==null?void 0:n[0]),c=n.map(u=>u.namespace).filter(u=>u!==void 0),l=z.state.enableEmbedded?new Set([...c]):new Set([...(e==null?void 0:e.map(u=>u.chainNamespace))??[]]);((n==null?void 0:n.length)===0||!a)&&(le.noAdapters=!0),le.noAdapters||(le.activeChain=a==null?void 0:a.namespace,le.activeCaipNetwork=i,I.setChainNetworkData(a==null?void 0:a.namespace,{caipNetwork:i}),le.activeChain&&Si.set({activeChain:a==null?void 0:a.namespace})),l.forEach(u=>{const h=e==null?void 0:e.filter(p=>p.chainNamespace===u),d=Q.getPreferredAccountTypes()||{},f={...z.state.defaultAccountTypes,...d};I.state.chains.set(u,{namespace:u,networkState:Vt({...Zy,caipNetwork:h==null?void 0:h[0]}),accountState:Vt({...Iv,preferredAccountType:f[u]}),caipNetworks:h??[],...t}),I.setRequestedCaipNetworks(h??[],u)})},removeAdapter(n){var e,t;if(le.activeChain===n){const r=Array.from(le.chains.entries()).find(([s])=>s!==n);if(r){const s=(t=(e=r[1])==null?void 0:e.caipNetworks)==null?void 0:t[0];s&&I.setActiveCaipNetwork(s)}}le.chains.delete(n)},addAdapter(n,{networkControllerClient:e,connectionControllerClient:t},r){if(!n.namespace)throw new Error("ChainController:addAdapter - adapter must have a namespace");le.chains.set(n.namespace,{namespace:n.namespace,networkState:{...Zy,caipNetwork:r[0]},accountState:Iv,caipNetworks:r,connectionControllerClient:t,networkControllerClient:e}),I.setRequestedCaipNetworks((r==null?void 0:r.filter(s=>s.chainNamespace===n.namespace))??[],n.namespace)},addNetwork(n){var t;const e=le.chains.get(n.chainNamespace);if(e){const r=[...e.caipNetworks||[]];(t=e.caipNetworks)!=null&&t.find(s=>s.id===n.id)||r.push(n),le.chains.set(n.chainNamespace,{...e,caipNetworks:r}),I.setRequestedCaipNetworks(r,n.chainNamespace),se.filterByNamespace(n.chainNamespace,!0)}},removeNetwork(n,e){var r,s,i;const t=le.chains.get(n);if(t){const o=((r=le.activeCaipNetwork)==null?void 0:r.id)===e,a=[...((s=t.caipNetworks)==null?void 0:s.filter(c=>c.id!==e))||[]];o&&((i=t==null?void 0:t.caipNetworks)!=null&&i[0])&&I.setActiveCaipNetwork(t.caipNetworks[0]),le.chains.set(n,{...t,caipNetworks:a}),I.setRequestedCaipNetworks(a||[],n),a.length===0&&se.filterByNamespace(n,!1)}},setAdapterNetworkState(n,e){const t=le.chains.get(n);t&&(t.networkState={...t.networkState||Zy,...e},le.chains.set(n,t))},setChainAccountData(n,e,t=!0){if(!n)throw new Error("Chain is required to update chain account data");const r=le.chains.get(n);if(r){const s={...r.accountState||Iv,...e};le.chains.set(n,{...r,accountState:s}),(le.chains.size===1||le.activeChain===n)&&(e.caipAddress&&(le.activeCaipAddress=e.caipAddress),ge.replaceState(s))}},setChainNetworkData(n,e){if(!n)return;const t=le.chains.get(n);if(t){const r={...t.networkState||Zy,...e};le.chains.set(n,{...t,networkState:r})}},setAccountProp(n,e,t,r=!0){I.setChainAccountData(t,{[n]:e},r)},setActiveNamespace(n){var r,s;le.activeChain=n;const e=n?le.chains.get(n):void 0,t=(r=e==null?void 0:e.networkState)==null?void 0:r.caipNetwork;t!=null&&t.id&&n&&(le.activeCaipAddress=(s=e==null?void 0:e.accountState)==null?void 0:s.caipAddress,le.activeCaipNetwork=t,I.setChainNetworkData(n,{caipNetwork:t}),Q.setActiveCaipNetworkId(t==null?void 0:t.caipNetworkId),Si.set({activeChain:n,selectedNetworkId:t==null?void 0:t.caipNetworkId}))},setActiveCaipNetwork(n){var r,s,i;if(!n)return;le.activeChain!==n.chainNamespace&&I.setIsSwitchingNamespace(!0);const e=le.chains.get(n.chainNamespace);le.activeChain=n.chainNamespace,le.activeCaipNetwork=n,I.setChainNetworkData(n.chainNamespace,{caipNetwork:n}),(r=e==null?void 0:e.accountState)!=null&&r.address?le.activeCaipAddress=`${n.chainNamespace}:${n.id}:${(s=e==null?void 0:e.accountState)==null?void 0:s.address}`:le.activeCaipAddress=void 0,I.setAccountProp("caipAddress",le.activeCaipAddress,n.chainNamespace),e&&ge.replaceState(e.accountState),Et.resetSend(),Si.set({activeChain:le.activeChain,selectedNetworkId:(i=le.activeCaipNetwork)==null?void 0:i.caipNetworkId}),Q.setActiveCaipNetworkId(n.caipNetworkId),!I.checkIfSupportedNetwork(n.chainNamespace)&&z.state.enableNetworkSwitch&&!z.state.allowUnsupportedChain&&!ie.state.wcBasic&&I.showUnsupportedChainUI()},addCaipNetwork(n){var t;if(!n)return;const e=le.chains.get(n.chainNamespace);e&&((t=e==null?void 0:e.caipNetworks)==null||t.push(n))},async switchActiveNamespace(n){var s;if(!n)return;const e=n!==I.state.activeChain,t=(s=I.getNetworkData(n))==null?void 0:s.caipNetwork,r=I.getCaipNetworkByNamespace(n,t==null?void 0:t.id);e&&r&&await I.switchActiveNetwork(r)},async switchActiveNetwork(n){var i;const e=I.state.activeChain;if(!e)throw new Error("ChainController:switchActiveNetwork - namespace is required");const t=I.state.chains.get(e),r=!((i=t==null?void 0:t.caipNetworks)!=null&&i.some(o=>{var a;return o.id===((a=le.activeCaipNetwork)==null?void 0:a.id)})),s=I.getNetworkControllerClient(n.chainNamespace);if(s){try{await s.switchCaipNetwork(n),r&&tt.close()}catch{Pe.goBack()}ut.sendEvent({type:"track",event:"SWITCH_NETWORK",properties:{network:n.caipNetworkId}})}},getNetworkControllerClient(n){const e=n||le.activeChain;if(!e)throw new Error("ChainController:getNetworkControllerClient - chain is required");const t=le.chains.get(e);if(!t)throw new Error("Chain adapter not found");if(!t.networkControllerClient)throw new Error("NetworkController client not set");return t.networkControllerClient},getConnectionControllerClient(n){const e=n||le.activeChain;if(!e)throw new Error("Chain is required to get connection controller client");const t=le.chains.get(e);if(!(t!=null&&t.connectionControllerClient))throw new Error("ConnectionController client not set");return t.connectionControllerClient},getNetworkProp(n,e){var r;const t=(r=le.chains.get(e))==null?void 0:r.networkState;if(t)return t[n]},getRequestedCaipNetworks(n){const e=le.chains.get(n),{approvedCaipNetworkIds:t=[],requestedCaipNetworks:r=[]}=(e==null?void 0:e.networkState)||{};return ye.sortRequestedNetworks(t,r).filter(o=>o==null?void 0:o.id)},getAllRequestedCaipNetworks(){const n=[];return le.chains.forEach(e=>{if(!e.namespace)throw new Error("ChainController:getAllRequestedCaipNetworks - chainAdapter must have a namespace");const t=I.getRequestedCaipNetworks(e.namespace);n.push(...t)}),n},setRequestedCaipNetworks(n,e){I.setAdapterNetworkState(e,{requestedCaipNetworks:n});const r=I.getAllRequestedCaipNetworks().map(i=>i.chainNamespace),s=Array.from(new Set(r));se.filterByNamespaces(s)},getAllApprovedCaipNetworkIds(){const n=[];return le.chains.forEach(e=>{if(!e.namespace)throw new Error("ChainController:getAllApprovedCaipNetworkIds - chainAdapter must have a namespace");const t=I.getApprovedCaipNetworkIds(e.namespace);n.push(...t)}),n},getActiveCaipNetwork(n){var e,t;return n?(t=(e=le.chains.get(n))==null?void 0:e.networkState)==null?void 0:t.caipNetwork:le.activeCaipNetwork},getActiveCaipAddress(){return le.activeCaipAddress},getApprovedCaipNetworkIds(n){var r;const e=le.chains.get(n);return((r=e==null?void 0:e.networkState)==null?void 0:r.approvedCaipNetworkIds)||[]},async setApprovedCaipNetworksData(n){const e=I.getNetworkControllerClient(),t=await(e==null?void 0:e.getApprovedCaipNetworksData());I.setAdapterNetworkState(n,{approvedCaipNetworkIds:t==null?void 0:t.approvedCaipNetworkIds,supportsAllNetworks:t==null?void 0:t.supportsAllNetworks})},checkIfSupportedNetwork(n,e){var s;const t=e||((s=le.activeCaipNetwork)==null?void 0:s.caipNetworkId),r=I.getRequestedCaipNetworks(n);return r.length?r==null?void 0:r.some(i=>i.caipNetworkId===t):!0},checkIfSupportedChainId(n){if(!le.activeChain)return!0;const e=I.getRequestedCaipNetworks(le.activeChain);return e==null?void 0:e.some(t=>t.id===n)},setSmartAccountEnabledNetworks(n,e){I.setAdapterNetworkState(e,{smartAccountEnabledNetworks:n})},checkIfSmartAccountEnabled(){var r;const n=RD.caipNetworkIdToNumber((r=le.activeCaipNetwork)==null?void 0:r.caipNetworkId),e=le.activeChain;if(!e||!n)return!1;const t=I.getNetworkProp("smartAccountEnabledNetworks",e);return!!(t!=null&&t.includes(Number(n)))},showUnsupportedChainUI(){tt.open({view:"UnsupportedChain"})},checkIfNamesSupported(){const n=le.activeCaipNetwork;return!!(n!=null&&n.chainNamespace&&st.NAMES_SUPPORTED_CHAIN_NAMESPACES.includes(n.chainNamespace))},resetNetwork(n){I.setAdapterNetworkState(n,{approvedCaipNetworkIds:void 0,supportsAllNetworks:!0})},resetAccount(n){var s,i;const e=n;if(!e)throw new Error("Chain is required to set account prop");const t=(i=(s=I.state.chains.get(e))==null?void 0:s.accountState)==null?void 0:i.preferredAccountType,r=z.state.defaultAccountTypes[e];le.activeCaipAddress=void 0,I.setChainAccountData(e,{smartAccountDeployed:!1,currentTab:0,caipAddress:void 0,address:void 0,balance:void 0,balanceSymbol:void 0,profileName:void 0,profileImage:void 0,addressExplorerUrl:void 0,tokenBalance:[],connectedWalletInfo:void 0,preferredAccountType:r||t,socialProvider:void 0,socialWindow:void 0,farcasterUrl:void 0,user:void 0,status:"disconnected"}),se.removeConnectorId(e)},setIsSwitchingNamespace(n){le.isSwitchingNamespace=n},getFirstCaipNetworkSupportsAuthConnector(){var t,r;const n=[];let e;if(le.chains.forEach(s=>{H.AUTH_CONNECTOR_SUPPORTED_CHAINS.find(i=>i===s.namespace)&&s.namespace&&n.push(s.namespace)}),n.length>0){const s=n[0];return e=s?(r=(t=le.chains.get(s))==null?void 0:t.caipNetworks)==null?void 0:r[0]:void 0,e}},getAccountData(n){var t;const e=n||le.activeChain;if(e)return(t=I.state.chains.get(e))==null?void 0:t.accountState},getNetworkData(n){var t;const e=n||le.activeChain;if(e)return(t=I.state.chains.get(e))==null?void 0:t.networkState},getCaipNetworkByNamespace(n,e){var s,i,o;if(!n)return;const t=I.state.chains.get(n),r=(s=t==null?void 0:t.caipNetworks)==null?void 0:s.find(a=>a.id===e);return r||((i=t==null?void 0:t.networkState)==null?void 0:i.caipNetwork)||((o=t==null?void 0:t.caipNetworks)==null?void 0:o[0])},getRequestedCaipNetworkIds(){const n=se.state.filterByNamespace;return(n?[le.chains.get(n)]:Array.from(le.chains.values())).flatMap(t=>(t==null?void 0:t.caipNetworks)||[]).map(t=>t.caipNetworkId)},getCaipNetworks(n){return n?I.getRequestedCaipNetworks(n):I.getAllRequestedCaipNetworks()},setLastConnectedSIWECaipNetwork(n){le.lastConnectedSIWECaipNetwork=n},getLastConnectedSIWECaipNetwork(){return le.lastConnectedSIWECaipNetwork}},I=Rs(F9),j9={purchaseCurrencies:[{id:"2b92315d-eab7-5bef-84fa-089a131333f5",name:"USD Coin",symbol:"USDC",networks:[{name:"ethereum-mainnet",display_name:"Ethereum",chain_id:"1",contract_address:"0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48"},{name:"polygon-mainnet",display_name:"Polygon",chain_id:"137",contract_address:"0x2791Bca1f2de4661ED88A30C99A7a9449Aa84174"}]},{id:"2b92315d-eab7-5bef-84fa-089a131333f5",name:"Ether",symbol:"ETH",networks:[{name:"ethereum-mainnet",display_name:"Ethereum",chain_id:"1",contract_address:"0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48"},{name:"polygon-mainnet",display_name:"Polygon",chain_id:"137",contract_address:"0x2791Bca1f2de4661ED88A30C99A7a9449Aa84174"}]}],paymentCurrencies:[{id:"USD",payment_method_limits:[{id:"card",min:"10.00",max:"7500.00"},{id:"ach_bank_account",min:"10.00",max:"25000.00"}]},{id:"EUR",payment_method_limits:[{id:"card",min:"10.00",max:"7500.00"},{id:"ach_bank_account",min:"10.00",max:"25000.00"}]}]},BD=ye.getBlockchainApiUrl(),Vr=Vt({clientId:null,api:new oy({baseUrl:BD,clientId:null}),supportedChains:{http:[],ws:[]}}),xe={state:Vr,async get(n){const{st:e,sv:t}=xe.getSdkProperties(),r=z.state.projectId,s={...n.params||{},st:e,sv:t,projectId:r};return Vr.api.get({...n,params:s})},getSdkProperties(){const{sdkType:n,sdkVersion:e}=z.state;return{st:n||"unknown",sv:e||"unknown"}},async isNetworkSupported(n){if(!n)return!1;try{Vr.supportedChains.http.length||await xe.getSupportedNetworks()}catch{return!1}return Vr.supportedChains.http.includes(n)},async getSupportedNetworks(){try{const n=await xe.get({path:"v1/supported-chains"});return Vr.supportedChains=n,n}catch{return Vr.supportedChains}},async fetchIdentity({address:n}){const e=Q.getIdentityFromCacheForAddress(n);if(e)return e;const t=await xe.get({path:`/v1/identity/${n}`,params:{sender:I.state.activeCaipAddress?ye.getPlainAddress(I.state.activeCaipAddress):void 0}});return Q.updateIdentityCache({address:n,identity:t,timestamp:Date.now()}),t},async fetchTransactions({account:n,cursor:e,signal:t,cache:r,chainId:s}){var c;if(!await xe.isNetworkSupported((c=I.state.activeCaipNetwork)==null?void 0:c.caipNetworkId))return{data:[],next:void 0};const o=Q.getTransactionsCacheForAddress({address:n,chainId:s});if(o)return o;const a=await xe.get({path:`/v1/account/${n}/history`,params:{cursor:e,chainId:s},signal:t,cache:r});return Q.updateTransactionsCache({address:n,chainId:s,timestamp:Date.now(),transactions:a}),a},async fetchSwapQuote({amount:n,userAddress:e,from:t,to:r,gasPrice:s}){var o;return await xe.isNetworkSupported((o=I.state.activeCaipNetwork)==null?void 0:o.caipNetworkId)?xe.get({path:"/v1/convert/quotes",headers:{"Content-Type":"application/json"},params:{amount:n,userAddress:e,from:t,to:r,gasPrice:s}}):{quotes:[]}},async fetchSwapTokens({chainId:n}){var t;return await xe.isNetworkSupported((t=I.state.activeCaipNetwork)==null?void 0:t.caipNetworkId)?xe.get({path:"/v1/convert/tokens",params:{chainId:n}}):{tokens:[]}},async fetchTokenPrice({addresses:n}){var s;if(!await xe.isNetworkSupported((s=I.state.activeCaipNetwork)==null?void 0:s.caipNetworkId))return{fungibles:[]};const t=Q.getTokenPriceCacheForAddresses(n);if(t)return t;const r=await Vr.api.post({path:"/v1/fungible/price",body:{currency:"usd",addresses:n,projectId:z.state.projectId},headers:{"Content-Type":"application/json"}});return Q.updateTokenPriceCache({addresses:n,timestamp:Date.now(),tokenPrice:r}),r},async fetchSwapAllowance({tokenAddress:n,userAddress:e}){var r;return await xe.isNetworkSupported((r=I.state.activeCaipNetwork)==null?void 0:r.caipNetworkId)?xe.get({path:"/v1/convert/allowance",params:{tokenAddress:n,userAddress:e},headers:{"Content-Type":"application/json"}}):{allowance:"0"}},async fetchGasPrice({chainId:n}){var s;const{st:e,sv:t}=xe.getSdkProperties();if(!await xe.isNetworkSupported((s=I.state.activeCaipNetwork)==null?void 0:s.caipNetworkId))throw new Error("Network not supported for Gas Price");return xe.get({path:"/v1/convert/gas-price",headers:{"Content-Type":"application/json"},params:{chainId:n,st:e,sv:t}})},async generateSwapCalldata({amount:n,from:e,to:t,userAddress:r,disableEstimate:s}){var o;if(!await xe.isNetworkSupported((o=I.state.activeCaipNetwork)==null?void 0:o.caipNetworkId))throw new Error("Network not supported for Swaps");return Vr.api.post({path:"/v1/convert/build-transaction",headers:{"Content-Type":"application/json"},body:{amount:n,eip155:{slippage:st.CONVERT_SLIPPAGE_TOLERANCE},projectId:z.state.projectId,from:e,to:t,userAddress:r,disableEstimate:s}})},async generateApproveCalldata({from:n,to:e,userAddress:t}){var o;const{st:r,sv:s}=xe.getSdkProperties();if(!await xe.isNetworkSupported((o=I.state.activeCaipNetwork)==null?void 0:o.caipNetworkId))throw new Error("Network not supported for Swaps");return xe.get({path:"/v1/convert/build-approve",headers:{"Content-Type":"application/json"},params:{userAddress:t,from:n,to:e,st:r,sv:s}})},async getBalance(n,e,t){var l;const{st:r,sv:s}=xe.getSdkProperties();if(!await xe.isNetworkSupported((l=I.state.activeCaipNetwork)==null?void 0:l.caipNetworkId))return uo.showError("Token Balance Unavailable"),{balances:[]};const o=`${e}:${n}`,a=Q.getBalanceCacheForCaipAddress(o);if(a)return a;const c=await xe.get({path:`/v1/account/${n}/balance`,params:{currency:"usd",chainId:e,forceUpdate:t,st:r,sv:s}});return Q.updateBalanceCache({caipAddress:o,balance:c,timestamp:Date.now()}),c},async lookupEnsName(n){var t;return await xe.isNetworkSupported((t=I.state.activeCaipNetwork)==null?void 0:t.caipNetworkId)?xe.get({path:`/v1/profile/account/${n}`,params:{apiVersion:"2"}}):{addresses:{},attributes:[]}},async reverseLookupEnsName({address:n}){var t;return await xe.isNetworkSupported((t=I.state.activeCaipNetwork)==null?void 0:t.caipNetworkId)?xe.get({path:`/v1/profile/reverse/${n}`,params:{sender:ge.state.address,apiVersion:"2"}}):[]},async getEnsNameSuggestions(n){var t;return await xe.isNetworkSupported((t=I.state.activeCaipNetwork)==null?void 0:t.caipNetworkId)?xe.get({path:`/v1/profile/suggestions/${n}`,params:{zone:"reown.id"}}):{suggestions:[]}},async registerEnsName({coinType:n,address:e,message:t,signature:r}){var i;return await xe.isNetworkSupported((i=I.state.activeCaipNetwork)==null?void 0:i.caipNetworkId)?Vr.api.post({path:"/v1/profile/account",body:{coin_type:n,address:e,message:t,signature:r},headers:{"Content-Type":"application/json"}}):{success:!1}},async generateOnRampURL({destinationWallets:n,partnerUserId:e,defaultNetwork:t,purchaseAmount:r,paymentAmount:s}){var a;return await xe.isNetworkSupported((a=I.state.activeCaipNetwork)==null?void 0:a.caipNetworkId)?(await Vr.api.post({path:"/v1/generators/onrampurl",params:{projectId:z.state.projectId},body:{destinationWallets:n,defaultNetwork:t,partnerUserId:e,defaultExperience:"buy",presetCryptoAmount:r,presetFiatAmount:s}})).url:""},async getOnrampOptions(){var e;if(!await xe.isNetworkSupported((e=I.state.activeCaipNetwork)==null?void 0:e.caipNetworkId))return{paymentCurrencies:[],purchaseCurrencies:[]};try{return await xe.get({path:"/v1/onramp/options"})}catch{return j9}},async getOnrampQuote({purchaseCurrency:n,paymentCurrency:e,amount:t,network:r}){var s;try{return await xe.isNetworkSupported((s=I.state.activeCaipNetwork)==null?void 0:s.caipNetworkId)?await Vr.api.post({path:"/v1/onramp/quote",params:{projectId:z.state.projectId},body:{purchaseCurrency:n,paymentCurrency:e,amount:t,network:r}}):null}catch{return{networkFee:{amount:t,currency:e.id},paymentSubtotal:{amount:t,currency:e.id},paymentTotal:{amount:t,currency:e.id},purchaseAmount:{amount:t,currency:e.id},quoteId:"mocked-quote-id"}}},async getSmartSessions(n){var t;return await xe.isNetworkSupported((t=I.state.activeCaipNetwork)==null?void 0:t.caipNetworkId)?xe.get({path:`/v1/sessions/${n}`}):[]},async revokeSmartSession(n,e,t){var s;return await xe.isNetworkSupported((s=I.state.activeCaipNetwork)==null?void 0:s.caipNetworkId)?Vr.api.post({path:`/v1/sessions/${n}/revoke`,params:{projectId:z.state.projectId},body:{pci:e,signature:t}}):{success:!1}},setClientId(n){Vr.clientId=n,Vr.api=new oy({baseUrl:BD,clientId:n})}};function H9(n,{strict:e=!0}={}){return!n||typeof n!="string"?!1:e?/^0x[0-9a-fA-F]*$/.test(n):n.startsWith("0x")}function bN(n){return H9(n,{strict:!1})?Math.ceil((n.length-2)/2):n.length}const FD="2.35.1";let tp={getDocsUrl:({docsBaseUrl:n,docsPath:e="",docsSlug:t})=>e?`${n??"https://viem.sh"}${e}${t?`#${t}`:""}`:void 0,version:`viem@${FD}`},Li=class mA extends Error{constructor(e,t={}){var a;const r=(()=>{var c;return t.cause instanceof mA?t.cause.details:(c=t.cause)!=null&&c.message?t.cause.message:t.details})(),s=t.cause instanceof mA&&t.cause.docsPath||t.docsPath,i=(a=tp.getDocsUrl)==null?void 0:a.call(tp,{...t,docsPath:s}),o=[e||"An error occurred.","",...t.metaMessages?[...t.metaMessages,""]:[],...i?[`Docs: ${i}`]:[],...r?[`Details: ${r}`]:[],...tp.version?[`Version: ${tp.version}`]:[]].join(`
`);super(o,t.cause?{cause:t.cause}:void 0),Object.defineProperty(this,"details",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docsPath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metaMessages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shortMessage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"version",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"BaseError"}),this.details=r,this.docsPath=s,this.metaMessages=t.metaMessages,this.name=t.name??this.name,this.shortMessage=e,this.version=FD}walk(e){return jD(this,e)}};function jD(n,e){return e!=null&&e(n)?n:n&&typeof n=="object"&&"cause"in n&&n.cause!==void 0?jD(n.cause,e):e?null:n}class Qbe extends Li{constructor({offset:e,position:t,size:r}){super(`Slice ${t==="start"?"starting":"ending"} at offset "${e}" is out-of-bounds (size: ${r}).`,{name:"SliceOffsetOutOfBoundsError"})}}let HD=class extends Li{constructor({size:e,targetSize:t,type:r}){super(`${r.charAt(0).toUpperCase()}${r.slice(1).toLowerCase()} size (${e}) exceeds padding size (${t}).`,{name:"SizeExceedsPaddingSizeError"})}};function QI(n,{dir:e,size:t=32}={}){return typeof n=="string"?V9(n,{dir:e,size:t}):q9(n,{dir:e,size:t})}function V9(n,{dir:e,size:t=32}={}){if(t===null)return n;const r=n.replace("0x","");if(r.length>t*2)throw new HD({size:Math.ceil(r.length/2),targetSize:t,type:"hex"});return`0x${r[e==="right"?"padEnd":"padStart"](t*2,"0")}`}function q9(n,{dir:e,size:t=32}={}){if(t===null)return n;if(n.length>t)throw new HD({size:n.length,targetSize:t,type:"bytes"});const r=new Uint8Array(t);for(let s=0;s<t;s++){const i=e==="right";r[i?s:t-s-1]=n[i?s:n.length-s-1]}return r}let z9=class extends Li{constructor({max:e,min:t,signed:r,size:s,value:i}){super(`Number "${i}" is not in safe ${s?`${s*8}-bit ${r?"signed":"unsigned"} `:""}integer range ${e?`(${t} to ${e})`:`(above ${t})`}`,{name:"IntegerOutOfRangeError"})}},W9=class extends Li{constructor({givenSize:e,maxSize:t}){super(`Size cannot exceed ${t} bytes. Given size: ${e} bytes.`,{name:"SizeOverflowError"})}};function VD(n,{size:e}){if(bN(n)>e)throw new W9({givenSize:bN(n),maxSize:e})}const G9=Array.from({length:256},(n,e)=>e.toString(16).padStart(2,"0"));function EN(n,e={}){return typeof n=="number"||typeof n=="bigint"?Y9(n,e):typeof n=="string"?zD(n,e):typeof n=="boolean"?K9(n,e):qD(n,e)}function K9(n,e={}){const t=`0x${Number(n)}`;return typeof e.size=="number"?(VD(t,{size:e.size}),QI(t,{size:e.size})):t}function qD(n,e={}){let t="";for(let s=0;s<n.length;s++)t+=G9[n[s]];const r=`0x${t}`;return typeof e.size=="number"?(VD(r,{size:e.size}),QI(r,{dir:"right",size:e.size})):r}function Y9(n,e={}){const{signed:t,size:r}=e,s=BigInt(n);let i;r?t?i=(1n<<BigInt(r)*8n-1n)-1n:i=2n**(BigInt(r)*8n)-1n:typeof n=="number"&&(i=BigInt(Number.MAX_SAFE_INTEGER));const o=typeof i=="bigint"&&t?-i-1n:0;if(i&&s>i||s<o){const c=typeof n=="bigint"?"n":"";throw new z9({max:i?`${i}${c}`:void 0,min:`${o}${c}`,signed:t,size:r,value:`${n}${c}`})}const a=`0x${(t&&s<0?(1n<<BigInt(r*8))+BigInt(s):s).toString(16)}`;return r?QI(a,{size:r}):a}const Q9=new TextEncoder;function zD(n,e={}){const t=Q9.encode(n);return qD(t,e)}const Jy=BigInt(2**32-1),vN=BigInt(32);function Z9(n,e=!1){return e?{h:Number(n&Jy),l:Number(n>>vN&Jy)}:{h:Number(n>>vN&Jy)|0,l:Number(n&Jy)|0}}function J9(n,e=!1){const t=n.length;let r=new Uint32Array(t),s=new Uint32Array(t);for(let i=0;i<t;i++){const{h:o,l:a}=Z9(n[i],e);[r[i],s[i]]=[o,a]}return[r,s]}const X9=(n,e,t)=>n<<t|e>>>32-t,e7=(n,e,t)=>e<<t|n>>>32-t,t7=(n,e,t)=>e<<t-32|n>>>64-t,n7=(n,e,t)=>n<<t-32|e>>>64-t,Ju=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */function r7(n){return n instanceof Uint8Array||ArrayBuffer.isView(n)&&n.constructor.name==="Uint8Array"}function _0(n){if(!Number.isSafeInteger(n)||n<0)throw new Error("positive integer expected, got "+n)}function mg(n,...e){if(!r7(n))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(n.length))throw new Error("Uint8Array expected of length "+e+", got length="+n.length)}function eEe(n){if(typeof n!="function"||typeof n.create!="function")throw new Error("Hash should be wrapped by utils.createHasher");_0(n.outputLen),_0(n.blockLen)}function AN(n,e=!0){if(n.destroyed)throw new Error("Hash instance has been destroyed");if(e&&n.finished)throw new Error("Hash#digest() has already been called")}function s7(n,e){mg(n);const t=e.outputLen;if(n.length<t)throw new Error("digestInto() expects output buffer of length at least "+t)}function i7(n){return new Uint32Array(n.buffer,n.byteOffset,Math.floor(n.byteLength/4))}function WD(...n){for(let e=0;e<n.length;e++)n[e].fill(0)}function tEe(n){return new DataView(n.buffer,n.byteOffset,n.byteLength)}function nEe(n,e){return n<<32-e|n>>>e}const o7=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function a7(n){return n<<24&4278190080|n<<8&16711680|n>>>8&65280|n>>>24&255}function c7(n){for(let e=0;e<n.length;e++)n[e]=a7(n[e]);return n}const CN=o7?n=>n:c7;function l7(n){if(typeof n!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(n))}function GD(n){return typeof n=="string"&&(n=l7(n)),mg(n),n}function rEe(...n){let e=0;for(let r=0;r<n.length;r++){const s=n[r];mg(s),e+=s.length}const t=new Uint8Array(e);for(let r=0,s=0;r<n.length;r++){const i=n[r];t.set(i,s),s+=i.length}return t}let u7=class{};function h7(n){const e=r=>n().update(GD(r)).digest(),t=n();return e.outputLen=t.outputLen,e.blockLen=t.blockLen,e.create=()=>n(),e}function iEe(n=32){if(Ju&&typeof Ju.getRandomValues=="function")return Ju.getRandomValues(new Uint8Array(n));if(Ju&&typeof Ju.randomBytes=="function")return Uint8Array.from(Ju.randomBytes(n));throw new Error("crypto.getRandomValues must be defined")}const d7=BigInt(0),np=BigInt(1),f7=BigInt(2),p7=BigInt(7),g7=BigInt(256),m7=BigInt(113),KD=[],YD=[],QD=[];for(let n=0,e=np,t=1,r=0;n<24;n++){[t,r]=[r,(2*t+3*r)%5],KD.push(2*(5*r+t)),YD.push((n+1)*(n+2)/2%64);let s=d7;for(let i=0;i<7;i++)e=(e<<np^(e>>p7)*m7)%g7,e&f7&&(s^=np<<(np<<BigInt(i))-np);QD.push(s)}const ZD=J9(QD,!0),y7=ZD[0],w7=ZD[1],IN=(n,e,t)=>t>32?t7(n,e,t):X9(n,e,t),_N=(n,e,t)=>t>32?n7(n,e,t):e7(n,e,t);function b7(n,e=24){const t=new Uint32Array(10);for(let r=24-e;r<24;r++){for(let o=0;o<10;o++)t[o]=n[o]^n[o+10]^n[o+20]^n[o+30]^n[o+40];for(let o=0;o<10;o+=2){const a=(o+8)%10,c=(o+2)%10,l=t[c],u=t[c+1],h=IN(l,u,1)^t[a],d=_N(l,u,1)^t[a+1];for(let f=0;f<50;f+=10)n[o+f]^=h,n[o+f+1]^=d}let s=n[2],i=n[3];for(let o=0;o<24;o++){const a=YD[o],c=IN(s,i,a),l=_N(s,i,a),u=KD[o];s=n[u],i=n[u+1],n[u]=c,n[u+1]=l}for(let o=0;o<50;o+=10){for(let a=0;a<10;a++)t[a]=n[o+a];for(let a=0;a<10;a++)n[o+a]^=~t[(a+2)%10]&t[(a+4)%10]}n[0]^=y7[r],n[1]^=w7[r]}WD(t)}let E7=class JD extends u7{constructor(e,t,r,s=!1,i=24){if(super(),this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,this.enableXOF=!1,this.blockLen=e,this.suffix=t,this.outputLen=r,this.enableXOF=s,this.rounds=i,_0(r),!(0<e&&e<200))throw new Error("only keccak-f1600 function is supported");this.state=new Uint8Array(200),this.state32=i7(this.state)}clone(){return this._cloneInto()}keccak(){CN(this.state32),b7(this.state32,this.rounds),CN(this.state32),this.posOut=0,this.pos=0}update(e){AN(this),e=GD(e),mg(e);const{blockLen:t,state:r}=this,s=e.length;for(let i=0;i<s;){const o=Math.min(t-this.pos,s-i);for(let a=0;a<o;a++)r[this.pos++]^=e[i++];this.pos===t&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:t,pos:r,blockLen:s}=this;e[r]^=t,t&128&&r===s-1&&this.keccak(),e[s-1]^=128,this.keccak()}writeInto(e){AN(this,!1),mg(e),this.finish();const t=this.state,{blockLen:r}=this;for(let s=0,i=e.length;s<i;){this.posOut>=r&&this.keccak();const o=Math.min(r-this.posOut,i-s);e.set(t.subarray(this.posOut,this.posOut+o),s),this.posOut+=o,s+=o}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return _0(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(s7(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,WD(this.state)}_cloneInto(e){const{blockLen:t,suffix:r,outputLen:s,rounds:i,enableXOF:o}=this;return e||(e=new JD(t,r,s,o,i)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=i,e.suffix=r,e.outputLen=s,e.enableXOF=o,e.destroyed=this.destroyed,e}};const v7=(n,e,t)=>h7(()=>new E7(e,n,t)),A7=v7(1,136,256/8);let C7=class extends Map{constructor(e){super(),Object.defineProperty(this,"maxSize",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxSize=e}get(e){const t=super.get(e);return super.has(e)&&t!==void 0&&(this.delete(e),super.set(e,t)),t}set(e,t){if(super.set(e,t),this.maxSize&&this.size>this.maxSize){const r=this.keys().next().value;r&&this.delete(r)}return this}};const su=(n,e,t)=>JSON.stringify(n,(r,s)=>typeof s=="bigint"?s.toString():s,t);function I7(n,e){let t=n.toString();const r=t.startsWith("-");r&&(t=t.slice(1)),t=t.padStart(e,"0");let[s,i]=[t.slice(0,t.length-e),t.slice(t.length-e)];return i=i.replace(/(0+)$/,""),`${r?"-":""}${s||"0"}${i?`.${i}`:""}`}const ZI=n=>n;class Vp extends Li{constructor({body:e,cause:t,details:r,headers:s,status:i,url:o}){super("HTTP request failed.",{cause:t,details:r,metaMessages:[i&&`Status: ${i}`,`URL: ${ZI(o)}`,e&&`Request body: ${su(e)}`].filter(Boolean),name:"HttpRequestError"}),Object.defineProperty(this,"body",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"headers",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"status",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"url",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.body=e,this.headers=s,this.status=i,this.url=o}}class XD extends Li{constructor({body:e,error:t,url:r}){super("RPC Request failed.",{cause:t,details:t.message,metaMessages:[`URL: ${ZI(r)}`,`Request body: ${su(e)}`],name:"RpcRequestError"}),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"data",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.code=t.code,this.data=t.data}}class SN extends Li{constructor({body:e,url:t}){super("The request took too long to respond.",{details:"The request timed out.",metaMessages:[`URL: ${ZI(t)}`,`Request body: ${su(e)}`],name:"TimeoutError"})}}const _7=-1;class us extends Li{constructor(e,{code:t,docsPath:r,metaMessages:s,name:i,shortMessage:o}){super(o,{cause:e,docsPath:r,metaMessages:s||(e==null?void 0:e.metaMessages),name:i||"RpcError"}),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name=i||e.name,this.code=e instanceof XD?e.code:t??_7}}class Ps extends us{constructor(e,t){super(e,t),Object.defineProperty(this,"data",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.data=t.data}}class yg extends us{constructor(e){super(e,{code:yg.code,name:"ParseRpcError",shortMessage:"Invalid JSON was received by the server. An error occurred on the server while parsing the JSON text."})}}Object.defineProperty(yg,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32700});class wg extends us{constructor(e){super(e,{code:wg.code,name:"InvalidRequestRpcError",shortMessage:"JSON is not a valid request object."})}}Object.defineProperty(wg,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32600});class bg extends us{constructor(e,{method:t}={}){super(e,{code:bg.code,name:"MethodNotFoundRpcError",shortMessage:`The method${t?` "${t}"`:""} does not exist / is not available.`})}}Object.defineProperty(bg,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32601});class Eg extends us{constructor(e){super(e,{code:Eg.code,name:"InvalidParamsRpcError",shortMessage:["Invalid parameters were provided to the RPC method.","Double check you have provided the correct parameters."].join(`
`)})}}Object.defineProperty(Eg,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32602});class tf extends us{constructor(e){super(e,{code:tf.code,name:"InternalRpcError",shortMessage:"An internal error was received."})}}Object.defineProperty(tf,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32603});class vg extends us{constructor(e){super(e,{code:vg.code,name:"InvalidInputRpcError",shortMessage:["Missing or invalid parameters.","Double check you have provided the correct parameters."].join(`
`)})}}Object.defineProperty(vg,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32e3});class Ag extends us{constructor(e){super(e,{code:Ag.code,name:"ResourceNotFoundRpcError",shortMessage:"Requested resource not found."}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"ResourceNotFoundRpcError"})}}Object.defineProperty(Ag,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32001});class Cg extends us{constructor(e){super(e,{code:Cg.code,name:"ResourceUnavailableRpcError",shortMessage:"Requested resource not available."})}}Object.defineProperty(Cg,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32002});class nf extends us{constructor(e){super(e,{code:nf.code,name:"TransactionRejectedRpcError",shortMessage:"Transaction creation failed."})}}Object.defineProperty(nf,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32003});class vl extends us{constructor(e,{method:t}={}){super(e,{code:vl.code,name:"MethodNotSupportedRpcError",shortMessage:`Method${t?` "${t}"`:""} is not supported.`})}}Object.defineProperty(vl,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32004});class rf extends us{constructor(e){super(e,{code:rf.code,name:"LimitExceededRpcError",shortMessage:"Request exceeds defined limit."})}}Object.defineProperty(rf,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32005});class Ig extends us{constructor(e){super(e,{code:Ig.code,name:"JsonRpcVersionUnsupportedError",shortMessage:"Version of JSON-RPC protocol is not supported."})}}Object.defineProperty(Ig,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32006});class iu extends Ps{constructor(e){super(e,{code:iu.code,name:"UserRejectedRequestError",shortMessage:"User rejected the request."})}}Object.defineProperty(iu,"code",{enumerable:!0,configurable:!0,writable:!0,value:4001});class _g extends Ps{constructor(e){super(e,{code:_g.code,name:"UnauthorizedProviderError",shortMessage:"The requested method and/or account has not been authorized by the user."})}}Object.defineProperty(_g,"code",{enumerable:!0,configurable:!0,writable:!0,value:4100});class Sg extends Ps{constructor(e,{method:t}={}){super(e,{code:Sg.code,name:"UnsupportedProviderMethodError",shortMessage:`The Provider does not support the requested method${t?` " ${t}"`:""}.`})}}Object.defineProperty(Sg,"code",{enumerable:!0,configurable:!0,writable:!0,value:4200});class Tg extends Ps{constructor(e){super(e,{code:Tg.code,name:"ProviderDisconnectedError",shortMessage:"The Provider is disconnected from all chains."})}}Object.defineProperty(Tg,"code",{enumerable:!0,configurable:!0,writable:!0,value:4900});class Ng extends Ps{constructor(e){super(e,{code:Ng.code,name:"ChainDisconnectedError",shortMessage:"The Provider is not connected to the requested chain."})}}Object.defineProperty(Ng,"code",{enumerable:!0,configurable:!0,writable:!0,value:4901});class Og extends Ps{constructor(e){super(e,{code:Og.code,name:"SwitchChainError",shortMessage:"An error occurred when attempting to switch chain."})}}Object.defineProperty(Og,"code",{enumerable:!0,configurable:!0,writable:!0,value:4902});class xg extends Ps{constructor(e){super(e,{code:xg.code,name:"UnsupportedNonOptionalCapabilityError",shortMessage:"This Wallet does not support a capability that was not marked as optional."})}}Object.defineProperty(xg,"code",{enumerable:!0,configurable:!0,writable:!0,value:5700});class Rg extends Ps{constructor(e){super(e,{code:Rg.code,name:"UnsupportedChainIdError",shortMessage:"This Wallet does not support the requested chain ID."})}}Object.defineProperty(Rg,"code",{enumerable:!0,configurable:!0,writable:!0,value:5710});class Pg extends Ps{constructor(e){super(e,{code:Pg.code,name:"DuplicateIdError",shortMessage:"There is already a bundle submitted with this ID."})}}Object.defineProperty(Pg,"code",{enumerable:!0,configurable:!0,writable:!0,value:5720});class kg extends Ps{constructor(e){super(e,{code:kg.code,name:"UnknownBundleIdError",shortMessage:"This bundle id is unknown / has not been submitted"})}}Object.defineProperty(kg,"code",{enumerable:!0,configurable:!0,writable:!0,value:5730});class Dg extends Ps{constructor(e){super(e,{code:Dg.code,name:"BundleTooLargeError",shortMessage:"The call bundle is too large for the Wallet to process."})}}Object.defineProperty(Dg,"code",{enumerable:!0,configurable:!0,writable:!0,value:5740});class Ug extends Ps{constructor(e){super(e,{code:Ug.code,name:"AtomicReadyWalletRejectedUpgradeError",shortMessage:"The Wallet can support atomicity after an upgrade, but the user rejected the upgrade."})}}Object.defineProperty(Ug,"code",{enumerable:!0,configurable:!0,writable:!0,value:5750});class $g extends Ps{constructor(e){super(e,{code:$g.code,name:"AtomicityNotSupportedError",shortMessage:"The wallet does not support atomic execution but the request requires it."})}}Object.defineProperty($g,"code",{enumerable:!0,configurable:!0,writable:!0,value:5760});class S7 extends us{constructor(e){super(e,{name:"UnknownRpcError",shortMessage:"An unknown RPC error occurred."})}}class JI extends Li{constructor({cause:e,message:t}={}){var s;const r=(s=t==null?void 0:t.replace("execution reverted: ",""))==null?void 0:s.replace("execution reverted","");super(`Execution reverted ${r?`with reason: ${r}`:"for an unknown reason"}.`,{cause:e,name:"ExecutionRevertedError"})}}Object.defineProperty(JI,"code",{enumerable:!0,configurable:!0,writable:!0,value:3});Object.defineProperty(JI,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/execution reverted/});function T7(){let n=()=>{},e=()=>{};return{promise:new Promise((r,s)=>{n=r,e=s}),resolve:n,reject:e}}const _v=new Map;function N7({fn:n,id:e,shouldSplitBatch:t,wait:r=0,sort:s}){const i=async()=>{const u=c();o();const h=u.map(({args:d})=>d);h.length!==0&&n(h).then(d=>{s&&Array.isArray(d)&&d.sort(s);for(let f=0;f<u.length;f++){const{resolve:p}=u[f];p==null||p([d[f],d])}}).catch(d=>{for(let f=0;f<u.length;f++){const{reject:p}=u[f];p==null||p(d)}})},o=()=>_v.delete(e),a=()=>c().map(({args:u})=>u),c=()=>_v.get(e)||[],l=u=>_v.set(e,[...c(),u]);return{flush:o,async schedule(u){const{promise:h,resolve:d,reject:f}=T7();return(t==null?void 0:t([...a(),u]))&&i(),c().length>0?(l({args:u,resolve:d,reject:f}),h):(l({args:u,resolve:d,reject:f}),setTimeout(i,r),h)}}}async function e3(n){return new Promise(e=>setTimeout(e,n))}function O7(n,{delay:e=100,retryCount:t=2,shouldRetry:r=()=>!0}={}){return new Promise((s,i)=>{const o=async({count:a=0}={})=>{const c=async({error:l})=>{const u=typeof e=="function"?e({count:a,error:l}):e;u&&await e3(u),o({count:a+1})};try{const l=await n();s(l)}catch(l){if(a<t&&await r({count:a,error:l}))return c({error:l});i(l)}};o()})}const yA=256;let Xy=yA,ew;function x7(n=11){if(!ew||Xy+n>yA*2){ew="",Xy=0;for(let e=0;e<yA;e++)ew+=(256+Math.random()*256|0).toString(16).substring(1)}return ew.substring(Xy,Xy+++n)}const tw=new C7(8192);function R7(n,{enabled:e=!0,id:t}){if(!e||!t)return n();if(tw.get(t))return tw.get(t);const r=n().finally(()=>tw.delete(t));return tw.set(t,r),r}function P7(n,e={}){return async(t,r={})=>{var h;const{dedupe:s=!1,methods:i,retryDelay:o=150,retryCount:a=3,uid:c}={...e,...r},{method:l}=t;if((h=i==null?void 0:i.exclude)!=null&&h.includes(l))throw new vl(new Error("method not supported"),{method:l});if(i!=null&&i.include&&!i.include.includes(l))throw new vl(new Error("method not supported"),{method:l});const u=s?zD(`${c}.${su(t)}`):void 0;return R7(()=>O7(async()=>{try{return await n(t)}catch(d){const f=d;switch(f.code){case yg.code:throw new yg(f);case wg.code:throw new wg(f);case bg.code:throw new bg(f,{method:t.method});case Eg.code:throw new Eg(f);case tf.code:throw new tf(f);case vg.code:throw new vg(f);case Ag.code:throw new Ag(f);case Cg.code:throw new Cg(f);case nf.code:throw new nf(f);case vl.code:throw new vl(f,{method:t.method});case rf.code:throw new rf(f);case Ig.code:throw new Ig(f);case iu.code:throw new iu(f);case _g.code:throw new _g(f);case Sg.code:throw new Sg(f);case Tg.code:throw new Tg(f);case Ng.code:throw new Ng(f);case Og.code:throw new Og(f);case xg.code:throw new xg(f);case Rg.code:throw new Rg(f);case Pg.code:throw new Pg(f);case kg.code:throw new kg(f);case Dg.code:throw new Dg(f);case Ug.code:throw new Ug(f);case $g.code:throw new $g(f);case 5e3:throw new iu(f);default:throw d instanceof Li?d:new S7(f)}}},{delay:({count:d,error:f})=>{var p;if(f&&f instanceof Vp){const g=(p=f==null?void 0:f.headers)==null?void 0:p.get("Retry-After");if(g!=null&&g.match(/\d/))return Number.parseInt(g)*1e3}return~~(1<<d)*o},retryCount:a,shouldRetry:({error:d})=>k7(d)}),{enabled:s,id:u})}}function k7(n){return"code"in n&&typeof n.code=="number"?n.code===-1||n.code===rf.code||n.code===tf.code:n instanceof Vp&&n.status?n.status===403||n.status===408||n.status===413||n.status===429||n.status===500||n.status===502||n.status===503||n.status===504:!0}function t3({key:n,methods:e,name:t,request:r,retryCount:s=3,retryDelay:i=150,timeout:o,type:a},c){const l=x7();return{config:{key:n,methods:e,name:t,request:r,retryCount:s,retryDelay:i,timeout:o,type:a},request:P7(r,{methods:e,retryCount:s,retryDelay:i,uid:l}),value:c}}function TN(n,e={}){const{key:t="fallback",name:r="Fallback",rank:s=!1,shouldThrow:i=D7,retryCount:o,retryDelay:a}=e;return({chain:c,pollingInterval:l=4e3,timeout:u,...h})=>{let d=n,f=()=>{};const p=t3({key:t,name:r,async request({method:g,params:m}){let w;const v=async(A=0)=>{const T=d[A]({...h,chain:c,retryCount:0,timeout:u});try{const N=await T.request({method:g,params:m});return f({method:g,params:m,response:N,transport:T,status:"success"}),N}catch(N){if(f({error:N,method:g,params:m,transport:T,status:"error"}),i(N)||A===d.length-1||(w??(w=d.slice(A+1).some(R=>{const{include:M,exclude:D}=R({chain:c}).config.methods||{};return M?M.includes(g):D?!D.includes(g):!0})),!w))throw N;return v(A+1)}};return v()},retryCount:o,retryDelay:a,type:"fallback"},{onResponse:g=>f=g,transports:d.map(g=>g({chain:c,retryCount:0}))});if(s){const g=typeof s=="object"?s:{};U7({chain:c,interval:g.interval??l,onTransports:m=>d=m,ping:g.ping,sampleCount:g.sampleCount,timeout:g.timeout,transports:d,weights:g.weights})}return p}}function D7(n){return!!("code"in n&&typeof n.code=="number"&&(n.code===nf.code||n.code===iu.code||JI.nodeMessage.test(n.message)||n.code===5e3))}function U7({chain:n,interval:e=4e3,onTransports:t,ping:r,sampleCount:s=10,timeout:i=1e3,transports:o,weights:a={}}){const{stability:c=.7,latency:l=.3}=a,u=[],h=async()=>{const d=await Promise.all(o.map(async g=>{const m=g({chain:n,retryCount:0,timeout:i}),w=Date.now();let v,A;try{await(r?r({transport:m}):m.request({method:"net_listening"})),A=1}catch{A=0}finally{v=Date.now()}return{latency:v-w,success:A}}));u.push(d),u.length>s&&u.shift();const f=Math.max(...u.map(g=>Math.max(...g.map(({latency:m})=>m)))),p=o.map((g,m)=>{const w=u.map(R=>R[m].latency),A=1-w.reduce((R,M)=>R+M,0)/w.length/f,T=u.map(R=>R[m].success),N=T.reduce((R,M)=>R+M,0)/T.length;return N===0?[0,m]:[l*A+c*N,m]}).sort((g,m)=>m[0]-g[0]);t(p.map(([,g])=>o[g])),await e3(e),h()};h()}class $7 extends Li{constructor(){super("No URL was provided to the Transport. Please provide a valid RPC URL to the Transport.",{docsPath:"/docs/clients/intro",name:"UrlRequiredError"})}}function M7(n,{errorInstance:e=new Error("timed out"),timeout:t,signal:r}){return new Promise((s,i)=>{(async()=>{let o;try{const a=new AbortController;t>0&&(o=setTimeout(()=>{r?a.abort():i(e)},t)),s(await n({signal:(a==null?void 0:a.signal)||null}))}catch(a){(a==null?void 0:a.name)==="AbortError"&&i(e),i(a)}finally{clearTimeout(o)}})()})}function L7(){return{current:0,take(){return this.current++},reset(){this.current=0}}}const NN=L7();function B7(n,e={}){return{async request(t){var h;const{body:r,onRequest:s=e.onRequest,onResponse:i=e.onResponse,timeout:o=e.timeout??1e4}=t,a={...e.fetchOptions??{},...t.fetchOptions??{}},{headers:c,method:l,signal:u}=a;try{const d=await M7(async({signal:p})=>{const g={...a,body:Array.isArray(r)?su(r.map(A=>({jsonrpc:"2.0",id:A.id??NN.take(),...A}))):su({jsonrpc:"2.0",id:r.id??NN.take(),...r}),headers:{"Content-Type":"application/json",...c},method:l||"POST",signal:u||(o>0?p:null)},m=new Request(n,g),w=await(s==null?void 0:s(m,g))??{...g,url:n};return await fetch(w.url??n,w)},{errorInstance:new SN({body:r,url:n}),timeout:o,signal:!0});i&&await i(d);let f;if((h=d.headers.get("Content-Type"))!=null&&h.startsWith("application/json"))f=await d.json();else{f=await d.text();try{f=JSON.parse(f||"{}")}catch(p){if(d.ok)throw p;f={error:f}}}if(!d.ok)throw new Vp({body:r,details:su(f.error)||d.statusText,headers:d.headers,status:d.status,url:n});return f}catch(d){throw d instanceof Vp||d instanceof SN?d:new Vp({body:r,cause:d,url:n})}}}}function nw(n,e={}){const{batch:t,fetchOptions:r,key:s="http",methods:i,name:o="HTTP JSON-RPC",onFetchRequest:a,onFetchResponse:c,retryDelay:l,raw:u}=e;return({chain:h,retryCount:d,timeout:f})=>{const{batchSize:p=1e3,wait:g=0}=typeof t=="object"?t:{},m=e.retryCount??d,w=f??e.timeout??1e4,v=n||(h==null?void 0:h.rpcUrls.default.http[0]);if(!v)throw new $7;const A=B7(v,{fetchOptions:r,onRequest:a,onResponse:c,timeout:w});return t3({key:s,methods:i,name:o,async request({method:T,params:N}){const R={method:T,params:N},{schedule:M}=N7({id:v,wait:g,shouldSplitBatch(P){return P.length>p},fn:P=>A.request({body:P}),sort:(P,L)=>P.id-L.id}),D=async P=>t?M(P):[await A.request({body:P})],[{error:S,result:$}]=await D(R);if(u)return{error:S,result:$};if(S)throw new XD({body:R,error:S,url:v});return $},retryCount:m,retryDelay:l,timeout:w,type:"http"},{fetchOptions:r,url:v})}}function n3(n){return{formatters:void 0,fees:void 0,serializers:void 0,...n}}const Sv={createBalance(n,e){const t={name:n.metadata.name||"",symbol:n.metadata.symbol||"",decimals:n.metadata.decimals||0,value:n.metadata.value||0,price:n.metadata.price||0,iconUrl:n.metadata.iconUrl||""};return{name:t.name,symbol:t.symbol,chainId:e,address:n.address==="native"?void 0:this.convertAddressToCAIP10Address(n.address,e),value:t.value,price:t.price,quantity:{decimals:t.decimals.toString(),numeric:this.convertHexToBalance({hex:n.balance,decimals:t.decimals})},iconUrl:t.iconUrl}},convertHexToBalance({hex:n,decimals:e}){return I7(BigInt(n),e)},convertAddressToCAIP10Address(n,e){return`${e}:${n}`},createCAIP2ChainId(n,e){return`${e}:${parseInt(n,16)}`},getChainIdHexFromCAIP2ChainId(n){const e=n.split(":");if(e.length<2||!e[1])return"0x0";const t=e[1],r=parseInt(t,10);return isNaN(r)?"0x0":`0x${r.toString(16)}`},isWalletGetAssetsResponse(n){return typeof n!="object"||n===null?!1:Object.values(n).every(e=>Array.isArray(e)&&e.every(t=>this.isValidAsset(t)))},isValidAsset(n){return typeof n=="object"&&n!==null&&typeof n.address=="string"&&typeof n.balance=="string"&&(n.type==="ERC20"||n.type==="NATIVE")&&typeof n.metadata=="object"&&n.metadata!==null&&typeof n.metadata.name=="string"&&typeof n.metadata.symbol=="string"&&typeof n.metadata.decimals=="number"&&typeof n.metadata.price=="number"&&typeof n.metadata.iconUrl=="string"}},XI={async getMyTokensWithBalance(n){const e=ge.state.address,t=I.state.activeCaipNetwork,r=se.getConnectorId("eip155")===H.CONNECTOR_ID.AUTH;if(!e||!t)return[];const s=`${t.caipNetworkId}:${e}`,i=Q.getBalanceCacheForCaipAddress(s);if(i)return i.balances;if(t.chainNamespace===H.CHAIN.EVM&&r){const a=await this.getEIP155Balances(e,t);if(a)return this.filterLowQualityTokens(a)}const o=await xe.getBalance(e,t.caipNetworkId,n);return this.filterLowQualityTokens(o.balances)},async getEIP155Balances(n,e){var t,r;try{const s=Sv.getChainIdHexFromCAIP2ChainId(e.caipNetworkId),i=await ie.getCapabilities(n);if(!((r=(t=i==null?void 0:i[s])==null?void 0:t.assetDiscovery)!=null&&r.supported))return null;const o=await ie.walletGetAssets({account:n,chainFilter:[s]});if(!Sv.isWalletGetAssetsResponse(o))return null;const c=(o[s]||[]).map(l=>Sv.createBalance(l,e.caipNetworkId));return Q.updateBalanceCache({caipAddress:`${e.caipNetworkId}:${n}`,balance:{balances:c},timestamp:Date.now()}),c}catch{return null}},filterLowQualityTokens(n){return n.filter(e=>e.quantity.decimals!=="0")}},ji=Vt({currentTab:0,tokenBalance:[],smartAccountDeployed:!1,addressLabels:new Map}),F7={state:ji,replaceState(n){n&&Object.assign(ji,Jd(n))},subscribe(n){return I.subscribeChainProp("accountState",e=>{if(e)return n(e)})},subscribeKey(n,e,t){let r;return I.subscribeChainProp("accountState",s=>{if(s){const i=s[n];r!==i&&(r=i,e(i))}},t)},setStatus(n,e){I.setAccountProp("status",n,e)},getCaipAddress(n){var e,t;if(n)return(t=(e=I.state.chains.get(n))==null?void 0:e.accountState)==null?void 0:t.caipAddress},setCaipAddress(n,e){const t=n?ye.getPlainAddress(n):void 0;e===I.state.activeChain&&(I.state.activeCaipAddress=n),I.setAccountProp("caipAddress",n,e),I.setAccountProp("address",t,e)},setBalance(n,e,t){I.setAccountProp("balance",n,t),I.setAccountProp("balanceSymbol",e,t)},setProfileName(n,e){I.setAccountProp("profileName",n,e)},setProfileImage(n,e){I.setAccountProp("profileImage",n,e)},setUser(n,e){I.setAccountProp("user",n,e)},setAddressExplorerUrl(n,e){I.setAccountProp("addressExplorerUrl",n,e)},setSmartAccountDeployed(n,e){I.setAccountProp("smartAccountDeployed",n,e)},setCurrentTab(n){I.setAccountProp("currentTab",n,I.state.activeChain)},setTokenBalance(n,e){n&&I.setAccountProp("tokenBalance",n,e)},setShouldUpdateToAddress(n,e){I.setAccountProp("shouldUpdateToAddress",n,e)},addAddressLabel(n,e,t){var s,i;if(!t)return;const r=((i=(s=I.state.chains.get(t))==null?void 0:s.accountState)==null?void 0:i.addressLabels)||new Map;r.set(n,e),I.setAccountProp("addressLabels",r,t)},removeAddressLabel(n,e){var r,s;if(!e)return;const t=((s=(r=I.state.chains.get(e))==null?void 0:r.accountState)==null?void 0:s.addressLabels)||new Map;t.delete(n),I.setAccountProp("addressLabels",t,e)},setConnectedWalletInfo(n,e){I.setAccountProp("connectedWalletInfo",n,e,!1)},setPreferredAccountType(n,e){I.setAccountProp("preferredAccountType",n,e)},setSocialProvider(n,e){n&&I.setAccountProp("socialProvider",n,e)},setSocialWindow(n,e){I.setAccountProp("socialWindow",n?Jd(n):void 0,e)},setFarcasterUrl(n,e){I.setAccountProp("farcasterUrl",n,e)},async fetchTokenBalance(n){var i,o;ji.balanceLoading=!0;const e=(i=I.state.activeCaipNetwork)==null?void 0:i.caipNetworkId,t=(o=I.state.activeCaipNetwork)==null?void 0:o.chainNamespace,r=I.state.activeCaipAddress,s=r?ye.getPlainAddress(r):void 0;if(ji.lastRetry&&!ye.isAllowedRetry(ji.lastRetry,30*st.ONE_SEC_MS))return ji.balanceLoading=!1,[];try{if(s&&e&&t){const a=await XI.getMyTokensWithBalance();return ge.setTokenBalance(a,t),ji.lastRetry=void 0,ji.balanceLoading=!1,a}}catch(a){ji.lastRetry=Date.now(),n==null||n(a),uo.showError("Token Balance Unavailable")}finally{ji.balanceLoading=!1}return[]},resetAccount(n){I.resetAccount(n)}},ge=Rs(F7),j7={onSwitchNetwork({network:n,ignoreSwitchConfirmation:e=!1}){const t=I.state.activeCaipNetwork,r=Pe.state.data;if(n.id===(t==null?void 0:t.id))return;const i=ge.getCaipAddress(I.state.activeChain),o=n.chainNamespace!==I.state.activeChain,a=ge.getCaipAddress(n.chainNamespace),l=se.getConnectorId(I.state.activeChain)===H.CONNECTOR_ID.AUTH,u=H.AUTH_CONNECTOR_SUPPORTED_CHAINS.find(h=>h===n.chainNamespace);e||l&&u?Pe.push("SwitchNetwork",{...r,network:n}):i&&o&&!a?Pe.push("SwitchActiveChain",{switchToChain:n.chainNamespace,navigateTo:"Connect",navigateWithReplace:!0,network:n}):Pe.push("SwitchNetwork",{...r,network:n})}},qr=Vt({loading:!1,loadingNamespaceMap:new Map,open:!1,shake:!1,namespace:void 0}),H7={state:qr,subscribe(n){return Lr(qr,()=>n(qr))},subscribeKey(n,e){return Fr(qr,n,e)},async open(n){var i,o;const e=n==null?void 0:n.namespace,t=I.state.activeChain,r=e&&e!==t,s=(i=I.getAccountData(n==null?void 0:n.namespace))==null?void 0:i.caipAddress;if(ie.state.wcBasic?Se.prefetch({fetchNetworkImages:!1,fetchConnectorImages:!1}):await Se.prefetch(),se.setFilterByNamespace(n==null?void 0:n.namespace),tt.setLoading(!0,e),e&&r){const a=((o=I.getNetworkData(e))==null?void 0:o.caipNetwork)||I.getRequestedCaipNetworks(e)[0];a&&j7.onSwitchNetwork({network:a,ignoreSwitchConfirmation:!0})}else{const a=I.state.noAdapters;z.state.manualWCControl||a&&!s?ye.isMobile()?Pe.reset("AllWallets"):Pe.reset("ConnectingWalletConnectBasic"):n!=null&&n.view?Pe.reset(n.view,n.data):s?Pe.reset("Account"):Pe.reset("Connect")}qr.open=!0,Si.set({open:!0}),ut.sendEvent({type:"track",event:"MODAL_OPEN",properties:{connected:!!s}})},close(){const n=z.state.enableEmbedded,e=!!I.state.activeCaipAddress;qr.open&&ut.sendEvent({type:"track",event:"MODAL_CLOSE",properties:{connected:e}}),qr.open=!1,Pe.reset("Connect"),tt.clearLoading(),n?e?Pe.replace("Account"):Pe.push("Connect"):Si.set({open:!1}),ie.resetUri()},setLoading(n,e){e&&qr.loadingNamespaceMap.set(e,n),qr.loading=n,Si.set({loading:n})},clearLoading(){qr.loadingNamespaceMap.clear(),qr.loading=!1,Si.set({loading:!1})},shake(){qr.shake||(qr.shake=!0,setTimeout(()=>{qr.shake=!1},500))}},tt=Rs(H7),qp={id:"2b92315d-eab7-5bef-84fa-089a131333f5",name:"USD Coin",symbol:"USDC",networks:[{name:"ethereum-mainnet",display_name:"Ethereum",chain_id:"1",contract_address:"0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48"},{name:"polygon-mainnet",display_name:"Polygon",chain_id:"137",contract_address:"0x2791Bca1f2de4661ED88A30C99A7a9449Aa84174"}]},wA={id:"USD",payment_method_limits:[{id:"card",min:"10.00",max:"7500.00"},{id:"ach_bank_account",min:"10.00",max:"25000.00"}]},V7={providers:UD,selectedProvider:null,error:null,purchaseCurrency:qp,paymentCurrency:wA,purchaseCurrencies:[qp],paymentCurrencies:[],quotesLoading:!1},at=Vt(V7),q7={state:at,subscribe(n){return Lr(at,()=>n(at))},subscribeKey(n,e){return Fr(at,n,e)},setSelectedProvider(n){var e,t;if(n&&n.name==="meld"){const r=I.state.activeChain,s=r===H.CHAIN.SOLANA?"SOL":"USDC",i=r?((t=(e=I.state.chains.get(r))==null?void 0:e.accountState)==null?void 0:t.address)??"":"",o=new URL(n.url);o.searchParams.append("publicKey",u9),o.searchParams.append("destinationCurrencyCode",s),o.searchParams.append("walletAddress",i),o.searchParams.append("externalCustomerId",z.state.projectId),at.selectedProvider={...n,url:o.toString()}}else at.selectedProvider=n},setOnrampProviders(n){if(Array.isArray(n)&&n.every(e=>typeof e=="string")){const e=n,t=UD.filter(r=>e.includes(r.name));at.providers=t}else at.providers=[]},setPurchaseCurrency(n){at.purchaseCurrency=n},setPaymentCurrency(n){at.paymentCurrency=n},setPurchaseAmount(n){bA.state.purchaseAmount=n},setPaymentAmount(n){bA.state.paymentAmount=n},async getAvailableCurrencies(){const n=await xe.getOnrampOptions();at.purchaseCurrencies=n.purchaseCurrencies,at.paymentCurrencies=n.paymentCurrencies,at.paymentCurrency=n.paymentCurrencies[0]||wA,at.purchaseCurrency=n.purchaseCurrencies[0]||qp,await Se.fetchCurrencyImages(n.paymentCurrencies.map(e=>e.id)),await Se.fetchTokenImages(n.purchaseCurrencies.map(e=>e.symbol))},async getQuote(){var n,e;at.quotesLoading=!0;try{const t=await xe.getOnrampQuote({purchaseCurrency:at.purchaseCurrency,paymentCurrency:at.paymentCurrency,amount:((n=at.paymentAmount)==null?void 0:n.toString())||"0",network:(e=at.purchaseCurrency)==null?void 0:e.symbol});return at.quotesLoading=!1,at.purchaseAmount=Number(t==null?void 0:t.purchaseAmount.amount),t}catch(t){return at.error=t.message,at.quotesLoading=!1,null}finally{at.quotesLoading=!1}},resetState(){at.selectedProvider=null,at.error=null,at.purchaseCurrency=qp,at.paymentCurrency=wA,at.purchaseCurrencies=[qp],at.paymentCurrencies=[],at.paymentAmount=void 0,at.purchaseAmount=void 0,at.quotesLoading=!1}},bA=Rs(q7),ON=2147483648,z7={convertEVMChainIdToCoinType(n){if(n>=ON)throw new Error("Invalid chainId");return(ON|n)>>>0}},Ds=Vt({suggestions:[],loading:!1}),W7={state:Ds,subscribe(n){return Lr(Ds,()=>n(Ds))},subscribeKey(n,e){return Fr(Ds,n,e)},async resolveName(n){var e,t;try{return await xe.lookupEnsName(n)}catch(r){const s=r;throw new Error(((t=(e=s==null?void 0:s.reasons)==null?void 0:e[0])==null?void 0:t.description)||"Error resolving name")}},async isNameRegistered(n){try{return await xe.lookupEnsName(n),!0}catch{return!1}},async getSuggestions(n){try{Ds.loading=!0,Ds.suggestions=[];const e=await xe.getEnsNameSuggestions(n);return Ds.suggestions=e.suggestions||[],Ds.suggestions}catch(e){const t=zp.parseEnsApiError(e,"Error fetching name suggestions");throw new Error(t)}finally{Ds.loading=!1}},async getNamesForAddress(n){try{if(!I.state.activeCaipNetwork)return[];const t=Q.getEnsFromCacheForAddress(n);if(t)return t;const r=await xe.reverseLookupEnsName({address:n});return Q.updateEnsCache({address:n,ens:r,timestamp:Date.now()}),r}catch(e){const t=zp.parseEnsApiError(e,"Error fetching names for address");throw new Error(t)}},async registerName(n){const e=I.state.activeCaipNetwork,t=ge.state.address,r=se.getAuthConnector();if(!e)throw new Error("Network not found");if(!t||!r)throw new Error("Address or auth connector not found");Ds.loading=!0;try{const s=JSON.stringify({name:n,attributes:{},timestamp:Math.floor(Date.now()/1e3)});Pe.pushTransactionStack({onCancel(){Pe.replace("RegisterAccountName")}});const i=await ie.signMessage(s);Ds.loading=!1;const o=e.id;if(!o)throw new Error("Network not found");const a=z7.convertEVMChainIdToCoinType(Number(o));await xe.registerEnsName({coinType:a,address:t,signature:i,message:s}),ge.setProfileName(n,e.chainNamespace),Q.updateEnsCache({address:t,ens:[{name:n,registered_at:new Date().toISOString(),updated_at:void 0,addresses:{},attributes:[]}],timestamp:Date.now()}),Pe.replace("RegisterAccountNameSuccess")}catch(s){const i=zp.parseEnsApiError(s,`Error registering name ${n}`);throw Pe.replace("RegisterAccountName"),new Error(i)}finally{Ds.loading=!1}},validateName(n){return/^[a-zA-Z0-9-]{4,}$/u.test(n)},parseEnsApiError(n,e){var r,s;const t=n;return((s=(r=t==null?void 0:t.reasons)==null?void 0:r[0])==null?void 0:s.description)||e}},zp=Rs(W7);var e_={exports:{}},Yh=typeof Reflect=="object"?Reflect:null,xN=Yh&&typeof Yh.apply=="function"?Yh.apply:function(e,t,r){return Function.prototype.apply.call(e,t,r)},Ww;Yh&&typeof Yh.ownKeys=="function"?Ww=Yh.ownKeys:Object.getOwnPropertySymbols?Ww=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Ww=function(e){return Object.getOwnPropertyNames(e)};function G7(n){console&&console.warn&&console.warn(n)}var r3=Number.isNaN||function(e){return e!==e};function kt(){kt.init.call(this)}e_.exports=kt;e_.exports.once=Z7;kt.EventEmitter=kt;kt.prototype._events=void 0;kt.prototype._eventsCount=0;kt.prototype._maxListeners=void 0;var RN=10;function zb(n){if(typeof n!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof n)}Object.defineProperty(kt,"defaultMaxListeners",{enumerable:!0,get:function(){return RN},set:function(n){if(typeof n!="number"||n<0||r3(n))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+n+".");RN=n}});kt.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};kt.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||r3(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function s3(n){return n._maxListeners===void 0?kt.defaultMaxListeners:n._maxListeners}kt.prototype.getMaxListeners=function(){return s3(this)};kt.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t.push(arguments[r]);var s=e==="error",i=this._events;if(i!==void 0)s=s&&i.error===void 0;else if(!s)return!1;if(s){var o;if(t.length>0&&(o=t[0]),o instanceof Error)throw o;var a=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw a.context=o,a}var c=i[e];if(c===void 0)return!1;if(typeof c=="function")xN(c,this,t);else for(var l=c.length,u=l3(c,l),r=0;r<l;++r)xN(u[r],this,t);return!0};function i3(n,e,t,r){var s,i,o;if(zb(t),i=n._events,i===void 0?(i=n._events=Object.create(null),n._eventsCount=0):(i.newListener!==void 0&&(n.emit("newListener",e,t.listener?t.listener:t),i=n._events),o=i[e]),o===void 0)o=i[e]=t,++n._eventsCount;else if(typeof o=="function"?o=i[e]=r?[t,o]:[o,t]:r?o.unshift(t):o.push(t),s=s3(n),s>0&&o.length>s&&!o.warned){o.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=n,a.type=e,a.count=o.length,G7(a)}return n}kt.prototype.addListener=function(e,t){return i3(this,e,t,!1)};kt.prototype.on=kt.prototype.addListener;kt.prototype.prependListener=function(e,t){return i3(this,e,t,!0)};function K7(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function o3(n,e,t){var r={fired:!1,wrapFn:void 0,target:n,type:e,listener:t},s=K7.bind(r);return s.listener=t,r.wrapFn=s,s}kt.prototype.once=function(e,t){return zb(t),this.on(e,o3(this,e,t)),this};kt.prototype.prependOnceListener=function(e,t){return zb(t),this.prependListener(e,o3(this,e,t)),this};kt.prototype.removeListener=function(e,t){var r,s,i,o,a;if(zb(t),s=this._events,s===void 0)return this;if(r=s[e],r===void 0)return this;if(r===t||r.listener===t)--this._eventsCount===0?this._events=Object.create(null):(delete s[e],s.removeListener&&this.emit("removeListener",e,r.listener||t));else if(typeof r!="function"){for(i=-1,o=r.length-1;o>=0;o--)if(r[o]===t||r[o].listener===t){a=r[o].listener,i=o;break}if(i<0)return this;i===0?r.shift():Y7(r,i),r.length===1&&(s[e]=r[0]),s.removeListener!==void 0&&this.emit("removeListener",e,a||t)}return this};kt.prototype.off=kt.prototype.removeListener;kt.prototype.removeAllListeners=function(e){var t,r,s;if(r=this._events,r===void 0)return this;if(r.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):r[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete r[e]),this;if(arguments.length===0){var i=Object.keys(r),o;for(s=0;s<i.length;++s)o=i[s],o!=="removeListener"&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(t=r[e],typeof t=="function")this.removeListener(e,t);else if(t!==void 0)for(s=t.length-1;s>=0;s--)this.removeListener(e,t[s]);return this};function a3(n,e,t){var r=n._events;if(r===void 0)return[];var s=r[e];return s===void 0?[]:typeof s=="function"?t?[s.listener||s]:[s]:t?Q7(s):l3(s,s.length)}kt.prototype.listeners=function(e){return a3(this,e,!0)};kt.prototype.rawListeners=function(e){return a3(this,e,!1)};kt.listenerCount=function(n,e){return typeof n.listenerCount=="function"?n.listenerCount(e):c3.call(n,e)};kt.prototype.listenerCount=c3;function c3(n){var e=this._events;if(e!==void 0){var t=e[n];if(typeof t=="function")return 1;if(t!==void 0)return t.length}return 0}kt.prototype.eventNames=function(){return this._eventsCount>0?Ww(this._events):[]};function l3(n,e){for(var t=new Array(e),r=0;r<e;++r)t[r]=n[r];return t}function Y7(n,e){for(;e+1<n.length;e++)n[e]=n[e+1];n.pop()}function Q7(n){for(var e=new Array(n.length),t=0;t<e.length;++t)e[t]=n[t].listener||n[t];return e}function Z7(n,e){return new Promise(function(t,r){function s(o){n.removeListener(e,i),r(o)}function i(){typeof n.removeListener=="function"&&n.removeListener("error",s),t([].slice.call(arguments))}u3(n,e,i,{once:!0}),e!=="error"&&J7(n,s,{once:!0})})}function J7(n,e,t){typeof n.on=="function"&&u3(n,"error",e,t)}function u3(n,e,t,r){if(typeof n.on=="function")r.once?n.once(e,t):n.on(e,t);else if(typeof n.addEventListener=="function")n.addEventListener(e,function s(i){r.once&&n.removeEventListener(e,s),t(i)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof n)}var ii=e_.exports;const t_=FI(ii);var ne={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var EA=function(n,e){return EA=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var s in r)r.hasOwnProperty(s)&&(t[s]=r[s])},EA(n,e)};function X7(n,e){EA(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var vA=function(){return vA=Object.assign||function(e){for(var t,r=1,s=arguments.length;r<s;r++){t=arguments[r];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},vA.apply(this,arguments)};function ej(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(n);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(n,r[s])&&(t[r[s]]=n[r[s]]);return t}function tj(n,e,t,r){var s=arguments.length,i=s<3?e:r===null?r=Object.getOwnPropertyDescriptor(e,t):r,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(n,e,t,r);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(i=(s<3?o(i):s>3?o(e,t,i):o(e,t))||i);return s>3&&i&&Object.defineProperty(e,t,i),i}function nj(n,e){return function(t,r){e(t,r,n)}}function rj(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)}function sj(n,e,t,r){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(u){try{l(r.next(u))}catch(h){o(h)}}function c(u){try{l(r.throw(u))}catch(h){o(h)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((r=r.apply(n,e||[])).next())})}function ij(n,e){var t={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},r,s,i,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(l){return function(u){return c([l,u])}}function c(l){if(r)throw new TypeError("Generator is already executing.");for(;t;)try{if(r=1,s&&(i=l[0]&2?s.return:l[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,l[1])).done)return i;switch(s=0,i&&(l=[l[0]&2,i.value]),l[0]){case 0:case 1:i=l;break;case 4:return t.label++,{value:l[1],done:!1};case 5:t.label++,s=l[1],l=[0];continue;case 7:l=t.ops.pop(),t.trys.pop();continue;default:if(i=t.trys,!(i=i.length>0&&i[i.length-1])&&(l[0]===6||l[0]===2)){t=0;continue}if(l[0]===3&&(!i||l[1]>i[0]&&l[1]<i[3])){t.label=l[1];break}if(l[0]===6&&t.label<i[1]){t.label=i[1],i=l;break}if(i&&t.label<i[2]){t.label=i[2],t.ops.push(l);break}i[2]&&t.ops.pop(),t.trys.pop();continue}l=e.call(n,t)}catch(u){l=[6,u],s=0}finally{r=i=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}function oj(n,e,t,r){r===void 0&&(r=t),n[r]=e[t]}function aj(n,e){for(var t in n)t!=="default"&&!e.hasOwnProperty(t)&&(e[t]=n[t])}function AA(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],r=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function h3(n,e){var t=typeof Symbol=="function"&&n[Symbol.iterator];if(!t)return n;var r=t.call(n),s,i=[],o;try{for(;(e===void 0||e-- >0)&&!(s=r.next()).done;)i.push(s.value)}catch(a){o={error:a}}finally{try{s&&!s.done&&(t=r.return)&&t.call(r)}finally{if(o)throw o.error}}return i}function cj(){for(var n=[],e=0;e<arguments.length;e++)n=n.concat(h3(arguments[e]));return n}function lj(){for(var n=0,e=0,t=arguments.length;e<t;e++)n+=arguments[e].length;for(var r=Array(n),s=0,e=0;e<t;e++)for(var i=arguments[e],o=0,a=i.length;o<a;o++,s++)r[s]=i[o];return r}function Mg(n){return this instanceof Mg?(this.v=n,this):new Mg(n)}function uj(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=t.apply(n,e||[]),s,i=[];return s={},o("next"),o("throw"),o("return"),s[Symbol.asyncIterator]=function(){return this},s;function o(d){r[d]&&(s[d]=function(f){return new Promise(function(p,g){i.push([d,f,p,g])>1||a(d,f)})})}function a(d,f){try{c(r[d](f))}catch(p){h(i[0][3],p)}}function c(d){d.value instanceof Mg?Promise.resolve(d.value.v).then(l,u):h(i[0][2],d)}function l(d){a("next",d)}function u(d){a("throw",d)}function h(d,f){d(f),i.shift(),i.length&&a(i[0][0],i[0][1])}}function hj(n){var e,t;return e={},r("next"),r("throw",function(s){throw s}),r("return"),e[Symbol.iterator]=function(){return this},e;function r(s,i){e[s]=n[s]?function(o){return(t=!t)?{value:Mg(n[s](o)),done:s==="return"}:i?i(o):o}:i}}function dj(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof AA=="function"?AA(n):n[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(i){t[i]=n[i]&&function(o){return new Promise(function(a,c){o=n[i](o),s(a,c,o.done,o.value)})}}function s(i,o,a,c){Promise.resolve(c).then(function(l){i({value:l,done:a})},o)}}function fj(n,e){return Object.defineProperty?Object.defineProperty(n,"raw",{value:e}):n.raw=e,n}function pj(n){if(n&&n.__esModule)return n;var e={};if(n!=null)for(var t in n)Object.hasOwnProperty.call(n,t)&&(e[t]=n[t]);return e.default=n,e}function gj(n){return n&&n.__esModule?n:{default:n}}function mj(n,e){if(!e.has(n))throw new TypeError("attempted to get private field on non-instance");return e.get(n)}function yj(n,e,t){if(!e.has(n))throw new TypeError("attempted to set private field on non-instance");return e.set(n,t),t}const wj=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return vA},__asyncDelegator:hj,__asyncGenerator:uj,__asyncValues:dj,__await:Mg,__awaiter:sj,__classPrivateFieldGet:mj,__classPrivateFieldSet:yj,__createBinding:oj,__decorate:tj,__exportStar:aj,__extends:X7,__generator:ij,__importDefault:gj,__importStar:pj,__makeTemplateObject:fj,__metadata:rj,__param:nj,__read:h3,__rest:ej,__spread:cj,__spreadArrays:lj,__values:AA},Symbol.toStringTag,{value:"Module"})),Wb=Nk(wj);var Tv={},rp={},PN;function bj(){if(PN)return rp;PN=1,Object.defineProperty(rp,"__esModule",{value:!0}),rp.delay=void 0;function n(e){return new Promise(t=>{setTimeout(()=>{t(!0)},e)})}return rp.delay=n,rp}var nl={},Nv={},rl={},kN;function Ej(){return kN||(kN=1,Object.defineProperty(rl,"__esModule",{value:!0}),rl.ONE_THOUSAND=rl.ONE_HUNDRED=void 0,rl.ONE_HUNDRED=100,rl.ONE_THOUSAND=1e3),rl}var Ov={},DN;function vj(){return DN||(DN=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.ONE_YEAR=n.FOUR_WEEKS=n.THREE_WEEKS=n.TWO_WEEKS=n.ONE_WEEK=n.THIRTY_DAYS=n.SEVEN_DAYS=n.FIVE_DAYS=n.THREE_DAYS=n.ONE_DAY=n.TWENTY_FOUR_HOURS=n.TWELVE_HOURS=n.SIX_HOURS=n.THREE_HOURS=n.ONE_HOUR=n.SIXTY_MINUTES=n.THIRTY_MINUTES=n.TEN_MINUTES=n.FIVE_MINUTES=n.ONE_MINUTE=n.SIXTY_SECONDS=n.THIRTY_SECONDS=n.TEN_SECONDS=n.FIVE_SECONDS=n.ONE_SECOND=void 0,n.ONE_SECOND=1,n.FIVE_SECONDS=5,n.TEN_SECONDS=10,n.THIRTY_SECONDS=30,n.SIXTY_SECONDS=60,n.ONE_MINUTE=n.SIXTY_SECONDS,n.FIVE_MINUTES=n.ONE_MINUTE*5,n.TEN_MINUTES=n.ONE_MINUTE*10,n.THIRTY_MINUTES=n.ONE_MINUTE*30,n.SIXTY_MINUTES=n.ONE_MINUTE*60,n.ONE_HOUR=n.SIXTY_MINUTES,n.THREE_HOURS=n.ONE_HOUR*3,n.SIX_HOURS=n.ONE_HOUR*6,n.TWELVE_HOURS=n.ONE_HOUR*12,n.TWENTY_FOUR_HOURS=n.ONE_HOUR*24,n.ONE_DAY=n.TWENTY_FOUR_HOURS,n.THREE_DAYS=n.ONE_DAY*3,n.FIVE_DAYS=n.ONE_DAY*5,n.SEVEN_DAYS=n.ONE_DAY*7,n.THIRTY_DAYS=n.ONE_DAY*30,n.ONE_WEEK=n.SEVEN_DAYS,n.TWO_WEEKS=n.ONE_WEEK*2,n.THREE_WEEKS=n.ONE_WEEK*3,n.FOUR_WEEKS=n.ONE_WEEK*4,n.ONE_YEAR=n.ONE_DAY*365}(Ov)),Ov}var UN;function d3(){return UN||(UN=1,function(n){Object.defineProperty(n,"__esModule",{value:!0});const e=Wb;e.__exportStar(Ej(),n),e.__exportStar(vj(),n)}(Nv)),Nv}var $N;function Aj(){if($N)return nl;$N=1,Object.defineProperty(nl,"__esModule",{value:!0}),nl.fromMiliseconds=nl.toMiliseconds=void 0;const n=d3();function e(r){return r*n.ONE_THOUSAND}nl.toMiliseconds=e;function t(r){return Math.floor(r/n.ONE_THOUSAND)}return nl.fromMiliseconds=t,nl}var MN;function Cj(){return MN||(MN=1,function(n){Object.defineProperty(n,"__esModule",{value:!0});const e=Wb;e.__exportStar(bj(),n),e.__exportStar(Aj(),n)}(Tv)),Tv}var Xu={},LN;function Ij(){if(LN)return Xu;LN=1,Object.defineProperty(Xu,"__esModule",{value:!0}),Xu.Watch=void 0;class n{constructor(){this.timestamps=new Map}start(t){if(this.timestamps.has(t))throw new Error(`Watch already started for label: ${t}`);this.timestamps.set(t,{started:Date.now()})}stop(t){const r=this.get(t);if(typeof r.elapsed<"u")throw new Error(`Watch already stopped for label: ${t}`);const s=Date.now()-r.started;this.timestamps.set(t,{started:r.started,elapsed:s})}get(t){const r=this.timestamps.get(t);if(typeof r>"u")throw new Error(`No timestamp found for label: ${t}`);return r}elapsed(t){const r=this.get(t);return r.elapsed||Date.now()-r.started}}return Xu.Watch=n,Xu.default=n,Xu}var xv={},sp={},BN;function _j(){if(BN)return sp;BN=1,Object.defineProperty(sp,"__esModule",{value:!0}),sp.IWatch=void 0;class n{}return sp.IWatch=n,sp}var FN;function Sj(){return FN||(FN=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),Wb.__exportStar(_j(),n)}(xv)),xv}(function(n){Object.defineProperty(n,"__esModule",{value:!0});const e=Wb;e.__exportStar(Cj(),n),e.__exportStar(Ij(),n),e.__exportStar(Sj(),n),e.__exportStar(d3(),n)})(ne);class Lu{}let Tj=class extends Lu{constructor(e){super()}};const jN=ne.FIVE_SECONDS,Bu={pulse:"heartbeat_pulse"};let Nj=class f3 extends Tj{constructor(e){super(e),this.events=new ii.EventEmitter,this.interval=jN,this.interval=(e==null?void 0:e.interval)||jN}static async init(e){const t=new f3(e);return await t.init(),t}async init(){await this.initialize()}stop(){clearInterval(this.intervalRef)}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async initialize(){this.intervalRef=setInterval(()=>this.pulse(),ne.toMiliseconds(this.interval))}pulse(){this.events.emit(Bu.pulse)}};function Oj(n){return!n||typeof n.then!="function"?Promise.resolve(n):n}function In(n,...e){try{return Oj(n(...e))}catch(t){return Promise.reject(t)}}function xj(n){const e=typeof n;return n===null||e!=="object"&&e!=="function"}function Rj(n){const e=Object.getPrototypeOf(n);return!e||e.isPrototypeOf(Object)}function Gw(n){if(xj(n))return String(n);if(Rj(n)||Array.isArray(n))return JSON.stringify(n);if(typeof n.toJSON=="function")return Gw(n.toJSON());throw new Error("[unstorage] Cannot stringify value!")}const CA="base64:";function Pj(n){return typeof n=="string"?n:CA+Uj(n)}function kj(n){return typeof n!="string"||!n.startsWith(CA)?n:Dj(n.slice(CA.length))}function Dj(n){return globalThis.Buffer?Buffer.from(n,"base64"):Uint8Array.from(globalThis.atob(n),e=>e.codePointAt(0))}function Uj(n){return globalThis.Buffer?Buffer.from(n).toString("base64"):globalThis.btoa(String.fromCodePoint(...n))}function Kr(n){var e;return n&&((e=n.split("?")[0])==null?void 0:e.replace(/[/\\]/g,":").replace(/:+/g,":").replace(/^:|:$/g,""))||""}function $j(...n){return Kr(n.join(":"))}function rw(n){return n=Kr(n),n?n+":":""}function Mj(n,e){if(e===void 0)return!0;let t=0,r=n.indexOf(":");for(;r>-1;)t++,r=n.indexOf(":",r+1);return t<=e}function Lj(n,e){return e?n.startsWith(e)&&n[n.length-1]!=="$":n[n.length-1]!=="$"}const Bj="memory",Fj=()=>{const n=new Map;return{name:Bj,getInstance:()=>n,hasItem(e){return n.has(e)},getItem(e){return n.get(e)??null},getItemRaw(e){return n.get(e)??null},setItem(e,t){n.set(e,t)},setItemRaw(e,t){n.set(e,t)},removeItem(e){n.delete(e)},getKeys(){return[...n.keys()]},clear(){n.clear()},dispose(){n.clear()}}};function jj(n={}){const e={mounts:{"":n.driver||Fj()},mountpoints:[""],watching:!1,watchListeners:[],unwatch:{}},t=l=>{for(const u of e.mountpoints)if(l.startsWith(u))return{base:u,relativeKey:l.slice(u.length),driver:e.mounts[u]};return{base:"",relativeKey:l,driver:e.mounts[""]}},r=(l,u)=>e.mountpoints.filter(h=>h.startsWith(l)||u&&l.startsWith(h)).map(h=>({relativeBase:l.length>h.length?l.slice(h.length):void 0,mountpoint:h,driver:e.mounts[h]})),s=(l,u)=>{if(e.watching){u=Kr(u);for(const h of e.watchListeners)h(l,u)}},i=async()=>{if(!e.watching){e.watching=!0;for(const l in e.mounts)e.unwatch[l]=await HN(e.mounts[l],s,l)}},o=async()=>{if(e.watching){for(const l in e.unwatch)await e.unwatch[l]();e.unwatch={},e.watching=!1}},a=(l,u,h)=>{const d=new Map,f=p=>{let g=d.get(p.base);return g||(g={driver:p.driver,base:p.base,items:[]},d.set(p.base,g)),g};for(const p of l){const g=typeof p=="string",m=Kr(g?p:p.key),w=g?void 0:p.value,v=g||!p.options?u:{...u,...p.options},A=t(m);f(A).items.push({key:m,value:w,relativeKey:A.relativeKey,options:v})}return Promise.all([...d.values()].map(p=>h(p))).then(p=>p.flat())},c={hasItem(l,u={}){l=Kr(l);const{relativeKey:h,driver:d}=t(l);return In(d.hasItem,h,u)},getItem(l,u={}){l=Kr(l);const{relativeKey:h,driver:d}=t(l);return In(d.getItem,h,u).then(f=>Hy(f))},getItems(l,u={}){return a(l,u,h=>h.driver.getItems?In(h.driver.getItems,h.items.map(d=>({key:d.relativeKey,options:d.options})),u).then(d=>d.map(f=>({key:$j(h.base,f.key),value:Hy(f.value)}))):Promise.all(h.items.map(d=>In(h.driver.getItem,d.relativeKey,d.options).then(f=>({key:d.key,value:Hy(f)})))))},getItemRaw(l,u={}){l=Kr(l);const{relativeKey:h,driver:d}=t(l);return d.getItemRaw?In(d.getItemRaw,h,u):In(d.getItem,h,u).then(f=>kj(f))},async setItem(l,u,h={}){if(u===void 0)return c.removeItem(l);l=Kr(l);const{relativeKey:d,driver:f}=t(l);f.setItem&&(await In(f.setItem,d,Gw(u),h),f.watch||s("update",l))},async setItems(l,u){await a(l,u,async h=>{if(h.driver.setItems)return In(h.driver.setItems,h.items.map(d=>({key:d.relativeKey,value:Gw(d.value),options:d.options})),u);h.driver.setItem&&await Promise.all(h.items.map(d=>In(h.driver.setItem,d.relativeKey,Gw(d.value),d.options)))})},async setItemRaw(l,u,h={}){if(u===void 0)return c.removeItem(l,h);l=Kr(l);const{relativeKey:d,driver:f}=t(l);if(f.setItemRaw)await In(f.setItemRaw,d,u,h);else if(f.setItem)await In(f.setItem,d,Pj(u),h);else return;f.watch||s("update",l)},async removeItem(l,u={}){typeof u=="boolean"&&(u={removeMeta:u}),l=Kr(l);const{relativeKey:h,driver:d}=t(l);d.removeItem&&(await In(d.removeItem,h,u),(u.removeMeta||u.removeMata)&&await In(d.removeItem,h+"$",u),d.watch||s("remove",l))},async getMeta(l,u={}){typeof u=="boolean"&&(u={nativeOnly:u}),l=Kr(l);const{relativeKey:h,driver:d}=t(l),f=Object.create(null);if(d.getMeta&&Object.assign(f,await In(d.getMeta,h,u)),!u.nativeOnly){const p=await In(d.getItem,h+"$",u).then(g=>Hy(g));p&&typeof p=="object"&&(typeof p.atime=="string"&&(p.atime=new Date(p.atime)),typeof p.mtime=="string"&&(p.mtime=new Date(p.mtime)),Object.assign(f,p))}return f},setMeta(l,u,h={}){return this.setItem(l+"$",u,h)},removeMeta(l,u={}){return this.removeItem(l+"$",u)},async getKeys(l,u={}){var m;l=rw(l);const h=r(l,!0);let d=[];const f=[];let p=!0;for(const w of h){(m=w.driver.flags)!=null&&m.maxDepth||(p=!1);const v=await In(w.driver.getKeys,w.relativeBase,u);for(const A of v){const T=w.mountpoint+Kr(A);d.some(N=>T.startsWith(N))||f.push(T)}d=[w.mountpoint,...d.filter(A=>!A.startsWith(w.mountpoint))]}const g=u.maxDepth!==void 0&&!p;return f.filter(w=>(!g||Mj(w,u.maxDepth))&&Lj(w,l))},async clear(l,u={}){l=rw(l),await Promise.all(r(l,!1).map(async h=>{if(h.driver.clear)return In(h.driver.clear,h.relativeBase,u);if(h.driver.removeItem){const d=await h.driver.getKeys(h.relativeBase||"",u);return Promise.all(d.map(f=>h.driver.removeItem(f,u)))}}))},async dispose(){await Promise.all(Object.values(e.mounts).map(l=>VN(l)))},async watch(l){return await i(),e.watchListeners.push(l),async()=>{e.watchListeners=e.watchListeners.filter(u=>u!==l),e.watchListeners.length===0&&await o()}},async unwatch(){e.watchListeners=[],await o()},mount(l,u){if(l=rw(l),l&&e.mounts[l])throw new Error(`already mounted at ${l}`);return l&&(e.mountpoints.push(l),e.mountpoints.sort((h,d)=>d.length-h.length)),e.mounts[l]=u,e.watching&&Promise.resolve(HN(u,s,l)).then(h=>{e.unwatch[l]=h}).catch(console.error),c},async unmount(l,u=!0){var h,d;l=rw(l),!(!l||!e.mounts[l])&&(e.watching&&l in e.unwatch&&((d=(h=e.unwatch)[l])==null||d.call(h),delete e.unwatch[l]),u&&await VN(e.mounts[l]),e.mountpoints=e.mountpoints.filter(f=>f!==l),delete e.mounts[l])},getMount(l=""){l=Kr(l)+":";const u=t(l);return{driver:u.driver,base:u.base}},getMounts(l="",u={}){return l=Kr(l),r(l,u.parents).map(d=>({driver:d.driver,base:d.mountpoint}))},keys:(l,u={})=>c.getKeys(l,u),get:(l,u={})=>c.getItem(l,u),set:(l,u,h={})=>c.setItem(l,u,h),has:(l,u={})=>c.hasItem(l,u),del:(l,u={})=>c.removeItem(l,u),remove:(l,u={})=>c.removeItem(l,u)};return c}function HN(n,e,t){return n.watch?n.watch((r,s)=>e(r,t+s)):()=>{}}async function VN(n){typeof n.dispose=="function"&&await In(n.dispose)}function Fu(n){return new Promise((e,t)=>{n.oncomplete=n.onsuccess=()=>e(n.result),n.onabort=n.onerror=()=>t(n.error)})}function p3(n,e){const t=indexedDB.open(n);t.onupgradeneeded=()=>t.result.createObjectStore(e);const r=Fu(t);return(s,i)=>r.then(o=>i(o.transaction(e,s).objectStore(e)))}let Rv;function ay(){return Rv||(Rv=p3("keyval-store","keyval")),Rv}function qN(n,e=ay()){return e("readonly",t=>Fu(t.get(n)))}function Hj(n,e,t=ay()){return t("readwrite",r=>(r.put(e,n),Fu(r.transaction)))}function Vj(n,e=ay()){return e("readwrite",t=>(t.delete(n),Fu(t.transaction)))}function qj(n=ay()){return n("readwrite",e=>(e.clear(),Fu(e.transaction)))}function zj(n,e){return n.openCursor().onsuccess=function(){this.result&&(e(this.result),this.result.continue())},Fu(n.transaction)}function Wj(n=ay()){return n("readonly",e=>{if(e.getAllKeys)return Fu(e.getAllKeys());const t=[];return zj(e,r=>t.push(r.key)).then(()=>t)})}const Gj=n=>JSON.stringify(n,(e,t)=>typeof t=="bigint"?t.toString()+"n":t),Kj=n=>{const e=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,t=n.replace(e,'$1"$2n"$3');return JSON.parse(t,(r,s)=>typeof s=="string"&&s.match(/^\d+n$/)?BigInt(s.substring(0,s.length-1)):s)};function fu(n){if(typeof n!="string")throw new Error(`Cannot safe json parse value of type ${typeof n}`);try{return Kj(n)}catch{return n}}function ma(n){return typeof n=="string"?n:Gj(n)||""}const Yj="idb-keyval";var Qj=(n={})=>{const e=n.base&&n.base.length>0?`${n.base}:`:"",t=s=>e+s;let r;return n.dbName&&n.storeName&&(r=p3(n.dbName,n.storeName)),{name:Yj,options:n,async hasItem(s){return!(typeof await qN(t(s),r)>"u")},async getItem(s){return await qN(t(s),r)??null},setItem(s,i){return Hj(t(s),i,r)},removeItem(s){return Vj(t(s),r)},getKeys(){return Wj(r)},clear(){return qj(r)}}};const Zj="WALLET_CONNECT_V2_INDEXED_DB",Jj="keyvaluestorage";let Xj=class{constructor(){this.indexedDb=jj({driver:Qj({dbName:Zj,storeName:Jj})})}async getKeys(){return this.indexedDb.getKeys()}async getEntries(){return(await this.indexedDb.getItems(await this.indexedDb.getKeys())).map(e=>[e.key,e.value])}async getItem(e){const t=await this.indexedDb.getItem(e);if(t!==null)return t}async setItem(e,t){await this.indexedDb.setItem(e,ma(t))}async removeItem(e){await this.indexedDb.removeItem(e)}};var Pv=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Kw={exports:{}};(function(){let n;function e(){}n=e,n.prototype.getItem=function(t){return this.hasOwnProperty(t)?String(this[t]):null},n.prototype.setItem=function(t,r){this[t]=String(r)},n.prototype.removeItem=function(t){delete this[t]},n.prototype.clear=function(){const t=this;Object.keys(t).forEach(function(r){t[r]=void 0,delete t[r]})},n.prototype.key=function(t){return t=t||0,Object.keys(this)[t]},n.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof Pv<"u"&&Pv.localStorage?Kw.exports=Pv.localStorage:typeof window<"u"&&window.localStorage?Kw.exports=window.localStorage:Kw.exports=new e})();function eH(n){var e;return[n[0],fu((e=n[1])!=null?e:"")]}let tH=class{constructor(){this.localStorage=Kw.exports}async getKeys(){return Object.keys(this.localStorage)}async getEntries(){return Object.entries(this.localStorage).map(eH)}async getItem(e){const t=this.localStorage.getItem(e);if(t!==null)return fu(t)}async setItem(e,t){this.localStorage.setItem(e,ma(t))}async removeItem(e){this.localStorage.removeItem(e)}};const nH="wc_storage_version",zN=1,rH=async(n,e,t)=>{const r=nH,s=await e.getItem(r);if(s&&s>=zN){t(e);return}const i=await n.getKeys();if(!i.length){t(e);return}const o=[];for(;i.length;){const a=i.shift();if(!a)continue;const c=a.toLowerCase();if(c.includes("wc@")||c.includes("walletconnect")||c.includes("wc_")||c.includes("wallet_connect")){const l=await n.getItem(a);await e.setItem(a,l),o.push(a)}}await e.setItem(r,zN),t(e),sH(n,o)},sH=async(n,e)=>{e.length&&e.forEach(async t=>{await n.removeItem(t)})};let iH=class{constructor(){this.initialized=!1,this.setInitialized=t=>{this.storage=t,this.initialized=!0};const e=new tH;this.storage=e;try{const t=new Xj;rH(e,t,this.setInitialized)}catch{this.initialized=!0}}async getKeys(){return await this.initialize(),this.storage.getKeys()}async getEntries(){return await this.initialize(),this.storage.getEntries()}async getItem(e){return await this.initialize(),this.storage.getItem(e)}async setItem(e,t){return await this.initialize(),this.storage.setItem(e,t)}async removeItem(e){return await this.initialize(),this.storage.removeItem(e)}async initialize(){this.initialized||await new Promise(e=>{const t=setInterval(()=>{this.initialized&&(clearInterval(t),e())},20)})}};function oH(n){try{return JSON.stringify(n)}catch{return'"[Circular]"'}}var aH=cH;function cH(n,e,t){var r=t&&t.stringify||oH,s=1;if(typeof n=="object"&&n!==null){var i=e.length+s;if(i===1)return n;var o=new Array(i);o[0]=r(n);for(var a=1;a<i;a++)o[a]=r(e[a]);return o.join(" ")}if(typeof n!="string")return n;var c=e.length;if(c===0)return n;for(var l="",u=1-s,h=-1,d=n&&n.length||0,f=0;f<d;){if(n.charCodeAt(f)===37&&f+1<d){switch(h=h>-1?h:0,n.charCodeAt(f+1)){case 100:case 102:if(u>=c||e[u]==null)break;h<f&&(l+=n.slice(h,f)),l+=Number(e[u]),h=f+2,f++;break;case 105:if(u>=c||e[u]==null)break;h<f&&(l+=n.slice(h,f)),l+=Math.floor(Number(e[u])),h=f+2,f++;break;case 79:case 111:case 106:if(u>=c||e[u]===void 0)break;h<f&&(l+=n.slice(h,f));var p=typeof e[u];if(p==="string"){l+="'"+e[u]+"'",h=f+2,f++;break}if(p==="function"){l+=e[u].name||"<anonymous>",h=f+2,f++;break}l+=r(e[u]),h=f+2,f++;break;case 115:if(u>=c)break;h<f&&(l+=n.slice(h,f)),l+=String(e[u]),h=f+2,f++;break;case 37:h<f&&(l+=n.slice(h,f)),l+="%",h=f+2,f++,u--;break}++u}++f}return h===-1?n:(h<d&&(l+=n.slice(h)),l)}const WN=aH;var Sh=yo;const Lg=wH().console||{},lH={mapHttpRequest:sw,mapHttpResponse:sw,wrapRequestSerializer:kv,wrapResponseSerializer:kv,wrapErrorSerializer:kv,req:sw,res:sw,err:pH};function uH(n,e){return Array.isArray(n)?n.filter(function(r){return r!=="!stdSerializers.err"}):n===!0?Object.keys(e):!1}function yo(n){n=n||{},n.browser=n.browser||{};const e=n.browser.transmit;if(e&&typeof e.send!="function")throw Error("pino: transmit option must have a send function");const t=n.browser.write||Lg;n.browser.write&&(n.browser.asObject=!0);const r=n.serializers||{},s=uH(n.browser.serialize,r);let i=n.browser.serialize;Array.isArray(n.browser.serialize)&&n.browser.serialize.indexOf("!stdSerializers.err")>-1&&(i=!1);const o=["error","fatal","warn","info","debug","trace"];typeof t=="function"&&(t.error=t.fatal=t.warn=t.info=t.debug=t.trace=t),n.enabled===!1&&(n.level="silent");const a=n.level||"info",c=Object.create(t);c.log||(c.log=Bg),Object.defineProperty(c,"levelVal",{get:u}),Object.defineProperty(c,"level",{get:h,set:d});const l={transmit:e,serialize:s,asObject:n.browser.asObject,levels:o,timestamp:gH(n)};c.levels=yo.levels,c.level=a,c.setMaxListeners=c.getMaxListeners=c.emit=c.addListener=c.on=c.prependListener=c.once=c.prependOnceListener=c.removeListener=c.removeAllListeners=c.listeners=c.listenerCount=c.eventNames=c.write=c.flush=Bg,c.serializers=r,c._serialize=s,c._stdErrSerialize=i,c.child=f,e&&(c._logEvent=IA());function u(){return this.level==="silent"?1/0:this.levels.values[this.level]}function h(){return this._level}function d(p){if(p!=="silent"&&!this.levels.values[p])throw Error("unknown level "+p);this._level=p,eh(l,c,"error","log"),eh(l,c,"fatal","error"),eh(l,c,"warn","error"),eh(l,c,"info","log"),eh(l,c,"debug","log"),eh(l,c,"trace","log")}function f(p,g){if(!p)throw new Error("missing bindings for child Pino");g=g||{},s&&p.serializers&&(g.serializers=p.serializers);const m=g.serializers;if(s&&m){var w=Object.assign({},r,m),v=n.browser.serialize===!0?Object.keys(w):s;delete p.serializers,Gb([p],v,w,this._stdErrSerialize)}function A(T){this._childLevel=(T._childLevel|0)+1,this.error=th(T,p,"error"),this.fatal=th(T,p,"fatal"),this.warn=th(T,p,"warn"),this.info=th(T,p,"info"),this.debug=th(T,p,"debug"),this.trace=th(T,p,"trace"),w&&(this.serializers=w,this._serialize=v),e&&(this._logEvent=IA([].concat(T._logEvent.bindings,p)))}return A.prototype=this,new A(this)}return c}yo.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}};yo.stdSerializers=lH;yo.stdTimeFunctions=Object.assign({},{nullTime:g3,epochTime:m3,unixTime:mH,isoTime:yH});function eh(n,e,t,r){const s=Object.getPrototypeOf(e);e[t]=e.levelVal>e.levels.values[t]?Bg:s[t]?s[t]:Lg[t]||Lg[r]||Bg,hH(n,e,t)}function hH(n,e,t){!n.transmit&&e[t]===Bg||(e[t]=function(r){return function(){const i=n.timestamp(),o=new Array(arguments.length),a=Object.getPrototypeOf&&Object.getPrototypeOf(this)===Lg?Lg:this;for(var c=0;c<o.length;c++)o[c]=arguments[c];if(n.serialize&&!n.asObject&&Gb(o,this._serialize,this.serializers,this._stdErrSerialize),n.asObject?r.call(a,dH(this,t,o,i)):r.apply(a,o),n.transmit){const l=n.transmit.level||e.level,u=yo.levels.values[l],h=yo.levels.values[t];if(h<u)return;fH(this,{ts:i,methodLevel:t,methodValue:h,transmitLevel:l,transmitValue:yo.levels.values[n.transmit.level||e.level],send:n.transmit.send,val:e.levelVal},o)}}}(e[t]))}function dH(n,e,t,r){n._serialize&&Gb(t,n._serialize,n.serializers,n._stdErrSerialize);const s=t.slice();let i=s[0];const o={};r&&(o.time=r),o.level=yo.levels.values[e];let a=(n._childLevel|0)+1;if(a<1&&(a=1),i!==null&&typeof i=="object"){for(;a--&&typeof s[0]=="object";)Object.assign(o,s.shift());i=s.length?WN(s.shift(),s):void 0}else typeof i=="string"&&(i=WN(s.shift(),s));return i!==void 0&&(o.msg=i),o}function Gb(n,e,t,r){for(const s in n)if(r&&n[s]instanceof Error)n[s]=yo.stdSerializers.err(n[s]);else if(typeof n[s]=="object"&&!Array.isArray(n[s]))for(const i in n[s])e&&e.indexOf(i)>-1&&i in t&&(n[s][i]=t[i](n[s][i]))}function th(n,e,t){return function(){const r=new Array(1+arguments.length);r[0]=e;for(var s=1;s<r.length;s++)r[s]=arguments[s-1];return n[t].apply(this,r)}}function fH(n,e,t){const r=e.send,s=e.ts,i=e.methodLevel,o=e.methodValue,a=e.val,c=n._logEvent.bindings;Gb(t,n._serialize||Object.keys(n.serializers),n.serializers,n._stdErrSerialize===void 0?!0:n._stdErrSerialize),n._logEvent.ts=s,n._logEvent.messages=t.filter(function(l){return c.indexOf(l)===-1}),n._logEvent.level.label=i,n._logEvent.level.value=o,r(i,n._logEvent,a),n._logEvent=IA(c)}function IA(n){return{ts:0,messages:[],bindings:n||[],level:{label:"",value:0}}}function pH(n){const e={type:n.constructor.name,msg:n.message,stack:n.stack};for(const t in n)e[t]===void 0&&(e[t]=n[t]);return e}function gH(n){return typeof n.timestamp=="function"?n.timestamp:n.timestamp===!1?g3:m3}function sw(){return{}}function kv(n){return n}function Bg(){}function g3(){return!1}function m3(){return Date.now()}function mH(){return Math.round(Date.now()/1e3)}function yH(){return new Date(Date.now()).toISOString()}function wH(){function n(e){return typeof e<"u"&&e}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return n(self)||n(window)||n(this)||{}}}const cy=FI(Sh),bH={level:"info"},ly="custom_context",n_=1e3*1024;let EH=class{constructor(e){this.nodeValue=e,this.sizeInBytes=new TextEncoder().encode(this.nodeValue).length,this.next=null}get value(){return this.nodeValue}get size(){return this.sizeInBytes}},GN=class{constructor(e){this.head=null,this.tail=null,this.lengthInNodes=0,this.maxSizeInBytes=e,this.sizeInBytes=0}append(e){const t=new EH(e);if(t.size>this.maxSizeInBytes)throw new Error(`[LinkedList] Value too big to insert into list: ${e} with size ${t.size}`);for(;this.size+t.size>this.maxSizeInBytes;)this.shift();this.head?(this.tail&&(this.tail.next=t),this.tail=t):(this.head=t,this.tail=t),this.lengthInNodes++,this.sizeInBytes+=t.size}shift(){if(!this.head)return;const e=this.head;this.head=this.head.next,this.head||(this.tail=null),this.lengthInNodes--,this.sizeInBytes-=e.size}toArray(){const e=[];let t=this.head;for(;t!==null;)e.push(t.value),t=t.next;return e}get length(){return this.lengthInNodes}get size(){return this.sizeInBytes}toOrderedArray(){return Array.from(this)}[Symbol.iterator](){let e=this.head;return{next:()=>{if(!e)return{done:!0,value:null};const t=e.value;return e=e.next,{done:!1,value:t}}}}},y3=class{constructor(e,t=n_){this.level=e??"error",this.levelValue=Sh.levels.values[this.level],this.MAX_LOG_SIZE_IN_BYTES=t,this.logs=new GN(this.MAX_LOG_SIZE_IN_BYTES)}forwardToConsole(e,t){t===Sh.levels.values.error?console.error(e):t===Sh.levels.values.warn?console.warn(e):t===Sh.levels.values.debug?console.debug(e):t===Sh.levels.values.trace?console.trace(e):console.log(e)}appendToLogs(e){this.logs.append(ma({timestamp:new Date().toISOString(),log:e}));const t=typeof e=="string"?JSON.parse(e).level:e.level;t>=this.levelValue&&this.forwardToConsole(e,t)}getLogs(){return this.logs}clearLogs(){this.logs=new GN(this.MAX_LOG_SIZE_IN_BYTES)}getLogArray(){return Array.from(this.logs)}logsToBlob(e){const t=this.getLogArray();return t.push(ma({extraMetadata:e})),new Blob(t,{type:"application/json"})}},vH=class{constructor(e,t=n_){this.baseChunkLogger=new y3(e,t)}write(e){this.baseChunkLogger.appendToLogs(e)}getLogs(){return this.baseChunkLogger.getLogs()}clearLogs(){this.baseChunkLogger.clearLogs()}getLogArray(){return this.baseChunkLogger.getLogArray()}logsToBlob(e){return this.baseChunkLogger.logsToBlob(e)}downloadLogsBlobInBrowser(e){const t=URL.createObjectURL(this.logsToBlob(e)),r=document.createElement("a");r.href=t,r.download=`walletconnect-logs-${new Date().toISOString()}.txt`,document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(t)}},AH=class{constructor(e,t=n_){this.baseChunkLogger=new y3(e,t)}write(e){this.baseChunkLogger.appendToLogs(e)}getLogs(){return this.baseChunkLogger.getLogs()}clearLogs(){this.baseChunkLogger.clearLogs()}getLogArray(){return this.baseChunkLogger.getLogArray()}logsToBlob(e){return this.baseChunkLogger.logsToBlob(e)}};var CH=Object.defineProperty,IH=Object.defineProperties,_H=Object.getOwnPropertyDescriptors,KN=Object.getOwnPropertySymbols,SH=Object.prototype.hasOwnProperty,TH=Object.prototype.propertyIsEnumerable,YN=(n,e,t)=>e in n?CH(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,S0=(n,e)=>{for(var t in e||(e={}))SH.call(e,t)&&YN(n,t,e[t]);if(KN)for(var t of KN(e))TH.call(e,t)&&YN(n,t,e[t]);return n},T0=(n,e)=>IH(n,_H(e));function Rf(n){return T0(S0({},n),{level:(n==null?void 0:n.level)||bH.level})}function NH(n,e=ly){return n[e]||""}function OH(n,e,t=ly){return n[t]=e,n}function hs(n,e=ly){let t="";return typeof n.bindings>"u"?t=NH(n,e):t=n.bindings().context||"",t}function xH(n,e,t=ly){const r=hs(n,t);return r.trim()?`${r}/${e}`:e}function vr(n,e,t=ly){const r=xH(n,e,t),s=n.child({context:r});return OH(s,r,t)}function RH(n){var e,t;const r=new vH((e=n.opts)==null?void 0:e.level,n.maxSizeInBytes);return{logger:cy(T0(S0({},n.opts),{level:"trace",browser:T0(S0({},(t=n.opts)==null?void 0:t.browser),{write:s=>r.write(s)})})),chunkLoggerController:r}}function PH(n){var e;const t=new AH((e=n.opts)==null?void 0:e.level,n.maxSizeInBytes);return{logger:cy(T0(S0({},n.opts),{level:"trace"}),t),chunkLoggerController:t}}function r_(n){return typeof n.loggerOverride<"u"&&typeof n.loggerOverride!="string"?{logger:n.loggerOverride,chunkLoggerController:null}:typeof window<"u"?RH(n):PH(n)}var kH=Object.defineProperty,DH=(n,e,t)=>e in n?kH(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,QN=(n,e,t)=>DH(n,typeof e!="symbol"?e+"":e,t);let UH=class extends Lu{constructor(e){super(),this.opts=e,QN(this,"protocol","wc"),QN(this,"version",2)}};var $H=Object.defineProperty,MH=(n,e,t)=>e in n?$H(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,LH=(n,e,t)=>MH(n,e+"",t);let BH=class extends Lu{constructor(e,t){super(),this.core=e,this.logger=t,LH(this,"records",new Map)}},FH=class{constructor(e,t){this.logger=e,this.core=t}},jH=class extends Lu{constructor(e,t){super(),this.relayer=e,this.logger=t}},HH=class extends Lu{constructor(e){super()}},VH=class{constructor(e,t,r,s){this.core=e,this.logger=t,this.name=r}},qH=class extends Lu{constructor(e,t){super(),this.relayer=e,this.logger=t}},zH=class extends Lu{constructor(e,t){super(),this.core=e,this.logger=t}},WH=class{constructor(e,t,r){this.core=e,this.logger=t,this.store=r}},GH=class{constructor(e,t){this.projectId=e,this.logger=t}},KH=class{constructor(e,t,r){this.core=e,this.logger=t,this.telemetryEnabled=r}};var YH=Object.defineProperty,QH=(n,e,t)=>e in n?YH(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,ZN=(n,e,t)=>QH(n,typeof e!="symbol"?e+"":e,t);let ZH=class{constructor(e){this.opts=e,ZN(this,"protocol","wc"),ZN(this,"version",2)}},JH=class{constructor(e){this.client=e}};function XH(n){return n instanceof Uint8Array||ArrayBuffer.isView(n)&&n.constructor.name==="Uint8Array"}function w3(n,...e){if(!XH(n))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(n.length))throw new Error("Uint8Array expected of length "+e+", got length="+n.length)}function JN(n,e=!0){if(n.destroyed)throw new Error("Hash instance has been destroyed");if(e&&n.finished)throw new Error("Hash#digest() has already been called")}function eV(n,e){w3(n);const t=e.outputLen;if(n.length<t)throw new Error("digestInto() expects output buffer of length at least "+t)}const nh=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Dv=n=>new DataView(n.buffer,n.byteOffset,n.byteLength);function tV(n){if(typeof n!="string")throw new Error("utf8ToBytes expected string, got "+typeof n);return new Uint8Array(new TextEncoder().encode(n))}function b3(n){return typeof n=="string"&&(n=tV(n)),w3(n),n}let nV=class{clone(){return this._cloneInto()}};function rV(n){const e=r=>n().update(b3(r)).digest(),t=n();return e.outputLen=t.outputLen,e.blockLen=t.blockLen,e.create=()=>n(),e}function E3(n=32){if(nh&&typeof nh.getRandomValues=="function")return nh.getRandomValues(new Uint8Array(n));if(nh&&typeof nh.randomBytes=="function")return nh.randomBytes(n);throw new Error("crypto.getRandomValues must be defined")}function sV(n,e,t,r){if(typeof n.setBigUint64=="function")return n.setBigUint64(e,t,r);const s=BigInt(32),i=BigInt(4294967295),o=Number(t>>s&i),a=Number(t&i),c=r?4:0,l=r?0:4;n.setUint32(e+c,o,r),n.setUint32(e+l,a,r)}let iV=class extends nV{constructor(e,t,r,s){super(),this.blockLen=e,this.outputLen=t,this.padOffset=r,this.isLE=s,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=Dv(this.buffer)}update(e){JN(this);const{view:t,buffer:r,blockLen:s}=this;e=b3(e);const i=e.length;for(let o=0;o<i;){const a=Math.min(s-this.pos,i-o);if(a===s){const c=Dv(e);for(;s<=i-o;o+=s)this.process(c,o);continue}r.set(e.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===s&&(this.process(t,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){JN(this),eV(e,this),this.finished=!0;const{buffer:t,view:r,blockLen:s,isLE:i}=this;let{pos:o}=this;t[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>s-o&&(this.process(r,0),o=0);for(let h=o;h<s;h++)t[h]=0;sV(r,s-8,BigInt(this.length*8),i),this.process(r,0);const a=Dv(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const l=c/4,u=this.get();if(l>u.length)throw new Error("_sha2: outputLen bigger than state");for(let h=0;h<l;h++)a.setUint32(4*h,u[h],i)}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const r=e.slice(0,t);return this.destroy(),r}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:t,buffer:r,length:s,finished:i,destroyed:o,pos:a}=this;return e.length=s,e.pos=a,e.finished=i,e.destroyed=o,s%t&&e.buffer.set(r),e}};const iw=BigInt(2**32-1),_A=BigInt(32);function v3(n,e=!1){return e?{h:Number(n&iw),l:Number(n>>_A&iw)}:{h:Number(n>>_A&iw)|0,l:Number(n&iw)|0}}function oV(n,e=!1){let t=new Uint32Array(n.length),r=new Uint32Array(n.length);for(let s=0;s<n.length;s++){const{h:i,l:o}=v3(n[s],e);[t[s],r[s]]=[i,o]}return[t,r]}const aV=(n,e)=>BigInt(n>>>0)<<_A|BigInt(e>>>0),cV=(n,e,t)=>n>>>t,lV=(n,e,t)=>n<<32-t|e>>>t,uV=(n,e,t)=>n>>>t|e<<32-t,hV=(n,e,t)=>n<<32-t|e>>>t,dV=(n,e,t)=>n<<64-t|e>>>t-32,fV=(n,e,t)=>n>>>t-32|e<<64-t,pV=(n,e)=>e,gV=(n,e)=>n,mV=(n,e,t)=>n<<t|e>>>32-t,yV=(n,e,t)=>e<<t|n>>>32-t,wV=(n,e,t)=>e<<t-32|n>>>64-t,bV=(n,e,t)=>n<<t-32|e>>>64-t;function EV(n,e,t,r){const s=(e>>>0)+(r>>>0);return{h:n+t+(s/2**32|0)|0,l:s|0}}const vV=(n,e,t)=>(n>>>0)+(e>>>0)+(t>>>0),AV=(n,e,t,r)=>e+t+r+(n/2**32|0)|0,CV=(n,e,t,r)=>(n>>>0)+(e>>>0)+(t>>>0)+(r>>>0),IV=(n,e,t,r,s)=>e+t+r+s+(n/2**32|0)|0,_V=(n,e,t,r,s)=>(n>>>0)+(e>>>0)+(t>>>0)+(r>>>0)+(s>>>0),SV=(n,e,t,r,s,i)=>e+t+r+s+i+(n/2**32|0)|0,Ge={fromBig:v3,split:oV,toBig:aV,shrSH:cV,shrSL:lV,rotrSH:uV,rotrSL:hV,rotrBH:dV,rotrBL:fV,rotr32H:pV,rotr32L:gV,rotlSH:mV,rotlSL:yV,rotlBH:wV,rotlBL:bV,add:EV,add3L:vV,add3H:AV,add4L:CV,add4H:IV,add5H:SV,add5L:_V},[TV,NV]=Ge.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(n=>BigInt(n))),Pa=new Uint32Array(80),ka=new Uint32Array(80);let OV=class extends iV{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:e,Al:t,Bh:r,Bl:s,Ch:i,Cl:o,Dh:a,Dl:c,Eh:l,El:u,Fh:h,Fl:d,Gh:f,Gl:p,Hh:g,Hl:m}=this;return[e,t,r,s,i,o,a,c,l,u,h,d,f,p,g,m]}set(e,t,r,s,i,o,a,c,l,u,h,d,f,p,g,m){this.Ah=e|0,this.Al=t|0,this.Bh=r|0,this.Bl=s|0,this.Ch=i|0,this.Cl=o|0,this.Dh=a|0,this.Dl=c|0,this.Eh=l|0,this.El=u|0,this.Fh=h|0,this.Fl=d|0,this.Gh=f|0,this.Gl=p|0,this.Hh=g|0,this.Hl=m|0}process(e,t){for(let A=0;A<16;A++,t+=4)Pa[A]=e.getUint32(t),ka[A]=e.getUint32(t+=4);for(let A=16;A<80;A++){const T=Pa[A-15]|0,N=ka[A-15]|0,R=Ge.rotrSH(T,N,1)^Ge.rotrSH(T,N,8)^Ge.shrSH(T,N,7),M=Ge.rotrSL(T,N,1)^Ge.rotrSL(T,N,8)^Ge.shrSL(T,N,7),D=Pa[A-2]|0,S=ka[A-2]|0,$=Ge.rotrSH(D,S,19)^Ge.rotrBH(D,S,61)^Ge.shrSH(D,S,6),P=Ge.rotrSL(D,S,19)^Ge.rotrBL(D,S,61)^Ge.shrSL(D,S,6),L=Ge.add4L(M,P,ka[A-7],ka[A-16]),V=Ge.add4H(L,R,$,Pa[A-7],Pa[A-16]);Pa[A]=V|0,ka[A]=L|0}let{Ah:r,Al:s,Bh:i,Bl:o,Ch:a,Cl:c,Dh:l,Dl:u,Eh:h,El:d,Fh:f,Fl:p,Gh:g,Gl:m,Hh:w,Hl:v}=this;for(let A=0;A<80;A++){const T=Ge.rotrSH(h,d,14)^Ge.rotrSH(h,d,18)^Ge.rotrBH(h,d,41),N=Ge.rotrSL(h,d,14)^Ge.rotrSL(h,d,18)^Ge.rotrBL(h,d,41),R=h&f^~h&g,M=d&p^~d&m,D=Ge.add5L(v,N,M,NV[A],ka[A]),S=Ge.add5H(D,w,T,R,TV[A],Pa[A]),$=D|0,P=Ge.rotrSH(r,s,28)^Ge.rotrBH(r,s,34)^Ge.rotrBH(r,s,39),L=Ge.rotrSL(r,s,28)^Ge.rotrBL(r,s,34)^Ge.rotrBL(r,s,39),V=r&i^r&a^i&a,G=s&o^s&c^o&c;w=g|0,v=m|0,g=f|0,m=p|0,f=h|0,p=d|0,{h,l:d}=Ge.add(l|0,u|0,S|0,$|0),l=a|0,u=c|0,a=i|0,c=o|0,i=r|0,o=s|0;const E=Ge.add3L($,L,G);r=Ge.add3H(E,S,P,V),s=E|0}({h:r,l:s}=Ge.add(this.Ah|0,this.Al|0,r|0,s|0)),{h:i,l:o}=Ge.add(this.Bh|0,this.Bl|0,i|0,o|0),{h:a,l:c}=Ge.add(this.Ch|0,this.Cl|0,a|0,c|0),{h:l,l:u}=Ge.add(this.Dh|0,this.Dl|0,l|0,u|0),{h,l:d}=Ge.add(this.Eh|0,this.El|0,h|0,d|0),{h:f,l:p}=Ge.add(this.Fh|0,this.Fl|0,f|0,p|0),{h:g,l:m}=Ge.add(this.Gh|0,this.Gl|0,g|0,m|0),{h:w,l:v}=Ge.add(this.Hh|0,this.Hl|0,w|0,v|0),this.set(r,s,i,o,a,c,l,u,h,d,f,p,g,m,w,v)}roundClean(){Pa.fill(0),ka.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}};const xV=rV(()=>new OV);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const s_=BigInt(0),A3=BigInt(1),RV=BigInt(2);function i_(n){return n instanceof Uint8Array||ArrayBuffer.isView(n)&&n.constructor.name==="Uint8Array"}function o_(n){if(!i_(n))throw new Error("Uint8Array expected")}function Uv(n,e){if(typeof e!="boolean")throw new Error(n+" boolean expected, got "+e)}const PV=Array.from({length:256},(n,e)=>e.toString(16).padStart(2,"0"));function a_(n){o_(n);let e="";for(let t=0;t<n.length;t++)e+=PV[n[t]];return e}function C3(n){if(typeof n!="string")throw new Error("hex string expected, got "+typeof n);return n===""?s_:BigInt("0x"+n)}const Ro={_0:48,_9:57,A:65,F:70,a:97,f:102};function XN(n){if(n>=Ro._0&&n<=Ro._9)return n-Ro._0;if(n>=Ro.A&&n<=Ro.F)return n-(Ro.A-10);if(n>=Ro.a&&n<=Ro.f)return n-(Ro.a-10)}function I3(n){if(typeof n!="string")throw new Error("hex string expected, got "+typeof n);const e=n.length,t=e/2;if(e%2)throw new Error("hex string expected, got unpadded hex of length "+e);const r=new Uint8Array(t);for(let s=0,i=0;s<t;s++,i+=2){const o=XN(n.charCodeAt(i)),a=XN(n.charCodeAt(i+1));if(o===void 0||a===void 0){const c=n[i]+n[i+1];throw new Error('hex string expected, got non-hex character "'+c+'" at index '+i)}r[s]=o*16+a}return r}function kV(n){return C3(a_(n))}function Yw(n){return o_(n),C3(a_(Uint8Array.from(n).reverse()))}function _3(n,e){return I3(n.toString(16).padStart(e*2,"0"))}function SA(n,e){return _3(n,e).reverse()}function Po(n,e,t){let r;if(typeof e=="string")try{r=I3(e)}catch(i){throw new Error(n+" must be hex string or Uint8Array, cause: "+i)}else if(i_(e))r=Uint8Array.from(e);else throw new Error(n+" must be hex string or Uint8Array");const s=r.length;if(typeof t=="number"&&s!==t)throw new Error(n+" of length "+t+" expected, got "+s);return r}function e2(...n){let e=0;for(let r=0;r<n.length;r++){const s=n[r];o_(s),e+=s.length}const t=new Uint8Array(e);for(let r=0,s=0;r<n.length;r++){const i=n[r];t.set(i,s),s+=i.length}return t}const $v=n=>typeof n=="bigint"&&s_<=n;function DV(n,e,t){return $v(n)&&$v(e)&&$v(t)&&e<=n&&n<t}function ip(n,e,t,r){if(!DV(e,t,r))throw new Error("expected valid "+n+": "+t+" <= n < "+r+", got "+e)}function UV(n){let e;for(e=0;n>s_;n>>=A3,e+=1);return e}const $V=n=>(RV<<BigInt(n-1))-A3,MV={bigint:n=>typeof n=="bigint",function:n=>typeof n=="function",boolean:n=>typeof n=="boolean",string:n=>typeof n=="string",stringOrUint8Array:n=>typeof n=="string"||i_(n),isSafeInteger:n=>Number.isSafeInteger(n),array:n=>Array.isArray(n),field:(n,e)=>e.Fp.isValid(n),hash:n=>typeof n=="function"&&Number.isSafeInteger(n.outputLen)};function c_(n,e,t={}){const r=(s,i,o)=>{const a=MV[i];if(typeof a!="function")throw new Error("invalid validator function");const c=n[s];if(!(o&&c===void 0)&&!a(c,n))throw new Error("param "+String(s)+" is invalid. Expected "+i+", got "+c)};for(const[s,i]of Object.entries(e))r(s,i,!1);for(const[s,i]of Object.entries(t))r(s,i,!0);return n}function t2(n){const e=new WeakMap;return(t,...r)=>{const s=e.get(t);if(s!==void 0)return s;const i=n(t,...r);return e.set(t,i),i}}const Rn=BigInt(0),nn=BigInt(1),fl=BigInt(2),LV=BigInt(3),TA=BigInt(4),n2=BigInt(5),r2=BigInt(8);function En(n,e){const t=n%e;return t>=Rn?t:e+t}function BV(n,e,t){if(e<Rn)throw new Error("invalid exponent, negatives unsupported");if(t<=Rn)throw new Error("invalid modulus");if(t===nn)return Rn;let r=nn;for(;e>Rn;)e&nn&&(r=r*n%t),n=n*n%t,e>>=nn;return r}function Hi(n,e,t){let r=n;for(;e-- >Rn;)r*=r,r%=t;return r}function s2(n,e){if(n===Rn)throw new Error("invert: expected non-zero number");if(e<=Rn)throw new Error("invert: expected positive modulus, got "+e);let t=En(n,e),r=e,s=Rn,i=nn;for(;t!==Rn;){const o=r/t,a=r%t,c=s-i*o;r=t,t=a,s=i,i=c}if(r!==nn)throw new Error("invert: does not exist");return En(s,e)}function FV(n){const e=(n-nn)/fl;let t,r,s;for(t=n-nn,r=0;t%fl===Rn;t/=fl,r++);for(s=fl;s<n&&BV(s,e,n)!==n-nn;s++)if(s>1e3)throw new Error("Cannot find square root: likely non-prime P");if(r===1){const o=(n+nn)/TA;return function(a,c){const l=a.pow(c,o);if(!a.eql(a.sqr(l),c))throw new Error("Cannot find square root");return l}}const i=(t+nn)/fl;return function(o,a){if(o.pow(a,e)===o.neg(o.ONE))throw new Error("Cannot find square root");let c=r,l=o.pow(o.mul(o.ONE,s),t),u=o.pow(a,i),h=o.pow(a,t);for(;!o.eql(h,o.ONE);){if(o.eql(h,o.ZERO))return o.ZERO;let d=1;for(let p=o.sqr(h);d<c&&!o.eql(p,o.ONE);d++)p=o.sqr(p);const f=o.pow(l,nn<<BigInt(c-d-1));l=o.sqr(f),u=o.mul(u,f),h=o.mul(h,l),c=d}return u}}function jV(n){if(n%TA===LV){const e=(n+nn)/TA;return function(t,r){const s=t.pow(r,e);if(!t.eql(t.sqr(s),r))throw new Error("Cannot find square root");return s}}if(n%r2===n2){const e=(n-n2)/r2;return function(t,r){const s=t.mul(r,fl),i=t.pow(s,e),o=t.mul(r,i),a=t.mul(t.mul(o,fl),i),c=t.mul(o,t.sub(a,t.ONE));if(!t.eql(t.sqr(c),r))throw new Error("Cannot find square root");return c}}return FV(n)}const HV=(n,e)=>(En(n,e)&nn)===nn,VV=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function qV(n){const e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},t=VV.reduce((r,s)=>(r[s]="function",r),e);return c_(n,t)}function zV(n,e,t){if(t<Rn)throw new Error("invalid exponent, negatives unsupported");if(t===Rn)return n.ONE;if(t===nn)return e;let r=n.ONE,s=e;for(;t>Rn;)t&nn&&(r=n.mul(r,s)),s=n.sqr(s),t>>=nn;return r}function WV(n,e){const t=new Array(e.length),r=e.reduce((i,o,a)=>n.is0(o)?i:(t[a]=i,n.mul(i,o)),n.ONE),s=n.inv(r);return e.reduceRight((i,o,a)=>n.is0(o)?i:(t[a]=n.mul(i,t[a]),n.mul(i,o)),s),t}function S3(n,e){const t=e!==void 0?e:n.toString(2).length,r=Math.ceil(t/8);return{nBitLength:t,nByteLength:r}}function T3(n,e,t=!1,r={}){if(n<=Rn)throw new Error("invalid field: expected ORDER > 0, got "+n);const{nBitLength:s,nByteLength:i}=S3(n,e);if(i>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let o;const a=Object.freeze({ORDER:n,isLE:t,BITS:s,BYTES:i,MASK:$V(s),ZERO:Rn,ONE:nn,create:c=>En(c,n),isValid:c=>{if(typeof c!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof c);return Rn<=c&&c<n},is0:c=>c===Rn,isOdd:c=>(c&nn)===nn,neg:c=>En(-c,n),eql:(c,l)=>c===l,sqr:c=>En(c*c,n),add:(c,l)=>En(c+l,n),sub:(c,l)=>En(c-l,n),mul:(c,l)=>En(c*l,n),pow:(c,l)=>zV(a,c,l),div:(c,l)=>En(c*s2(l,n),n),sqrN:c=>c*c,addN:(c,l)=>c+l,subN:(c,l)=>c-l,mulN:(c,l)=>c*l,inv:c=>s2(c,n),sqrt:r.sqrt||(c=>(o||(o=jV(n)),o(a,c))),invertBatch:c=>WV(a,c),cmov:(c,l,u)=>u?l:c,toBytes:c=>t?SA(c,i):_3(c,i),fromBytes:c=>{if(c.length!==i)throw new Error("Field.fromBytes: expected "+i+" bytes, got "+c.length);return t?Yw(c):kV(c)}});return Object.freeze(a)}const i2=BigInt(0),ow=BigInt(1);function Mv(n,e){const t=e.negate();return n?t:e}function N3(n,e){if(!Number.isSafeInteger(n)||n<=0||n>e)throw new Error("invalid window size, expected [1.."+e+"], got W="+n)}function Lv(n,e){N3(n,e);const t=Math.ceil(e/n)+1,r=2**(n-1);return{windows:t,windowSize:r}}function GV(n,e){if(!Array.isArray(n))throw new Error("array expected");n.forEach((t,r)=>{if(!(t instanceof e))throw new Error("invalid point at index "+r)})}function KV(n,e){if(!Array.isArray(n))throw new Error("array of scalars expected");n.forEach((t,r)=>{if(!e.isValid(t))throw new Error("invalid scalar at index "+r)})}const Bv=new WeakMap,O3=new WeakMap;function Fv(n){return O3.get(n)||1}function YV(n,e){return{constTimeNegate:Mv,hasPrecomputes(t){return Fv(t)!==1},unsafeLadder(t,r,s=n.ZERO){let i=t;for(;r>i2;)r&ow&&(s=s.add(i)),i=i.double(),r>>=ow;return s},precomputeWindow(t,r){const{windows:s,windowSize:i}=Lv(r,e),o=[];let a=t,c=a;for(let l=0;l<s;l++){c=a,o.push(c);for(let u=1;u<i;u++)c=c.add(a),o.push(c);a=c.double()}return o},wNAF(t,r,s){const{windows:i,windowSize:o}=Lv(t,e);let a=n.ZERO,c=n.BASE;const l=BigInt(2**t-1),u=2**t,h=BigInt(t);for(let d=0;d<i;d++){const f=d*o;let p=Number(s&l);s>>=h,p>o&&(p-=u,s+=ow);const g=f,m=f+Math.abs(p)-1,w=d%2!==0,v=p<0;p===0?c=c.add(Mv(w,r[g])):a=a.add(Mv(v,r[m]))}return{p:a,f:c}},wNAFUnsafe(t,r,s,i=n.ZERO){const{windows:o,windowSize:a}=Lv(t,e),c=BigInt(2**t-1),l=2**t,u=BigInt(t);for(let h=0;h<o;h++){const d=h*a;if(s===i2)break;let f=Number(s&c);if(s>>=u,f>a&&(f-=l,s+=ow),f===0)continue;let p=r[d+Math.abs(f)-1];f<0&&(p=p.negate()),i=i.add(p)}return i},getPrecomputes(t,r,s){let i=Bv.get(r);return i||(i=this.precomputeWindow(r,t),t!==1&&Bv.set(r,s(i))),i},wNAFCached(t,r,s){const i=Fv(t);return this.wNAF(i,this.getPrecomputes(i,t,s),r)},wNAFCachedUnsafe(t,r,s,i){const o=Fv(t);return o===1?this.unsafeLadder(t,r,i):this.wNAFUnsafe(o,this.getPrecomputes(o,t,s),r,i)},setWindowSize(t,r){N3(r,e),O3.set(t,r),Bv.delete(t)}}}function QV(n,e,t,r){if(GV(t,n),KV(r,e),t.length!==r.length)throw new Error("arrays of points and scalars must have equal length");const s=n.ZERO,i=UV(BigInt(t.length)),o=i>12?i-3:i>4?i-2:i?2:1,a=(1<<o)-1,c=new Array(a+1).fill(s),l=Math.floor((e.BITS-1)/o)*o;let u=s;for(let h=l;h>=0;h-=o){c.fill(s);for(let f=0;f<r.length;f++){const p=r[f],g=Number(p>>BigInt(h)&BigInt(a));c[g]=c[g].add(t[f])}let d=s;for(let f=c.length-1,p=s;f>0;f--)p=p.add(c[f]),d=d.add(p);if(u=u.add(d),h!==0)for(let f=0;f<o;f++)u=u.double()}return u}function ZV(n){return qV(n.Fp),c_(n,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...S3(n.n,n.nBitLength),...n,p:n.Fp.ORDER})}const ui=BigInt(0),zr=BigInt(1),aw=BigInt(2),JV=BigInt(8),XV={zip215:!0};function eq(n){const e=ZV(n);return c_(n,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...e})}function tq(n){const e=eq(n),{Fp:t,n:r,prehash:s,hash:i,randomBytes:o,nByteLength:a,h:c}=e,l=aw<<BigInt(a*8)-zr,u=t.create,h=T3(e.n,e.nBitLength),d=e.uvRatio||((E,C)=>{try{return{isValid:!0,value:t.sqrt(E*t.inv(C))}}catch{return{isValid:!1,value:ui}}}),f=e.adjustScalarBytes||(E=>E),p=e.domain||((E,C,O)=>{if(Uv("phflag",O),C.length||O)throw new Error("Contexts/pre-hash are not supported");return E});function g(E,C){ip("coordinate "+E,C,ui,l)}function m(E){if(!(E instanceof A))throw new Error("ExtendedPoint expected")}const w=t2((E,C)=>{const{ex:O,ey:U,ez:k}=E,j=E.is0();C==null&&(C=j?JV:t.inv(k));const q=u(O*C),X=u(U*C),ce=u(k*C);if(j)return{x:ui,y:zr};if(ce!==zr)throw new Error("invZ was invalid");return{x:q,y:X}}),v=t2(E=>{const{a:C,d:O}=e;if(E.is0())throw new Error("bad point: ZERO");const{ex:U,ey:k,ez:j,et:q}=E,X=u(U*U),ce=u(k*k),te=u(j*j),de=u(te*te),De=u(X*C),Qe=u(te*u(De+ce)),Je=u(de+u(O*u(X*ce)));if(Qe!==Je)throw new Error("bad point: equation left != right (1)");const Me=u(U*k),Ot=u(j*q);if(Me!==Ot)throw new Error("bad point: equation left != right (2)");return!0});class A{constructor(C,O,U,k){this.ex=C,this.ey=O,this.ez=U,this.et=k,g("x",C),g("y",O),g("z",U),g("t",k),Object.freeze(this)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(C){if(C instanceof A)throw new Error("extended point not allowed");const{x:O,y:U}=C||{};return g("x",O),g("y",U),new A(O,U,zr,u(O*U))}static normalizeZ(C){const O=t.invertBatch(C.map(U=>U.ez));return C.map((U,k)=>U.toAffine(O[k])).map(A.fromAffine)}static msm(C,O){return QV(A,h,C,O)}_setWindowSize(C){R.setWindowSize(this,C)}assertValidity(){v(this)}equals(C){m(C);const{ex:O,ey:U,ez:k}=this,{ex:j,ey:q,ez:X}=C,ce=u(O*X),te=u(j*k),de=u(U*X),De=u(q*k);return ce===te&&de===De}is0(){return this.equals(A.ZERO)}negate(){return new A(u(-this.ex),this.ey,this.ez,u(-this.et))}double(){const{a:C}=e,{ex:O,ey:U,ez:k}=this,j=u(O*O),q=u(U*U),X=u(aw*u(k*k)),ce=u(C*j),te=O+U,de=u(u(te*te)-j-q),De=ce+q,Qe=De-X,Je=ce-q,Me=u(de*Qe),Ot=u(De*Je),an=u(de*Je),jr=u(Qe*De);return new A(Me,Ot,jr,an)}add(C){m(C);const{a:O,d:U}=e,{ex:k,ey:j,ez:q,et:X}=this,{ex:ce,ey:te,ez:de,et:De}=C;if(O===BigInt(-1)){const NT=u((j-k)*(te+ce)),OT=u((j+k)*(te-ce)),hv=u(OT-NT);if(hv===ui)return this.double();const xT=u(q*aw*De),RT=u(X*aw*de),PT=RT+xT,kT=OT+NT,DT=RT-xT,R6=u(PT*hv),P6=u(kT*DT),k6=u(PT*DT),D6=u(hv*kT);return new A(R6,P6,D6,k6)}const Qe=u(k*ce),Je=u(j*te),Me=u(X*U*De),Ot=u(q*de),an=u((k+j)*(ce+te)-Qe-Je),jr=Ot-Me,Zn=Ot+Me,ds=u(Je-O*Qe),Ku=u(an*jr),jy=u(Zn*ds),O6=u(an*ds),x6=u(jr*Zn);return new A(Ku,jy,x6,O6)}subtract(C){return this.add(C.negate())}wNAF(C){return R.wNAFCached(this,C,A.normalizeZ)}multiply(C){const O=C;ip("scalar",O,zr,r);const{p:U,f:k}=this.wNAF(O);return A.normalizeZ([U,k])[0]}multiplyUnsafe(C,O=A.ZERO){const U=C;return ip("scalar",U,ui,r),U===ui?N:this.is0()||U===zr?this:R.wNAFCachedUnsafe(this,U,A.normalizeZ,O)}isSmallOrder(){return this.multiplyUnsafe(c).is0()}isTorsionFree(){return R.unsafeLadder(this,r).is0()}toAffine(C){return w(this,C)}clearCofactor(){const{h:C}=e;return C===zr?this:this.multiplyUnsafe(C)}static fromHex(C,O=!1){const{d:U,a:k}=e,j=t.BYTES;C=Po("pointHex",C,j),Uv("zip215",O);const q=C.slice(),X=C[j-1];q[j-1]=X&-129;const ce=Yw(q),te=O?l:t.ORDER;ip("pointHex.y",ce,ui,te);const de=u(ce*ce),De=u(de-zr),Qe=u(U*de-k);let{isValid:Je,value:Me}=d(De,Qe);if(!Je)throw new Error("Point.fromHex: invalid y coordinate");const Ot=(Me&zr)===zr,an=(X&128)!==0;if(!O&&Me===ui&&an)throw new Error("Point.fromHex: x=0 and x_0=1");return an!==Ot&&(Me=u(-Me)),A.fromAffine({x:Me,y:ce})}static fromPrivateKey(C){return S(C).point}toRawBytes(){const{x:C,y:O}=this.toAffine(),U=SA(O,t.BYTES);return U[U.length-1]|=C&zr?128:0,U}toHex(){return a_(this.toRawBytes())}}A.BASE=new A(e.Gx,e.Gy,zr,u(e.Gx*e.Gy)),A.ZERO=new A(ui,zr,zr,ui);const{BASE:T,ZERO:N}=A,R=YV(A,a*8);function M(E){return En(E,r)}function D(E){return M(Yw(E))}function S(E){const C=t.BYTES;E=Po("private key",E,C);const O=Po("hashed private key",i(E),2*C),U=f(O.slice(0,C)),k=O.slice(C,2*C),j=D(U),q=T.multiply(j),X=q.toRawBytes();return{head:U,prefix:k,scalar:j,point:q,pointBytes:X}}function $(E){return S(E).pointBytes}function P(E=new Uint8Array,...C){const O=e2(...C);return D(i(p(O,Po("context",E),!!s)))}function L(E,C,O={}){E=Po("message",E),s&&(E=s(E));const{prefix:U,scalar:k,pointBytes:j}=S(C),q=P(O.context,U,E),X=T.multiply(q).toRawBytes(),ce=P(O.context,X,j,E),te=M(q+ce*k);ip("signature.s",te,ui,r);const de=e2(X,SA(te,t.BYTES));return Po("result",de,t.BYTES*2)}const V=XV;function G(E,C,O,U=V){const{context:k,zip215:j}=U,q=t.BYTES;E=Po("signature",E,2*q),C=Po("message",C),O=Po("publicKey",O,q),j!==void 0&&Uv("zip215",j),s&&(C=s(C));const X=Yw(E.slice(q,2*q));let ce,te,de;try{ce=A.fromHex(O,j),te=A.fromHex(E.slice(0,q),j),de=T.multiplyUnsafe(X)}catch{return!1}if(!j&&ce.isSmallOrder())return!1;const De=P(k,te.toRawBytes(),ce.toRawBytes(),C);return te.add(ce.multiplyUnsafe(De)).subtract(de).clearCofactor().equals(A.ZERO)}return T._setWindowSize(8),{CURVE:e,getPublicKey:$,sign:L,verify:G,ExtendedPoint:A,utils:{getExtendedPublicKey:S,randomPrivateKey:()=>o(t.BYTES),precompute(E=8,C=A.BASE){return C._setWindowSize(E),C.multiply(BigInt(3)),C}}}}BigInt(0),BigInt(1);const l_=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),o2=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752");BigInt(0);const nq=BigInt(1),a2=BigInt(2);BigInt(3);const rq=BigInt(5),sq=BigInt(8);function iq(n){const e=BigInt(10),t=BigInt(20),r=BigInt(40),s=BigInt(80),i=l_,o=n*n%i*n%i,a=Hi(o,a2,i)*o%i,c=Hi(a,nq,i)*n%i,l=Hi(c,rq,i)*c%i,u=Hi(l,e,i)*l%i,h=Hi(u,t,i)*u%i,d=Hi(h,r,i)*h%i,f=Hi(d,s,i)*d%i,p=Hi(f,s,i)*d%i,g=Hi(p,e,i)*l%i;return{pow_p_5_8:Hi(g,a2,i)*n%i,b2:o}}function oq(n){return n[0]&=248,n[31]&=127,n[31]|=64,n}function aq(n,e){const t=l_,r=En(e*e*e,t),s=En(r*r*e,t),i=iq(n*s).pow_p_5_8;let o=En(n*r*i,t);const a=En(e*o*o,t),c=o,l=En(o*o2,t),u=a===n,h=a===En(-n,t),d=a===En(-n*o2,t);return u&&(o=c),(h||d)&&(o=l),HV(o,t)&&(o=En(-o,t)),{isValid:u||h,value:o}}const cq=T3(l_,void 0,!0),lq={a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:cq,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:sq,Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:xV,randomBytes:E3,adjustScalarBytes:oq,uvRatio:aq},x3=tq(lq),uq="EdDSA",hq="JWT",N0=".",Kb="base64url",R3="utf8",P3="utf8",dq=":",fq="did",pq="key",c2="base58btc",gq="z",mq="K36",yq=32;function u_(n){return globalThis.Buffer!=null?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):n}function k3(n=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?u_(globalThis.Buffer.allocUnsafe(n)):new Uint8Array(n)}function D3(n,e){e||(e=n.reduce((s,i)=>s+i.length,0));const t=k3(e);let r=0;for(const s of n)t.set(s,r),r+=s.length;return u_(t)}function wq(n,e){if(n.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),r=0;r<t.length;r++)t[r]=255;for(var s=0;s<n.length;s++){var i=n.charAt(s),o=i.charCodeAt(0);if(t[o]!==255)throw new TypeError(i+" is ambiguous");t[o]=s}var a=n.length,c=n.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function h(p){if(p instanceof Uint8Array||(ArrayBuffer.isView(p)?p=new Uint8Array(p.buffer,p.byteOffset,p.byteLength):Array.isArray(p)&&(p=Uint8Array.from(p))),!(p instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(p.length===0)return"";for(var g=0,m=0,w=0,v=p.length;w!==v&&p[w]===0;)w++,g++;for(var A=(v-w)*u+1>>>0,T=new Uint8Array(A);w!==v;){for(var N=p[w],R=0,M=A-1;(N!==0||R<m)&&M!==-1;M--,R++)N+=256*T[M]>>>0,T[M]=N%a>>>0,N=N/a>>>0;if(N!==0)throw new Error("Non-zero carry");m=R,w++}for(var D=A-m;D!==A&&T[D]===0;)D++;for(var S=c.repeat(g);D<A;++D)S+=n.charAt(T[D]);return S}function d(p){if(typeof p!="string")throw new TypeError("Expected String");if(p.length===0)return new Uint8Array;var g=0;if(p[g]!==" "){for(var m=0,w=0;p[g]===c;)m++,g++;for(var v=(p.length-g)*l+1>>>0,A=new Uint8Array(v);p[g];){var T=t[p.charCodeAt(g)];if(T===255)return;for(var N=0,R=v-1;(T!==0||N<w)&&R!==-1;R--,N++)T+=a*A[R]>>>0,A[R]=T%256>>>0,T=T/256>>>0;if(T!==0)throw new Error("Non-zero carry");w=N,g++}if(p[g]!==" "){for(var M=v-w;M!==v&&A[M]===0;)M++;for(var D=new Uint8Array(m+(v-M)),S=m;M!==v;)D[S++]=A[M++];return D}}}function f(p){var g=d(p);if(g)return g;throw new Error(`Non-${e} character`)}return{encode:h,decodeUnsafe:d,decode:f}}var bq=wq,Eq=bq;const U3=n=>{if(n instanceof Uint8Array&&n.constructor.name==="Uint8Array")return n;if(n instanceof ArrayBuffer)return new Uint8Array(n);if(ArrayBuffer.isView(n))return new Uint8Array(n.buffer,n.byteOffset,n.byteLength);throw new Error("Unknown type, must be binary type")},vq=n=>new TextEncoder().encode(n),Aq=n=>new TextDecoder().decode(n);let Cq=class{constructor(e,t,r){this.name=e,this.prefix=t,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},Iq=class{constructor(e,t,r){if(this.name=e,this.prefix=t,t.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=r}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return $3(this,e)}},_q=class{constructor(e){this.decoders=e}or(e){return $3(this,e)}decode(e){const t=e[0],r=this.decoders[t];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}};const $3=(n,e)=>new _q({...n.decoders||{[n.prefix]:n},...e.decoders||{[e.prefix]:e}});let Sq=class{constructor(e,t,r,s){this.name=e,this.prefix=t,this.baseEncode=r,this.baseDecode=s,this.encoder=new Cq(e,t,r),this.decoder=new Iq(e,t,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}};const Yb=({name:n,prefix:e,encode:t,decode:r})=>new Sq(n,e,t,r),uy=({prefix:n,name:e,alphabet:t})=>{const{encode:r,decode:s}=Eq(t,e);return Yb({prefix:n,name:e,encode:r,decode:i=>U3(s(i))})},Tq=(n,e,t,r)=>{const s={};for(let u=0;u<e.length;++u)s[e[u]]=u;let i=n.length;for(;n[i-1]==="=";)--i;const o=new Uint8Array(i*t/8|0);let a=0,c=0,l=0;for(let u=0;u<i;++u){const h=s[n[u]];if(h===void 0)throw new SyntaxError(`Non-${r} character`);c=c<<t|h,a+=t,a>=8&&(a-=8,o[l++]=255&c>>a)}if(a>=t||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},Nq=(n,e,t)=>{const r=e[e.length-1]==="=",s=(1<<t)-1;let i="",o=0,a=0;for(let c=0;c<n.length;++c)for(a=a<<8|n[c],o+=8;o>t;)o-=t,i+=e[s&a>>o];if(o&&(i+=e[s&a<<t-o]),r)for(;i.length*t&7;)i+="=";return i},Kn=({name:n,prefix:e,bitsPerChar:t,alphabet:r})=>Yb({prefix:e,name:n,encode(s){return Nq(s,r,t)},decode(s){return Tq(s,r,t,n)}}),Oq=Yb({prefix:"\0",name:"identity",encode:n=>Aq(n),decode:n=>vq(n)});var xq=Object.freeze({__proto__:null,identity:Oq});const Rq=Kn({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var Pq=Object.freeze({__proto__:null,base2:Rq});const kq=Kn({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var Dq=Object.freeze({__proto__:null,base8:kq});const Uq=uy({prefix:"9",name:"base10",alphabet:"0123456789"});var $q=Object.freeze({__proto__:null,base10:Uq});const Mq=Kn({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Lq=Kn({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var Bq=Object.freeze({__proto__:null,base16:Mq,base16upper:Lq});const Fq=Kn({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),jq=Kn({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Hq=Kn({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Vq=Kn({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),qq=Kn({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),zq=Kn({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Wq=Kn({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Gq=Kn({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Kq=Kn({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var Yq=Object.freeze({__proto__:null,base32:Fq,base32upper:jq,base32pad:Hq,base32padupper:Vq,base32hex:qq,base32hexupper:zq,base32hexpad:Wq,base32hexpadupper:Gq,base32z:Kq});const Qq=uy({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Zq=uy({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var Jq=Object.freeze({__proto__:null,base36:Qq,base36upper:Zq});const Xq=uy({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),ez=uy({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var tz=Object.freeze({__proto__:null,base58btc:Xq,base58flickr:ez});const nz=Kn({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),rz=Kn({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),sz=Kn({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),iz=Kn({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var oz=Object.freeze({__proto__:null,base64:nz,base64pad:rz,base64url:sz,base64urlpad:iz});const M3=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),az=M3.reduce((n,e,t)=>(n[t]=e,n),[]),cz=M3.reduce((n,e,t)=>(n[e.codePointAt(0)]=t,n),[]);function lz(n){return n.reduce((e,t)=>(e+=az[t],e),"")}function uz(n){const e=[];for(const t of n){const r=cz[t.codePointAt(0)];if(r===void 0)throw new Error(`Non-base256emoji character: ${t}`);e.push(r)}return new Uint8Array(e)}const hz=Yb({prefix:"🚀",name:"base256emoji",encode:lz,decode:uz});var dz=Object.freeze({__proto__:null,base256emoji:hz}),fz=L3,l2=128,pz=127,gz=~pz,mz=Math.pow(2,31);function L3(n,e,t){e=e||[],t=t||0;for(var r=t;n>=mz;)e[t++]=n&255|l2,n/=128;for(;n&gz;)e[t++]=n&255|l2,n>>>=7;return e[t]=n|0,L3.bytes=t-r+1,e}var yz=NA,wz=128,u2=127;function NA(n,r){var t=0,r=r||0,s=0,i=r,o,a=n.length;do{if(i>=a)throw NA.bytes=0,new RangeError("Could not decode varint");o=n[i++],t+=s<28?(o&u2)<<s:(o&u2)*Math.pow(2,s),s+=7}while(o>=wz);return NA.bytes=i-r,t}var bz=Math.pow(2,7),Ez=Math.pow(2,14),vz=Math.pow(2,21),Az=Math.pow(2,28),Cz=Math.pow(2,35),Iz=Math.pow(2,42),_z=Math.pow(2,49),Sz=Math.pow(2,56),Tz=Math.pow(2,63),Nz=function(n){return n<bz?1:n<Ez?2:n<vz?3:n<Az?4:n<Cz?5:n<Iz?6:n<_z?7:n<Sz?8:n<Tz?9:10},Oz={encode:fz,decode:yz,encodingLength:Nz},B3=Oz;const h2=(n,e,t=0)=>(B3.encode(n,e,t),e),d2=n=>B3.encodingLength(n),OA=(n,e)=>{const t=e.byteLength,r=d2(n),s=r+d2(t),i=new Uint8Array(s+t);return h2(n,i,0),h2(t,i,r),i.set(e,s),new xz(n,t,e,i)};let xz=class{constructor(e,t,r,s){this.code=e,this.size=t,this.digest=r,this.bytes=s}};const F3=({name:n,code:e,encode:t})=>new Rz(n,e,t);let Rz=class{constructor(e,t,r){this.name=e,this.code=t,this.encode=r}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?OA(this.code,t):t.then(r=>OA(this.code,r))}else throw Error("Unknown type, must be binary type")}};const j3=n=>async e=>new Uint8Array(await crypto.subtle.digest(n,e)),Pz=F3({name:"sha2-256",code:18,encode:j3("SHA-256")}),kz=F3({name:"sha2-512",code:19,encode:j3("SHA-512")});var Dz=Object.freeze({__proto__:null,sha256:Pz,sha512:kz});const H3=0,Uz="identity",V3=U3,$z=n=>OA(H3,V3(n)),Mz={code:H3,name:Uz,encode:V3,digest:$z};var Lz=Object.freeze({__proto__:null,identity:Mz});new TextEncoder,new TextDecoder;const f2={...xq,...Pq,...Dq,...$q,...Bq,...Yq,...Jq,...tz,...oz,...dz};({...Dz,...Lz});function q3(n,e,t,r){return{name:n,prefix:e,encoder:{name:n,prefix:e,encode:t},decoder:{decode:r}}}const p2=q3("utf8","u",n=>"u"+new TextDecoder("utf8").decode(n),n=>new TextEncoder().encode(n.substring(1))),jv=q3("ascii","a",n=>{let e="a";for(let t=0;t<n.length;t++)e+=String.fromCharCode(n[t]);return e},n=>{n=n.substring(1);const e=k3(n.length);for(let t=0;t<n.length;t++)e[t]=n.charCodeAt(t);return e}),z3={utf8:p2,"utf-8":p2,hex:f2.base16,latin1:jv,ascii:jv,binary:jv,...f2};function Qb(n,e="utf8"){const t=z3[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(n.buffer,n.byteOffset,n.byteLength).toString("utf8"):t.encoder.encode(n).substring(1)}function Pf(n,e="utf8"){const t=z3[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?u_(globalThis.Buffer.from(n,"utf-8")):t.decoder.decode(`${t.prefix}${n}`)}function g2(n){return fu(Qb(Pf(n,Kb),R3))}function O0(n){return Qb(Pf(ma(n),R3),Kb)}function W3(n){const e=Pf(mq,c2),t=gq+Qb(D3([e,n]),c2);return[fq,pq,t].join(dq)}function Bz(n){return Qb(n,Kb)}function Fz(n){return Pf(n,Kb)}function jz(n){return Pf([O0(n.header),O0(n.payload)].join(N0),P3)}function Hz(n){return[O0(n.header),O0(n.payload),Bz(n.signature)].join(N0)}function xA(n){const e=n.split(N0),t=g2(e[0]),r=g2(e[1]),s=Fz(e[2]),i=Pf(e.slice(0,2).join(N0),P3);return{header:t,payload:r,signature:s,data:i}}function m2(n=E3(yq)){const e=x3.getPublicKey(n);return{secretKey:D3([n,e]),publicKey:e}}async function Vz(n,e,t,r,s=ne.fromMiliseconds(Date.now())){const i={alg:uq,typ:hq},o=W3(r.publicKey),a=s+t,c={iss:o,sub:n,aud:e,iat:s,exp:a},l=jz({header:i,payload:c}),u=x3.sign(l,r.secretKey.slice(0,32));return Hz({header:i,payload:c,signature:u})}var y2=function(n,e,t){if(t||arguments.length===2)for(var r=0,s=e.length,i;r<s;r++)(i||!(r in e))&&(i||(i=Array.prototype.slice.call(e,0,r)),i[r]=e[r]);return n.concat(i||Array.prototype.slice.call(e))},qz=function(){function n(e,t,r){this.name=e,this.version=t,this.os=r,this.type="browser"}return n}(),zz=function(){function n(e){this.version=e,this.type="node",this.name="node",this.os=process.platform}return n}(),Wz=function(){function n(e,t,r,s){this.name=e,this.version=t,this.os=r,this.bot=s,this.type="bot-device"}return n}(),Gz=function(){function n(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}return n}(),Kz=function(){function n(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}return n}(),Yz=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,Qz=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,w2=3,Zz=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",Yz]],b2=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function Jz(n){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"?new Kz:typeof navigator<"u"?eW(navigator.userAgent):nW()}function Xz(n){return n!==""&&Zz.reduce(function(e,t){var r=t[0],s=t[1];if(e)return e;var i=s.exec(n);return!!i&&[r,i]},!1)}function eW(n){var e=Xz(n);if(!e)return null;var t=e[0],r=e[1];if(t==="searchbot")return new Gz;var s=r[1]&&r[1].split(".").join("_").split("_").slice(0,3);s?s.length<w2&&(s=y2(y2([],s,!0),rW(w2-s.length),!0)):s=[];var i=s.join("."),o=tW(n),a=Qz.exec(n);return a&&a[1]?new Wz(t,i,o,a[1]):new qz(t,i,o)}function tW(n){for(var e=0,t=b2.length;e<t;e++){var r=b2[e],s=r[0],i=r[1],o=i.exec(n);if(o)return s}return null}function nW(){var n=typeof process<"u"&&process.version;return n?new zz(process.version.slice(1)):null}function rW(n){for(var e=[],t=0;t<n;t++)e.push("0");return e}var Mt={};Object.defineProperty(Mt,"__esModule",{value:!0});Mt.getLocalStorage=Mt.getLocalStorageOrThrow=Mt.getCrypto=Mt.getCryptoOrThrow=G3=Mt.getLocation=Mt.getLocationOrThrow=h_=Mt.getNavigator=Mt.getNavigatorOrThrow=pu=Mt.getDocument=Mt.getDocumentOrThrow=Mt.getFromWindowOrThrow=Mt.getFromWindow=void 0;function ju(n){let e;return typeof window<"u"&&typeof window[n]<"u"&&(e=window[n]),e}Mt.getFromWindow=ju;function kf(n){const e=ju(n);if(!e)throw new Error(`${n} is not defined in Window`);return e}Mt.getFromWindowOrThrow=kf;function sW(){return kf("document")}Mt.getDocumentOrThrow=sW;function iW(){return ju("document")}var pu=Mt.getDocument=iW;function oW(){return kf("navigator")}Mt.getNavigatorOrThrow=oW;function aW(){return ju("navigator")}var h_=Mt.getNavigator=aW;function cW(){return kf("location")}Mt.getLocationOrThrow=cW;function lW(){return ju("location")}var G3=Mt.getLocation=lW;function uW(){return kf("crypto")}Mt.getCryptoOrThrow=uW;function hW(){return ju("crypto")}Mt.getCrypto=hW;function dW(){return kf("localStorage")}Mt.getLocalStorageOrThrow=dW;function fW(){return ju("localStorage")}Mt.getLocalStorage=fW;var d_={};Object.defineProperty(d_,"__esModule",{value:!0});var K3=d_.getWindowMetadata=void 0;const E2=Mt;function pW(){let n,e;try{n=E2.getDocumentOrThrow(),e=E2.getLocationOrThrow()}catch{return null}function t(){const h=n.getElementsByTagName("link"),d=[];for(let f=0;f<h.length;f++){const p=h[f],g=p.getAttribute("rel");if(g&&g.toLowerCase().indexOf("icon")>-1){const m=p.getAttribute("href");if(m)if(m.toLowerCase().indexOf("https:")===-1&&m.toLowerCase().indexOf("http:")===-1&&m.indexOf("//")!==0){let w=e.protocol+"//"+e.host;if(m.indexOf("/")===0)w+=m;else{const v=e.pathname.split("/");v.pop();const A=v.join("/");w+=A+"/"+m}d.push(w)}else if(m.indexOf("//")===0){const w=e.protocol+m;d.push(w)}else d.push(m)}}return d}function r(...h){const d=n.getElementsByTagName("meta");for(let f=0;f<d.length;f++){const p=d[f],g=["itemprop","property","name"].map(m=>p.getAttribute(m)).filter(m=>m?h.includes(m):!1);if(g.length&&g){const m=p.getAttribute("content");if(m)return m}}return""}function s(){let h=r("name","og:site_name","og:title","twitter:title");return h||(h=n.title),h}function i(){return r("description","og:description","twitter:description","keywords")}const o=s(),a=i(),c=e.origin,l=t();return{description:a,url:c,icons:l,name:o}}K3=d_.getWindowMetadata=pW;function Fg(n,{strict:e=!0}={}){return!n||typeof n!="string"?!1:e?/^0x[0-9a-fA-F]*$/.test(n):n.startsWith("0x")}function RA(n){return Fg(n,{strict:!1})?Math.ceil((n.length-2)/2):n.length}const Y3="2.31.0";let op={getDocsUrl:({docsBaseUrl:n,docsPath:e="",docsSlug:t})=>e?`${n??"https://viem.sh"}${e}${t?`#${t}`:""}`:void 0,version:`viem@${Y3}`};class gu extends Error{constructor(e,t={}){var a;const r=(()=>{var c;return t.cause instanceof gu?t.cause.details:(c=t.cause)!=null&&c.message?t.cause.message:t.details})(),s=t.cause instanceof gu&&t.cause.docsPath||t.docsPath,i=(a=op.getDocsUrl)==null?void 0:a.call(op,{...t,docsPath:s}),o=[e||"An error occurred.","",...t.metaMessages?[...t.metaMessages,""]:[],...i?[`Docs: ${i}`]:[],...r?[`Details: ${r}`]:[],...op.version?[`Version: ${op.version}`]:[]].join(`
`);super(o,t.cause?{cause:t.cause}:void 0),Object.defineProperty(this,"details",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docsPath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metaMessages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shortMessage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"version",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"BaseError"}),this.details=r,this.docsPath=s,this.metaMessages=t.metaMessages,this.name=t.name??this.name,this.shortMessage=e,this.version=Y3}walk(e){return Q3(this,e)}}function Q3(n,e){return e!=null&&e(n)?n:n&&typeof n=="object"&&"cause"in n&&n.cause!==void 0?Q3(n.cause,e):e?null:n}class Z3 extends gu{constructor({size:e,targetSize:t,type:r}){super(`${r.charAt(0).toUpperCase()}${r.slice(1).toLowerCase()} size (${e}) exceeds padding size (${t}).`,{name:"SizeExceedsPaddingSizeError"})}}function Df(n,{dir:e,size:t=32}={}){return typeof n=="string"?gW(n,{dir:e,size:t}):mW(n,{dir:e,size:t})}function gW(n,{dir:e,size:t=32}={}){if(t===null)return n;const r=n.replace("0x","");if(r.length>t*2)throw new Z3({size:Math.ceil(r.length/2),targetSize:t,type:"hex"});return`0x${r[e==="right"?"padEnd":"padStart"](t*2,"0")}`}function mW(n,{dir:e,size:t=32}={}){if(t===null)return n;if(n.length>t)throw new Z3({size:n.length,targetSize:t,type:"bytes"});const r=new Uint8Array(t);for(let s=0;s<t;s++){const i=e==="right";r[i?s:t-s-1]=n[i?s:n.length-s-1]}return r}class yW extends gu{constructor({max:e,min:t,signed:r,size:s,value:i}){super(`Number "${i}" is not in safe ${s?`${s*8}-bit ${r?"signed":"unsigned"} `:""}integer range ${e?`(${t} to ${e})`:`(above ${t})`}`,{name:"IntegerOutOfRangeError"})}}class wW extends gu{constructor({givenSize:e,maxSize:t}){super(`Size cannot exceed ${t} bytes. Given size: ${e} bytes.`,{name:"SizeOverflowError"})}}function Uf(n,{size:e}){if(RA(n)>e)throw new wW({givenSize:RA(n),maxSize:e})}function PA(n,e={}){const{signed:t}=e;e.size&&Uf(n,{size:e.size});const r=BigInt(n);if(!t)return r;const s=(n.length-2)/2,i=(1n<<BigInt(s)*8n-1n)-1n;return r<=i?r:r-BigInt(`0x${"f".padStart(s*2,"f")}`)-1n}function bW(n,e={}){return Number(PA(n,e))}const EW=Array.from({length:256},(n,e)=>e.toString(16).padStart(2,"0"));function kA(n,e={}){return typeof n=="number"||typeof n=="bigint"?X3(n,e):typeof n=="string"?CW(n,e):typeof n=="boolean"?vW(n,e):J3(n,e)}function vW(n,e={}){const t=`0x${Number(n)}`;return typeof e.size=="number"?(Uf(t,{size:e.size}),Df(t,{size:e.size})):t}function J3(n,e={}){let t="";for(let s=0;s<n.length;s++)t+=EW[n[s]];const r=`0x${t}`;return typeof e.size=="number"?(Uf(r,{size:e.size}),Df(r,{dir:"right",size:e.size})):r}function X3(n,e={}){const{signed:t,size:r}=e,s=BigInt(n);let i;r?t?i=(1n<<BigInt(r)*8n-1n)-1n:i=2n**(BigInt(r)*8n)-1n:typeof n=="number"&&(i=BigInt(Number.MAX_SAFE_INTEGER));const o=typeof i=="bigint"&&t?-i-1n:0;if(i&&s>i||s<o){const c=typeof n=="bigint"?"n":"";throw new yW({max:i?`${i}${c}`:void 0,min:`${o}${c}`,signed:t,size:r,value:`${n}${c}`})}const a=`0x${(t&&s<0?(1n<<BigInt(r*8))+BigInt(s):s).toString(16)}`;return r?Df(a,{size:r}):a}const AW=new TextEncoder;function CW(n,e={}){const t=AW.encode(n);return J3(t,e)}const IW=new TextEncoder;function _W(n,e={}){return typeof n=="number"||typeof n=="bigint"?TW(n,e):typeof n=="boolean"?SW(n,e):Fg(n)?eU(n,e):tU(n,e)}function SW(n,e={}){const t=new Uint8Array(1);return t[0]=Number(n),typeof e.size=="number"?(Uf(t,{size:e.size}),Df(t,{size:e.size})):t}const ko={zero:48,nine:57,A:65,F:70,a:97,f:102};function v2(n){if(n>=ko.zero&&n<=ko.nine)return n-ko.zero;if(n>=ko.A&&n<=ko.F)return n-(ko.A-10);if(n>=ko.a&&n<=ko.f)return n-(ko.a-10)}function eU(n,e={}){let t=n;e.size&&(Uf(t,{size:e.size}),t=Df(t,{dir:"right",size:e.size}));let r=t.slice(2);r.length%2&&(r=`0${r}`);const s=r.length/2,i=new Uint8Array(s);for(let o=0,a=0;o<s;o++){const c=v2(r.charCodeAt(a++)),l=v2(r.charCodeAt(a++));if(c===void 0||l===void 0)throw new gu(`Invalid byte sequence ("${r[a-2]}${r[a-1]}" in "${r}").`);i[o]=c*16+l}return i}function TW(n,e){const t=X3(n,e);return eU(t)}function tU(n,e={}){const t=IW.encode(n);return typeof e.size=="number"?(Uf(t,{size:e.size}),Df(t,{dir:"right",size:e.size})):t}function nU(n,e){const t=e||"hex",r=A7(Fg(n,{strict:!1})?_W(n):n);return t==="bytes"?r:kA(r)}class NW extends Map{constructor(e){super(),Object.defineProperty(this,"maxSize",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxSize=e}get(e){const t=super.get(e);return super.has(e)&&t!==void 0&&(this.delete(e),super.set(e,t)),t}set(e,t){if(super.set(e,t),this.maxSize&&this.size>this.maxSize){const r=this.keys().next().value;r&&this.delete(r)}return this}}const Hv=new NW(8192);function OW(n,e){if(Hv.has(`${n}.${e}`))return Hv.get(`${n}.${e}`);const t=n.substring(2).toLowerCase(),r=nU(tU(t),"bytes"),s=t.split("");for(let o=0;o<40;o+=2)r[o>>1]>>4>=8&&s[o]&&(s[o]=s[o].toUpperCase()),(r[o>>1]&15)>=8&&s[o+1]&&(s[o+1]=s[o+1].toUpperCase());const i=`0x${s.join("")}`;return Hv.set(`${n}.${e}`,i),i}function xW(n){const e=nU(`0x${n.substring(4)}`).substring(26);return OW(`0x${e}`)}async function RW({hash:n,signature:e}){const t=Fg(n)?n:kA(n),{secp256k1:r}=await Sn(()=>import("./CdyUX1yU.js"),__vite__mapDeps([0,1,2,3]),import.meta.url);return`0x${(()=>{if(typeof e=="object"&&"r"in e&&"s"in e){const{r:l,s:u,v:h,yParity:d}=e,f=Number(d??h),p=A2(f);return new r.Signature(PA(l),PA(u)).addRecoveryBit(p)}const o=Fg(e)?e:kA(e);if(RA(o)!==65)throw new Error("invalid signature length");const a=bW(`0x${o.slice(130)}`),c=A2(a);return r.Signature.fromCompact(o.substring(2,130)).addRecoveryBit(c)})().recoverPublicKey(t.substring(2)).toHex(!1)}`}function A2(n){if(n===0||n===1)return n;if(n===27)return 0;if(n===28)return 1;throw new Error("Invalid yParityOrV value")}async function PW({hash:n,signature:e}){return xW(await RW({hash:n,signature:e}))}function kW(n){if(n.length>=255)throw new TypeError("Alphabet too long");const e=new Uint8Array(256);for(let l=0;l<e.length;l++)e[l]=255;for(let l=0;l<n.length;l++){const u=n.charAt(l),h=u.charCodeAt(0);if(e[h]!==255)throw new TypeError(u+" is ambiguous");e[h]=l}const t=n.length,r=n.charAt(0),s=Math.log(t)/Math.log(256),i=Math.log(256)/Math.log(t);function o(l){if(l instanceof Uint8Array||(ArrayBuffer.isView(l)?l=new Uint8Array(l.buffer,l.byteOffset,l.byteLength):Array.isArray(l)&&(l=Uint8Array.from(l))),!(l instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(l.length===0)return"";let u=0,h=0,d=0;const f=l.length;for(;d!==f&&l[d]===0;)d++,u++;const p=(f-d)*i+1>>>0,g=new Uint8Array(p);for(;d!==f;){let v=l[d],A=0;for(let T=p-1;(v!==0||A<h)&&T!==-1;T--,A++)v+=256*g[T]>>>0,g[T]=v%t>>>0,v=v/t>>>0;if(v!==0)throw new Error("Non-zero carry");h=A,d++}let m=p-h;for(;m!==p&&g[m]===0;)m++;let w=r.repeat(u);for(;m<p;++m)w+=n.charAt(g[m]);return w}function a(l){if(typeof l!="string")throw new TypeError("Expected String");if(l.length===0)return new Uint8Array;let u=0,h=0,d=0;for(;l[u]===r;)h++,u++;const f=(l.length-u)*s+1>>>0,p=new Uint8Array(f);for(;u<l.length;){const v=l.charCodeAt(u);if(v>255)return;let A=e[v];if(A===255)return;let T=0;for(let N=f-1;(A!==0||T<d)&&N!==-1;N--,T++)A+=t*p[N]>>>0,p[N]=A%256>>>0,A=A/256>>>0;if(A!==0)throw new Error("Non-zero carry");d=T,u++}let g=f-d;for(;g!==f&&p[g]===0;)g++;const m=new Uint8Array(h+(f-g));let w=h;for(;g!==f;)m[w++]=p[g++];return m}function c(l){const u=a(l);if(u)return u;throw new Error("Non-base"+t+" character")}return{encode:o,decodeUnsafe:a,decode:c}}var DW="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";const $f=kW(DW);function UW(n){const e=n.length;let t=0,r=0;for(;r<e;){let s=n.charCodeAt(r++);if(s&4294967168)if(!(s&4294965248))t+=2;else{if(s>=55296&&s<=56319&&r<e){const i=n.charCodeAt(r);(i&64512)===56320&&(++r,s=((s&1023)<<10)+(i&1023)+65536)}s&4294901760?t+=4:t+=3}else{t++;continue}}return t}function $W(n,e,t){const r=n.length;let s=t,i=0;for(;i<r;){let o=n.charCodeAt(i++);if(o&4294967168)if(!(o&4294965248))e[s++]=o>>6&31|192;else{if(o>=55296&&o<=56319&&i<r){const a=n.charCodeAt(i);(a&64512)===56320&&(++i,o=((o&1023)<<10)+(a&1023)+65536)}o&4294901760?(e[s++]=o>>18&7|240,e[s++]=o>>12&63|128,e[s++]=o>>6&63|128):(e[s++]=o>>12&15|224,e[s++]=o>>6&63|128)}else{e[s++]=o;continue}e[s++]=o&63|128}}const MW=new TextEncoder,LW=50;function BW(n,e,t){MW.encodeInto(n,e.subarray(t))}function FW(n,e,t){n.length>LW?BW(n,e,t):$W(n,e,t)}const jW=4096;function rU(n,e,t){let r=e;const s=r+t,i=[];let o="";for(;r<s;){const a=n[r++];if(!(a&128))i.push(a);else if((a&224)===192){const c=n[r++]&63;i.push((a&31)<<6|c)}else if((a&240)===224){const c=n[r++]&63,l=n[r++]&63;i.push((a&31)<<12|c<<6|l)}else if((a&248)===240){const c=n[r++]&63,l=n[r++]&63,u=n[r++]&63;let h=(a&7)<<18|c<<12|l<<6|u;h>65535&&(h-=65536,i.push(h>>>10&1023|55296),h=56320|h&1023),i.push(h)}else i.push(a);i.length>=jW&&(o+=String.fromCharCode(...i),i.length=0)}return i.length>0&&(o+=String.fromCharCode(...i)),o}const HW=new TextDecoder,VW=200;function qW(n,e,t){const r=n.subarray(e,e+t);return HW.decode(r)}function zW(n,e,t){return t>VW?qW(n,e,t):rU(n,e,t)}class cw{constructor(e,t){this.type=e,this.data=t}}class As extends Error{constructor(e){super(e);const t=Object.create(As.prototype);Object.setPrototypeOf(this,t),Object.defineProperty(this,"name",{configurable:!0,enumerable:!1,value:As.name})}}const ap=4294967295;function WW(n,e,t){const r=t/4294967296,s=t;n.setUint32(e,r),n.setUint32(e+4,s)}function sU(n,e,t){const r=Math.floor(t/4294967296),s=t;n.setUint32(e,r),n.setUint32(e+4,s)}function iU(n,e){const t=n.getInt32(e),r=n.getUint32(e+4);return t*4294967296+r}function GW(n,e){const t=n.getUint32(e),r=n.getUint32(e+4);return t*4294967296+r}const KW=-1,YW=4294967296-1,QW=17179869184-1;function ZW({sec:n,nsec:e}){if(n>=0&&e>=0&&n<=QW)if(e===0&&n<=YW){const t=new Uint8Array(4);return new DataView(t.buffer).setUint32(0,n),t}else{const t=n/4294967296,r=n&4294967295,s=new Uint8Array(8),i=new DataView(s.buffer);return i.setUint32(0,e<<2|t&3),i.setUint32(4,r),s}else{const t=new Uint8Array(12),r=new DataView(t.buffer);return r.setUint32(0,e),sU(r,4,n),t}}function JW(n){const e=n.getTime(),t=Math.floor(e/1e3),r=(e-t*1e3)*1e6,s=Math.floor(r/1e9);return{sec:t+s,nsec:r-s*1e9}}function XW(n){if(n instanceof Date){const e=JW(n);return ZW(e)}else return null}function eG(n){const e=new DataView(n.buffer,n.byteOffset,n.byteLength);switch(n.byteLength){case 4:return{sec:e.getUint32(0),nsec:0};case 8:{const t=e.getUint32(0),r=e.getUint32(4),s=(t&3)*4294967296+r,i=t>>>2;return{sec:s,nsec:i}}case 12:{const t=iU(e,4),r=e.getUint32(0);return{sec:t,nsec:r}}default:throw new As(`Unrecognized data size for timestamp (expected 4, 8, or 12): ${n.length}`)}}function tG(n){const e=eG(n);return new Date(e.sec*1e3+e.nsec/1e6)}const nG={type:KW,encode:XW,decode:tG};class x0{constructor(){this.builtInEncoders=[],this.builtInDecoders=[],this.encoders=[],this.decoders=[],this.register(nG)}register({type:e,encode:t,decode:r}){if(e>=0)this.encoders[e]=t,this.decoders[e]=r;else{const s=-1-e;this.builtInEncoders[s]=t,this.builtInDecoders[s]=r}}tryToEncode(e,t){for(let r=0;r<this.builtInEncoders.length;r++){const s=this.builtInEncoders[r];if(s!=null){const i=s(e,t);if(i!=null){const o=-1-r;return new cw(o,i)}}}for(let r=0;r<this.encoders.length;r++){const s=this.encoders[r];if(s!=null){const i=s(e,t);if(i!=null){const o=r;return new cw(o,i)}}}return e instanceof cw?e:null}decode(e,t,r){const s=t<0?this.builtInDecoders[-1-t]:this.decoders[t];return s?s(e,t,r):new cw(t,e)}}x0.defaultCodec=new x0;function rG(n){return n instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&n instanceof SharedArrayBuffer}function DA(n){return n instanceof Uint8Array?n:ArrayBuffer.isView(n)?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):rG(n)?new Uint8Array(n):Uint8Array.from(n)}const sG=100,iG=2048;let oG=class oU{constructor(e){this.entered=!1,this.extensionCodec=(e==null?void 0:e.extensionCodec)??x0.defaultCodec,this.context=e==null?void 0:e.context,this.useBigInt64=(e==null?void 0:e.useBigInt64)??!1,this.maxDepth=(e==null?void 0:e.maxDepth)??sG,this.initialBufferSize=(e==null?void 0:e.initialBufferSize)??iG,this.sortKeys=(e==null?void 0:e.sortKeys)??!1,this.forceFloat32=(e==null?void 0:e.forceFloat32)??!1,this.ignoreUndefined=(e==null?void 0:e.ignoreUndefined)??!1,this.forceIntegerToFloat=(e==null?void 0:e.forceIntegerToFloat)??!1,this.pos=0,this.view=new DataView(new ArrayBuffer(this.initialBufferSize)),this.bytes=new Uint8Array(this.view.buffer)}clone(){return new oU({extensionCodec:this.extensionCodec,context:this.context,useBigInt64:this.useBigInt64,maxDepth:this.maxDepth,initialBufferSize:this.initialBufferSize,sortKeys:this.sortKeys,forceFloat32:this.forceFloat32,ignoreUndefined:this.ignoreUndefined,forceIntegerToFloat:this.forceIntegerToFloat})}reinitializeState(){this.pos=0}encodeSharedRef(e){if(this.entered)return this.clone().encodeSharedRef(e);try{return this.entered=!0,this.reinitializeState(),this.doEncode(e,1),this.bytes.subarray(0,this.pos)}finally{this.entered=!1}}encode(e){if(this.entered)return this.clone().encode(e);try{return this.entered=!0,this.reinitializeState(),this.doEncode(e,1),this.bytes.slice(0,this.pos)}finally{this.entered=!1}}doEncode(e,t){if(t>this.maxDepth)throw new Error(`Too deep objects in depth ${t}`);e==null?this.encodeNil():typeof e=="boolean"?this.encodeBoolean(e):typeof e=="number"?this.forceIntegerToFloat?this.encodeNumberAsFloat(e):this.encodeNumber(e):typeof e=="string"?this.encodeString(e):this.useBigInt64&&typeof e=="bigint"?this.encodeBigInt64(e):this.encodeObject(e,t)}ensureBufferSizeToWrite(e){const t=this.pos+e;this.view.byteLength<t&&this.resizeBuffer(t*2)}resizeBuffer(e){const t=new ArrayBuffer(e),r=new Uint8Array(t),s=new DataView(t);r.set(this.bytes),this.view=s,this.bytes=r}encodeNil(){this.writeU8(192)}encodeBoolean(e){e===!1?this.writeU8(194):this.writeU8(195)}encodeNumber(e){!this.forceIntegerToFloat&&Number.isSafeInteger(e)?e>=0?e<128?this.writeU8(e):e<256?(this.writeU8(204),this.writeU8(e)):e<65536?(this.writeU8(205),this.writeU16(e)):e<4294967296?(this.writeU8(206),this.writeU32(e)):this.useBigInt64?this.encodeNumberAsFloat(e):(this.writeU8(207),this.writeU64(e)):e>=-32?this.writeU8(224|e+32):e>=-128?(this.writeU8(208),this.writeI8(e)):e>=-32768?(this.writeU8(209),this.writeI16(e)):e>=-2147483648?(this.writeU8(210),this.writeI32(e)):this.useBigInt64?this.encodeNumberAsFloat(e):(this.writeU8(211),this.writeI64(e)):this.encodeNumberAsFloat(e)}encodeNumberAsFloat(e){this.forceFloat32?(this.writeU8(202),this.writeF32(e)):(this.writeU8(203),this.writeF64(e))}encodeBigInt64(e){e>=BigInt(0)?(this.writeU8(207),this.writeBigUint64(e)):(this.writeU8(211),this.writeBigInt64(e))}writeStringHeader(e){if(e<32)this.writeU8(160+e);else if(e<256)this.writeU8(217),this.writeU8(e);else if(e<65536)this.writeU8(218),this.writeU16(e);else if(e<4294967296)this.writeU8(219),this.writeU32(e);else throw new Error(`Too long string: ${e} bytes in UTF-8`)}encodeString(e){const r=UW(e);this.ensureBufferSizeToWrite(5+r),this.writeStringHeader(r),FW(e,this.bytes,this.pos),this.pos+=r}encodeObject(e,t){const r=this.extensionCodec.tryToEncode(e,this.context);if(r!=null)this.encodeExtension(r);else if(Array.isArray(e))this.encodeArray(e,t);else if(ArrayBuffer.isView(e))this.encodeBinary(e);else if(typeof e=="object")this.encodeMap(e,t);else throw new Error(`Unrecognized object: ${Object.prototype.toString.apply(e)}`)}encodeBinary(e){const t=e.byteLength;if(t<256)this.writeU8(196),this.writeU8(t);else if(t<65536)this.writeU8(197),this.writeU16(t);else if(t<4294967296)this.writeU8(198),this.writeU32(t);else throw new Error(`Too large binary: ${t}`);const r=DA(e);this.writeU8a(r)}encodeArray(e,t){const r=e.length;if(r<16)this.writeU8(144+r);else if(r<65536)this.writeU8(220),this.writeU16(r);else if(r<4294967296)this.writeU8(221),this.writeU32(r);else throw new Error(`Too large array: ${r}`);for(const s of e)this.doEncode(s,t+1)}countWithoutUndefined(e,t){let r=0;for(const s of t)e[s]!==void 0&&r++;return r}encodeMap(e,t){const r=Object.keys(e);this.sortKeys&&r.sort();const s=this.ignoreUndefined?this.countWithoutUndefined(e,r):r.length;if(s<16)this.writeU8(128+s);else if(s<65536)this.writeU8(222),this.writeU16(s);else if(s<4294967296)this.writeU8(223),this.writeU32(s);else throw new Error(`Too large map object: ${s}`);for(const i of r){const o=e[i];this.ignoreUndefined&&o===void 0||(this.encodeString(i),this.doEncode(o,t+1))}}encodeExtension(e){if(typeof e.data=="function"){const r=e.data(this.pos+6),s=r.length;if(s>=4294967296)throw new Error(`Too large extension object: ${s}`);this.writeU8(201),this.writeU32(s),this.writeI8(e.type),this.writeU8a(r);return}const t=e.data.length;if(t===1)this.writeU8(212);else if(t===2)this.writeU8(213);else if(t===4)this.writeU8(214);else if(t===8)this.writeU8(215);else if(t===16)this.writeU8(216);else if(t<256)this.writeU8(199),this.writeU8(t);else if(t<65536)this.writeU8(200),this.writeU16(t);else if(t<4294967296)this.writeU8(201),this.writeU32(t);else throw new Error(`Too large extension object: ${t}`);this.writeI8(e.type),this.writeU8a(e.data)}writeU8(e){this.ensureBufferSizeToWrite(1),this.view.setUint8(this.pos,e),this.pos++}writeU8a(e){const t=e.length;this.ensureBufferSizeToWrite(t),this.bytes.set(e,this.pos),this.pos+=t}writeI8(e){this.ensureBufferSizeToWrite(1),this.view.setInt8(this.pos,e),this.pos++}writeU16(e){this.ensureBufferSizeToWrite(2),this.view.setUint16(this.pos,e),this.pos+=2}writeI16(e){this.ensureBufferSizeToWrite(2),this.view.setInt16(this.pos,e),this.pos+=2}writeU32(e){this.ensureBufferSizeToWrite(4),this.view.setUint32(this.pos,e),this.pos+=4}writeI32(e){this.ensureBufferSizeToWrite(4),this.view.setInt32(this.pos,e),this.pos+=4}writeF32(e){this.ensureBufferSizeToWrite(4),this.view.setFloat32(this.pos,e),this.pos+=4}writeF64(e){this.ensureBufferSizeToWrite(8),this.view.setFloat64(this.pos,e),this.pos+=8}writeU64(e){this.ensureBufferSizeToWrite(8),WW(this.view,this.pos,e),this.pos+=8}writeI64(e){this.ensureBufferSizeToWrite(8),sU(this.view,this.pos,e),this.pos+=8}writeBigUint64(e){this.ensureBufferSizeToWrite(8),this.view.setBigUint64(this.pos,e),this.pos+=8}writeBigInt64(e){this.ensureBufferSizeToWrite(8),this.view.setBigInt64(this.pos,e),this.pos+=8}};function aG(n,e){return new oG(e).encodeSharedRef(n)}function Vv(n){return`${n<0?"-":""}0x${Math.abs(n).toString(16).padStart(2,"0")}`}const cG=16,lG=16;class uG{constructor(e=cG,t=lG){this.hit=0,this.miss=0,this.maxKeyLength=e,this.maxLengthPerKey=t,this.caches=[];for(let r=0;r<this.maxKeyLength;r++)this.caches.push([])}canBeCached(e){return e>0&&e<=this.maxKeyLength}find(e,t,r){const s=this.caches[r-1];e:for(const i of s){const o=i.bytes;for(let a=0;a<r;a++)if(o[a]!==e[t+a])continue e;return i.str}return null}store(e,t){const r=this.caches[e.length-1],s={bytes:e,str:t};r.length>=this.maxLengthPerKey?r[Math.random()*r.length|0]=s:r.push(s)}decode(e,t,r){const s=this.find(e,t,r);if(s!=null)return this.hit++,s;this.miss++;const i=rU(e,t,r),o=Uint8Array.prototype.slice.call(e,t,t+r);return this.store(o,i),i}}const UA="array",Wp="map_key",aU="map_value",hG=n=>{if(typeof n=="string"||typeof n=="number")return n;throw new As("The type of key must be string or number but "+typeof n)};class dG{constructor(){this.stack=[],this.stackHeadPosition=-1}get length(){return this.stackHeadPosition+1}top(){return this.stack[this.stackHeadPosition]}pushArrayState(e){const t=this.getUninitializedStateFromPool();t.type=UA,t.position=0,t.size=e,t.array=new Array(e)}pushMapState(e){const t=this.getUninitializedStateFromPool();t.type=Wp,t.readCount=0,t.size=e,t.map={}}getUninitializedStateFromPool(){if(this.stackHeadPosition++,this.stackHeadPosition===this.stack.length){const e={type:void 0,size:0,array:void 0,position:0,readCount:0,map:void 0,key:null};this.stack.push(e)}return this.stack[this.stackHeadPosition]}release(e){if(this.stack[this.stackHeadPosition]!==e)throw new Error("Invalid stack state. Released state is not on top of the stack.");if(e.type===UA){const r=e;r.size=0,r.array=void 0,r.position=0,r.type=void 0}if(e.type===Wp||e.type===aU){const r=e;r.size=0,r.map=void 0,r.readCount=0,r.type=void 0}this.stackHeadPosition--}reset(){this.stack.length=0,this.stackHeadPosition=-1}}const cp=-1,f_=new DataView(new ArrayBuffer(0)),fG=new Uint8Array(f_.buffer);try{f_.getInt8(0)}catch(n){if(!(n instanceof RangeError))throw new Error("This module is not supported in the current JavaScript engine because DataView does not throw RangeError on out-of-bounds access")}const C2=new RangeError("Insufficient data"),pG=new uG;let gG=class cU{constructor(e){this.totalPos=0,this.pos=0,this.view=f_,this.bytes=fG,this.headByte=cp,this.stack=new dG,this.entered=!1,this.extensionCodec=(e==null?void 0:e.extensionCodec)??x0.defaultCodec,this.context=e==null?void 0:e.context,this.useBigInt64=(e==null?void 0:e.useBigInt64)??!1,this.rawStrings=(e==null?void 0:e.rawStrings)??!1,this.maxStrLength=(e==null?void 0:e.maxStrLength)??ap,this.maxBinLength=(e==null?void 0:e.maxBinLength)??ap,this.maxArrayLength=(e==null?void 0:e.maxArrayLength)??ap,this.maxMapLength=(e==null?void 0:e.maxMapLength)??ap,this.maxExtLength=(e==null?void 0:e.maxExtLength)??ap,this.keyDecoder=(e==null?void 0:e.keyDecoder)!==void 0?e.keyDecoder:pG,this.mapKeyConverter=(e==null?void 0:e.mapKeyConverter)??hG}clone(){return new cU({extensionCodec:this.extensionCodec,context:this.context,useBigInt64:this.useBigInt64,rawStrings:this.rawStrings,maxStrLength:this.maxStrLength,maxBinLength:this.maxBinLength,maxArrayLength:this.maxArrayLength,maxMapLength:this.maxMapLength,maxExtLength:this.maxExtLength,keyDecoder:this.keyDecoder})}reinitializeState(){this.totalPos=0,this.headByte=cp,this.stack.reset()}setBuffer(e){const t=DA(e);this.bytes=t,this.view=new DataView(t.buffer,t.byteOffset,t.byteLength),this.pos=0}appendBuffer(e){if(this.headByte===cp&&!this.hasRemaining(1))this.setBuffer(e);else{const t=this.bytes.subarray(this.pos),r=DA(e),s=new Uint8Array(t.length+r.length);s.set(t),s.set(r,t.length),this.setBuffer(s)}}hasRemaining(e){return this.view.byteLength-this.pos>=e}createExtraByteError(e){const{view:t,pos:r}=this;return new RangeError(`Extra ${t.byteLength-r} of ${t.byteLength} byte(s) found at buffer[${e}]`)}decode(e){if(this.entered)return this.clone().decode(e);try{this.entered=!0,this.reinitializeState(),this.setBuffer(e);const t=this.doDecodeSync();if(this.hasRemaining(1))throw this.createExtraByteError(this.pos);return t}finally{this.entered=!1}}*decodeMulti(e){if(this.entered){yield*this.clone().decodeMulti(e);return}try{for(this.entered=!0,this.reinitializeState(),this.setBuffer(e);this.hasRemaining(1);)yield this.doDecodeSync()}finally{this.entered=!1}}async decodeAsync(e){if(this.entered)return this.clone().decodeAsync(e);try{this.entered=!0;let t=!1,r;for await(const a of e){if(t)throw this.entered=!1,this.createExtraByteError(this.totalPos);this.appendBuffer(a);try{r=this.doDecodeSync(),t=!0}catch(c){if(!(c instanceof RangeError))throw c}this.totalPos+=this.pos}if(t){if(this.hasRemaining(1))throw this.createExtraByteError(this.totalPos);return r}const{headByte:s,pos:i,totalPos:o}=this;throw new RangeError(`Insufficient data in parsing ${Vv(s)} at ${o} (${i} in the current buffer)`)}finally{this.entered=!1}}decodeArrayStream(e){return this.decodeMultiAsync(e,!0)}decodeStream(e){return this.decodeMultiAsync(e,!1)}async*decodeMultiAsync(e,t){if(this.entered){yield*this.clone().decodeMultiAsync(e,t);return}try{this.entered=!0;let r=t,s=-1;for await(const i of e){if(t&&s===0)throw this.createExtraByteError(this.totalPos);this.appendBuffer(i),r&&(s=this.readArraySize(),r=!1,this.complete());try{for(;yield this.doDecodeSync(),--s!==0;);}catch(o){if(!(o instanceof RangeError))throw o}this.totalPos+=this.pos}}finally{this.entered=!1}}doDecodeSync(){e:for(;;){const e=this.readHeadByte();let t;if(e>=224)t=e-256;else if(e<192)if(e<128)t=e;else if(e<144){const s=e-128;if(s!==0){this.pushMapState(s),this.complete();continue e}else t={}}else if(e<160){const s=e-144;if(s!==0){this.pushArrayState(s),this.complete();continue e}else t=[]}else{const s=e-160;t=this.decodeString(s,0)}else if(e===192)t=null;else if(e===194)t=!1;else if(e===195)t=!0;else if(e===202)t=this.readF32();else if(e===203)t=this.readF64();else if(e===204)t=this.readU8();else if(e===205)t=this.readU16();else if(e===206)t=this.readU32();else if(e===207)this.useBigInt64?t=this.readU64AsBigInt():t=this.readU64();else if(e===208)t=this.readI8();else if(e===209)t=this.readI16();else if(e===210)t=this.readI32();else if(e===211)this.useBigInt64?t=this.readI64AsBigInt():t=this.readI64();else if(e===217){const s=this.lookU8();t=this.decodeString(s,1)}else if(e===218){const s=this.lookU16();t=this.decodeString(s,2)}else if(e===219){const s=this.lookU32();t=this.decodeString(s,4)}else if(e===220){const s=this.readU16();if(s!==0){this.pushArrayState(s),this.complete();continue e}else t=[]}else if(e===221){const s=this.readU32();if(s!==0){this.pushArrayState(s),this.complete();continue e}else t=[]}else if(e===222){const s=this.readU16();if(s!==0){this.pushMapState(s),this.complete();continue e}else t={}}else if(e===223){const s=this.readU32();if(s!==0){this.pushMapState(s),this.complete();continue e}else t={}}else if(e===196){const s=this.lookU8();t=this.decodeBinary(s,1)}else if(e===197){const s=this.lookU16();t=this.decodeBinary(s,2)}else if(e===198){const s=this.lookU32();t=this.decodeBinary(s,4)}else if(e===212)t=this.decodeExtension(1,0);else if(e===213)t=this.decodeExtension(2,0);else if(e===214)t=this.decodeExtension(4,0);else if(e===215)t=this.decodeExtension(8,0);else if(e===216)t=this.decodeExtension(16,0);else if(e===199){const s=this.lookU8();t=this.decodeExtension(s,1)}else if(e===200){const s=this.lookU16();t=this.decodeExtension(s,2)}else if(e===201){const s=this.lookU32();t=this.decodeExtension(s,4)}else throw new As(`Unrecognized type byte: ${Vv(e)}`);this.complete();const r=this.stack;for(;r.length>0;){const s=r.top();if(s.type===UA)if(s.array[s.position]=t,s.position++,s.position===s.size)t=s.array,r.release(s);else continue e;else if(s.type===Wp){if(t==="__proto__")throw new As("The key __proto__ is not allowed");s.key=this.mapKeyConverter(t),s.type=aU;continue e}else if(s.map[s.key]=t,s.readCount++,s.readCount===s.size)t=s.map,r.release(s);else{s.key=null,s.type=Wp;continue e}}return t}}readHeadByte(){return this.headByte===cp&&(this.headByte=this.readU8()),this.headByte}complete(){this.headByte=cp}readArraySize(){const e=this.readHeadByte();switch(e){case 220:return this.readU16();case 221:return this.readU32();default:{if(e<160)return e-144;throw new As(`Unrecognized array type byte: ${Vv(e)}`)}}}pushMapState(e){if(e>this.maxMapLength)throw new As(`Max length exceeded: map length (${e}) > maxMapLengthLength (${this.maxMapLength})`);this.stack.pushMapState(e)}pushArrayState(e){if(e>this.maxArrayLength)throw new As(`Max length exceeded: array length (${e}) > maxArrayLength (${this.maxArrayLength})`);this.stack.pushArrayState(e)}decodeString(e,t){return!this.rawStrings||this.stateIsMapKey()?this.decodeUtf8String(e,t):this.decodeBinary(e,t)}decodeUtf8String(e,t){var i;if(e>this.maxStrLength)throw new As(`Max length exceeded: UTF-8 byte length (${e}) > maxStrLength (${this.maxStrLength})`);if(this.bytes.byteLength<this.pos+t+e)throw C2;const r=this.pos+t;let s;return this.stateIsMapKey()&&((i=this.keyDecoder)!=null&&i.canBeCached(e))?s=this.keyDecoder.decode(this.bytes,r,e):s=zW(this.bytes,r,e),this.pos+=t+e,s}stateIsMapKey(){return this.stack.length>0?this.stack.top().type===Wp:!1}decodeBinary(e,t){if(e>this.maxBinLength)throw new As(`Max length exceeded: bin length (${e}) > maxBinLength (${this.maxBinLength})`);if(!this.hasRemaining(e+t))throw C2;const r=this.pos+t,s=this.bytes.subarray(r,r+e);return this.pos+=t+e,s}decodeExtension(e,t){if(e>this.maxExtLength)throw new As(`Max length exceeded: ext length (${e}) > maxExtLength (${this.maxExtLength})`);const r=this.view.getInt8(this.pos+t),s=this.decodeBinary(e,t+1);return this.extensionCodec.decode(s,r,this.context)}lookU8(){return this.view.getUint8(this.pos)}lookU16(){return this.view.getUint16(this.pos)}lookU32(){return this.view.getUint32(this.pos)}readU8(){const e=this.view.getUint8(this.pos);return this.pos++,e}readI8(){const e=this.view.getInt8(this.pos);return this.pos++,e}readU16(){const e=this.view.getUint16(this.pos);return this.pos+=2,e}readI16(){const e=this.view.getInt16(this.pos);return this.pos+=2,e}readU32(){const e=this.view.getUint32(this.pos);return this.pos+=4,e}readI32(){const e=this.view.getInt32(this.pos);return this.pos+=4,e}readU64(){const e=GW(this.view,this.pos);return this.pos+=8,e}readI64(){const e=iU(this.view,this.pos);return this.pos+=8,e}readU64AsBigInt(){const e=this.view.getBigUint64(this.pos);return this.pos+=8,e}readI64AsBigInt(){const e=this.view.getBigInt64(this.pos);return this.pos+=8,e}readF32(){const e=this.view.getFloat32(this.pos);return this.pos+=4,e}readF64(){const e=this.view.getFloat64(this.pos);return this.pos+=8,e}};function mG(n,e){return new gG(e).decode(n)}/*! scure-base - MIT License (c) 2022 Paul Miller (paulmillr.com) */function yG(n){return n instanceof Uint8Array||ArrayBuffer.isView(n)&&n.constructor.name==="Uint8Array"}function lU(n,e){return Array.isArray(e)?e.length===0?!0:n?e.every(t=>typeof t=="string"):e.every(t=>Number.isSafeInteger(t)):!1}function R0(n,e){if(typeof e!="string")throw new Error(`${n}: string expected`);return!0}function p_(n){if(!Number.isSafeInteger(n))throw new Error(`invalid integer: ${n}`)}function $A(n){if(!Array.isArray(n))throw new Error("array expected")}function P0(n,e){if(!lU(!0,e))throw new Error(`${n}: array of strings expected`)}function wG(n,e){if(!lU(!1,e))throw new Error(`${n}: array of numbers expected`)}function bG(...n){const e=i=>i,t=(i,o)=>a=>i(o(a)),r=n.map(i=>i.encode).reduceRight(t,e),s=n.map(i=>i.decode).reduce(t,e);return{encode:r,decode:s}}function EG(n){const e=typeof n=="string"?n.split(""):n,t=e.length;P0("alphabet",e);const r=new Map(e.map((s,i)=>[s,i]));return{encode:s=>($A(s),s.map(i=>{if(!Number.isSafeInteger(i)||i<0||i>=t)throw new Error(`alphabet.encode: digit index outside alphabet "${i}". Allowed: ${n}`);return e[i]})),decode:s=>($A(s),s.map(i=>{R0("alphabet.decode",i);const o=r.get(i);if(o===void 0)throw new Error(`Unknown letter: "${i}". Allowed: ${n}`);return o}))}}function vG(n=""){return R0("join",n),{encode:e=>(P0("join.decode",e),e.join(n)),decode:e=>(R0("join.decode",e),e.split(n))}}function AG(n,e="="){return p_(n),R0("padding",e),{encode(t){for(P0("padding.encode",t);t.length*n%8;)t.push(e);return t},decode(t){P0("padding.decode",t);let r=t.length;if(r*n%8)throw new Error("padding: invalid, string should have whole number of bytes");for(;r>0&&t[r-1]===e;r--)if((r-1)*n%8===0)throw new Error("padding: invalid, string has too much padding");return t.slice(0,r)}}}const uU=(n,e)=>e===0?n:uU(e,n%e),k0=(n,e)=>n+(e-uU(n,e)),qv=(()=>{let n=[];for(let e=0;e<40;e++)n.push(2**e);return n})();function I2(n,e,t,r){if($A(n),e<=0||e>32)throw new Error(`convertRadix2: wrong from=${e}`);if(t<=0||t>32)throw new Error(`convertRadix2: wrong to=${t}`);if(k0(e,t)>32)throw new Error(`convertRadix2: carry overflow from=${e} to=${t} carryBits=${k0(e,t)}`);let s=0,i=0;const o=qv[e],a=qv[t]-1,c=[];for(const l of n){if(p_(l),l>=o)throw new Error(`convertRadix2: invalid data word=${l} from=${e}`);if(s=s<<e|l,i+e>32)throw new Error(`convertRadix2: carry overflow pos=${i} from=${e}`);for(i+=e;i>=t;i-=t)c.push((s>>i-t&a)>>>0);const u=qv[i];if(u===void 0)throw new Error("invalid carry");s&=u-1}if(s=s<<t-i&a,!r&&i>=e)throw new Error("Excess padding");if(!r&&s>0)throw new Error(`Non-zero padding: ${s}`);return r&&i>0&&c.push(s>>>0),c}function CG(n,e=!1){if(p_(n),n<=0||n>32)throw new Error("radix2: bits should be in (0..32]");if(k0(8,n)>32||k0(n,8)>32)throw new Error("radix2: carry overflow");return{encode:t=>{if(!yG(t))throw new Error("radix2.encode input should be Uint8Array");return I2(Array.from(t),8,n,!e)},decode:t=>(wG("radix2.decode",t),Uint8Array.from(I2(t,n,8,e)))}}const IG=bG(CG(5),EG("ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"),AG(5),vG(""));function g_(n){return globalThis.Buffer!=null?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):n}function hU(n=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?g_(globalThis.Buffer.allocUnsafe(n)):new Uint8Array(n)}function Gp(n,e){e||(e=n.reduce((s,i)=>s+i.length,0));const t=hU(e);let r=0;for(const s of n)t.set(s,r),r+=s.length;return g_(t)}function _G(n,e){if(n.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),r=0;r<t.length;r++)t[r]=255;for(var s=0;s<n.length;s++){var i=n.charAt(s),o=i.charCodeAt(0);if(t[o]!==255)throw new TypeError(i+" is ambiguous");t[o]=s}var a=n.length,c=n.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function h(p){if(p instanceof Uint8Array||(ArrayBuffer.isView(p)?p=new Uint8Array(p.buffer,p.byteOffset,p.byteLength):Array.isArray(p)&&(p=Uint8Array.from(p))),!(p instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(p.length===0)return"";for(var g=0,m=0,w=0,v=p.length;w!==v&&p[w]===0;)w++,g++;for(var A=(v-w)*u+1>>>0,T=new Uint8Array(A);w!==v;){for(var N=p[w],R=0,M=A-1;(N!==0||R<m)&&M!==-1;M--,R++)N+=256*T[M]>>>0,T[M]=N%a>>>0,N=N/a>>>0;if(N!==0)throw new Error("Non-zero carry");m=R,w++}for(var D=A-m;D!==A&&T[D]===0;)D++;for(var S=c.repeat(g);D<A;++D)S+=n.charAt(T[D]);return S}function d(p){if(typeof p!="string")throw new TypeError("Expected String");if(p.length===0)return new Uint8Array;var g=0;if(p[g]!==" "){for(var m=0,w=0;p[g]===c;)m++,g++;for(var v=(p.length-g)*l+1>>>0,A=new Uint8Array(v);p[g];){var T=t[p.charCodeAt(g)];if(T===255)return;for(var N=0,R=v-1;(T!==0||N<w)&&R!==-1;R--,N++)T+=a*A[R]>>>0,A[R]=T%256>>>0,T=T/256>>>0;if(T!==0)throw new Error("Non-zero carry");w=N,g++}if(p[g]!==" "){for(var M=v-w;M!==v&&A[M]===0;)M++;for(var D=new Uint8Array(m+(v-M)),S=m;M!==v;)D[S++]=A[M++];return D}}}function f(p){var g=d(p);if(g)return g;throw new Error(`Non-${e} character`)}return{encode:h,decodeUnsafe:d,decode:f}}var SG=_G,TG=SG;const NG=n=>{if(n instanceof Uint8Array&&n.constructor.name==="Uint8Array")return n;if(n instanceof ArrayBuffer)return new Uint8Array(n);if(ArrayBuffer.isView(n))return new Uint8Array(n.buffer,n.byteOffset,n.byteLength);throw new Error("Unknown type, must be binary type")},OG=n=>new TextEncoder().encode(n),xG=n=>new TextDecoder().decode(n);class RG{constructor(e,t,r){this.name=e,this.prefix=t,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class PG{constructor(e,t,r){if(this.name=e,this.prefix=t,t.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=r}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return dU(this,e)}}class kG{constructor(e){this.decoders=e}or(e){return dU(this,e)}decode(e){const t=e[0],r=this.decoders[t];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const dU=(n,e)=>new kG({...n.decoders||{[n.prefix]:n},...e.decoders||{[e.prefix]:e}});class DG{constructor(e,t,r,s){this.name=e,this.prefix=t,this.baseEncode=r,this.baseDecode=s,this.encoder=new RG(e,t,r),this.decoder=new PG(e,t,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const Zb=({name:n,prefix:e,encode:t,decode:r})=>new DG(n,e,t,r),hy=({prefix:n,name:e,alphabet:t})=>{const{encode:r,decode:s}=TG(t,e);return Zb({prefix:n,name:e,encode:r,decode:i=>NG(s(i))})},UG=(n,e,t,r)=>{const s={};for(let u=0;u<e.length;++u)s[e[u]]=u;let i=n.length;for(;n[i-1]==="=";)--i;const o=new Uint8Array(i*t/8|0);let a=0,c=0,l=0;for(let u=0;u<i;++u){const h=s[n[u]];if(h===void 0)throw new SyntaxError(`Non-${r} character`);c=c<<t|h,a+=t,a>=8&&(a-=8,o[l++]=255&c>>a)}if(a>=t||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},$G=(n,e,t)=>{const r=e[e.length-1]==="=",s=(1<<t)-1;let i="",o=0,a=0;for(let c=0;c<n.length;++c)for(a=a<<8|n[c],o+=8;o>t;)o-=t,i+=e[s&a>>o];if(o&&(i+=e[s&a<<t-o]),r)for(;i.length*t&7;)i+="=";return i},Yn=({name:n,prefix:e,bitsPerChar:t,alphabet:r})=>Zb({prefix:e,name:n,encode(s){return $G(s,r,t)},decode(s){return UG(s,r,t,n)}}),MG=Zb({prefix:"\0",name:"identity",encode:n=>xG(n),decode:n=>OG(n)}),LG=Object.freeze(Object.defineProperty({__proto__:null,identity:MG},Symbol.toStringTag,{value:"Module"})),BG=Yn({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),FG=Object.freeze(Object.defineProperty({__proto__:null,base2:BG},Symbol.toStringTag,{value:"Module"})),jG=Yn({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),HG=Object.freeze(Object.defineProperty({__proto__:null,base8:jG},Symbol.toStringTag,{value:"Module"})),VG=hy({prefix:"9",name:"base10",alphabet:"0123456789"}),qG=Object.freeze(Object.defineProperty({__proto__:null,base10:VG},Symbol.toStringTag,{value:"Module"})),zG=Yn({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),WG=Yn({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),GG=Object.freeze(Object.defineProperty({__proto__:null,base16:zG,base16upper:WG},Symbol.toStringTag,{value:"Module"})),KG=Yn({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),YG=Yn({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),QG=Yn({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),ZG=Yn({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),JG=Yn({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),XG=Yn({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),eK=Yn({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),tK=Yn({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),nK=Yn({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),rK=Object.freeze(Object.defineProperty({__proto__:null,base32:KG,base32hex:JG,base32hexpad:eK,base32hexpadupper:tK,base32hexupper:XG,base32pad:QG,base32padupper:ZG,base32upper:YG,base32z:nK},Symbol.toStringTag,{value:"Module"})),sK=hy({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),iK=hy({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),oK=Object.freeze(Object.defineProperty({__proto__:null,base36:sK,base36upper:iK},Symbol.toStringTag,{value:"Module"})),aK=hy({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),cK=hy({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),lK=Object.freeze(Object.defineProperty({__proto__:null,base58btc:aK,base58flickr:cK},Symbol.toStringTag,{value:"Module"})),uK=Yn({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),hK=Yn({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),dK=Yn({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),fK=Yn({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),pK=Object.freeze(Object.defineProperty({__proto__:null,base64:uK,base64pad:hK,base64url:dK,base64urlpad:fK},Symbol.toStringTag,{value:"Module"})),fU=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),gK=fU.reduce((n,e,t)=>(n[t]=e,n),[]),mK=fU.reduce((n,e,t)=>(n[e.codePointAt(0)]=t,n),[]);function yK(n){return n.reduce((e,t)=>(e+=gK[t],e),"")}function wK(n){const e=[];for(const t of n){const r=mK[t.codePointAt(0)];if(r===void 0)throw new Error(`Non-base256emoji character: ${t}`);e.push(r)}return new Uint8Array(e)}const bK=Zb({prefix:"🚀",name:"base256emoji",encode:yK,decode:wK}),EK=Object.freeze(Object.defineProperty({__proto__:null,base256emoji:bK},Symbol.toStringTag,{value:"Module"}));new TextEncoder;new TextDecoder;const _2={...LG,...FG,...HG,...qG,...GG,...rK,...oK,...lK,...pK,...EK};function pU(n,e,t,r){return{name:n,prefix:e,encoder:{name:n,prefix:e,encode:t},decoder:{decode:r}}}const S2=pU("utf8","u",n=>"u"+new TextDecoder("utf8").decode(n),n=>new TextEncoder().encode(n.substring(1))),zv=pU("ascii","a",n=>{let e="a";for(let t=0;t<n.length;t++)e+=String.fromCharCode(n[t]);return e},n=>{n=n.substring(1);const e=hU(n.length);for(let t=0;t<n.length;t++)e[t]=n.charCodeAt(t);return e}),gU={utf8:S2,"utf-8":S2,hex:_2.base16,latin1:zv,ascii:zv,binary:zv,..._2};function ti(n,e="utf8"){const t=gU[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?g_(globalThis.Buffer.from(n,"utf-8")):t.decoder.decode(`${t.prefix}${n}`)}function as(n,e="utf8"){const t=gU[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(n.buffer,n.byteOffset,n.byteLength).toString("utf8"):t.encoder.encode(n).substring(1)}const vK={waku:{publish:"waku_publish",batchPublish:"waku_batchPublish",subscribe:"waku_subscribe",batchSubscribe:"waku_batchSubscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe",batchUnsubscribe:"waku_batchUnsubscribe",batchFetchMessages:"waku_batchFetchMessages"},irn:{publish:"irn_publish",batchPublish:"irn_batchPublish",subscribe:"irn_subscribe",batchSubscribe:"irn_batchSubscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe",batchUnsubscribe:"irn_batchUnsubscribe",batchFetchMessages:"irn_batchFetchMessages"},iridium:{publish:"iridium_publish",batchPublish:"iridium_batchPublish",subscribe:"iridium_subscribe",batchSubscribe:"iridium_batchSubscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe",batchUnsubscribe:"iridium_batchUnsubscribe",batchFetchMessages:"iridium_batchFetchMessages"}},AK="Input must be an string, Buffer or Uint8Array";function CK(n){let e;if(n instanceof Uint8Array)e=n;else if(typeof n=="string")e=new TextEncoder().encode(n);else throw new Error(AK);return e}function IK(n){return Array.prototype.map.call(n,function(e){return(e<16?"0":"")+e.toString(16)}).join("")}function lw(n){return(4294967296+n).toString(16).substring(1)}function _K(n,e,t){let r=`
`+n+" = ";for(let s=0;s<e.length;s+=2){if(t===32)r+=lw(e[s]).toUpperCase(),r+=" ",r+=lw(e[s+1]).toUpperCase();else if(t===64)r+=lw(e[s+1]).toUpperCase(),r+=lw(e[s]).toUpperCase();else throw new Error("Invalid size "+t);s%6===4?r+=`
`+new Array(n.length+4).join(" "):s<e.length-2&&(r+=" ")}console.log(r)}function SK(n,e,t){let r=new Date().getTime();const s=new Uint8Array(e);for(let o=0;o<e;o++)s[o]=o%256;const i=new Date().getTime();console.log("Generated random input in "+(i-r)+"ms"),r=i;for(let o=0;o<t;o++){const a=n(s),c=new Date().getTime(),l=c-r;r=c,console.log("Hashed in "+l+"ms: "+a.substring(0,20)+"..."),console.log(Math.round(e/(1<<20)/(l/1e3)*100)/100+" MB PER SECOND")}}var mU={normalizeInput:CK,toHex:IK,debugPrint:_K,testSpeed:SK};const Qw=mU;function uw(n,e,t){const r=n[e]+n[t];let s=n[e+1]+n[t+1];r>=4294967296&&s++,n[e]=r,n[e+1]=s}function T2(n,e,t,r){let s=n[e]+t;t<0&&(s+=4294967296);let i=n[e+1]+r;s>=4294967296&&i++,n[e]=s,n[e+1]=i}function yU(n,e){return n[e]^n[e+1]<<8^n[e+2]<<16^n[e+3]<<24}function Da(n,e,t,r,s,i){const o=Np[s],a=Np[s+1],c=Np[i],l=Np[i+1];uw(Ve,n,e),T2(Ve,n,o,a);let u=Ve[r]^Ve[n],h=Ve[r+1]^Ve[n+1];Ve[r]=h,Ve[r+1]=u,uw(Ve,t,r),u=Ve[e]^Ve[t],h=Ve[e+1]^Ve[t+1],Ve[e]=u>>>24^h<<8,Ve[e+1]=h>>>24^u<<8,uw(Ve,n,e),T2(Ve,n,c,l),u=Ve[r]^Ve[n],h=Ve[r+1]^Ve[n+1],Ve[r]=u>>>16^h<<16,Ve[r+1]=h>>>16^u<<16,uw(Ve,t,r),u=Ve[e]^Ve[t],h=Ve[e+1]^Ve[t+1],Ve[e]=h>>>31^u<<1,Ve[e+1]=u>>>31^h<<1}const wU=new Uint32Array([4089235720,1779033703,2227873595,3144134277,4271175723,1013904242,1595750129,2773480762,2917565137,1359893119,725511199,2600822924,4215389547,528734635,327033209,1541459225]),TK=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3],Jn=new Uint8Array(TK.map(function(n){return n*2})),Ve=new Uint32Array(32),Np=new Uint32Array(32);function bU(n,e){let t=0;for(t=0;t<16;t++)Ve[t]=n.h[t],Ve[t+16]=wU[t];for(Ve[24]=Ve[24]^n.t,Ve[25]=Ve[25]^n.t/4294967296,e&&(Ve[28]=~Ve[28],Ve[29]=~Ve[29]),t=0;t<32;t++)Np[t]=yU(n.b,4*t);for(t=0;t<12;t++)Da(0,8,16,24,Jn[t*16+0],Jn[t*16+1]),Da(2,10,18,26,Jn[t*16+2],Jn[t*16+3]),Da(4,12,20,28,Jn[t*16+4],Jn[t*16+5]),Da(6,14,22,30,Jn[t*16+6],Jn[t*16+7]),Da(0,10,20,30,Jn[t*16+8],Jn[t*16+9]),Da(2,12,22,24,Jn[t*16+10],Jn[t*16+11]),Da(4,14,16,26,Jn[t*16+12],Jn[t*16+13]),Da(6,8,18,28,Jn[t*16+14],Jn[t*16+15]);for(t=0;t<16;t++)n.h[t]=n.h[t]^Ve[t]^Ve[t+16]}const Ua=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);function EU(n,e,t,r){if(n===0||n>64)throw new Error("Illegal output length, expected 0 < length <= 64");if(e&&e.length>64)throw new Error("Illegal key, expected Uint8Array with 0 < length <= 64");if(t&&t.length!==16)throw new Error("Illegal salt, expected Uint8Array with length is 16");if(r&&r.length!==16)throw new Error("Illegal personal, expected Uint8Array with length is 16");const s={b:new Uint8Array(128),h:new Uint32Array(16),t:0,c:0,outlen:n};Ua.fill(0),Ua[0]=n,e&&(Ua[1]=e.length),Ua[2]=1,Ua[3]=1,t&&Ua.set(t,32),r&&Ua.set(r,48);for(let i=0;i<16;i++)s.h[i]=wU[i]^yU(Ua,i*4);return e&&(m_(s,e),s.c=128),s}function m_(n,e){for(let t=0;t<e.length;t++)n.c===128&&(n.t+=n.c,bU(n,!1),n.c=0),n.b[n.c++]=e[t]}function vU(n){for(n.t+=n.c;n.c<128;)n.b[n.c++]=0;bU(n,!0);const e=new Uint8Array(n.outlen);for(let t=0;t<n.outlen;t++)e[t]=n.h[t>>2]>>8*(t&3);return e}function AU(n,e,t,r,s){t=t||64,n=Qw.normalizeInput(n),r&&(r=Qw.normalizeInput(r)),s&&(s=Qw.normalizeInput(s));const i=EU(t,e,r,s);return m_(i,n),vU(i)}function NK(n,e,t,r,s){const i=AU(n,e,t,r,s);return Qw.toHex(i)}var OK={blake2b:AU,blake2bHex:NK,blake2bInit:EU,blake2bUpdate:m_,blake2bFinal:vU};const CU=mU;function xK(n,e){return n[e]^n[e+1]<<8^n[e+2]<<16^n[e+3]<<24}function $a(n,e,t,r,s,i){gt[n]=gt[n]+gt[e]+s,gt[r]=hw(gt[r]^gt[n],16),gt[t]=gt[t]+gt[r],gt[e]=hw(gt[e]^gt[t],12),gt[n]=gt[n]+gt[e]+i,gt[r]=hw(gt[r]^gt[n],8),gt[t]=gt[t]+gt[r],gt[e]=hw(gt[e]^gt[t],7)}function hw(n,e){return n>>>e^n<<32-e}const IU=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Xn=new Uint8Array([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0]),gt=new Uint32Array(16),Un=new Uint32Array(16);function _U(n,e){let t=0;for(t=0;t<8;t++)gt[t]=n.h[t],gt[t+8]=IU[t];for(gt[12]^=n.t,gt[13]^=n.t/4294967296,e&&(gt[14]=~gt[14]),t=0;t<16;t++)Un[t]=xK(n.b,4*t);for(t=0;t<10;t++)$a(0,4,8,12,Un[Xn[t*16+0]],Un[Xn[t*16+1]]),$a(1,5,9,13,Un[Xn[t*16+2]],Un[Xn[t*16+3]]),$a(2,6,10,14,Un[Xn[t*16+4]],Un[Xn[t*16+5]]),$a(3,7,11,15,Un[Xn[t*16+6]],Un[Xn[t*16+7]]),$a(0,5,10,15,Un[Xn[t*16+8]],Un[Xn[t*16+9]]),$a(1,6,11,12,Un[Xn[t*16+10]],Un[Xn[t*16+11]]),$a(2,7,8,13,Un[Xn[t*16+12]],Un[Xn[t*16+13]]),$a(3,4,9,14,Un[Xn[t*16+14]],Un[Xn[t*16+15]]);for(t=0;t<8;t++)n.h[t]^=gt[t]^gt[t+8]}function SU(n,e){if(!(n>0&&n<=32))throw new Error("Incorrect output length, should be in [1, 32]");const t=e?e.length:0;if(e&&!(t>0&&t<=32))throw new Error("Incorrect key length, should be in [1, 32]");const r={h:new Uint32Array(IU),b:new Uint8Array(64),c:0,t:0,outlen:n};return r.h[0]^=16842752^t<<8^n,t>0&&(y_(r,e),r.c=64),r}function y_(n,e){for(let t=0;t<e.length;t++)n.c===64&&(n.t+=n.c,_U(n,!1),n.c=0),n.b[n.c++]=e[t]}function TU(n){for(n.t+=n.c;n.c<64;)n.b[n.c++]=0;_U(n,!0);const e=new Uint8Array(n.outlen);for(let t=0;t<n.outlen;t++)e[t]=n.h[t>>2]>>8*(t&3)&255;return e}function NU(n,e,t){t=t||32,n=CU.normalizeInput(n);const r=SU(t,e);return y_(r,n),TU(r)}function RK(n,e,t){const r=NU(n,e,t);return CU.toHex(r)}var PK={blake2s:NU,blake2sHex:RK,blake2sInit:SU,blake2sUpdate:y_,blake2sFinal:TU};const lp=OK,up=PK;var kK={blake2b:lp.blake2b,blake2bHex:lp.blake2bHex,blake2bInit:lp.blake2bInit,blake2bUpdate:lp.blake2bUpdate,blake2bFinal:lp.blake2bFinal,blake2s:up.blake2s,blake2sHex:up.blake2sHex,blake2sInit:up.blake2sInit,blake2sUpdate:up.blake2sUpdate,blake2sFinal:up.blake2sFinal},DK={};const UK=":";function ou(n){const[e,t]=n.split(UK);return{namespace:e,reference:t}}function OU(n,e){return n.includes(":")?[n]:e.chains||[]}var $K=Object.defineProperty,MK=Object.defineProperties,LK=Object.getOwnPropertyDescriptors,N2=Object.getOwnPropertySymbols,BK=Object.prototype.hasOwnProperty,FK=Object.prototype.propertyIsEnumerable,MA=(n,e,t)=>e in n?$K(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,O2=(n,e)=>{for(var t in e||(e={}))BK.call(e,t)&&MA(n,t,e[t]);if(N2)for(var t of N2(e))FK.call(e,t)&&MA(n,t,e[t]);return n},jK=(n,e)=>MK(n,LK(e)),x2=(n,e,t)=>MA(n,typeof e!="symbol"?e+"":e,t);const HK="ReactNative",_s={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},VK="js";function D0(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function zc(){return!pu()&&!!h_()&&navigator.product===HK}function qK(){return zc()&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"&&(global==null?void 0:global.Platform.OS)==="android"}function zK(){return zc()&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"&&(global==null?void 0:global.Platform.OS)==="ios"}function Mf(){return!D0()&&!!h_()&&!!pu()}function dy(){return zc()?_s.reactNative:D0()?_s.node:Mf()?_s.browser:_s.unknown}function R2(){var n;try{return zc()&&typeof global<"u"&&typeof(global==null?void 0:global.Application)<"u"?(n=global.Application)==null?void 0:n.applicationId:void 0}catch{return}}function WK(n,e){const t=new URLSearchParams(n);for(const r of Object.keys(e).sort())if(e.hasOwnProperty(r)){const s=e[r];s!==void 0&&t.set(r,s)}return t.toString()}function GK(n){var e,t;const r=xU();try{return n!=null&&n.url&&r.url&&new URL(n.url).host!==new URL(r.url).host&&(console.warn(`The configured WalletConnect 'metadata.url':${n.url} differs from the actual page url:${r.url}. This is probably unintended and can lead to issues.`),n.url=r.url),(e=n==null?void 0:n.icons)!=null&&e.length&&n.icons.length>0&&(n.icons=n.icons.filter(s=>s!=="")),jK(O2(O2({},r),n),{url:(n==null?void 0:n.url)||r.url,name:(n==null?void 0:n.name)||r.name,description:(n==null?void 0:n.description)||r.description,icons:(t=n==null?void 0:n.icons)!=null&&t.length&&n.icons.length>0?n.icons:r.icons})}catch(s){return console.warn("Error populating app metadata",s),n||r}}function xU(){return K3()||{name:"",description:"",url:"",icons:[""]}}function KK(){if(dy()===_s.reactNative&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"){const{OS:t,Version:r}=global.Platform;return[t,r].join("-")}const n=Jz();if(n===null)return"unknown";const e=n.os?n.os.replace(" ","").toLowerCase():"unknown";return n.type==="browser"?[e,n.name,n.version].join("-"):[e,n.version].join("-")}function YK(){var n;const e=dy();return e===_s.browser?[e,((n=G3())==null?void 0:n.host)||"unknown"].join(":"):e}function RU(n,e,t){const r=KK(),s=YK();return[[n,e].join("-"),[VK,t].join("-"),r,s].join("/")}function QK({protocol:n,version:e,relayUrl:t,sdkVersion:r,auth:s,projectId:i,useOnCloseEvent:o,bundleId:a,packageName:c}){const l=t.split("?"),u=RU(n,e,r),h={auth:s,ua:u,projectId:i,useOnCloseEvent:o||void 0,packageName:c||void 0,bundleId:a||void 0},d=WK(l[1]||"",h);return l[0]+"?"+d}function Al(n,e){return n.filter(t=>e.includes(t)).length===n.length}function LA(n){return Object.fromEntries(n.entries())}function BA(n){return new Map(Object.entries(n))}function ll(n=ne.FIVE_MINUTES,e){const t=ne.toMiliseconds(n||ne.FIVE_MINUTES);let r,s,i,o;return{resolve:a=>{i&&r&&(clearTimeout(i),r(a),o=Promise.resolve(a))},reject:a=>{i&&s&&(clearTimeout(i),s(a))},done:()=>new Promise((a,c)=>{if(o)return a(o);i=setTimeout(()=>{const l=new Error(e);o=Promise.reject(l),c(l)},t),r=a,s=c})}}function ho(n,e,t){return new Promise(async(r,s)=>{const i=setTimeout(()=>s(new Error(t)),e);try{const o=await n;r(o)}catch(o){s(o)}clearTimeout(i)})}function PU(n,e){if(typeof e=="string"&&e.startsWith(`${n}:`))return e;if(n.toLowerCase()==="topic"){if(typeof e!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${e}`}else if(n.toLowerCase()==="id"){if(typeof e!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${e}`}throw new Error(`Unknown expirer target type: ${n}`)}function ZK(n){return PU("topic",n)}function JK(n){return PU("id",n)}function kU(n){const[e,t]=n.split(":"),r={id:void 0,topic:void 0};if(e==="topic"&&typeof t=="string")r.topic=t;else if(e==="id"&&Number.isInteger(Number(t)))r.id=Number(t);else throw new Error(`Invalid target, expected id:number or topic:string, got ${e}:${t}`);return r}function bn(n,e){return ne.fromMiliseconds(Date.now()+ne.toMiliseconds(n))}function Qa(n){return Date.now()>=ne.toMiliseconds(n)}function At(n,e){return`${n}${e?`:${e}`:""}`}function wo(n=[],e=[]){return[...new Set([...n,...e])]}async function XK({id:n,topic:e,wcDeepLink:t}){var r;try{if(!t)return;const s=typeof t=="string"?JSON.parse(t):t,i=s==null?void 0:s.href;if(typeof i!="string")return;const o=eY(i,n,e),a=dy();if(a===_s.browser){if(!((r=pu())!=null&&r.hasFocus())){console.warn("Document does not have focus, skipping deeplink.");return}tY(o)}else a===_s.reactNative&&typeof(global==null?void 0:global.Linking)<"u"&&await globalThis.Linking.openURL(o)}catch(s){console.error(s)}}function eY(n,e,t){const r=`requestId=${e}&sessionTopic=${t}`;n.endsWith("/")&&(n=n.slice(0,-1));let s=`${n}`;if(n.startsWith("https://t.me")){const i=n.includes("?")?"&startapp=":"?startapp=";s=`${s}${i}${iY(r,!0)}`}else s=`${s}/wc?${r}`;return s}function tY(n){let e="_self";sY()?e="_top":(rY()||n.startsWith("https://")||n.startsWith("http://"))&&(e="_blank"),window.open(n,e,"noreferrer noopener")}async function nY(n,e){let t="";try{if(Mf()&&(t=localStorage.getItem(e),t))return t;t=await n.getItem(e)}catch(r){console.error(r)}return t}function P2(n,e){if(!n.includes(e))return null;const t=n.split(/([&,?,=])/),r=t.indexOf(e);return t[r+2]}function k2(){return typeof crypto<"u"&&crypto!=null&&crypto.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/gu,n=>{const e=Math.random()*16|0;return(n==="x"?e:e&3|8).toString(16)})}function w_(){return typeof process<"u"&&DK.IS_VITEST==="true"}function rY(){return typeof window<"u"&&(!!window.TelegramWebviewProxy||!!window.Telegram||!!window.TelegramWebviewProxyProto)}function sY(){try{return window.self!==window.top}catch{return!1}}function iY(n,e=!1){const t=Buffer.from(n).toString("base64");return e?t.replace(/[=]/g,""):t}function DU(n){return Buffer.from(n,"base64").toString("utf-8")}function oY(n){return new Promise(e=>setTimeout(e,n))}let aY=class{constructor({limit:e}){x2(this,"limit"),x2(this,"set"),this.limit=e,this.set=new Set}add(e){if(!this.set.has(e)){if(this.set.size>=this.limit){const t=this.set.values().next().value;t&&this.set.delete(t)}this.set.add(e)}}has(e){return this.set.has(e)}};const dw=BigInt(2**32-1),D2=BigInt(32);function UU(n,e=!1){return e?{h:Number(n&dw),l:Number(n>>D2&dw)}:{h:Number(n>>D2&dw)|0,l:Number(n&dw)|0}}function $U(n,e=!1){const t=n.length;let r=new Uint32Array(t),s=new Uint32Array(t);for(let i=0;i<t;i++){const{h:o,l:a}=UU(n[i],e);[r[i],s[i]]=[o,a]}return[r,s]}const U2=(n,e,t)=>n>>>t,$2=(n,e,t)=>n<<32-t|e>>>t,Za=(n,e,t)=>n>>>t|e<<32-t,Ja=(n,e,t)=>n<<32-t|e>>>t,Op=(n,e,t)=>n<<64-t|e>>>t-32,xp=(n,e,t)=>n>>>t-32|e<<64-t,cY=(n,e)=>e,lY=(n,e)=>n,uY=(n,e,t)=>n<<t|e>>>32-t,hY=(n,e,t)=>e<<t|n>>>32-t,dY=(n,e,t)=>e<<t-32|n>>>64-t,fY=(n,e,t)=>n<<t-32|e>>>64-t;function fi(n,e,t,r){const s=(e>>>0)+(r>>>0);return{h:n+t+(s/2**32|0)|0,l:s|0}}const b_=(n,e,t)=>(n>>>0)+(e>>>0)+(t>>>0),E_=(n,e,t,r)=>e+t+r+(n/2**32|0)|0,pY=(n,e,t,r)=>(n>>>0)+(e>>>0)+(t>>>0)+(r>>>0),gY=(n,e,t,r,s)=>e+t+r+s+(n/2**32|0)|0,mY=(n,e,t,r,s)=>(n>>>0)+(e>>>0)+(t>>>0)+(r>>>0)+(s>>>0),yY=(n,e,t,r,s,i)=>e+t+r+s+i+(n/2**32|0)|0,rh=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;function v_(n){return n instanceof Uint8Array||ArrayBuffer.isView(n)&&n.constructor.name==="Uint8Array"}function ya(n){if(!Number.isSafeInteger(n)||n<0)throw new Error("positive integer expected, got "+n)}function ri(n,...e){if(!v_(n))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(n.length))throw new Error("Uint8Array expected of length "+e+", got length="+n.length)}function A_(n){if(typeof n!="function"||typeof n.create!="function")throw new Error("Hash should be wrapped by utils.createHasher");ya(n.outputLen),ya(n.blockLen)}function $c(n,e=!0){if(n.destroyed)throw new Error("Hash instance has been destroyed");if(e&&n.finished)throw new Error("Hash#digest() has already been called")}function C_(n,e){ri(n);const t=e.outputLen;if(n.length<t)throw new Error("digestInto() expects output buffer of length at least "+t)}function jg(n){return new Uint32Array(n.buffer,n.byteOffset,Math.floor(n.byteLength/4))}function si(...n){for(let e=0;e<n.length;e++)n[e].fill(0)}function Wv(n){return new DataView(n.buffer,n.byteOffset,n.byteLength)}function Vi(n,e){return n<<32-e|n>>>e}const MU=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function LU(n){return n<<24&4278190080|n<<8&16711680|n>>>8&65280|n>>>24&255}const Mo=MU?n=>n:n=>LU(n);function wY(n){for(let e=0;e<n.length;e++)n[e]=LU(n[e]);return n}const Xa=MU?n=>n:wY,BU=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",bY=Array.from({length:256},(n,e)=>e.toString(16).padStart(2,"0"));function Hg(n){if(ri(n),BU)return n.toHex();let e="";for(let t=0;t<n.length;t++)e+=bY[n[t]];return e}const Do={_0:48,_9:57,A:65,F:70,a:97,f:102};function M2(n){if(n>=Do._0&&n<=Do._9)return n-Do._0;if(n>=Do.A&&n<=Do.F)return n-(Do.A-10);if(n>=Do.a&&n<=Do.f)return n-(Do.a-10)}function I_(n){if(typeof n!="string")throw new Error("hex string expected, got "+typeof n);if(BU)return Uint8Array.fromHex(n);const e=n.length,t=e/2;if(e%2)throw new Error("hex string expected, got unpadded hex of length "+e);const r=new Uint8Array(t);for(let s=0,i=0;s<t;s++,i+=2){const o=M2(n.charCodeAt(i)),a=M2(n.charCodeAt(i+1));if(o===void 0||a===void 0){const c=n[i]+n[i+1];throw new Error('hex string expected, got non-hex character "'+c+'" at index '+i)}r[s]=o*16+a}return r}function EY(n){if(typeof n!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(n))}function Ni(n){return typeof n=="string"&&(n=EY(n)),ri(n),n}function Cl(...n){let e=0;for(let r=0;r<n.length;r++){const s=n[r];ri(s),e+=s.length}const t=new Uint8Array(e);for(let r=0,s=0;r<n.length;r++){const i=n[r];t.set(i,s),s+=i.length}return t}let Jb=class{};function fy(n){const e=r=>n().update(Ni(r)).digest(),t=n();return e.outputLen=t.outputLen,e.blockLen=t.blockLen,e.create=()=>n(),e}function vY(n){const e=(r,s)=>n(s).update(Ni(r)).digest(),t=n({});return e.outputLen=t.outputLen,e.blockLen=t.blockLen,e.create=r=>n(r),e}function Lf(n=32){if(rh&&typeof rh.getRandomValues=="function")return rh.getRandomValues(new Uint8Array(n));if(rh&&typeof rh.randomBytes=="function")return Uint8Array.from(rh.randomBytes(n));throw new Error("crypto.getRandomValues must be defined")}const AY=BigInt(0),hp=BigInt(1),CY=BigInt(2),IY=BigInt(7),_Y=BigInt(256),SY=BigInt(113),FU=[],jU=[],HU=[];for(let n=0,e=hp,t=1,r=0;n<24;n++){[t,r]=[r,(2*t+3*r)%5],FU.push(2*(5*r+t)),jU.push((n+1)*(n+2)/2%64);let s=AY;for(let i=0;i<7;i++)e=(e<<hp^(e>>IY)*SY)%_Y,e&CY&&(s^=hp<<(hp<<BigInt(i))-hp);HU.push(s)}const VU=$U(HU,!0),TY=VU[0],NY=VU[1],L2=(n,e,t)=>t>32?dY(n,e,t):uY(n,e,t),B2=(n,e,t)=>t>32?fY(n,e,t):hY(n,e,t);function OY(n,e=24){const t=new Uint32Array(10);for(let r=24-e;r<24;r++){for(let o=0;o<10;o++)t[o]=n[o]^n[o+10]^n[o+20]^n[o+30]^n[o+40];for(let o=0;o<10;o+=2){const a=(o+8)%10,c=(o+2)%10,l=t[c],u=t[c+1],h=L2(l,u,1)^t[a],d=B2(l,u,1)^t[a+1];for(let f=0;f<50;f+=10)n[o+f]^=h,n[o+f+1]^=d}let s=n[2],i=n[3];for(let o=0;o<24;o++){const a=jU[o],c=L2(s,i,a),l=B2(s,i,a),u=FU[o];s=n[u],i=n[u+1],n[u]=c,n[u+1]=l}for(let o=0;o<50;o+=10){for(let a=0;a<10;a++)t[a]=n[o+a];for(let a=0;a<10;a++)n[o+a]^=~t[(a+2)%10]&t[(a+4)%10]}n[0]^=TY[r],n[1]^=NY[r]}si(t)}let xY=class qU extends Jb{constructor(e,t,r,s=!1,i=24){if(super(),this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,this.enableXOF=!1,this.blockLen=e,this.suffix=t,this.outputLen=r,this.enableXOF=s,this.rounds=i,ya(r),!(0<e&&e<200))throw new Error("only keccak-f1600 function is supported");this.state=new Uint8Array(200),this.state32=jg(this.state)}clone(){return this._cloneInto()}keccak(){Xa(this.state32),OY(this.state32,this.rounds),Xa(this.state32),this.posOut=0,this.pos=0}update(e){$c(this),e=Ni(e),ri(e);const{blockLen:t,state:r}=this,s=e.length;for(let i=0;i<s;){const o=Math.min(t-this.pos,s-i);for(let a=0;a<o;a++)r[this.pos++]^=e[i++];this.pos===t&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:t,pos:r,blockLen:s}=this;e[r]^=t,t&128&&r===s-1&&this.keccak(),e[s-1]^=128,this.keccak()}writeInto(e){$c(this,!1),ri(e),this.finish();const t=this.state,{blockLen:r}=this;for(let s=0,i=e.length;s<i;){this.posOut>=r&&this.keccak();const o=Math.min(r-this.posOut,i-s);e.set(t.subarray(this.posOut,this.posOut+o),s),this.posOut+=o,s+=o}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return ya(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(C_(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,si(this.state)}_cloneInto(e){const{blockLen:t,suffix:r,outputLen:s,rounds:i,enableXOF:o}=this;return e||(e=new qU(t,r,s,o,i)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=i,e.suffix=r,e.outputLen=s,e.enableXOF=o,e.destroyed=this.destroyed,e}};const RY=(n,e,t)=>fy(()=>new xY(e,n,t)),PY=RY(1,136,256/8);function kY(n,e,t,r){if(typeof n.setBigUint64=="function")return n.setBigUint64(e,t,r);const s=BigInt(32),i=BigInt(4294967295),o=Number(t>>s&i),a=Number(t&i),c=r?4:0,l=r?0:4;n.setUint32(e+c,o,r),n.setUint32(e+l,a,r)}function DY(n,e,t){return n&e^~n&t}function UY(n,e,t){return n&e^n&t^e&t}let zU=class extends Jb{constructor(e,t,r,s){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=e,this.outputLen=t,this.padOffset=r,this.isLE=s,this.buffer=new Uint8Array(e),this.view=Wv(this.buffer)}update(e){$c(this),e=Ni(e),ri(e);const{view:t,buffer:r,blockLen:s}=this,i=e.length;for(let o=0;o<i;){const a=Math.min(s-this.pos,i-o);if(a===s){const c=Wv(e);for(;s<=i-o;o+=s)this.process(c,o);continue}r.set(e.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===s&&(this.process(t,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){$c(this),C_(e,this),this.finished=!0;const{buffer:t,view:r,blockLen:s,isLE:i}=this;let{pos:o}=this;t[o++]=128,si(this.buffer.subarray(o)),this.padOffset>s-o&&(this.process(r,0),o=0);for(let h=o;h<s;h++)t[h]=0;kY(r,s-8,BigInt(this.length*8),i),this.process(r,0);const a=Wv(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const l=c/4,u=this.get();if(l>u.length)throw new Error("_sha2: outputLen bigger than state");for(let h=0;h<l;h++)a.setUint32(4*h,u[h],i)}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const r=e.slice(0,t);return this.destroy(),r}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:t,buffer:r,length:s,finished:i,destroyed:o,pos:a}=this;return e.destroyed=o,e.finished=i,e.length=s,e.pos=a,s%t&&e.buffer.set(r),e}clone(){return this._cloneInto()}};const Ma=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),er=Uint32Array.from([3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]),tr=Uint32Array.from([1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209]),$Y=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),La=new Uint32Array(64);let MY=class extends zU{constructor(e=32){super(64,e,8,!1),this.A=Ma[0]|0,this.B=Ma[1]|0,this.C=Ma[2]|0,this.D=Ma[3]|0,this.E=Ma[4]|0,this.F=Ma[5]|0,this.G=Ma[6]|0,this.H=Ma[7]|0}get(){const{A:e,B:t,C:r,D:s,E:i,F:o,G:a,H:c}=this;return[e,t,r,s,i,o,a,c]}set(e,t,r,s,i,o,a,c){this.A=e|0,this.B=t|0,this.C=r|0,this.D=s|0,this.E=i|0,this.F=o|0,this.G=a|0,this.H=c|0}process(e,t){for(let h=0;h<16;h++,t+=4)La[h]=e.getUint32(t,!1);for(let h=16;h<64;h++){const d=La[h-15],f=La[h-2],p=Vi(d,7)^Vi(d,18)^d>>>3,g=Vi(f,17)^Vi(f,19)^f>>>10;La[h]=g+La[h-7]+p+La[h-16]|0}let{A:r,B:s,C:i,D:o,E:a,F:c,G:l,H:u}=this;for(let h=0;h<64;h++){const d=Vi(a,6)^Vi(a,11)^Vi(a,25),f=u+d+DY(a,c,l)+$Y[h]+La[h]|0,p=(Vi(r,2)^Vi(r,13)^Vi(r,22))+UY(r,s,i)|0;u=l,l=c,c=a,a=o+f|0,o=i,i=s,s=r,r=f+p|0}r=r+this.A|0,s=s+this.B|0,i=i+this.C|0,o=o+this.D|0,a=a+this.E|0,c=c+this.F|0,l=l+this.G|0,u=u+this.H|0,this.set(r,s,i,o,a,c,l,u)}roundClean(){si(La)}destroy(){this.set(0,0,0,0,0,0,0,0),si(this.buffer)}};const WU=$U(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(n=>BigInt(n))),LY=WU[0],BY=WU[1],Ba=new Uint32Array(80),Fa=new Uint32Array(80);let __=class extends zU{constructor(e=64){super(128,e,16,!1),this.Ah=tr[0]|0,this.Al=tr[1]|0,this.Bh=tr[2]|0,this.Bl=tr[3]|0,this.Ch=tr[4]|0,this.Cl=tr[5]|0,this.Dh=tr[6]|0,this.Dl=tr[7]|0,this.Eh=tr[8]|0,this.El=tr[9]|0,this.Fh=tr[10]|0,this.Fl=tr[11]|0,this.Gh=tr[12]|0,this.Gl=tr[13]|0,this.Hh=tr[14]|0,this.Hl=tr[15]|0}get(){const{Ah:e,Al:t,Bh:r,Bl:s,Ch:i,Cl:o,Dh:a,Dl:c,Eh:l,El:u,Fh:h,Fl:d,Gh:f,Gl:p,Hh:g,Hl:m}=this;return[e,t,r,s,i,o,a,c,l,u,h,d,f,p,g,m]}set(e,t,r,s,i,o,a,c,l,u,h,d,f,p,g,m){this.Ah=e|0,this.Al=t|0,this.Bh=r|0,this.Bl=s|0,this.Ch=i|0,this.Cl=o|0,this.Dh=a|0,this.Dl=c|0,this.Eh=l|0,this.El=u|0,this.Fh=h|0,this.Fl=d|0,this.Gh=f|0,this.Gl=p|0,this.Hh=g|0,this.Hl=m|0}process(e,t){for(let A=0;A<16;A++,t+=4)Ba[A]=e.getUint32(t),Fa[A]=e.getUint32(t+=4);for(let A=16;A<80;A++){const T=Ba[A-15]|0,N=Fa[A-15]|0,R=Za(T,N,1)^Za(T,N,8)^U2(T,N,7),M=Ja(T,N,1)^Ja(T,N,8)^$2(T,N,7),D=Ba[A-2]|0,S=Fa[A-2]|0,$=Za(D,S,19)^Op(D,S,61)^U2(D,S,6),P=Ja(D,S,19)^xp(D,S,61)^$2(D,S,6),L=pY(M,P,Fa[A-7],Fa[A-16]),V=gY(L,R,$,Ba[A-7],Ba[A-16]);Ba[A]=V|0,Fa[A]=L|0}let{Ah:r,Al:s,Bh:i,Bl:o,Ch:a,Cl:c,Dh:l,Dl:u,Eh:h,El:d,Fh:f,Fl:p,Gh:g,Gl:m,Hh:w,Hl:v}=this;for(let A=0;A<80;A++){const T=Za(h,d,14)^Za(h,d,18)^Op(h,d,41),N=Ja(h,d,14)^Ja(h,d,18)^xp(h,d,41),R=h&f^~h&g,M=d&p^~d&m,D=mY(v,N,M,BY[A],Fa[A]),S=yY(D,w,T,R,LY[A],Ba[A]),$=D|0,P=Za(r,s,28)^Op(r,s,34)^Op(r,s,39),L=Ja(r,s,28)^xp(r,s,34)^xp(r,s,39),V=r&i^r&a^i&a,G=s&o^s&c^o&c;w=g|0,v=m|0,g=f|0,m=p|0,f=h|0,p=d|0,{h,l:d}=fi(l|0,u|0,S|0,$|0),l=a|0,u=c|0,a=i|0,c=o|0,i=r|0,o=s|0;const E=b_($,L,G);r=E_(E,S,P,V),s=E|0}({h:r,l:s}=fi(this.Ah|0,this.Al|0,r|0,s|0)),{h:i,l:o}=fi(this.Bh|0,this.Bl|0,i|0,o|0),{h:a,l:c}=fi(this.Ch|0,this.Cl|0,a|0,c|0),{h:l,l:u}=fi(this.Dh|0,this.Dl|0,l|0,u|0),{h,l:d}=fi(this.Eh|0,this.El|0,h|0,d|0),{h:f,l:p}=fi(this.Fh|0,this.Fl|0,f|0,p|0),{h:g,l:m}=fi(this.Gh|0,this.Gl|0,g|0,m|0),{h:w,l:v}=fi(this.Hh|0,this.Hl|0,w|0,v|0),this.set(r,s,i,o,a,c,l,u,h,d,f,p,g,m,w,v)}roundClean(){si(Ba,Fa)}destroy(){si(this.buffer),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}},FY=class extends __{constructor(){super(48),this.Ah=er[0]|0,this.Al=er[1]|0,this.Bh=er[2]|0,this.Bl=er[3]|0,this.Ch=er[4]|0,this.Cl=er[5]|0,this.Dh=er[6]|0,this.Dl=er[7]|0,this.Eh=er[8]|0,this.El=er[9]|0,this.Fh=er[10]|0,this.Fl=er[11]|0,this.Gh=er[12]|0,this.Gl=er[13]|0,this.Hh=er[14]|0,this.Hl=er[15]|0}};const nr=Uint32Array.from([573645204,4230739756,2673172387,3360449730,596883563,1867755857,2520282905,1497426621,2519219938,2827943907,3193839141,1401305490,721525244,746961066,246885852,2177182882]);let jY=class extends __{constructor(){super(32),this.Ah=nr[0]|0,this.Al=nr[1]|0,this.Bh=nr[2]|0,this.Bl=nr[3]|0,this.Ch=nr[4]|0,this.Cl=nr[5]|0,this.Dh=nr[6]|0,this.Dl=nr[7]|0,this.Eh=nr[8]|0,this.El=nr[9]|0,this.Fh=nr[10]|0,this.Fl=nr[11]|0,this.Gh=nr[12]|0,this.Gl=nr[13]|0,this.Hh=nr[14]|0,this.Hl=nr[15]|0}};const Xb=fy(()=>new MY),HY=fy(()=>new __),VY=fy(()=>new FY),qY=fy(()=>new jY),zY=Uint8Array.from([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9]),yn=Uint32Array.from([4089235720,1779033703,2227873595,3144134277,4271175723,1013904242,1595750129,2773480762,2917565137,1359893119,725511199,2600822924,4215389547,528734635,327033209,1541459225]),ue=new Uint32Array(32);function ja(n,e,t,r,s,i){const o=s[i],a=s[i+1];let c=ue[2*n],l=ue[2*n+1],u=ue[2*e],h=ue[2*e+1],d=ue[2*t],f=ue[2*t+1],p=ue[2*r],g=ue[2*r+1],m=b_(c,u,o);l=E_(m,l,h,a),c=m|0,{Dh:g,Dl:p}={Dh:g^l,Dl:p^c},{Dh:g,Dl:p}={Dh:cY(g,p),Dl:lY(g)},{h:f,l:d}=fi(f,d,g,p),{Bh:h,Bl:u}={Bh:h^f,Bl:u^d},{Bh:h,Bl:u}={Bh:Za(h,u,24),Bl:Ja(h,u,24)},ue[2*n]=c,ue[2*n+1]=l,ue[2*e]=u,ue[2*e+1]=h,ue[2*t]=d,ue[2*t+1]=f,ue[2*r]=p,ue[2*r+1]=g}function Ha(n,e,t,r,s,i){const o=s[i],a=s[i+1];let c=ue[2*n],l=ue[2*n+1],u=ue[2*e],h=ue[2*e+1],d=ue[2*t],f=ue[2*t+1],p=ue[2*r],g=ue[2*r+1],m=b_(c,u,o);l=E_(m,l,h,a),c=m|0,{Dh:g,Dl:p}={Dh:g^l,Dl:p^c},{Dh:g,Dl:p}={Dh:Za(g,p,16),Dl:Ja(g,p,16)},{h:f,l:d}=fi(f,d,g,p),{Bh:h,Bl:u}={Bh:h^f,Bl:u^d},{Bh:h,Bl:u}={Bh:Op(h,u,63),Bl:xp(h,u,63)},ue[2*n]=c,ue[2*n+1]=l,ue[2*e]=u,ue[2*e+1]=h,ue[2*t]=d,ue[2*t+1]=f,ue[2*r]=p,ue[2*r+1]=g}function WY(n,e={},t,r,s){if(ya(t),n<0||n>t)throw new Error("outputLen bigger than keyLen");const{key:i,salt:o,personalization:a}=e;if(i!==void 0&&(i.length<1||i.length>t))throw new Error("key length must be undefined or 1.."+t);if(o!==void 0&&o.length!==r)throw new Error("salt must be undefined or "+r);if(a!==void 0&&a.length!==s)throw new Error("personalization must be undefined or "+s)}class GY extends Jb{constructor(e,t){super(),this.finished=!1,this.destroyed=!1,this.length=0,this.pos=0,ya(e),ya(t),this.blockLen=e,this.outputLen=t,this.buffer=new Uint8Array(e),this.buffer32=jg(this.buffer)}update(e){$c(this),e=Ni(e),ri(e);const{blockLen:t,buffer:r,buffer32:s}=this,i=e.length,o=e.byteOffset,a=e.buffer;for(let c=0;c<i;){this.pos===t&&(Xa(s),this.compress(s,0,!1),Xa(s),this.pos=0);const l=Math.min(t-this.pos,i-c),u=o+c;if(l===t&&!(u%4)&&c+l<i){const h=new Uint32Array(a,u,Math.floor((i-c)/4));Xa(h);for(let d=0;c+t<i;d+=s.length,c+=t)this.length+=t,this.compress(h,d,!1);Xa(h);continue}r.set(e.subarray(c,c+l),this.pos),this.pos+=l,this.length+=l,c+=l}return this}digestInto(e){$c(this),C_(e,this);const{pos:t,buffer32:r}=this;this.finished=!0,si(this.buffer.subarray(t)),Xa(r),this.compress(r,0,!0),Xa(r);const s=jg(e);this.get().forEach((i,o)=>s[o]=Mo(i))}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const r=e.slice(0,t);return this.destroy(),r}_cloneInto(e){const{buffer:t,length:r,finished:s,destroyed:i,outputLen:o,pos:a}=this;return e||(e=new this.constructor({dkLen:o})),e.set(...this.get()),e.buffer.set(t),e.destroyed=i,e.finished=s,e.length=r,e.pos=a,e.outputLen=o,e}clone(){return this._cloneInto()}}class KY extends GY{constructor(e={}){const t=e.dkLen===void 0?64:e.dkLen;super(128,t),this.v0l=yn[0]|0,this.v0h=yn[1]|0,this.v1l=yn[2]|0,this.v1h=yn[3]|0,this.v2l=yn[4]|0,this.v2h=yn[5]|0,this.v3l=yn[6]|0,this.v3h=yn[7]|0,this.v4l=yn[8]|0,this.v4h=yn[9]|0,this.v5l=yn[10]|0,this.v5h=yn[11]|0,this.v6l=yn[12]|0,this.v6h=yn[13]|0,this.v7l=yn[14]|0,this.v7h=yn[15]|0,WY(t,e,64,16,16);let{key:r,personalization:s,salt:i}=e,o=0;if(r!==void 0&&(r=Ni(r),o=r.length),this.v0l^=this.outputLen|o<<8|65536|1<<24,i!==void 0){i=Ni(i);const a=jg(i);this.v4l^=Mo(a[0]),this.v4h^=Mo(a[1]),this.v5l^=Mo(a[2]),this.v5h^=Mo(a[3])}if(s!==void 0){s=Ni(s);const a=jg(s);this.v6l^=Mo(a[0]),this.v6h^=Mo(a[1]),this.v7l^=Mo(a[2]),this.v7h^=Mo(a[3])}if(r!==void 0){const a=new Uint8Array(this.blockLen);a.set(r),this.update(a)}}get(){let{v0l:e,v0h:t,v1l:r,v1h:s,v2l:i,v2h:o,v3l:a,v3h:c,v4l:l,v4h:u,v5l:h,v5h:d,v6l:f,v6h:p,v7l:g,v7h:m}=this;return[e,t,r,s,i,o,a,c,l,u,h,d,f,p,g,m]}set(e,t,r,s,i,o,a,c,l,u,h,d,f,p,g,m){this.v0l=e|0,this.v0h=t|0,this.v1l=r|0,this.v1h=s|0,this.v2l=i|0,this.v2h=o|0,this.v3l=a|0,this.v3h=c|0,this.v4l=l|0,this.v4h=u|0,this.v5l=h|0,this.v5h=d|0,this.v6l=f|0,this.v6h=p|0,this.v7l=g|0,this.v7h=m|0}compress(e,t,r){this.get().forEach((c,l)=>ue[l]=c),ue.set(yn,16);let{h:s,l:i}=UU(BigInt(this.length));ue[24]=yn[8]^i,ue[25]=yn[9]^s,r&&(ue[28]=~ue[28],ue[29]=~ue[29]);let o=0;const a=zY;for(let c=0;c<12;c++)ja(0,4,8,12,e,t+2*a[o++]),Ha(0,4,8,12,e,t+2*a[o++]),ja(1,5,9,13,e,t+2*a[o++]),Ha(1,5,9,13,e,t+2*a[o++]),ja(2,6,10,14,e,t+2*a[o++]),Ha(2,6,10,14,e,t+2*a[o++]),ja(3,7,11,15,e,t+2*a[o++]),Ha(3,7,11,15,e,t+2*a[o++]),ja(0,5,10,15,e,t+2*a[o++]),Ha(0,5,10,15,e,t+2*a[o++]),ja(1,6,11,12,e,t+2*a[o++]),Ha(1,6,11,12,e,t+2*a[o++]),ja(2,7,8,13,e,t+2*a[o++]),Ha(2,7,8,13,e,t+2*a[o++]),ja(3,4,9,14,e,t+2*a[o++]),Ha(3,4,9,14,e,t+2*a[o++]);this.v0l^=ue[0]^ue[16],this.v0h^=ue[1]^ue[17],this.v1l^=ue[2]^ue[18],this.v1h^=ue[3]^ue[19],this.v2l^=ue[4]^ue[20],this.v2h^=ue[5]^ue[21],this.v3l^=ue[6]^ue[22],this.v3h^=ue[7]^ue[23],this.v4l^=ue[8]^ue[24],this.v4h^=ue[9]^ue[25],this.v5l^=ue[10]^ue[26],this.v5h^=ue[11]^ue[27],this.v6l^=ue[12]^ue[28],this.v6h^=ue[13]^ue[29],this.v7l^=ue[14]^ue[30],this.v7h^=ue[15]^ue[31],si(ue)}destroy(){this.destroyed=!0,si(this.buffer32),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const YY=vY(n=>new KY(n)),QY="https://rpc.walletconnect.org/v1";function GU(n){const e=`Ethereum Signed Message:
${n.length}`,t=new TextEncoder().encode(e+n);return"0x"+Buffer.from(PY(t)).toString("hex")}async function ZY(n,e,t,r,s,i){switch(t.t){case"eip191":return await JY(n,e,t.s);case"eip1271":return await XY(n,e,t.s,r,s,i);default:throw new Error(`verifySignature failed: Attempted to verify CacaoSignature with unknown type: ${t.t}`)}}async function JY(n,e,t){return(await PW({hash:GU(e),signature:t})).toLowerCase()===n.toLowerCase()}async function XY(n,e,t,r,s,i){const o=ou(r);if(!o.namespace||!o.reference)throw new Error(`isValidEip1271Signature failed: chainId must be in CAIP-2 format, received: ${r}`);try{const a="0x1626ba7e",c="0000000000000000000000000000000000000000000000000000000000000040",l=t.substring(2),u=(l.length/2).toString(16).padStart(64,"0"),h=(e.startsWith("0x")?e:GU(e)).substring(2),d=a+h+c+u+l,f=await fetch(`${i||QY}/?chainId=${r}&projectId=${s}`,{headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify({id:eQ(),jsonrpc:"2.0",method:"eth_call",params:[{to:n,data:d},"latest"]})}),{result:p}=await f.json();return p?p.slice(0,a.length).toLowerCase()===a.toLowerCase():!1}catch(a){return console.error("isValidEip1271Signature: ",a),!1}}function eQ(){return Date.now()+Math.floor(Math.random()*1e3)}function tQ(n){const e=atob(n),t=new Uint8Array(e.length);for(let o=0;o<e.length;o++)t[o]=e.charCodeAt(o);const r=t[0];if(r===0)throw new Error("No signatures found");const s=1+r*64;if(t.length<s)throw new Error("Transaction data too short for claimed signature count");if(t.length<100)throw new Error("Transaction too short");const i=Buffer.from(n,"base64").slice(1,65);return $f.encode(i)}function nQ(n){const e=new Uint8Array(Buffer.from(n,"base64")),t=Array.from("TransactionData::").map(i=>i.charCodeAt(0)),r=new Uint8Array(t.length+e.length);r.set(t),r.set(e,t.length);const s=YY(r,{dkLen:32});return $f.encode(s)}function F2(n){const e=new Uint8Array(Xb(rQ(n)));return $f.encode(e)}function rQ(n){if(n instanceof Uint8Array)return n;if(Array.isArray(n))return new Uint8Array(n);if(typeof n=="object"&&n!=null&&n.data)return new Uint8Array(Object.values(n.data));if(typeof n=="object"&&n)return new Uint8Array(Object.values(n));throw new Error("getNearUint8ArrayFromBytes: Unexpected result type from bytes array")}function j2(n){const e=Buffer.from(n,"base64"),t=mG(e).txn;if(!t)throw new Error("Invalid signed transaction: missing 'txn' field");const r=aG(t),s=Buffer.from("TX"),i=Buffer.concat([s,Buffer.from(r)]),o=qY(i);return IG.encode(o).replace(/=+$/,"")}function Gv(n){const e=[];let t=BigInt(n);for(;t>=BigInt(128);)e.push(Number(t&BigInt(127)|BigInt(128))),t>>=BigInt(7);return e.push(Number(t)),Buffer.from(e)}function sQ(n){const e=Buffer.from(n.signed.bodyBytes,"base64"),t=Buffer.from(n.signed.authInfoBytes,"base64"),r=Buffer.from(n.signature.signature,"base64"),s=[];s.push(Buffer.from([10])),s.push(Gv(e.length)),s.push(e),s.push(Buffer.from([18])),s.push(Gv(t.length)),s.push(t),s.push(Buffer.from([26])),s.push(Gv(r.length)),s.push(r);const i=Buffer.concat(s),o=Xb(i);return Buffer.from(o).toString("hex").toUpperCase()}var iQ=Object.defineProperty,oQ=Object.defineProperties,aQ=Object.getOwnPropertyDescriptors,H2=Object.getOwnPropertySymbols,cQ=Object.prototype.hasOwnProperty,lQ=Object.prototype.propertyIsEnumerable,V2=(n,e,t)=>e in n?iQ(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,uQ=(n,e)=>{for(var t in e||(e={}))cQ.call(e,t)&&V2(n,t,e[t]);if(H2)for(var t of H2(e))lQ.call(e,t)&&V2(n,t,e[t]);return n},hQ=(n,e)=>oQ(n,aQ(e));const dQ="did:pkh:",S_=n=>n==null?void 0:n.split(":"),fQ=n=>{const e=n&&S_(n);if(e)return n.includes(dQ)?e[3]:e[1]},FA=n=>{const e=n&&S_(n);if(e)return e[2]+":"+e[3]},U0=n=>{const e=n&&S_(n);if(e)return e.pop()};async function q2(n){const{cacao:e,projectId:t}=n,{s:r,p:s}=e,i=KU(s,s.iss),o=U0(s.iss);return await ZY(o,i,r,FA(s.iss),t)}const KU=(n,e)=>{const t=`${n.domain} wants you to sign in with your Ethereum account:`,r=U0(e);if(!n.aud&&!n.uri)throw new Error("Either `aud` or `uri` is required to construct the message");let s=n.statement||void 0;const i=`URI: ${n.aud||n.uri}`,o=`Version: ${n.version}`,a=`Chain ID: ${fQ(e)}`,c=`Nonce: ${n.nonce}`,l=`Issued At: ${n.iat}`,u=n.exp?`Expiration Time: ${n.exp}`:void 0,h=n.nbf?`Not Before: ${n.nbf}`:void 0,d=n.requestId?`Request ID: ${n.requestId}`:void 0,f=n.resources?`Resources:${n.resources.map(g=>`
- ${g}`).join("")}`:void 0,p=Zw(n.resources);if(p){const g=Vg(p);s=AQ(s,g)}return[t,r,"",s,"",i,o,a,c,l,u,h,d,f].filter(g=>g!=null).join(`
`)};function pQ(n){return Buffer.from(JSON.stringify(n)).toString("base64")}function gQ(n){return JSON.parse(Buffer.from(n,"base64").toString("utf-8"))}function mu(n){if(!n)throw new Error("No recap provided, value is undefined");if(!n.att)throw new Error("No `att` property found");const e=Object.keys(n.att);if(!(e!=null&&e.length))throw new Error("No resources found in `att` property");e.forEach(t=>{const r=n.att[t];if(Array.isArray(r))throw new Error(`Resource must be an object: ${t}`);if(typeof r!="object")throw new Error(`Resource must be an object: ${t}`);if(!Object.keys(r).length)throw new Error(`Resource object is empty: ${t}`);Object.keys(r).forEach(s=>{const i=r[s];if(!Array.isArray(i))throw new Error(`Ability limits ${s} must be an array of objects, found: ${i}`);if(!i.length)throw new Error(`Value of ${s} is empty array, must be an array with objects`);i.forEach(o=>{if(typeof o!="object")throw new Error(`Ability limits (${s}) must be an array of objects, found: ${o}`)})})})}function mQ(n,e,t,r={}){return t==null||t.sort((s,i)=>s.localeCompare(i)),{att:{[n]:yQ(e,t,r)}}}function yQ(n,e,t={}){e=e==null?void 0:e.sort((s,i)=>s.localeCompare(i));const r=e.map(s=>({[`${n}/${s}`]:[t]}));return Object.assign({},...r)}function YU(n){return mu(n),`urn:recap:${pQ(n).replace(/=/g,"")}`}function Vg(n){const e=gQ(n.replace("urn:recap:",""));return mu(e),e}function wQ(n,e,t){const r=mQ(n,e,t);return YU(r)}function bQ(n){return n&&n.includes("urn:recap:")}function EQ(n,e){const t=Vg(n),r=Vg(e),s=vQ(t,r);return YU(s)}function vQ(n,e){mu(n),mu(e);const t=Object.keys(n.att).concat(Object.keys(e.att)).sort((s,i)=>s.localeCompare(i)),r={att:{}};return t.forEach(s=>{var i,o;Object.keys(((i=n.att)==null?void 0:i[s])||{}).concat(Object.keys(((o=e.att)==null?void 0:o[s])||{})).sort((a,c)=>a.localeCompare(c)).forEach(a=>{var c,l;r.att[s]=hQ(uQ({},r.att[s]),{[a]:((c=n.att[s])==null?void 0:c[a])||((l=e.att[s])==null?void 0:l[a])})})}),r}function AQ(n="",e){mu(e);const t="I further authorize the stated URI to perform the following actions on my behalf: ";if(n.includes(t))return n;const r=[];let s=0;Object.keys(e.att).forEach(a=>{const c=Object.keys(e.att[a]).map(h=>({ability:h.split("/")[0],action:h.split("/")[1]}));c.sort((h,d)=>h.action.localeCompare(d.action));const l={};c.forEach(h=>{l[h.ability]||(l[h.ability]=[]),l[h.ability].push(h.action)});const u=Object.keys(l).map(h=>(s++,`(${s}) '${h}': '${l[h].join("', '")}' for '${a}'.`));r.push(u.join(", ").replace(".,","."))});const i=r.join(" "),o=`${t}${i}`;return`${n?n+" ":""}${o}`}function z2(n){var e;const t=Vg(n);mu(t);const r=(e=t.att)==null?void 0:e.eip155;return r?Object.keys(r).map(s=>s.split("/")[1]):[]}function W2(n){const e=Vg(n);mu(e);const t=[];return Object.values(e.att).forEach(r=>{Object.values(r).forEach(s=>{var i;(i=s==null?void 0:s[0])!=null&&i.chains&&t.push(s[0].chains)})}),[...new Set(t.flat())]}function Zw(n){if(!n)return;const e=n==null?void 0:n[n.length-1];return bQ(e)?e:void 0}/*! noble-ciphers - MIT License (c) 2023 Paul Miller (paulmillr.com) */function QU(n){return n instanceof Uint8Array||ArrayBuffer.isView(n)&&n.constructor.name==="Uint8Array"}function jA(n){if(typeof n!="boolean")throw new Error(`boolean expected, not ${n}`)}function Kv(n){if(!Number.isSafeInteger(n)||n<0)throw new Error("positive integer expected, got "+n)}function es(n,...e){if(!QU(n))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(n.length))throw new Error("Uint8Array expected of length "+e+", got length="+n.length)}function G2(n,e=!0){if(n.destroyed)throw new Error("Hash instance has been destroyed");if(e&&n.finished)throw new Error("Hash#digest() has already been called")}function CQ(n,e){es(n);const t=e.outputLen;if(n.length<t)throw new Error("digestInto() expects output buffer of length at least "+t)}function Sc(n){return new Uint32Array(n.buffer,n.byteOffset,Math.floor(n.byteLength/4))}function sf(...n){for(let e=0;e<n.length;e++)n[e].fill(0)}function IQ(n){return new DataView(n.buffer,n.byteOffset,n.byteLength)}const _Q=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function SQ(n){if(typeof n!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(n))}function HA(n){if(typeof n=="string")n=SQ(n);else if(QU(n))n=VA(n);else throw new Error("Uint8Array expected, got "+typeof n);return n}function TQ(n,e){if(e==null||typeof e!="object")throw new Error("options must be defined");return Object.assign(n,e)}function NQ(n,e){if(n.length!==e.length)return!1;let t=0;for(let r=0;r<n.length;r++)t|=n[r]^e[r];return t===0}const OQ=(n,e)=>{function t(r,...s){if(es(r),!_Q)throw new Error("Non little-endian hardware is not yet supported");if(n.nonceLength!==void 0){const l=s[0];if(!l)throw new Error("nonce / iv required");n.varSizeNonce?es(l):es(l,n.nonceLength)}const i=n.tagLength;i&&s[1]!==void 0&&es(s[1]);const o=e(r,...s),a=(l,u)=>{if(u!==void 0){if(l!==2)throw new Error("cipher output not supported");es(u)}};let c=!1;return{encrypt(l,u){if(c)throw new Error("cannot encrypt() twice with same key + nonce");return c=!0,es(l),a(o.encrypt.length,u),o.encrypt(l,u)},decrypt(l,u){if(es(l),i&&l.length<i)throw new Error("invalid ciphertext length: smaller than tagLength="+i);return a(o.decrypt.length,u),o.decrypt(l,u)}}}return Object.assign(t,n),t};function K2(n,e,t=!0){if(e===void 0)return new Uint8Array(n);if(e.length!==n)throw new Error("invalid output length, expected "+n+", got: "+e.length);if(t&&!RQ(e))throw new Error("invalid output, must be aligned");return e}function Y2(n,e,t,r){if(typeof n.setBigUint64=="function")return n.setBigUint64(e,t,r);const s=BigInt(32),i=BigInt(4294967295),o=Number(t>>s&i),a=Number(t&i);n.setUint32(e+4,o,r),n.setUint32(e+0,a,r)}function xQ(n,e,t){jA(t);const r=new Uint8Array(16),s=IQ(r);return Y2(s,0,BigInt(e),t),Y2(s,8,BigInt(n),t),r}function RQ(n){return n.byteOffset%4===0}function VA(n){return Uint8Array.from(n)}const ZU=n=>Uint8Array.from(n.split("").map(e=>e.charCodeAt(0))),PQ=ZU("expand 16-byte k"),kQ=ZU("expand 32-byte k"),DQ=Sc(PQ),UQ=Sc(kQ);function dt(n,e){return n<<e|n>>>32-e}function qA(n){return n.byteOffset%4===0}const fw=64,$Q=16,JU=2**32-1,Q2=new Uint32Array;function MQ(n,e,t,r,s,i,o,a){const c=s.length,l=new Uint8Array(fw),u=Sc(l),h=qA(s)&&qA(i),d=h?Sc(s):Q2,f=h?Sc(i):Q2;for(let p=0;p<c;o++){if(n(e,t,r,u,o,a),o>=JU)throw new Error("arx: counter overflow");const g=Math.min(fw,c-p);if(h&&g===fw){const m=p/4;if(p%4!==0)throw new Error("arx: invalid block position");for(let w=0,v;w<$Q;w++)v=m+w,f[v]=d[v]^u[w];p+=fw;continue}for(let m=0,w;m<g;m++)w=p+m,i[w]=s[w]^l[m];p+=g}}function LQ(n,e){const{allowShortKeys:t,extendNonceFn:r,counterLength:s,counterRight:i,rounds:o}=TQ({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},e);if(typeof n!="function")throw new Error("core must be a function");return Kv(s),Kv(o),jA(i),jA(t),(a,c,l,u,h=0)=>{es(a),es(c),es(l);const d=l.length;if(u===void 0&&(u=new Uint8Array(d)),es(u),Kv(h),h<0||h>=JU)throw new Error("arx: counter overflow");if(u.length<d)throw new Error(`arx: output (${u.length}) is shorter than data (${d})`);const f=[];let p=a.length,g,m;if(p===32)f.push(g=VA(a)),m=UQ;else if(p===16&&t)g=new Uint8Array(32),g.set(a),g.set(a,16),m=DQ,f.push(g);else throw new Error(`arx: invalid 32-byte key, got length=${p}`);qA(c)||f.push(c=VA(c));const w=Sc(g);if(r){if(c.length!==24)throw new Error("arx: extended nonce must be 24 bytes");r(m,w,Sc(c.subarray(0,16)),w),c=c.subarray(16)}const v=16-s;if(v!==c.length)throw new Error(`arx: nonce must be ${v} or 16 bytes`);if(v!==12){const T=new Uint8Array(12);T.set(c,i?0:12-c.length),c=T,f.push(c)}const A=Sc(c);return MQ(n,m,w,A,l,u,h,o),sf(...f),u}}const $n=(n,e)=>n[e++]&255|(n[e++]&255)<<8;class BQ{constructor(e){this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,e=HA(e),es(e,32);const t=$n(e,0),r=$n(e,2),s=$n(e,4),i=$n(e,6),o=$n(e,8),a=$n(e,10),c=$n(e,12),l=$n(e,14);this.r[0]=t&8191,this.r[1]=(t>>>13|r<<3)&8191,this.r[2]=(r>>>10|s<<6)&7939,this.r[3]=(s>>>7|i<<9)&8191,this.r[4]=(i>>>4|o<<12)&255,this.r[5]=o>>>1&8190,this.r[6]=(o>>>14|a<<2)&8191,this.r[7]=(a>>>11|c<<5)&8065,this.r[8]=(c>>>8|l<<8)&8191,this.r[9]=l>>>5&127;for(let u=0;u<8;u++)this.pad[u]=$n(e,16+2*u)}process(e,t,r=!1){const s=r?0:2048,{h:i,r:o}=this,a=o[0],c=o[1],l=o[2],u=o[3],h=o[4],d=o[5],f=o[6],p=o[7],g=o[8],m=o[9],w=$n(e,t+0),v=$n(e,t+2),A=$n(e,t+4),T=$n(e,t+6),N=$n(e,t+8),R=$n(e,t+10),M=$n(e,t+12),D=$n(e,t+14);let S=i[0]+(w&8191),$=i[1]+((w>>>13|v<<3)&8191),P=i[2]+((v>>>10|A<<6)&8191),L=i[3]+((A>>>7|T<<9)&8191),V=i[4]+((T>>>4|N<<12)&8191),G=i[5]+(N>>>1&8191),E=i[6]+((N>>>14|R<<2)&8191),C=i[7]+((R>>>11|M<<5)&8191),O=i[8]+((M>>>8|D<<8)&8191),U=i[9]+(D>>>5|s),k=0,j=k+S*a+$*(5*m)+P*(5*g)+L*(5*p)+V*(5*f);k=j>>>13,j&=8191,j+=G*(5*d)+E*(5*h)+C*(5*u)+O*(5*l)+U*(5*c),k+=j>>>13,j&=8191;let q=k+S*c+$*a+P*(5*m)+L*(5*g)+V*(5*p);k=q>>>13,q&=8191,q+=G*(5*f)+E*(5*d)+C*(5*h)+O*(5*u)+U*(5*l),k+=q>>>13,q&=8191;let X=k+S*l+$*c+P*a+L*(5*m)+V*(5*g);k=X>>>13,X&=8191,X+=G*(5*p)+E*(5*f)+C*(5*d)+O*(5*h)+U*(5*u),k+=X>>>13,X&=8191;let ce=k+S*u+$*l+P*c+L*a+V*(5*m);k=ce>>>13,ce&=8191,ce+=G*(5*g)+E*(5*p)+C*(5*f)+O*(5*d)+U*(5*h),k+=ce>>>13,ce&=8191;let te=k+S*h+$*u+P*l+L*c+V*a;k=te>>>13,te&=8191,te+=G*(5*m)+E*(5*g)+C*(5*p)+O*(5*f)+U*(5*d),k+=te>>>13,te&=8191;let de=k+S*d+$*h+P*u+L*l+V*c;k=de>>>13,de&=8191,de+=G*a+E*(5*m)+C*(5*g)+O*(5*p)+U*(5*f),k+=de>>>13,de&=8191;let De=k+S*f+$*d+P*h+L*u+V*l;k=De>>>13,De&=8191,De+=G*c+E*a+C*(5*m)+O*(5*g)+U*(5*p),k+=De>>>13,De&=8191;let Qe=k+S*p+$*f+P*d+L*h+V*u;k=Qe>>>13,Qe&=8191,Qe+=G*l+E*c+C*a+O*(5*m)+U*(5*g),k+=Qe>>>13,Qe&=8191;let Je=k+S*g+$*p+P*f+L*d+V*h;k=Je>>>13,Je&=8191,Je+=G*u+E*l+C*c+O*a+U*(5*m),k+=Je>>>13,Je&=8191;let Me=k+S*m+$*g+P*p+L*f+V*d;k=Me>>>13,Me&=8191,Me+=G*h+E*u+C*l+O*c+U*a,k+=Me>>>13,Me&=8191,k=(k<<2)+k|0,k=k+j|0,j=k&8191,k=k>>>13,q+=k,i[0]=j,i[1]=q,i[2]=X,i[3]=ce,i[4]=te,i[5]=de,i[6]=De,i[7]=Qe,i[8]=Je,i[9]=Me}finalize(){const{h:e,pad:t}=this,r=new Uint16Array(10);let s=e[1]>>>13;e[1]&=8191;for(let a=2;a<10;a++)e[a]+=s,s=e[a]>>>13,e[a]&=8191;e[0]+=s*5,s=e[0]>>>13,e[0]&=8191,e[1]+=s,s=e[1]>>>13,e[1]&=8191,e[2]+=s,r[0]=e[0]+5,s=r[0]>>>13,r[0]&=8191;for(let a=1;a<10;a++)r[a]=e[a]+s,s=r[a]>>>13,r[a]&=8191;r[9]-=8192;let i=(s^1)-1;for(let a=0;a<10;a++)r[a]&=i;i=~i;for(let a=0;a<10;a++)e[a]=e[a]&i|r[a];e[0]=(e[0]|e[1]<<13)&65535,e[1]=(e[1]>>>3|e[2]<<10)&65535,e[2]=(e[2]>>>6|e[3]<<7)&65535,e[3]=(e[3]>>>9|e[4]<<4)&65535,e[4]=(e[4]>>>12|e[5]<<1|e[6]<<14)&65535,e[5]=(e[6]>>>2|e[7]<<11)&65535,e[6]=(e[7]>>>5|e[8]<<8)&65535,e[7]=(e[8]>>>8|e[9]<<5)&65535;let o=e[0]+t[0];e[0]=o&65535;for(let a=1;a<8;a++)o=(e[a]+t[a]|0)+(o>>>16)|0,e[a]=o&65535;sf(r)}update(e){G2(this),e=HA(e),es(e);const{buffer:t,blockLen:r}=this,s=e.length;for(let i=0;i<s;){const o=Math.min(r-this.pos,s-i);if(o===r){for(;r<=s-i;i+=r)this.process(e,i);continue}t.set(e.subarray(i,i+o),this.pos),this.pos+=o,i+=o,this.pos===r&&(this.process(t,0,!1),this.pos=0)}return this}destroy(){sf(this.h,this.r,this.buffer,this.pad)}digestInto(e){G2(this),CQ(e,this),this.finished=!0;const{buffer:t,h:r}=this;let{pos:s}=this;if(s){for(t[s++]=1;s<16;s++)t[s]=0;this.process(t,0,!0)}this.finalize();let i=0;for(let o=0;o<8;o++)e[i++]=r[o]>>>0,e[i++]=r[o]>>>8;return e}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const r=e.slice(0,t);return this.destroy(),r}}function FQ(n){const e=(r,s)=>n(s).update(HA(r)).digest(),t=n(new Uint8Array(32));return e.outputLen=t.outputLen,e.blockLen=t.blockLen,e.create=r=>n(r),e}const jQ=FQ(n=>new BQ(n));function HQ(n,e,t,r,s,i=20){let o=n[0],a=n[1],c=n[2],l=n[3],u=e[0],h=e[1],d=e[2],f=e[3],p=e[4],g=e[5],m=e[6],w=e[7],v=s,A=t[0],T=t[1],N=t[2],R=o,M=a,D=c,S=l,$=u,P=h,L=d,V=f,G=p,E=g,C=m,O=w,U=v,k=A,j=T,q=N;for(let ce=0;ce<i;ce+=2)R=R+$|0,U=dt(U^R,16),G=G+U|0,$=dt($^G,12),R=R+$|0,U=dt(U^R,8),G=G+U|0,$=dt($^G,7),M=M+P|0,k=dt(k^M,16),E=E+k|0,P=dt(P^E,12),M=M+P|0,k=dt(k^M,8),E=E+k|0,P=dt(P^E,7),D=D+L|0,j=dt(j^D,16),C=C+j|0,L=dt(L^C,12),D=D+L|0,j=dt(j^D,8),C=C+j|0,L=dt(L^C,7),S=S+V|0,q=dt(q^S,16),O=O+q|0,V=dt(V^O,12),S=S+V|0,q=dt(q^S,8),O=O+q|0,V=dt(V^O,7),R=R+P|0,q=dt(q^R,16),C=C+q|0,P=dt(P^C,12),R=R+P|0,q=dt(q^R,8),C=C+q|0,P=dt(P^C,7),M=M+L|0,U=dt(U^M,16),O=O+U|0,L=dt(L^O,12),M=M+L|0,U=dt(U^M,8),O=O+U|0,L=dt(L^O,7),D=D+V|0,k=dt(k^D,16),G=G+k|0,V=dt(V^G,12),D=D+V|0,k=dt(k^D,8),G=G+k|0,V=dt(V^G,7),S=S+$|0,j=dt(j^S,16),E=E+j|0,$=dt($^E,12),S=S+$|0,j=dt(j^S,8),E=E+j|0,$=dt($^E,7);let X=0;r[X++]=o+R|0,r[X++]=a+M|0,r[X++]=c+D|0,r[X++]=l+S|0,r[X++]=u+$|0,r[X++]=h+P|0,r[X++]=d+L|0,r[X++]=f+V|0,r[X++]=p+G|0,r[X++]=g+E|0,r[X++]=m+C|0,r[X++]=w+O|0,r[X++]=v+U|0,r[X++]=A+k|0,r[X++]=T+j|0,r[X++]=N+q|0}const VQ=LQ(HQ,{counterRight:!1,counterLength:4,allowShortKeys:!1}),qQ=new Uint8Array(16),Z2=(n,e)=>{n.update(e);const t=e.length%16;t&&n.update(qQ.subarray(t))},zQ=new Uint8Array(32);function J2(n,e,t,r,s){const i=n(e,t,zQ),o=jQ.create(i);s&&Z2(o,s),Z2(o,r);const a=xQ(r.length,s?s.length:0,!0);o.update(a);const c=o.digest();return sf(i,a),c}const WQ=n=>(e,t,r)=>({encrypt(s,i){const o=s.length;i=K2(o+16,i,!1),i.set(s);const a=i.subarray(0,-16);n(e,t,a,a,1);const c=J2(n,e,t,a,r);return i.set(c,o),sf(c),i},decrypt(s,i){i=K2(s.length-16,i,!1);const o=s.subarray(0,-16),a=s.subarray(-16),c=J2(n,e,t,o,r);if(!NQ(a,c))throw new Error("invalid tag");return i.set(s.subarray(0,-16)),n(e,t,i,i,1),sf(c),i}}),XU=OQ({blockSize:64,nonceLength:12,tagLength:16},WQ(VQ));let e$=class extends Jb{constructor(e,t){super(),this.finished=!1,this.destroyed=!1,A_(e);const r=Ni(t);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const s=this.blockLen,i=new Uint8Array(s);i.set(r.length>s?e.create().update(r).digest():r);for(let o=0;o<i.length;o++)i[o]^=54;this.iHash.update(i),this.oHash=e.create();for(let o=0;o<i.length;o++)i[o]^=106;this.oHash.update(i),si(i)}update(e){return $c(this),this.iHash.update(e),this}digestInto(e){$c(this),ri(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:t,iHash:r,finished:s,destroyed:i,blockLen:o,outputLen:a}=this;return e=e,e.finished=s,e.destroyed=i,e.blockLen=o,e.outputLen=a,e.oHash=t._cloneInto(e.oHash),e.iHash=r._cloneInto(e.iHash),e}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}};const eE=(n,e,t)=>new e$(n,e).update(t).digest();eE.create=(n,e)=>new e$(n,e);function GQ(n,e,t){return A_(n),t===void 0&&(t=new Uint8Array(n.outputLen)),eE(n,Ni(t),Ni(e))}const Yv=Uint8Array.from([0]),X2=Uint8Array.of();function KQ(n,e,t,r=32){A_(n),ya(r);const s=n.outputLen;if(r>255*s)throw new Error("Length should be <= 255*HashLen");const i=Math.ceil(r/s);t===void 0&&(t=X2);const o=new Uint8Array(i*s),a=eE.create(n,e),c=a._cloneInto(),l=new Uint8Array(a.outputLen);for(let u=0;u<i;u++)Yv[0]=u+1,c.update(u===0?X2:l).update(t).update(Yv).digestInto(l),o.set(l,s*u),a._cloneInto(c);return a.destroy(),c.destroy(),si(l,Yv),o.slice(0,r)}const YQ=(n,e,t,r,s)=>KQ(n,GQ(n,e,t),r,s),tE=Xb,T_=BigInt(0),zA=BigInt(1);function $0(n,e){if(typeof e!="boolean")throw new Error(n+" boolean expected, got "+e)}function pw(n){const e=n.toString(16);return e.length&1?"0"+e:e}function t$(n){if(typeof n!="string")throw new Error("hex string expected, got "+typeof n);return n===""?T_:BigInt("0x"+n)}function nE(n){return t$(Hg(n))}function M0(n){return ri(n),t$(Hg(Uint8Array.from(n).reverse()))}function N_(n,e){return I_(n.toString(16).padStart(e*2,"0"))}function O_(n,e){return N_(n,e).reverse()}function Xr(n,e,t){let r;if(typeof e=="string")try{r=I_(e)}catch(i){throw new Error(n+" must be hex string or Uint8Array, cause: "+i)}else if(v_(e))r=Uint8Array.from(e);else throw new Error(n+" must be hex string or Uint8Array");const s=r.length;if(typeof t=="number"&&s!==t)throw new Error(n+" of length "+t+" expected, got "+s);return r}const Qv=n=>typeof n=="bigint"&&T_<=n;function QQ(n,e,t){return Qv(n)&&Qv(e)&&Qv(t)&&e<=n&&n<t}function WA(n,e,t,r){if(!QQ(e,t,r))throw new Error("expected valid "+n+": "+t+" <= n < "+r+", got "+e)}function ZQ(n){let e;for(e=0;n>T_;n>>=zA,e+=1);return e}const rE=n=>(zA<<BigInt(n))-zA;function JQ(n,e,t){if(typeof n!="number"||n<2)throw new Error("hashLen must be a number");if(typeof e!="number"||e<2)throw new Error("qByteLen must be a number");if(typeof t!="function")throw new Error("hmacFn must be a function");const r=d=>new Uint8Array(d),s=d=>Uint8Array.of(d);let i=r(n),o=r(n),a=0;const c=()=>{i.fill(1),o.fill(0),a=0},l=(...d)=>t(o,i,...d),u=(d=r(0))=>{o=l(s(0),d),i=l(),d.length!==0&&(o=l(s(1),d),i=l())},h=()=>{if(a++>=1e3)throw new Error("drbg: tried 1000 values");let d=0;const f=[];for(;d<e;){i=l();const p=i.slice();f.push(p),d+=i.length}return Cl(...f)};return(d,f)=>{c(),u(d);let p;for(;!(p=f(h()));)u();return c(),p}}function sE(n,e,t={}){if(!n||typeof n!="object")throw new Error("expected valid options object");function r(s,i,o){const a=n[s];if(o&&a===void 0)return;const c=typeof a;if(c!==i||a===null)throw new Error(`param "${s}" is invalid: expected ${i}, got ${c}`)}Object.entries(e).forEach(([s,i])=>r(s,i,!1)),Object.entries(t).forEach(([s,i])=>r(s,i,!0))}function eO(n){const e=new WeakMap;return(t,...r)=>{const s=e.get(t);if(s!==void 0)return s;const i=n(t,...r);return e.set(t,i),i}}const os=BigInt(0),Ur=BigInt(1),Il=BigInt(2),XQ=BigInt(3),n$=BigInt(4),r$=BigInt(5),s$=BigInt(8);function Qs(n,e){const t=n%e;return t>=os?t:e+t}function di(n,e,t){let r=n;for(;e-- >os;)r*=r,r%=t;return r}function tO(n,e){if(n===os)throw new Error("invert: expected non-zero number");if(e<=os)throw new Error("invert: expected positive modulus, got "+e);let t=Qs(n,e),r=e,s=os,i=Ur;for(;t!==os;){const o=r/t,a=r%t,c=s-i*o;r=t,t=a,s=i,i=c}if(r!==Ur)throw new Error("invert: does not exist");return Qs(s,e)}function i$(n,e){const t=(n.ORDER+Ur)/n$,r=n.pow(e,t);if(!n.eql(n.sqr(r),e))throw new Error("Cannot find square root");return r}function eZ(n,e){const t=(n.ORDER-r$)/s$,r=n.mul(e,Il),s=n.pow(r,t),i=n.mul(e,s),o=n.mul(n.mul(i,Il),s),a=n.mul(i,n.sub(o,n.ONE));if(!n.eql(n.sqr(a),e))throw new Error("Cannot find square root");return a}function tZ(n){if(n<BigInt(3))throw new Error("sqrt is not defined for small field");let e=n-Ur,t=0;for(;e%Il===os;)e/=Il,t++;let r=Il;const s=Bf(n);for(;nO(s,r)===1;)if(r++>1e3)throw new Error("Cannot find square root: probably non-prime P");if(t===1)return i$;let i=s.pow(r,e);const o=(e+Ur)/Il;return function(a,c){if(a.is0(c))return c;if(nO(a,c)!==1)throw new Error("Cannot find square root");let l=t,u=a.mul(a.ONE,i),h=a.pow(c,e),d=a.pow(c,o);for(;!a.eql(h,a.ONE);){if(a.is0(h))return a.ZERO;let f=1,p=a.sqr(h);for(;!a.eql(p,a.ONE);)if(f++,p=a.sqr(p),f===l)throw new Error("Cannot find square root");const g=Ur<<BigInt(l-f-1),m=a.pow(u,g);l=f,u=a.sqr(m),h=a.mul(h,u),d=a.mul(d,m)}return d}}function nZ(n){return n%n$===XQ?i$:n%s$===r$?eZ:tZ(n)}const rZ=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function sZ(n){const e={ORDER:"bigint",MASK:"bigint",BYTES:"number",BITS:"number"},t=rZ.reduce((r,s)=>(r[s]="function",r),e);return sE(n,t),n}function iZ(n,e,t){if(t<os)throw new Error("invalid exponent, negatives unsupported");if(t===os)return n.ONE;if(t===Ur)return e;let r=n.ONE,s=e;for(;t>os;)t&Ur&&(r=n.mul(r,s)),s=n.sqr(s),t>>=Ur;return r}function o$(n,e,t=!1){const r=new Array(e.length).fill(t?n.ZERO:void 0),s=e.reduce((o,a,c)=>n.is0(a)?o:(r[c]=o,n.mul(o,a)),n.ONE),i=n.inv(s);return e.reduceRight((o,a,c)=>n.is0(a)?o:(r[c]=n.mul(o,r[c]),n.mul(o,a)),i),r}function nO(n,e){const t=(n.ORDER-Ur)/Il,r=n.pow(e,t),s=n.eql(r,n.ONE),i=n.eql(r,n.ZERO),o=n.eql(r,n.neg(n.ONE));if(!s&&!i&&!o)throw new Error("invalid Legendre symbol result");return s?1:i?0:-1}function oZ(n,e){e!==void 0&&ya(e);const t=e!==void 0?e:n.toString(2).length,r=Math.ceil(t/8);return{nBitLength:t,nByteLength:r}}function Bf(n,e,t=!1,r={}){if(n<=os)throw new Error("invalid field: expected ORDER > 0, got "+n);let s,i;if(typeof e=="object"&&e!=null){if(r.sqrt||t)throw new Error("cannot specify opts in two arguments");const u=e;u.BITS&&(s=u.BITS),u.sqrt&&(i=u.sqrt),typeof u.isLE=="boolean"&&(t=u.isLE)}else typeof e=="number"&&(s=e),r.sqrt&&(i=r.sqrt);const{nBitLength:o,nByteLength:a}=oZ(n,s);if(a>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let c;const l=Object.freeze({ORDER:n,isLE:t,BITS:o,BYTES:a,MASK:rE(o),ZERO:os,ONE:Ur,create:u=>Qs(u,n),isValid:u=>{if(typeof u!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof u);return os<=u&&u<n},is0:u=>u===os,isValidNot0:u=>!l.is0(u)&&l.isValid(u),isOdd:u=>(u&Ur)===Ur,neg:u=>Qs(-u,n),eql:(u,h)=>u===h,sqr:u=>Qs(u*u,n),add:(u,h)=>Qs(u+h,n),sub:(u,h)=>Qs(u-h,n),mul:(u,h)=>Qs(u*h,n),pow:(u,h)=>iZ(l,u,h),div:(u,h)=>Qs(u*tO(h,n),n),sqrN:u=>u*u,addN:(u,h)=>u+h,subN:(u,h)=>u-h,mulN:(u,h)=>u*h,inv:u=>tO(u,n),sqrt:i||(u=>(c||(c=nZ(n)),c(l,u))),toBytes:u=>t?O_(u,a):N_(u,a),fromBytes:u=>{if(u.length!==a)throw new Error("Field.fromBytes: expected "+a+" bytes, got "+u.length);return t?M0(u):nE(u)},invertBatch:u=>o$(l,u),cmov:(u,h,d)=>d?h:u});return Object.freeze(l)}function a$(n){if(typeof n!="bigint")throw new Error("field order must be bigint");const e=n.toString(2).length;return Math.ceil(e/8)}function c$(n){const e=a$(n);return e+Math.ceil(e/2)}function aZ(n,e,t=!1){const r=n.length,s=a$(e),i=c$(e);if(r<16||r<i||r>1024)throw new Error("expected "+i+"-1024 bytes of input, got "+r);const o=t?M0(n):nE(n),a=Qs(o,e-Ur)+Ur;return t?O_(a,s):N_(a,s)}const of=BigInt(0),_l=BigInt(1);function Kp(n,e){const t=e.negate();return n?t:e}function cZ(n,e,t){const r=i=>i.pz,s=o$(n.Fp,t.map(r));return t.map((i,o)=>i.toAffine(s[o])).map(n.fromAffine)}function l$(n,e){if(!Number.isSafeInteger(n)||n<=0||n>e)throw new Error("invalid window size, expected [1.."+e+"], got W="+n)}function Zv(n,e){l$(n,e);const t=Math.ceil(e/n)+1,r=2**(n-1),s=2**n,i=rE(n),o=BigInt(n);return{windows:t,windowSize:r,mask:i,maxNumber:s,shiftBy:o}}function rO(n,e,t){const{windowSize:r,mask:s,maxNumber:i,shiftBy:o}=t;let a=Number(n&s),c=n>>o;a>r&&(a-=i,c+=_l);const l=e*r,u=l+Math.abs(a)-1,h=a===0,d=a<0,f=e%2!==0;return{nextN:c,offset:u,isZero:h,isNeg:d,isNegF:f,offsetF:l}}function lZ(n,e){if(!Array.isArray(n))throw new Error("array expected");n.forEach((t,r)=>{if(!(t instanceof e))throw new Error("invalid point at index "+r)})}function uZ(n,e){if(!Array.isArray(n))throw new Error("array of scalars expected");n.forEach((t,r)=>{if(!e.isValid(t))throw new Error("invalid scalar at index "+r)})}const Jv=new WeakMap,u$=new WeakMap;function Xv(n){return u$.get(n)||1}function sO(n){if(n!==of)throw new Error("invalid wNAF")}function hZ(n,e){return{constTimeNegate:Kp,hasPrecomputes(t){return Xv(t)!==1},unsafeLadder(t,r,s=n.ZERO){let i=t;for(;r>of;)r&_l&&(s=s.add(i)),i=i.double(),r>>=_l;return s},precomputeWindow(t,r){const{windows:s,windowSize:i}=Zv(r,e),o=[];let a=t,c=a;for(let l=0;l<s;l++){c=a,o.push(c);for(let u=1;u<i;u++)c=c.add(a),o.push(c);a=c.double()}return o},wNAF(t,r,s){let i=n.ZERO,o=n.BASE;const a=Zv(t,e);for(let c=0;c<a.windows;c++){const{nextN:l,offset:u,isZero:h,isNeg:d,isNegF:f,offsetF:p}=rO(s,c,a);s=l,h?o=o.add(Kp(f,r[p])):i=i.add(Kp(d,r[u]))}return sO(s),{p:i,f:o}},wNAFUnsafe(t,r,s,i=n.ZERO){const o=Zv(t,e);for(let a=0;a<o.windows&&s!==of;a++){const{nextN:c,offset:l,isZero:u,isNeg:h}=rO(s,a,o);if(s=c,!u){const d=r[l];i=i.add(h?d.negate():d)}}return sO(s),i},getPrecomputes(t,r,s){let i=Jv.get(r);return i||(i=this.precomputeWindow(r,t),t!==1&&(typeof s=="function"&&(i=s(i)),Jv.set(r,i))),i},wNAFCached(t,r,s){const i=Xv(t);return this.wNAF(i,this.getPrecomputes(i,t,s),r)},wNAFCachedUnsafe(t,r,s,i){const o=Xv(t);return o===1?this.unsafeLadder(t,r,i):this.wNAFUnsafe(o,this.getPrecomputes(o,t,s),r,i)},setWindowSize(t,r){l$(r,e),u$.set(t,r),Jv.delete(t)}}}function dZ(n,e,t,r){let s=e,i=n.ZERO,o=n.ZERO;for(;t>of||r>of;)t&_l&&(i=i.add(s)),r&_l&&(o=o.add(s)),s=s.double(),t>>=_l,r>>=_l;return{p1:i,p2:o}}function fZ(n,e,t,r){lZ(t,n),uZ(r,e);const s=t.length,i=r.length;if(s!==i)throw new Error("arrays of points and scalars must have equal length");const o=n.ZERO,a=ZQ(BigInt(s));let c=1;a>12?c=a-3:a>4?c=a-2:a>0&&(c=2);const l=rE(c),u=new Array(Number(l)+1).fill(o),h=Math.floor((e.BITS-1)/c)*c;let d=o;for(let f=h;f>=0;f-=c){u.fill(o);for(let g=0;g<i;g++){const m=r[g],w=Number(m>>BigInt(f)&l);u[w]=u[w].add(t[g])}let p=o;for(let g=u.length-1,m=o;g>0;g--)m=m.add(u[g]),p=p.add(m);if(d=d.add(p),f!==0)for(let g=0;g<c;g++)d=d.double()}return d}function iO(n,e){if(e){if(e.ORDER!==n)throw new Error("Field.ORDER must match order: Fp == p, Fn == n");return sZ(e),e}else return Bf(n)}function pZ(n,e,t={}){if(!e||typeof e!="object")throw new Error(`expected valid ${n} CURVE object`);for(const o of["p","n","h"]){const a=e[o];if(!(typeof a=="bigint"&&a>of))throw new Error(`CURVE.${o} must be positive bigint`)}const r=iO(e.p,t.Fp),s=iO(e.n,t.Fn),i=["Gx","Gy","a","b"];for(const o of i)if(!r.isValid(e[o]))throw new Error(`CURVE.${o} must be valid field element of CURVE.Fp`);return{Fp:r,Fn:s}}BigInt(0),BigInt(1),BigInt(2),BigInt(8);const dp=BigInt(0),sh=BigInt(1),gw=BigInt(2);function gZ(n){return sE(n,{adjustScalarBytes:"function",powPminus2:"function"}),Object.freeze({...n})}function mZ(n){const e=gZ(n),{P:t,type:r,adjustScalarBytes:s,powPminus2:i,randomBytes:o}=e,a=r==="x25519";if(!a&&r!=="x448")throw new Error("invalid type");const c=o||Lf,l=a?255:448,u=a?32:56,h=BigInt(a?9:5),d=BigInt(a?121665:39081),f=a?gw**BigInt(254):gw**BigInt(447),p=a?BigInt(8)*gw**BigInt(251)-sh:BigInt(4)*gw**BigInt(445)-sh,g=f+p+sh,m=S=>Qs(S,t),w=v(h);function v(S){return O_(m(S),u)}function A(S){const $=Xr("u coordinate",S,u);return a&&($[31]&=127),m(M0($))}function T(S){return M0(s(Xr("scalar",S,u)))}function N(S,$){const P=D(A($),T(S));if(P===dp)throw new Error("invalid private or public key received");return v(P)}function R(S){return N(S,w)}function M(S,$,P){const L=m(S*($-P));return $=m($-L),P=m(P+L),{x_2:$,x_3:P}}function D(S,$){WA("u",S,dp,t),WA("scalar",$,f,g);const P=$,L=S;let V=sh,G=dp,E=S,C=sh,O=dp;for(let k=BigInt(l-1);k>=dp;k--){const j=P>>k&sh;O^=j,{x_2:V,x_3:E}=M(O,V,E),{x_2:G,x_3:C}=M(O,G,C),O=j;const q=V+G,X=m(q*q),ce=V-G,te=m(ce*ce),de=X-te,De=E+C,Qe=E-C,Je=m(Qe*q),Me=m(De*ce),Ot=Je+Me,an=Je-Me;E=m(Ot*Ot),C=m(L*m(an*an)),V=m(X*te),G=m(de*(X+m(d*de)))}({x_2:V,x_3:E}=M(O,V,E)),{x_2:G,x_3:C}=M(O,G,C);const U=i(G);return m(V*U)}return{scalarMult:N,scalarMultBase:R,getSharedSecret:(S,$)=>N(S,$),getPublicKey:S=>R(S),utils:{randomPrivateKey:()=>c(u)},GuBytes:w.slice()}}BigInt(0);const yZ=BigInt(1),oO=BigInt(2),wZ=BigInt(3),bZ=BigInt(5),EZ=BigInt(8),h$={p:BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffed"),n:BigInt("0x1000000000000000000000000000000014def9dea2f79cd65812631a5cf5d3ed"),h:EZ,a:BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffec"),d:BigInt("0x52036cee2b6ffe738cc740797779e89800700a4d4141d8ab75eb4dca135978a3"),Gx:BigInt("0x216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a"),Gy:BigInt("0x6666666666666666666666666666666666666666666666666666666666666658")};function vZ(n){const e=BigInt(10),t=BigInt(20),r=BigInt(40),s=BigInt(80),i=h$.p,o=n*n%i*n%i,a=di(o,oO,i)*o%i,c=di(a,yZ,i)*n%i,l=di(c,bZ,i)*c%i,u=di(l,e,i)*l%i,h=di(u,t,i)*u%i,d=di(h,r,i)*h%i,f=di(d,s,i)*d%i,p=di(f,s,i)*d%i,g=di(p,e,i)*l%i;return{pow_p_5_8:di(g,oO,i)*n%i,b2:o}}function AZ(n){return n[0]&=248,n[31]&=127,n[31]|=64,n}const GA=(()=>{const n=h$.p;return mZ({P:n,type:"x25519",powPminus2:e=>{const{pow_p_5_8:t,b2:r}=vZ(e);return Qs(di(t,wZ,n)*r,n)},adjustScalarBytes:AZ})})();function aO(n){n.lowS!==void 0&&$0("lowS",n.lowS),n.prehash!==void 0&&$0("prehash",n.prehash)}let CZ=class extends Error{constructor(e=""){super(e)}};const Vo={Err:CZ,_tlv:{encode:(n,e)=>{const{Err:t}=Vo;if(n<0||n>256)throw new t("tlv.encode: wrong tag");if(e.length&1)throw new t("tlv.encode: unpadded data");const r=e.length/2,s=pw(r);if(s.length/2&128)throw new t("tlv.encode: long form length too big");const i=r>127?pw(s.length/2|128):"";return pw(n)+i+s+e},decode(n,e){const{Err:t}=Vo;let r=0;if(n<0||n>256)throw new t("tlv.encode: wrong tag");if(e.length<2||e[r++]!==n)throw new t("tlv.decode: wrong tlv");const s=e[r++],i=!!(s&128);let o=0;if(!i)o=s;else{const c=s&127;if(!c)throw new t("tlv.decode(long): indefinite length not supported");if(c>4)throw new t("tlv.decode(long): byte length is too big");const l=e.subarray(r,r+c);if(l.length!==c)throw new t("tlv.decode: length bytes not complete");if(l[0]===0)throw new t("tlv.decode(long): zero leftmost byte");for(const u of l)o=o<<8|u;if(r+=c,o<128)throw new t("tlv.decode(long): not minimal encoding")}const a=e.subarray(r,r+o);if(a.length!==o)throw new t("tlv.decode: wrong value length");return{v:a,l:e.subarray(r+o)}}},_int:{encode(n){const{Err:e}=Vo;if(n<Yp)throw new e("integer: negative integers are not allowed");let t=pw(n);if(Number.parseInt(t[0],16)&8&&(t="00"+t),t.length&1)throw new e("unexpected DER parsing assertion: unpadded hex");return t},decode(n){const{Err:e}=Vo;if(n[0]&128)throw new e("invalid signature integer: negative");if(n[0]===0&&!(n[1]&128))throw new e("invalid signature integer: unnecessary leading zero");return nE(n)}},toSig(n){const{Err:e,_int:t,_tlv:r}=Vo,s=Xr("signature",n),{v:i,l:o}=r.decode(48,s);if(o.length)throw new e("invalid signature: left bytes after parsing");const{v:a,l:c}=r.decode(2,i),{v:l,l:u}=r.decode(2,c);if(u.length)throw new e("invalid signature: left bytes after parsing");return{r:t.decode(a),s:t.decode(l)}},hexFromSig(n){const{_tlv:e,_int:t}=Vo,r=e.encode(2,t.encode(n.r)),s=e.encode(2,t.encode(n.s)),i=r+s;return e.encode(48,i)}},Yp=BigInt(0),Qp=BigInt(1),IZ=BigInt(2),mw=BigInt(3),_Z=BigInt(4);function SZ(n,e,t){function r(s){const i=n.sqr(s),o=n.mul(i,s);return n.add(n.add(o,n.mul(s,e)),t)}return r}function d$(n,e,t){const{BYTES:r}=n;function s(i){let o;if(typeof i=="bigint")o=i;else{let a=Xr("private key",i);if(e){if(!e.includes(a.length*2))throw new Error("invalid private key");const c=new Uint8Array(r);c.set(a,c.length-a.length),a=c}try{o=n.fromBytes(a)}catch{throw new Error(`invalid private key: expected ui8a of size ${r}, got ${typeof i}`)}}if(t&&(o=n.create(o)),!n.isValidNot0(o))throw new Error("invalid private key: out of range [1..N-1]");return o}return s}function TZ(n,e={}){const{Fp:t,Fn:r}=pZ("weierstrass",n,e),{h:s,n:i}=n;sE(e,{},{allowInfinityPoint:"boolean",clearCofactor:"function",isTorsionFree:"function",fromBytes:"function",toBytes:"function",endo:"object",wrapPrivateKey:"boolean"});const{endo:o}=e;if(o&&(!t.is0(n.a)||typeof o.beta!="bigint"||typeof o.splitScalar!="function"))throw new Error('invalid endo: expected "beta": bigint and "splitScalar": function');function a(){if(!t.isOdd)throw new Error("compression is not supported: Field does not have .isOdd()")}function c(D,S,$){const{x:P,y:L}=S.toAffine(),V=t.toBytes(P);if($0("isCompressed",$),$){a();const G=!t.isOdd(L);return Cl(f$(G),V)}else return Cl(Uint8Array.of(4),V,t.toBytes(L))}function l(D){ri(D);const S=t.BYTES,$=S+1,P=2*S+1,L=D.length,V=D[0],G=D.subarray(1);if(L===$&&(V===2||V===3)){const E=t.fromBytes(G);if(!t.isValid(E))throw new Error("bad point: is not on curve, wrong x");const C=d(E);let O;try{O=t.sqrt(C)}catch(k){const j=k instanceof Error?": "+k.message:"";throw new Error("bad point: is not on curve, sqrt error"+j)}a();const U=t.isOdd(O);return(V&1)===1!==U&&(O=t.neg(O)),{x:E,y:O}}else if(L===P&&V===4){const E=t.fromBytes(G.subarray(S*0,S*1)),C=t.fromBytes(G.subarray(S*1,S*2));if(!f(E,C))throw new Error("bad point: is not on curve");return{x:E,y:C}}else throw new Error(`bad point: got length ${L}, expected compressed=${$} or uncompressed=${P}`)}const u=e.toBytes||c,h=e.fromBytes||l,d=SZ(t,n.a,n.b);function f(D,S){const $=t.sqr(S),P=d(D);return t.eql($,P)}if(!f(n.Gx,n.Gy))throw new Error("bad curve params: generator point");const p=t.mul(t.pow(n.a,mw),_Z),g=t.mul(t.sqr(n.b),BigInt(27));if(t.is0(t.add(p,g)))throw new Error("bad curve params: a or b");function m(D,S,$=!1){if(!t.isValid(S)||$&&t.is0(S))throw new Error(`bad point coordinate ${D}`);return S}function w(D){if(!(D instanceof N))throw new Error("ProjectivePoint expected")}const v=eO((D,S)=>{const{px:$,py:P,pz:L}=D;if(t.eql(L,t.ONE))return{x:$,y:P};const V=D.is0();S==null&&(S=V?t.ONE:t.inv(L));const G=t.mul($,S),E=t.mul(P,S),C=t.mul(L,S);if(V)return{x:t.ZERO,y:t.ZERO};if(!t.eql(C,t.ONE))throw new Error("invZ was invalid");return{x:G,y:E}}),A=eO(D=>{if(D.is0()){if(e.allowInfinityPoint&&!t.is0(D.py))return;throw new Error("bad point: ZERO")}const{x:S,y:$}=D.toAffine();if(!t.isValid(S)||!t.isValid($))throw new Error("bad point: x or y not field elements");if(!f(S,$))throw new Error("bad point: equation left != right");if(!D.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});function T(D,S,$,P,L){return $=new N(t.mul($.px,D),$.py,$.pz),S=Kp(P,S),$=Kp(L,$),S.add($)}class N{constructor(S,$,P){this.px=m("x",S),this.py=m("y",$,!0),this.pz=m("z",P),Object.freeze(this)}static fromAffine(S){const{x:$,y:P}=S||{};if(!S||!t.isValid($)||!t.isValid(P))throw new Error("invalid affine point");if(S instanceof N)throw new Error("projective point not allowed");return t.is0($)&&t.is0(P)?N.ZERO:new N($,P,t.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(S){return cZ(N,"pz",S)}static fromBytes(S){return ri(S),N.fromHex(S)}static fromHex(S){const $=N.fromAffine(h(Xr("pointHex",S)));return $.assertValidity(),$}static fromPrivateKey(S){const $=d$(r,e.allowedPrivateKeyLengths,e.wrapPrivateKey);return N.BASE.multiply($(S))}static msm(S,$){return fZ(N,r,S,$)}precompute(S=8,$=!0){return M.setWindowSize(this,S),$||this.multiply(mw),this}_setWindowSize(S){this.precompute(S)}assertValidity(){A(this)}hasEvenY(){const{y:S}=this.toAffine();if(!t.isOdd)throw new Error("Field doesn't support isOdd");return!t.isOdd(S)}equals(S){w(S);const{px:$,py:P,pz:L}=this,{px:V,py:G,pz:E}=S,C=t.eql(t.mul($,E),t.mul(V,L)),O=t.eql(t.mul(P,E),t.mul(G,L));return C&&O}negate(){return new N(this.px,t.neg(this.py),this.pz)}double(){const{a:S,b:$}=n,P=t.mul($,mw),{px:L,py:V,pz:G}=this;let E=t.ZERO,C=t.ZERO,O=t.ZERO,U=t.mul(L,L),k=t.mul(V,V),j=t.mul(G,G),q=t.mul(L,V);return q=t.add(q,q),O=t.mul(L,G),O=t.add(O,O),E=t.mul(S,O),C=t.mul(P,j),C=t.add(E,C),E=t.sub(k,C),C=t.add(k,C),C=t.mul(E,C),E=t.mul(q,E),O=t.mul(P,O),j=t.mul(S,j),q=t.sub(U,j),q=t.mul(S,q),q=t.add(q,O),O=t.add(U,U),U=t.add(O,U),U=t.add(U,j),U=t.mul(U,q),C=t.add(C,U),j=t.mul(V,G),j=t.add(j,j),U=t.mul(j,q),E=t.sub(E,U),O=t.mul(j,k),O=t.add(O,O),O=t.add(O,O),new N(E,C,O)}add(S){w(S);const{px:$,py:P,pz:L}=this,{px:V,py:G,pz:E}=S;let C=t.ZERO,O=t.ZERO,U=t.ZERO;const k=n.a,j=t.mul(n.b,mw);let q=t.mul($,V),X=t.mul(P,G),ce=t.mul(L,E),te=t.add($,P),de=t.add(V,G);te=t.mul(te,de),de=t.add(q,X),te=t.sub(te,de),de=t.add($,L);let De=t.add(V,E);return de=t.mul(de,De),De=t.add(q,ce),de=t.sub(de,De),De=t.add(P,L),C=t.add(G,E),De=t.mul(De,C),C=t.add(X,ce),De=t.sub(De,C),U=t.mul(k,de),C=t.mul(j,ce),U=t.add(C,U),C=t.sub(X,U),U=t.add(X,U),O=t.mul(C,U),X=t.add(q,q),X=t.add(X,q),ce=t.mul(k,ce),de=t.mul(j,de),X=t.add(X,ce),ce=t.sub(q,ce),ce=t.mul(k,ce),de=t.add(de,ce),q=t.mul(X,de),O=t.add(O,q),q=t.mul(De,de),C=t.mul(te,C),C=t.sub(C,q),q=t.mul(te,X),U=t.mul(De,U),U=t.add(U,q),new N(C,O,U)}subtract(S){return this.add(S.negate())}is0(){return this.equals(N.ZERO)}multiply(S){const{endo:$}=e;if(!r.isValidNot0(S))throw new Error("invalid scalar: out of range");let P,L;const V=G=>M.wNAFCached(this,G,N.normalizeZ);if($){const{k1neg:G,k1:E,k2neg:C,k2:O}=$.splitScalar(S),{p:U,f:k}=V(E),{p:j,f:q}=V(O);L=k.add(q),P=T($.beta,U,j,G,C)}else{const{p:G,f:E}=V(S);P=G,L=E}return N.normalizeZ([P,L])[0]}multiplyUnsafe(S){const{endo:$}=e,P=this;if(!r.isValid(S))throw new Error("invalid scalar: out of range");if(S===Yp||P.is0())return N.ZERO;if(S===Qp)return P;if(M.hasPrecomputes(this))return this.multiply(S);if($){const{k1neg:L,k1:V,k2neg:G,k2:E}=$.splitScalar(S),{p1:C,p2:O}=dZ(N,P,V,E);return T($.beta,C,O,L,G)}else return M.wNAFCachedUnsafe(P,S)}multiplyAndAddUnsafe(S,$,P){const L=this.multiplyUnsafe($).add(S.multiplyUnsafe(P));return L.is0()?void 0:L}toAffine(S){return v(this,S)}isTorsionFree(){const{isTorsionFree:S}=e;return s===Qp?!0:S?S(N,this):M.wNAFCachedUnsafe(this,i).is0()}clearCofactor(){const{clearCofactor:S}=e;return s===Qp?this:S?S(N,this):this.multiplyUnsafe(s)}toBytes(S=!0){return $0("isCompressed",S),this.assertValidity(),u(N,this,S)}toRawBytes(S=!0){return this.toBytes(S)}toHex(S=!0){return Hg(this.toBytes(S))}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}}N.BASE=new N(n.Gx,n.Gy,t.ONE),N.ZERO=new N(t.ZERO,t.ONE,t.ZERO),N.Fp=t,N.Fn=r;const R=r.BITS,M=hZ(N,e.endo?Math.ceil(R/2):R);return N}function f$(n){return Uint8Array.of(n?2:3)}function NZ(n,e,t={}){sE(e,{hash:"function"},{hmac:"function",lowS:"boolean",randomBytes:"function",bits2int:"function",bits2int_modN:"function"});const r=e.randomBytes||Lf,s=e.hmac||((P,...L)=>eE(e.hash,P,Cl(...L))),{Fp:i,Fn:o}=n,{ORDER:a,BITS:c}=o;function l(P){const L=a>>Qp;return P>L}function u(P){return l(P)?o.neg(P):P}function h(P,L){if(!o.isValidNot0(L))throw new Error(`invalid signature ${P}: out of range 1..CURVE.n`)}class d{constructor(L,V,G){h("r",L),h("s",V),this.r=L,this.s=V,G!=null&&(this.recovery=G),Object.freeze(this)}static fromCompact(L){const V=o.BYTES,G=Xr("compactSignature",L,V*2);return new d(o.fromBytes(G.subarray(0,V)),o.fromBytes(G.subarray(V,V*2)))}static fromDER(L){const{r:V,s:G}=Vo.toSig(Xr("DER",L));return new d(V,G)}assertValidity(){}addRecoveryBit(L){return new d(this.r,this.s,L)}recoverPublicKey(L){const V=i.ORDER,{r:G,s:E,recovery:C}=this;if(C==null||![0,1,2,3].includes(C))throw new Error("recovery id invalid");if(a*IZ<V&&C>1)throw new Error("recovery id is ambiguous for h>1 curve");const O=C===2||C===3?G+a:G;if(!i.isValid(O))throw new Error("recovery id 2 or 3 invalid");const U=i.toBytes(O),k=n.fromHex(Cl(f$((C&1)===0),U)),j=o.inv(O),q=A(Xr("msgHash",L)),X=o.create(-q*j),ce=o.create(E*j),te=n.BASE.multiplyUnsafe(X).add(k.multiplyUnsafe(ce));if(te.is0())throw new Error("point at infinify");return te.assertValidity(),te}hasHighS(){return l(this.s)}normalizeS(){return this.hasHighS()?new d(this.r,o.neg(this.s),this.recovery):this}toBytes(L){if(L==="compact")return Cl(o.toBytes(this.r),o.toBytes(this.s));if(L==="der")return I_(Vo.hexFromSig(this));throw new Error("invalid format")}toDERRawBytes(){return this.toBytes("der")}toDERHex(){return Hg(this.toBytes("der"))}toCompactRawBytes(){return this.toBytes("compact")}toCompactHex(){return Hg(this.toBytes("compact"))}}const f=d$(o,t.allowedPrivateKeyLengths,t.wrapPrivateKey),p={isValidPrivateKey(P){try{return f(P),!0}catch{return!1}},normPrivateKeyToScalar:f,randomPrivateKey:()=>{const P=a;return aZ(r(c$(P)),P)},precompute(P=8,L=n.BASE){return L.precompute(P,!1)}};function g(P,L=!0){return n.fromPrivateKey(P).toBytes(L)}function m(P){if(typeof P=="bigint")return!1;if(P instanceof n)return!0;const L=Xr("key",P).length,V=i.BYTES,G=V+1,E=2*V+1;if(!(t.allowedPrivateKeyLengths||o.BYTES===G))return L===G||L===E}function w(P,L,V=!0){if(m(P)===!0)throw new Error("first arg must be private key");if(m(L)===!1)throw new Error("second arg must be public key");return n.fromHex(L).multiply(f(P)).toBytes(V)}const v=e.bits2int||function(P){if(P.length>8192)throw new Error("input is too large");const L=nE(P),V=P.length*8-c;return V>0?L>>BigInt(V):L},A=e.bits2int_modN||function(P){return o.create(v(P))},T=rE(c);function N(P){return WA("num < 2^"+c,P,Yp,T),o.toBytes(P)}function R(P,L,V=M){if(["recovered","canonical"].some(te=>te in V))throw new Error("sign() legacy options not supported");const{hash:G}=e;let{lowS:E,prehash:C,extraEntropy:O}=V;E==null&&(E=!0),P=Xr("msgHash",P),aO(V),C&&(P=Xr("prehashed msgHash",G(P)));const U=A(P),k=f(L),j=[N(k),N(U)];if(O!=null&&O!==!1){const te=O===!0?r(i.BYTES):O;j.push(Xr("extraEntropy",te))}const q=Cl(...j),X=U;function ce(te){const de=v(te);if(!o.isValidNot0(de))return;const De=o.inv(de),Qe=n.BASE.multiply(de).toAffine(),Je=o.create(Qe.x);if(Je===Yp)return;const Me=o.create(De*o.create(X+Je*k));if(Me===Yp)return;let Ot=(Qe.x===Je?0:2)|Number(Qe.y&Qp),an=Me;return E&&l(Me)&&(an=u(Me),Ot^=1),new d(Je,an,Ot)}return{seed:q,k2sig:ce}}const M={lowS:e.lowS,prehash:!1},D={lowS:e.lowS,prehash:!1};function S(P,L,V=M){const{seed:G,k2sig:E}=R(P,L,V);return JQ(e.hash.outputLen,o.BYTES,s)(G,E)}n.BASE.precompute(8);function $(P,L,V,G=D){const E=P;L=Xr("msgHash",L),V=Xr("publicKey",V),aO(G);const{lowS:C,prehash:O,format:U}=G;if("strict"in G)throw new Error("options.strict was renamed to lowS");if(U!==void 0&&!["compact","der","js"].includes(U))throw new Error('format must be "compact", "der" or "js"');const k=typeof E=="string"||v_(E),j=!k&&!U&&typeof E=="object"&&E!==null&&typeof E.r=="bigint"&&typeof E.s=="bigint";if(!k&&!j)throw new Error("invalid signature, expected Uint8Array, hex string or Signature instance");let q,X;try{if(j)if(U===void 0||U==="js")q=new d(E.r,E.s);else throw new Error("invalid format");if(k){try{U!=="compact"&&(q=d.fromDER(E))}catch(Ot){if(!(Ot instanceof Vo.Err))throw Ot}!q&&U!=="der"&&(q=d.fromCompact(E))}X=n.fromHex(V)}catch{return!1}if(!q||C&&q.hasHighS())return!1;O&&(L=e.hash(L));const{r:ce,s:te}=q,de=A(L),De=o.inv(te),Qe=o.create(de*De),Je=o.create(ce*De),Me=n.BASE.multiplyUnsafe(Qe).add(X.multiplyUnsafe(Je));return Me.is0()?!1:o.create(Me.x)===ce}return Object.freeze({getPublicKey:g,getSharedSecret:w,sign:S,verify:$,utils:p,Point:n,Signature:d})}function OZ(n){const e={a:n.a,b:n.b,p:n.Fp.ORDER,n:n.n,h:n.h,Gx:n.Gx,Gy:n.Gy},t=n.Fp,r=Bf(e.n,n.nBitLength),s={Fp:t,Fn:r,allowedPrivateKeyLengths:n.allowedPrivateKeyLengths,allowInfinityPoint:n.allowInfinityPoint,endo:n.endo,wrapPrivateKey:n.wrapPrivateKey,isTorsionFree:n.isTorsionFree,clearCofactor:n.clearCofactor,fromBytes:n.fromBytes,toBytes:n.toBytes};return{CURVE:e,curveOpts:s}}function xZ(n){const{CURVE:e,curveOpts:t}=OZ(n),r={hash:n.hash,hmac:n.hmac,randomBytes:n.randomBytes,lowS:n.lowS,bits2int:n.bits2int,bits2int_modN:n.bits2int_modN};return{CURVE:e,curveOpts:t,ecdsaOpts:r}}function RZ(n,e){return Object.assign({},e,{ProjectivePoint:e.Point,CURVE:n})}function PZ(n){const{CURVE:e,curveOpts:t,ecdsaOpts:r}=xZ(n),s=TZ(e,t),i=NZ(s,r,t);return RZ(n,i)}function KA(n,e){const t=r=>PZ({...n,hash:r});return{...t(e),create:t}}const p$={p:BigInt("0xffffffff00000001000000000000000000000000ffffffffffffffffffffffff"),n:BigInt("0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551"),h:BigInt(1),a:BigInt("0xffffffff00000001000000000000000000000000fffffffffffffffffffffffc"),b:BigInt("0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b"),Gx:BigInt("0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296"),Gy:BigInt("0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5")},g$={p:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000ffffffff"),n:BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffc7634d81f4372ddf581a0db248b0a77aecec196accc52973"),h:BigInt(1),a:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000fffffffc"),b:BigInt("0xb3312fa7e23ee7e4988e056be3f82d19181d9c6efe8141120314088f5013875ac656398d8a2ed19d2a85c8edd3ec2aef"),Gx:BigInt("0xaa87ca22be8b05378eb1c71ef320ad746e1d3b628ba79b9859f741e082542a385502f25dbf55296c3a545e3872760ab7"),Gy:BigInt("0x3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f")},m$={p:BigInt("0x1ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),n:BigInt("0x01fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffa51868783bf2f966b7fcc0148f709a5d03bb5c9b8899c47aebb6fb71e91386409"),h:BigInt(1),a:BigInt("0x1fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffc"),b:BigInt("0x0051953eb9618e1c9a1f929a21a0b68540eea2da725b99b315f3b8b489918ef109e156193951ec7e937b1652c0bd3bb1bf073573df883d2c34f1ef451fd46b503f00"),Gx:BigInt("0x00c6858e06b70404e9cd9e3ecb662395b4429c648139053fb521f828af606b4d3dbaa14b5e77efe75928fe1dc127a2ffa8de3348b3c1856a429bf97e7e31c2e5bd66"),Gy:BigInt("0x011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650")},kZ=Bf(p$.p),DZ=Bf(g$.p),UZ=Bf(m$.p),$Z=KA({...p$,Fp:kZ,lowS:!1},Xb);KA({...g$,Fp:DZ,lowS:!1},VY),KA({...m$,Fp:UZ,lowS:!1,allowedPrivateKeyLengths:[130,131,132]},HY);const MZ=$Z,y$="base10",$r="base16",ts="base64pad",nc="base64url",py="utf8",w$=0,la=1,gy=2,LZ=0,cO=1,Zp=12,x_=32;function BZ(){const n=GA.utils.randomPrivateKey(),e=GA.getPublicKey(n);return{privateKey:as(n,$r),publicKey:as(e,$r)}}function YA(){const n=Lf(x_);return as(n,$r)}function FZ(n,e){const t=GA.getSharedSecret(ti(n,$r),ti(e,$r)),r=YQ(tE,t,void 0,void 0,x_);return as(r,$r)}function Jw(n){const e=tE(ti(n,$r));return as(e,$r)}function Gs(n){const e=tE(ti(n,py));return as(e,$r)}function b$(n){return ti(`${n}`,y$)}function yu(n){return Number(as(n,y$))}function E$(n){return n.replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}function v$(n){const e=n.replace(/-/g,"+").replace(/_/g,"/"),t=(4-e.length%4)%4;return e+"=".repeat(t)}function jZ(n){const e=b$(typeof n.type<"u"?n.type:w$);if(yu(e)===la&&typeof n.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const t=typeof n.senderPublicKey<"u"?ti(n.senderPublicKey,$r):void 0,r=typeof n.iv<"u"?ti(n.iv,$r):Lf(Zp),s=ti(n.symKey,$r),i=XU(s,r).encrypt(ti(n.message,py)),o=A$({type:e,sealed:i,iv:r,senderPublicKey:t});return n.encoding===nc?E$(o):o}function HZ(n){const e=ti(n.symKey,$r),{sealed:t,iv:r}=qg({encoded:n.encoded,encoding:n.encoding}),s=XU(e,r).decrypt(t);if(s===null)throw new Error("Failed to decrypt");return as(s,py)}function VZ(n,e){const t=b$(gy),r=Lf(Zp),s=ti(n,py),i=A$({type:t,sealed:s,iv:r});return e===nc?E$(i):i}function qZ(n,e){const{sealed:t}=qg({encoded:n,encoding:e});return as(t,py)}function A$(n){if(yu(n.type)===gy)return as(Gp([n.type,n.sealed]),ts);if(yu(n.type)===la){if(typeof n.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return as(Gp([n.type,n.senderPublicKey,n.iv,n.sealed]),ts)}return as(Gp([n.type,n.iv,n.sealed]),ts)}function qg(n){const e=(n.encoding||ts)===nc?v$(n.encoded):n.encoded,t=ti(e,ts),r=t.slice(LZ,cO),s=cO;if(yu(r)===la){const c=s+x_,l=c+Zp,u=t.slice(s,c),h=t.slice(c,l),d=t.slice(l);return{type:r,sealed:d,iv:h,senderPublicKey:u}}if(yu(r)===gy){const c=t.slice(s),l=Lf(Zp);return{type:r,sealed:c,iv:l}}const i=s+Zp,o=t.slice(s,i),a=t.slice(i);return{type:r,sealed:a,iv:o}}function zZ(n,e){const t=qg({encoded:n,encoding:e==null?void 0:e.encoding});return C$({type:yu(t.type),senderPublicKey:typeof t.senderPublicKey<"u"?as(t.senderPublicKey,$r):void 0,receiverPublicKey:e==null?void 0:e.receiverPublicKey})}function C$(n){const e=(n==null?void 0:n.type)||w$;if(e===la){if(typeof(n==null?void 0:n.senderPublicKey)>"u")throw new Error("missing sender public key");if(typeof(n==null?void 0:n.receiverPublicKey)>"u")throw new Error("missing receiver public key")}return{type:e,senderPublicKey:n==null?void 0:n.senderPublicKey,receiverPublicKey:n==null?void 0:n.receiverPublicKey}}function lO(n){return n.type===la&&typeof n.senderPublicKey=="string"&&typeof n.receiverPublicKey=="string"}function uO(n){return n.type===gy}function WZ(n){const e=Buffer.from(n.x,"base64"),t=Buffer.from(n.y,"base64");return Gp([new Uint8Array([4]),e,t])}function GZ(n,e){const[t,r,s]=n.split("."),i=Buffer.from(v$(s),"base64");if(i.length!==64)throw new Error("Invalid signature length");const o=i.slice(0,32),a=i.slice(32,64),c=`${t}.${r}`,l=tE(c),u=WZ(e);if(!MZ.verify(Gp([o,a]),l,u))throw new Error("Invalid signature");return xA(n).payload}const KZ="irn";function L0(n){return(n==null?void 0:n.relay)||{protocol:KZ}}function Mh(n){const e=vK[n];if(typeof e>"u")throw new Error(`Relay Protocol not supported: ${n}`);return e}function YZ(n,e="-"){const t={},r="relay"+e;return Object.keys(n).forEach(s=>{if(s.startsWith(r)){const i=s.replace(r,""),o=n[s];t[i]=o}}),t}function hO(n){if(!n.includes("wc:")){const l=DU(n);l!=null&&l.includes("wc:")&&(n=l)}n=n.includes("wc://")?n.replace("wc://",""):n,n=n.includes("wc:")?n.replace("wc:",""):n;const e=n.indexOf(":"),t=n.indexOf("?")!==-1?n.indexOf("?"):void 0,r=n.substring(0,e),s=n.substring(e+1,t).split("@"),i=typeof t<"u"?n.substring(t):"",o=new URLSearchParams(i),a={};o.forEach((l,u)=>{a[u]=l});const c=typeof a.methods=="string"?a.methods.split(","):void 0;return{protocol:r,topic:QZ(s[0]),version:parseInt(s[1],10),symKey:a.symKey,relay:YZ(a),methods:c,expiryTimestamp:a.expiryTimestamp?parseInt(a.expiryTimestamp,10):void 0}}function QZ(n){return n.startsWith("//")?n.substring(2):n}function ZZ(n,e="-"){const t="relay",r={};return Object.keys(n).forEach(s=>{const i=s,o=t+e+i;n[i]&&(r[o]=n[i])}),r}function dO(n){const e=new URLSearchParams,t=ZZ(n.relay);Object.keys(t).sort().forEach(s=>{e.set(s,t[s])}),e.set("symKey",n.symKey),n.expiryTimestamp&&e.set("expiryTimestamp",n.expiryTimestamp.toString()),n.methods&&e.set("methods",n.methods.join(","));const r=e.toString();return`${n.protocol}:${n.topic}@${n.version}?${r}`}function yw(n,e,t){return`${n}?wc_ev=${t}&topic=${e}`}var JZ=Object.defineProperty,XZ=Object.defineProperties,eJ=Object.getOwnPropertyDescriptors,fO=Object.getOwnPropertySymbols,tJ=Object.prototype.hasOwnProperty,nJ=Object.prototype.propertyIsEnumerable,pO=(n,e,t)=>e in n?JZ(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,rJ=(n,e)=>{for(var t in e||(e={}))tJ.call(e,t)&&pO(n,t,e[t]);if(fO)for(var t of fO(e))nJ.call(e,t)&&pO(n,t,e[t]);return n},sJ=(n,e)=>XZ(n,eJ(e));function Ff(n){const e=[];return n.forEach(t=>{const[r,s]=t.split(":");e.push(`${r}:${s}`)}),e}function iJ(n){const e=[];return Object.values(n).forEach(t=>{e.push(...Ff(t.accounts))}),e}function oJ(n,e){const t=[];return Object.values(n).forEach(r=>{Ff(r.accounts).includes(e)&&t.push(...r.methods)}),t}function aJ(n,e){const t=[];return Object.values(n).forEach(r=>{Ff(r.accounts).includes(e)&&t.push(...r.events)}),t}function iE(n){return n.includes(":")}function Lh(n){return iE(n)?n.split(":")[0]:n}function gO(n){var e,t,r;const s={};if(!bo(n))return s;for(const[i,o]of Object.entries(n)){const a=iE(i)?[i]:o.chains,c=o.methods||[],l=o.events||[],u=Lh(i);s[u]=sJ(rJ({},s[u]),{chains:wo(a,(e=s[u])==null?void 0:e.chains),methods:wo(c,(t=s[u])==null?void 0:t.methods),events:wo(l,(r=s[u])==null?void 0:r.events)})}return s}function cJ(n){const e={};return n==null||n.forEach(t=>{var r;const[s,i]=t.split(":");e[s]||(e[s]={accounts:[],chains:[],events:[],methods:[]}),e[s].accounts.push(t),(r=e[s].chains)==null||r.push(`${s}:${i}`)}),e}function mO(n,e){e=e.map(r=>r.replace("did:pkh:",""));const t=cJ(e);for(const[r,s]of Object.entries(t))s.methods?s.methods=wo(s.methods,n):s.methods=n,s.events=["chainChanged","accountsChanged"];return t}function lJ(n,e){var t,r,s,i,o,a;const c=gO(n),l=gO(e),u={},h=Object.keys(c).concat(Object.keys(l));for(const d of h)u[d]={chains:wo((t=c[d])==null?void 0:t.chains,(r=l[d])==null?void 0:r.chains),methods:wo((s=c[d])==null?void 0:s.methods,(i=l[d])==null?void 0:i.methods),events:wo((o=c[d])==null?void 0:o.events,(a=l[d])==null?void 0:a.events)};return u}const uJ={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},hJ={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function re(n,e){const{message:t,code:r}=hJ[n];return{message:e?`${t} ${e}`:t,code:r}}function zt(n,e){const{message:t,code:r}=uJ[n];return{message:e?`${t} ${e}`:t,code:r}}function ua(n,e){return!!Array.isArray(n)}function bo(n){return Object.getPrototypeOf(n)===Object.prototype&&Object.keys(n).length}function Nn(n){return typeof n>"u"}function fn(n,e){return e&&Nn(n)?!0:typeof n=="string"&&!!n.trim().length}function R_(n,e){return typeof n=="number"&&!isNaN(n)}function dJ(n,e){const{requiredNamespaces:t}=e,r=Object.keys(n.namespaces),s=Object.keys(t);let i=!0;return Al(s,r)?(r.forEach(o=>{const{accounts:a,methods:c,events:l}=n.namespaces[o],u=Ff(a),h=t[o];(!Al(OU(o,h),u)||!Al(h.methods,c)||!Al(h.events,l))&&(i=!1)}),i):!1}function B0(n){return fn(n,!1)&&n.includes(":")?n.split(":").length===2:!1}function fJ(n){if(fn(n,!1)&&n.includes(":")){const e=n.split(":");if(e.length===3){const t=e[0]+":"+e[1];return!!e[2]&&B0(t)}}return!1}function pJ(n){function e(t){try{return typeof new URL(t)<"u"}catch{return!1}}try{if(fn(n,!1)){if(e(n))return!0;const t=DU(n);return e(t)}}catch{}return!1}function gJ(n){var e;return(e=n==null?void 0:n.proposer)==null?void 0:e.publicKey}function mJ(n){return n==null?void 0:n.topic}function yJ(n,e){let t=null;return fn(n==null?void 0:n.publicKey,!1)||(t=re("MISSING_OR_INVALID",`${e} controller public key should be a string`)),t}function yO(n){let e=!0;return ua(n)?n.length&&(e=n.every(t=>fn(t,!1))):e=!1,e}function wJ(n,e,t){let r=null;return ua(e)&&e.length?e.forEach(s=>{r||B0(s)||(r=zt("UNSUPPORTED_CHAINS",`${t}, chain ${s} should be a string and conform to "namespace:chainId" format`))}):B0(n)||(r=zt("UNSUPPORTED_CHAINS",`${t}, chains must be defined as "namespace:chainId" e.g. "eip155:1": {...} in the namespace key OR as an array of CAIP-2 chainIds e.g. eip155: { chains: ["eip155:1", "eip155:5"] }`)),r}function bJ(n,e,t){let r=null;return Object.entries(n).forEach(([s,i])=>{if(r)return;const o=wJ(s,OU(s,i),`${e} ${t}`);o&&(r=o)}),r}function EJ(n,e){let t=null;return ua(n)?n.forEach(r=>{t||fJ(r)||(t=zt("UNSUPPORTED_ACCOUNTS",`${e}, account ${r} should be a string and conform to "namespace:chainId:address" format`))}):t=zt("UNSUPPORTED_ACCOUNTS",`${e}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),t}function vJ(n,e){let t=null;return Object.values(n).forEach(r=>{if(t)return;const s=EJ(r==null?void 0:r.accounts,`${e} namespace`);s&&(t=s)}),t}function AJ(n,e){let t=null;return yO(n==null?void 0:n.methods)?yO(n==null?void 0:n.events)||(t=zt("UNSUPPORTED_EVENTS",`${e}, events should be an array of strings or empty array for no events`)):t=zt("UNSUPPORTED_METHODS",`${e}, methods should be an array of strings or empty array for no methods`),t}function I$(n,e){let t=null;return Object.values(n).forEach(r=>{if(t)return;const s=AJ(r,`${e}, namespace`);s&&(t=s)}),t}function CJ(n,e,t){let r=null;if(n&&bo(n)){const s=I$(n,e);s&&(r=s);const i=bJ(n,e,t);i&&(r=i)}else r=re("MISSING_OR_INVALID",`${e}, ${t} should be an object with data`);return r}function e1(n,e){let t=null;if(n&&bo(n)){const r=I$(n,e);r&&(t=r);const s=vJ(n,e);s&&(t=s)}else t=re("MISSING_OR_INVALID",`${e}, namespaces should be an object with data`);return t}function _$(n){return fn(n.protocol,!0)}function IJ(n,e){let t=!1;return n?n&&ua(n)&&n.length&&n.forEach(r=>{t=_$(r)}):t=!0,t}function _J(n){return typeof n=="number"}function Yr(n){return typeof n<"u"&&typeof n!==null}function SJ(n){return!(!n||typeof n!="object"||!n.code||!R_(n.code)||!n.message||!fn(n.message,!1))}function TJ(n){return!(Nn(n)||!fn(n.method,!1))}function NJ(n){return!(Nn(n)||Nn(n.result)&&Nn(n.error)||!R_(n.id)||!fn(n.jsonrpc,!1))}function OJ(n){return!(Nn(n)||!fn(n.name,!1))}function wO(n,e){return!(!B0(e)||!iJ(n).includes(e))}function xJ(n,e,t){return fn(t,!1)?oJ(n,e).includes(t):!1}function RJ(n,e,t){return fn(t,!1)?aJ(n,e).includes(t):!1}function bO(n,e,t){let r=null;const s=PJ(n),i=kJ(e),o=Object.keys(s),a=Object.keys(i),c=EO(Object.keys(n)),l=EO(Object.keys(e)),u=c.filter(h=>!l.includes(h));return u.length&&(r=re("NON_CONFORMING_NAMESPACES",`${t} namespaces keys don't satisfy requiredNamespaces.
      Required: ${u.toString()}
      Received: ${Object.keys(e).toString()}`)),Al(o,a)||(r=re("NON_CONFORMING_NAMESPACES",`${t} namespaces chains don't satisfy required namespaces.
      Required: ${o.toString()}
      Approved: ${a.toString()}`)),Object.keys(e).forEach(h=>{if(!h.includes(":")||r)return;const d=Ff(e[h].accounts);d.includes(h)||(r=re("NON_CONFORMING_NAMESPACES",`${t} namespaces accounts don't satisfy namespace accounts for ${h}
        Required: ${h}
        Approved: ${d.toString()}`))}),o.forEach(h=>{r||(Al(s[h].methods,i[h].methods)?Al(s[h].events,i[h].events)||(r=re("NON_CONFORMING_NAMESPACES",`${t} namespaces events don't satisfy namespace events for ${h}`)):r=re("NON_CONFORMING_NAMESPACES",`${t} namespaces methods don't satisfy namespace methods for ${h}`))}),r}function PJ(n){const e={};return Object.keys(n).forEach(t=>{var r;t.includes(":")?e[t]=n[t]:(r=n[t].chains)==null||r.forEach(s=>{e[s]={methods:n[t].methods,events:n[t].events}})}),e}function EO(n){return[...new Set(n.map(e=>e.includes(":")?e.split(":")[0]:e))]}function kJ(n){const e={};return Object.keys(n).forEach(t=>{if(t.includes(":"))e[t]=n[t];else{const r=Ff(n[t].accounts);r==null||r.forEach(s=>{e[s]={accounts:n[t].accounts.filter(i=>i.includes(`${s}:`)),methods:n[t].methods,events:n[t].events}})}}),e}function DJ(n,e){return R_(n)&&n<=e.max&&n>=e.min}function vO(){const n=dy();return new Promise(e=>{switch(n){case _s.browser:e(UJ());break;case _s.reactNative:e($J());break;case _s.node:e(MJ());break;default:e(!0)}})}function UJ(){return Mf()&&(navigator==null?void 0:navigator.onLine)}async function $J(){if(zc()&&typeof global<"u"&&global!=null&&global.NetInfo){const n=await(global==null?void 0:global.NetInfo.fetch());return n==null?void 0:n.isConnected}return!0}function MJ(){return!0}function LJ(n){switch(dy()){case _s.browser:BJ(n);break;case _s.reactNative:FJ(n);break}}function BJ(n){!zc()&&Mf()&&(window.addEventListener("online",()=>n(!0)),window.addEventListener("offline",()=>n(!1)))}function FJ(n){zc()&&typeof global<"u"&&global!=null&&global.NetInfo&&(global==null||global.NetInfo.addEventListener(e=>n(e==null?void 0:e.isConnected)))}function jJ(){var n;return Mf()&&pu()?((n=pu())==null?void 0:n.visibilityState)==="visible":!0}const t1={};let fp=class{static get(e){return t1[e]}static set(e,t){t1[e]=t}static delete(e){delete t1[e]}};function HJ(n){const e=$f.decode(n);if(e.length<33)throw new Error("Too short to contain a public key");return e.slice(1,33)}function VJ({publicKey:n,signature:e,payload:t}){var r;const s=QA(t.method),i=128|parseInt(((r=t.version)==null?void 0:r.toString())||"4"),o=WJ(t.address),a=t.era==="00"?new Uint8Array([0]):QA(t.era);if(a.length!==1&&a.length!==2)throw new Error("Invalid era length");const c=parseInt(t.nonce,16),l=new Uint8Array([c&255,c>>8&255]),u=BigInt(`0x${zJ(t.tip)}`),h=KJ(u),d=new Uint8Array([0,...n,o,...e,...a,...l,...h,...s]),f=GJ(d.length+1);return new Uint8Array([...f,i,...d])}function qJ(n){const e=QA(n),t=kK.blake2b(e,void 0,32);return"0x"+Buffer.from(t).toString("hex")}function QA(n){return new Uint8Array(n.replace(/^0x/,"").match(/.{1,2}/g).map(e=>parseInt(e,16)))}function zJ(n){return n.startsWith("0x")?n.slice(2):n}function WJ(n){const e=$f.decode(n)[0];return e===42?0:e===60?2:1}function GJ(n){if(n<64)return new Uint8Array([n<<2]);if(n<16384){const e=n<<2|1;return new Uint8Array([e&255,e>>8&255])}else if(n<1<<30){const e=n<<2|2;return new Uint8Array([e&255,e>>8&255,e>>16&255,e>>24&255])}else throw new Error("Compact encoding > 2^30 not supported")}function KJ(n){if(n<BigInt(1)<<BigInt(6))return new Uint8Array([Number(n<<BigInt(2))]);if(n<BigInt(1)<<BigInt(14)){const e=n<<BigInt(2)|BigInt(1);return new Uint8Array([Number(e&BigInt(255)),Number(e>>BigInt(8)&BigInt(255))])}else if(n<BigInt(1)<<BigInt(30)){const e=n<<BigInt(2)|BigInt(2);return new Uint8Array([Number(e&BigInt(255)),Number(e>>BigInt(8)&BigInt(255)),Number(e>>BigInt(16)&BigInt(255)),Number(e>>BigInt(24)&BigInt(255))])}else throw new Error("BigInt compact encoding not supported > 2^30")}function YJ(n){const e=Uint8Array.from(Buffer.from(n.signature,"hex")),t=HJ(n.transaction.address),r=VJ({publicKey:t,signature:e,payload:n.transaction}),s=Buffer.from(r).toString("hex");return qJ(s)}const QJ="PARSE_ERROR",ZJ="INVALID_REQUEST",JJ="METHOD_NOT_FOUND",XJ="INVALID_PARAMS",S$="INTERNAL_ERROR",P_="SERVER_ERROR",eX=[-32700,-32600,-32601,-32602,-32603],Jp={[QJ]:{code:-32700,message:"Parse error"},[ZJ]:{code:-32600,message:"Invalid Request"},[JJ]:{code:-32601,message:"Method not found"},[XJ]:{code:-32602,message:"Invalid params"},[S$]:{code:-32603,message:"Internal error"},[P_]:{code:-32e3,message:"Server error"}},T$=P_;function tX(n){return eX.includes(n)}function AO(n){return Object.keys(Jp).includes(n)?Jp[n]:Jp[T$]}function nX(n){const e=Object.values(Jp).find(t=>t.code===n);return e||Jp[T$]}function N$(n,e,t){return n.message.includes("getaddrinfo ENOTFOUND")||n.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${t} RPC url at ${e}`):n}var O$={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var ZA=function(n,e){return ZA=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var s in r)r.hasOwnProperty(s)&&(t[s]=r[s])},ZA(n,e)};function rX(n,e){ZA(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var JA=function(){return JA=Object.assign||function(e){for(var t,r=1,s=arguments.length;r<s;r++){t=arguments[r];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},JA.apply(this,arguments)};function sX(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(n);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(n,r[s])&&(t[r[s]]=n[r[s]]);return t}function iX(n,e,t,r){var s=arguments.length,i=s<3?e:r===null?r=Object.getOwnPropertyDescriptor(e,t):r,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(n,e,t,r);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(i=(s<3?o(i):s>3?o(e,t,i):o(e,t))||i);return s>3&&i&&Object.defineProperty(e,t,i),i}function oX(n,e){return function(t,r){e(t,r,n)}}function aX(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)}function cX(n,e,t,r){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(u){try{l(r.next(u))}catch(h){o(h)}}function c(u){try{l(r.throw(u))}catch(h){o(h)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((r=r.apply(n,e||[])).next())})}function lX(n,e){var t={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},r,s,i,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(l){return function(u){return c([l,u])}}function c(l){if(r)throw new TypeError("Generator is already executing.");for(;t;)try{if(r=1,s&&(i=l[0]&2?s.return:l[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,l[1])).done)return i;switch(s=0,i&&(l=[l[0]&2,i.value]),l[0]){case 0:case 1:i=l;break;case 4:return t.label++,{value:l[1],done:!1};case 5:t.label++,s=l[1],l=[0];continue;case 7:l=t.ops.pop(),t.trys.pop();continue;default:if(i=t.trys,!(i=i.length>0&&i[i.length-1])&&(l[0]===6||l[0]===2)){t=0;continue}if(l[0]===3&&(!i||l[1]>i[0]&&l[1]<i[3])){t.label=l[1];break}if(l[0]===6&&t.label<i[1]){t.label=i[1],i=l;break}if(i&&t.label<i[2]){t.label=i[2],t.ops.push(l);break}i[2]&&t.ops.pop(),t.trys.pop();continue}l=e.call(n,t)}catch(u){l=[6,u],s=0}finally{r=i=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}function uX(n,e,t,r){r===void 0&&(r=t),n[r]=e[t]}function hX(n,e){for(var t in n)t!=="default"&&!e.hasOwnProperty(t)&&(e[t]=n[t])}function XA(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],r=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function x$(n,e){var t=typeof Symbol=="function"&&n[Symbol.iterator];if(!t)return n;var r=t.call(n),s,i=[],o;try{for(;(e===void 0||e-- >0)&&!(s=r.next()).done;)i.push(s.value)}catch(a){o={error:a}}finally{try{s&&!s.done&&(t=r.return)&&t.call(r)}finally{if(o)throw o.error}}return i}function dX(){for(var n=[],e=0;e<arguments.length;e++)n=n.concat(x$(arguments[e]));return n}function fX(){for(var n=0,e=0,t=arguments.length;e<t;e++)n+=arguments[e].length;for(var r=Array(n),s=0,e=0;e<t;e++)for(var i=arguments[e],o=0,a=i.length;o<a;o++,s++)r[s]=i[o];return r}function zg(n){return this instanceof zg?(this.v=n,this):new zg(n)}function pX(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=t.apply(n,e||[]),s,i=[];return s={},o("next"),o("throw"),o("return"),s[Symbol.asyncIterator]=function(){return this},s;function o(d){r[d]&&(s[d]=function(f){return new Promise(function(p,g){i.push([d,f,p,g])>1||a(d,f)})})}function a(d,f){try{c(r[d](f))}catch(p){h(i[0][3],p)}}function c(d){d.value instanceof zg?Promise.resolve(d.value.v).then(l,u):h(i[0][2],d)}function l(d){a("next",d)}function u(d){a("throw",d)}function h(d,f){d(f),i.shift(),i.length&&a(i[0][0],i[0][1])}}function gX(n){var e,t;return e={},r("next"),r("throw",function(s){throw s}),r("return"),e[Symbol.iterator]=function(){return this},e;function r(s,i){e[s]=n[s]?function(o){return(t=!t)?{value:zg(n[s](o)),done:s==="return"}:i?i(o):o}:i}}function mX(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof XA=="function"?XA(n):n[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(i){t[i]=n[i]&&function(o){return new Promise(function(a,c){o=n[i](o),s(a,c,o.done,o.value)})}}function s(i,o,a,c){Promise.resolve(c).then(function(l){i({value:l,done:a})},o)}}function yX(n,e){return Object.defineProperty?Object.defineProperty(n,"raw",{value:e}):n.raw=e,n}function wX(n){if(n&&n.__esModule)return n;var e={};if(n!=null)for(var t in n)Object.hasOwnProperty.call(n,t)&&(e[t]=n[t]);return e.default=n,e}function bX(n){return n&&n.__esModule?n:{default:n}}function EX(n,e){if(!e.has(n))throw new TypeError("attempted to get private field on non-instance");return e.get(n)}function vX(n,e,t){if(!e.has(n))throw new TypeError("attempted to set private field on non-instance");return e.set(n,t),t}const AX=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return JA},__asyncDelegator:gX,__asyncGenerator:pX,__asyncValues:mX,__await:zg,__awaiter:cX,__classPrivateFieldGet:EX,__classPrivateFieldSet:vX,__createBinding:uX,__decorate:iX,__exportStar:hX,__extends:rX,__generator:lX,__importDefault:bX,__importStar:wX,__makeTemplateObject:yX,__metadata:aX,__param:oX,__read:x$,__rest:sX,__spread:dX,__spreadArrays:fX,__values:XA},Symbol.toStringTag,{value:"Module"})),CX=Nk(AX);var Uo={},CO;function IX(){if(CO)return Uo;CO=1,Object.defineProperty(Uo,"__esModule",{value:!0}),Uo.isBrowserCryptoAvailable=Uo.getSubtleCrypto=Uo.getBrowerCrypto=void 0;function n(){return(so===null||so===void 0?void 0:so.crypto)||(so===null||so===void 0?void 0:so.msCrypto)||{}}Uo.getBrowerCrypto=n;function e(){const r=n();return r.subtle||r.webkitSubtle}Uo.getSubtleCrypto=e;function t(){return!!n()&&!!e()}return Uo.isBrowserCryptoAvailable=t,Uo}var $o={},IO;function _X(){if(IO)return $o;IO=1,Object.defineProperty($o,"__esModule",{value:!0}),$o.isBrowser=$o.isNode=$o.isReactNative=void 0;function n(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}$o.isReactNative=n;function e(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}$o.isNode=e;function t(){return!n()&&!e()}return $o.isBrowser=t,$o}(function(n){Object.defineProperty(n,"__esModule",{value:!0});const e=CX;e.__exportStar(IX(),n),e.__exportStar(_X(),n)})(O$);function Ki(n=3){const e=Date.now()*Math.pow(10,n),t=Math.floor(Math.random()*Math.pow(10,n));return e+t}function Ic(n=6){return BigInt(Ki(n))}function io(n,e,t){return{id:t||Ki(),jsonrpc:"2.0",method:n,params:e}}function Wg(n,e){return{id:n,jsonrpc:"2.0",result:e}}function oE(n,e,t){return{id:n,jsonrpc:"2.0",error:SX(e)}}function SX(n,e){return typeof n>"u"?AO(S$):(typeof n=="string"&&(n=Object.assign(Object.assign({},AO(P_)),{message:n})),tX(n.code)&&(n=nX(n.code)),n)}let TX=class{},NX=class extends TX{constructor(){super()}},OX=class extends NX{constructor(e){super()}};const xX="^https?:",RX="^wss?:";function PX(n){const e=n.match(new RegExp(/^\w+:/,"gi"));if(!(!e||!e.length))return e[0]}function R$(n,e){const t=PX(n);return typeof t>"u"?!1:new RegExp(e).test(t)}function _O(n){return R$(n,xX)}function SO(n){return R$(n,RX)}function kX(n){return new RegExp("wss?://localhost(:d{2,5})?").test(n)}function P$(n){return typeof n=="object"&&"id"in n&&"jsonrpc"in n&&n.jsonrpc==="2.0"}function k_(n){return P$(n)&&"method"in n}function aE(n){return P$(n)&&(Yi(n)||Ks(n))}function Yi(n){return"result"in n}function Ks(n){return"error"in n}let oi=class extends OX{constructor(e){super(e),this.events=new ii.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(e),this.connection.connected&&this.registerEventListeners()}async connect(e=this.connection){await this.open(e)}async disconnect(){await this.close()}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async request(e,t){return this.requestStrict(io(e.method,e.params||[],e.id||Ic().toString()),t)}async requestStrict(e,t){return new Promise(async(r,s)=>{if(!this.connection.connected)try{await this.open()}catch(i){s(i)}this.events.on(`${e.id}`,i=>{Ks(i)?s(i.error):r(i.result)});try{await this.connection.send(e,t)}catch(i){s(i)}})}setConnection(e=this.connection){return e}onPayload(e){this.events.emit("payload",e),aE(e)?this.events.emit(`${e.id}`,e):this.events.emit("message",{type:e.method,data:e.params})}onClose(e){e&&e.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${e.code} ${e.reason?`(${e.reason})`:""}`)),this.events.emit("disconnect")}async open(e=this.connection){this.connection===e&&this.connection.connected||(this.connection.connected&&this.close(),typeof e=="string"&&(await this.connection.open(e),e=this.connection),this.connection=this.setConnection(e),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",e=>this.onPayload(e)),this.connection.on("close",e=>this.onClose(e)),this.connection.on("error",e=>this.events.emit("error",e)),this.connection.on("register_error",e=>this.onClose()),this.hasRegisteredEventListeners=!0)}};const DX=()=>typeof WebSocket<"u"?WebSocket:typeof global<"u"&&typeof globalThis.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:typeof self<"u"&&typeof self.WebSocket<"u"?self.WebSocket:require("ws"),UX=()=>typeof WebSocket<"u"||typeof global<"u"&&typeof globalThis.WebSocket<"u"||typeof window<"u"&&typeof window.WebSocket<"u"||typeof self<"u"&&typeof self.WebSocket<"u",TO=n=>n.split("?")[0],NO=10,$X=DX();let MX=class{constructor(e){if(this.url=e,this.events=new ii.EventEmitter,this.registering=!1,!SO(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);this.url=e}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async open(e=this.url){await this.register(e)}async close(){return new Promise((e,t)=>{if(typeof this.socket>"u"){t(new Error("Connection already closed"));return}this.socket.onclose=r=>{this.onClose(r),e()},this.socket.close()})}async send(e){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(ma(e))}catch(t){this.onError(e.id,t)}}register(e=this.url){if(!SO(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);if(this.registering){const t=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=t||this.events.listenerCount("open")>=t)&&this.events.setMaxListeners(t+1),new Promise((r,s)=>{this.events.once("register_error",i=>{this.resetMaxListeners(),s(i)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return s(new Error("WebSocket connection is missing or invalid"));r(this.socket)})})}return this.url=e,this.registering=!0,new Promise((t,r)=>{const s=O$.isReactNative()?void 0:{rejectUnauthorized:!kX(e)},i=new $X(e,[],s);UX()?i.onerror=o=>{const a=o;r(this.emitError(a.error))}:i.on("error",o=>{r(this.emitError(o))}),i.onopen=()=>{this.onOpen(i),t(i)}})}onOpen(e){e.onmessage=t=>this.onPayload(t),e.onclose=t=>this.onClose(t),this.socket=e,this.registering=!1,this.events.emit("open")}onClose(e){this.socket=void 0,this.registering=!1,this.events.emit("close",e)}onPayload(e){if(typeof e.data>"u")return;const t=typeof e.data=="string"?fu(e.data):e.data;this.events.emit("payload",t)}onError(e,t){const r=this.parseError(t),s=r.message||r.toString(),i=oE(e,s);this.events.emit("payload",i)}parseError(e,t=this.url){return N$(e,TO(t),"WS")}resetMaxListeners(){this.events.getMaxListeners()>NO&&this.events.setMaxListeners(NO)}emitError(e){const t=this.parseError(new Error((e==null?void 0:e.message)||`WebSocket connection failed for host: ${TO(this.url)}`));return this.events.emit("register_error",t),t}};var LX={};const k$="wc",D$=2,F0="core",Co=`${k$}@2:${F0}:`,BX={name:F0,logger:"error"},FX={database:":memory:"},jX="crypto",OO="client_ed25519_seed",HX=ne.ONE_DAY,VX="keychain",qX="0.3",zX="messages",WX="0.3",GX=ne.SIX_HOURS,KX="publisher",U$="irn",YX="error",$$="wss://relay.walletconnect.org",QX="relayer",en={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},ZX="_subscription",Us={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},JX=.1,eC="2.21.7",Lt={link_mode:"link_mode",relay:"relay"},Xw={inbound:"inbound",outbound:"outbound"},XX="0.3",eee="WALLETCONNECT_CLIENT_ID",xO="WALLETCONNECT_LINK_MODE_APPS",ms={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},tee="subscription",nee="0.3",ree="pairing",see="0.3",pp={wc_pairingDelete:{req:{ttl:ne.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:ne.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:ne.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:ne.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:ne.ONE_DAY,prompt:!1,tag:0},res:{ttl:ne.ONE_DAY,prompt:!1,tag:0}}},pl={create:"pairing_create",expire:"pairing_expire",delete:"pairing_delete",ping:"pairing_ping"},hi={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},iee="history",oee="0.3",aee="expirer",Fs={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},cee="0.3",lee="verify-api",uee="https://verify.walletconnect.com",M$="https://verify.walletconnect.org",Xp=M$,hee=`${Xp}/v3`,dee=[uee,M$],fee="echo",pee="https://echo.walletconnect.com",Gi={pairing_started:"pairing_started",pairing_uri_validation_success:"pairing_uri_validation_success",pairing_uri_not_expired:"pairing_uri_not_expired",store_new_pairing:"store_new_pairing",subscribing_pairing_topic:"subscribing_pairing_topic",subscribe_pairing_topic_success:"subscribe_pairing_topic_success",existing_pairing:"existing_pairing",pairing_not_expired:"pairing_not_expired",emit_inactive_pairing:"emit_inactive_pairing",emit_session_proposal:"emit_session_proposal",subscribing_to_pairing_topic:"subscribing_to_pairing_topic"},Lo={no_wss_connection:"no_wss_connection",no_internet_connection:"no_internet_connection",malformed_pairing_uri:"malformed_pairing_uri",active_pairing_already_exists:"active_pairing_already_exists",subscribe_pairing_topic_failure:"subscribe_pairing_topic_failure",pairing_expired:"pairing_expired",proposal_expired:"proposal_expired",proposal_listener_not_found:"proposal_listener_not_found"},Va={session_approve_started:"session_approve_started",proposal_not_expired:"proposal_not_expired",session_namespaces_validation_success:"session_namespaces_validation_success",create_session_topic:"create_session_topic",subscribing_session_topic:"subscribing_session_topic",subscribe_session_topic_success:"subscribe_session_topic_success",publishing_session_approve:"publishing_session_approve",session_approve_publish_success:"session_approve_publish_success",store_session:"store_session",publishing_session_settle:"publishing_session_settle",session_settle_publish_success:"session_settle_publish_success"},gp={no_internet_connection:"no_internet_connection",no_wss_connection:"no_wss_connection",proposal_expired:"proposal_expired",subscribe_session_topic_failure:"subscribe_session_topic_failure",session_approve_publish_failure:"session_approve_publish_failure",session_settle_publish_failure:"session_settle_publish_failure",session_approve_namespace_validation_failure:"session_approve_namespace_validation_failure",proposal_not_found:"proposal_not_found"},sl={authenticated_session_approve_started:"authenticated_session_approve_started",authenticated_session_not_expired:"authenticated_session_not_expired",chains_caip2_compliant:"chains_caip2_compliant",chains_evm_compliant:"chains_evm_compliant",create_authenticated_session_topic:"create_authenticated_session_topic",cacaos_verified:"cacaos_verified",store_authenticated_session:"store_authenticated_session",subscribing_authenticated_session_topic:"subscribing_authenticated_session_topic",subscribe_authenticated_session_topic_success:"subscribe_authenticated_session_topic_success",publishing_authenticated_session_approve:"publishing_authenticated_session_approve",authenticated_session_approve_publish_success:"authenticated_session_approve_publish_success"},mp={no_internet_connection:"no_internet_connection",no_wss_connection:"no_wss_connection",missing_session_authenticate_request:"missing_session_authenticate_request",session_authenticate_request_expired:"session_authenticate_request_expired",chains_caip2_compliant_failure:"chains_caip2_compliant_failure",chains_evm_compliant_failure:"chains_evm_compliant_failure",invalid_cacao:"invalid_cacao",subscribe_authenticated_session_topic_failure:"subscribe_authenticated_session_topic_failure",authenticated_session_approve_publish_failure:"authenticated_session_approve_publish_failure",authenticated_session_pending_request_not_found:"authenticated_session_pending_request_not_found"},gee=.1,mee="event-client",yee=86400,wee="https://pulse.walletconnect.org/batch";function bee(n,e){if(n.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),r=0;r<t.length;r++)t[r]=255;for(var s=0;s<n.length;s++){var i=n.charAt(s),o=i.charCodeAt(0);if(t[o]!==255)throw new TypeError(i+" is ambiguous");t[o]=s}var a=n.length,c=n.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function h(p){if(p instanceof Uint8Array||(ArrayBuffer.isView(p)?p=new Uint8Array(p.buffer,p.byteOffset,p.byteLength):Array.isArray(p)&&(p=Uint8Array.from(p))),!(p instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(p.length===0)return"";for(var g=0,m=0,w=0,v=p.length;w!==v&&p[w]===0;)w++,g++;for(var A=(v-w)*u+1>>>0,T=new Uint8Array(A);w!==v;){for(var N=p[w],R=0,M=A-1;(N!==0||R<m)&&M!==-1;M--,R++)N+=256*T[M]>>>0,T[M]=N%a>>>0,N=N/a>>>0;if(N!==0)throw new Error("Non-zero carry");m=R,w++}for(var D=A-m;D!==A&&T[D]===0;)D++;for(var S=c.repeat(g);D<A;++D)S+=n.charAt(T[D]);return S}function d(p){if(typeof p!="string")throw new TypeError("Expected String");if(p.length===0)return new Uint8Array;var g=0;if(p[g]!==" "){for(var m=0,w=0;p[g]===c;)m++,g++;for(var v=(p.length-g)*l+1>>>0,A=new Uint8Array(v);p[g];){var T=t[p.charCodeAt(g)];if(T===255)return;for(var N=0,R=v-1;(T!==0||N<w)&&R!==-1;R--,N++)T+=a*A[R]>>>0,A[R]=T%256>>>0,T=T/256>>>0;if(T!==0)throw new Error("Non-zero carry");w=N,g++}if(p[g]!==" "){for(var M=v-w;M!==v&&A[M]===0;)M++;for(var D=new Uint8Array(m+(v-M)),S=m;M!==v;)D[S++]=A[M++];return D}}}function f(p){var g=d(p);if(g)return g;throw new Error(`Non-${e} character`)}return{encode:h,decodeUnsafe:d,decode:f}}var Eee=bee,vee=Eee;const L$=n=>{if(n instanceof Uint8Array&&n.constructor.name==="Uint8Array")return n;if(n instanceof ArrayBuffer)return new Uint8Array(n);if(ArrayBuffer.isView(n))return new Uint8Array(n.buffer,n.byteOffset,n.byteLength);throw new Error("Unknown type, must be binary type")},Aee=n=>new TextEncoder().encode(n),Cee=n=>new TextDecoder().decode(n);class Iee{constructor(e,t,r){this.name=e,this.prefix=t,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class _ee{constructor(e,t,r){if(this.name=e,this.prefix=t,t.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=r}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return B$(this,e)}}let See=class{constructor(e){this.decoders=e}or(e){return B$(this,e)}decode(e){const t=e[0],r=this.decoders[t];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}};const B$=(n,e)=>new See({...n.decoders||{[n.prefix]:n},...e.decoders||{[e.prefix]:e}});class Tee{constructor(e,t,r,s){this.name=e,this.prefix=t,this.baseEncode=r,this.baseDecode=s,this.encoder=new Iee(e,t,r),this.decoder=new _ee(e,t,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const cE=({name:n,prefix:e,encode:t,decode:r})=>new Tee(n,e,t,r),my=({prefix:n,name:e,alphabet:t})=>{const{encode:r,decode:s}=vee(t,e);return cE({prefix:n,name:e,encode:r,decode:i=>L$(s(i))})},Nee=(n,e,t,r)=>{const s={};for(let u=0;u<e.length;++u)s[e[u]]=u;let i=n.length;for(;n[i-1]==="=";)--i;const o=new Uint8Array(i*t/8|0);let a=0,c=0,l=0;for(let u=0;u<i;++u){const h=s[n[u]];if(h===void 0)throw new SyntaxError(`Non-${r} character`);c=c<<t|h,a+=t,a>=8&&(a-=8,o[l++]=255&c>>a)}if(a>=t||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},Oee=(n,e,t)=>{const r=e[e.length-1]==="=",s=(1<<t)-1;let i="",o=0,a=0;for(let c=0;c<n.length;++c)for(a=a<<8|n[c],o+=8;o>t;)o-=t,i+=e[s&a>>o];if(o&&(i+=e[s&a<<t-o]),r)for(;i.length*t&7;)i+="=";return i},Qn=({name:n,prefix:e,bitsPerChar:t,alphabet:r})=>cE({prefix:e,name:n,encode(s){return Oee(s,r,t)},decode(s){return Nee(s,r,t,n)}}),xee=cE({prefix:"\0",name:"identity",encode:n=>Cee(n),decode:n=>Aee(n)});var Ree=Object.freeze({__proto__:null,identity:xee});const Pee=Qn({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var kee=Object.freeze({__proto__:null,base2:Pee});const Dee=Qn({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var Uee=Object.freeze({__proto__:null,base8:Dee});const $ee=my({prefix:"9",name:"base10",alphabet:"0123456789"});var Mee=Object.freeze({__proto__:null,base10:$ee});const Lee=Qn({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Bee=Qn({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var Fee=Object.freeze({__proto__:null,base16:Lee,base16upper:Bee});const jee=Qn({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Hee=Qn({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Vee=Qn({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),qee=Qn({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),zee=Qn({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Wee=Qn({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Gee=Qn({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Kee=Qn({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Yee=Qn({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var Qee=Object.freeze({__proto__:null,base32:jee,base32upper:Hee,base32pad:Vee,base32padupper:qee,base32hex:zee,base32hexupper:Wee,base32hexpad:Gee,base32hexpadupper:Kee,base32z:Yee});const Zee=my({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Jee=my({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var Xee=Object.freeze({__proto__:null,base36:Zee,base36upper:Jee});const ete=my({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),tte=my({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var nte=Object.freeze({__proto__:null,base58btc:ete,base58flickr:tte});const rte=Qn({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),ste=Qn({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),ite=Qn({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),ote=Qn({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var ate=Object.freeze({__proto__:null,base64:rte,base64pad:ste,base64url:ite,base64urlpad:ote});const F$=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),cte=F$.reduce((n,e,t)=>(n[t]=e,n),[]),lte=F$.reduce((n,e,t)=>(n[e.codePointAt(0)]=t,n),[]);function ute(n){return n.reduce((e,t)=>(e+=cte[t],e),"")}function hte(n){const e=[];for(const t of n){const r=lte[t.codePointAt(0)];if(r===void 0)throw new Error(`Non-base256emoji character: ${t}`);e.push(r)}return new Uint8Array(e)}const dte=cE({prefix:"🚀",name:"base256emoji",encode:ute,decode:hte});var fte=Object.freeze({__proto__:null,base256emoji:dte}),pte=j$,RO=128,gte=127,mte=~gte,yte=Math.pow(2,31);function j$(n,e,t){e=e||[],t=t||0;for(var r=t;n>=yte;)e[t++]=n&255|RO,n/=128;for(;n&mte;)e[t++]=n&255|RO,n>>>=7;return e[t]=n|0,j$.bytes=t-r+1,e}var wte=tC,bte=128,PO=127;function tC(n,r){var t=0,r=r||0,s=0,i=r,o,a=n.length;do{if(i>=a)throw tC.bytes=0,new RangeError("Could not decode varint");o=n[i++],t+=s<28?(o&PO)<<s:(o&PO)*Math.pow(2,s),s+=7}while(o>=bte);return tC.bytes=i-r,t}var Ete=Math.pow(2,7),vte=Math.pow(2,14),Ate=Math.pow(2,21),Cte=Math.pow(2,28),Ite=Math.pow(2,35),_te=Math.pow(2,42),Ste=Math.pow(2,49),Tte=Math.pow(2,56),Nte=Math.pow(2,63),Ote=function(n){return n<Ete?1:n<vte?2:n<Ate?3:n<Cte?4:n<Ite?5:n<_te?6:n<Ste?7:n<Tte?8:n<Nte?9:10},xte={encode:pte,decode:wte,encodingLength:Ote},H$=xte;const kO=(n,e,t=0)=>(H$.encode(n,e,t),e),DO=n=>H$.encodingLength(n),nC=(n,e)=>{const t=e.byteLength,r=DO(n),s=r+DO(t),i=new Uint8Array(s+t);return kO(n,i,0),kO(t,i,r),i.set(e,s),new Rte(n,t,e,i)};let Rte=class{constructor(e,t,r,s){this.code=e,this.size=t,this.digest=r,this.bytes=s}};const V$=({name:n,code:e,encode:t})=>new Pte(n,e,t);let Pte=class{constructor(e,t,r){this.name=e,this.code=t,this.encode=r}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?nC(this.code,t):t.then(r=>nC(this.code,r))}else throw Error("Unknown type, must be binary type")}};const q$=n=>async e=>new Uint8Array(await crypto.subtle.digest(n,e)),kte=V$({name:"sha2-256",code:18,encode:q$("SHA-256")}),Dte=V$({name:"sha2-512",code:19,encode:q$("SHA-512")});var Ute=Object.freeze({__proto__:null,sha256:kte,sha512:Dte});const z$=0,$te="identity",W$=L$,Mte=n=>nC(z$,W$(n)),Lte={code:z$,name:$te,encode:W$,digest:Mte};var Bte=Object.freeze({__proto__:null,identity:Lte});new TextEncoder,new TextDecoder;const UO={...Ree,...kee,...Uee,...Mee,...Fee,...Qee,...Xee,...nte,...ate,...fte};({...Ute,...Bte});function G$(n){return globalThis.Buffer!=null?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):n}function Fte(n=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?G$(globalThis.Buffer.allocUnsafe(n)):new Uint8Array(n)}function K$(n,e,t,r){return{name:n,prefix:e,encoder:{name:n,prefix:e,encode:t},decoder:{decode:r}}}const $O=K$("utf8","u",n=>"u"+new TextDecoder("utf8").decode(n),n=>new TextEncoder().encode(n.substring(1))),n1=K$("ascii","a",n=>{let e="a";for(let t=0;t<n.length;t++)e+=String.fromCharCode(n[t]);return e},n=>{n=n.substring(1);const e=Fte(n.length);for(let t=0;t<n.length;t++)e[t]=n.charCodeAt(t);return e}),jte={utf8:$O,"utf-8":$O,hex:UO.base16,latin1:n1,ascii:n1,binary:n1,...UO};function Hte(n,e="utf8"){const t=jte[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?G$(globalThis.Buffer.from(n,"utf-8")):t.decoder.decode(`${t.prefix}${n}`)}var Vte=Object.defineProperty,qte=(n,e,t)=>e in n?Vte(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,qi=(n,e,t)=>qte(n,typeof e!="symbol"?e+"":e,t);let zte=class{constructor(e,t){this.core=e,this.logger=t,qi(this,"keychain",new Map),qi(this,"name",VX),qi(this,"version",qX),qi(this,"initialized",!1),qi(this,"storagePrefix",Co),qi(this,"init",async()=>{if(!this.initialized){const r=await this.getKeyChain();typeof r<"u"&&(this.keychain=r),this.initialized=!0}}),qi(this,"has",r=>(this.isInitialized(),this.keychain.has(r))),qi(this,"set",async(r,s)=>{this.isInitialized(),this.keychain.set(r,s),await this.persist()}),qi(this,"get",r=>{this.isInitialized();const s=this.keychain.get(r);if(typeof s>"u"){const{message:i}=re("NO_MATCHING_KEY",`${this.name}: ${r}`);throw new Error(i)}return s}),qi(this,"del",async r=>{this.isInitialized(),this.keychain.delete(r),await this.persist()}),this.core=e,this.logger=vr(t,this.name)}get context(){return hs(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setKeyChain(e){await this.core.storage.setItem(this.storageKey,LA(e))}async getKeyChain(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?BA(e):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:e}=re("NOT_INITIALIZED",this.name);throw new Error(e)}}};var Wte=Object.defineProperty,Gte=(n,e,t)=>e in n?Wte(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Mn=(n,e,t)=>Gte(n,typeof e!="symbol"?e+"":e,t);let Kte=class{constructor(e,t,r){this.core=e,this.logger=t,Mn(this,"name",jX),Mn(this,"keychain"),Mn(this,"randomSessionIdentifier",YA()),Mn(this,"initialized",!1),Mn(this,"init",async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)}),Mn(this,"hasKeys",s=>(this.isInitialized(),this.keychain.has(s))),Mn(this,"getClientId",async()=>{this.isInitialized();const s=await this.getClientSeed(),i=m2(s);return W3(i.publicKey)}),Mn(this,"generateKeyPair",()=>{this.isInitialized();const s=BZ();return this.setPrivateKey(s.publicKey,s.privateKey)}),Mn(this,"signJWT",async s=>{this.isInitialized();const i=await this.getClientSeed(),o=m2(i),a=this.randomSessionIdentifier;return await Vz(a,s,HX,o)}),Mn(this,"generateSharedKey",(s,i,o)=>{this.isInitialized();const a=this.getPrivateKey(s),c=FZ(a,i);return this.setSymKey(c,o)}),Mn(this,"setSymKey",async(s,i)=>{this.isInitialized();const o=i||Jw(s);return await this.keychain.set(o,s),o}),Mn(this,"deleteKeyPair",async s=>{this.isInitialized(),await this.keychain.del(s)}),Mn(this,"deleteSymKey",async s=>{this.isInitialized(),await this.keychain.del(s)}),Mn(this,"encode",async(s,i,o)=>{this.isInitialized();const a=C$(o),c=ma(i);if(uO(a))return VZ(c,o==null?void 0:o.encoding);if(lO(a)){const d=a.senderPublicKey,f=a.receiverPublicKey;s=await this.generateSharedKey(d,f)}const l=this.getSymKey(s),{type:u,senderPublicKey:h}=a;return jZ({type:u,symKey:l,message:c,senderPublicKey:h,encoding:o==null?void 0:o.encoding})}),Mn(this,"decode",async(s,i,o)=>{this.isInitialized();const a=zZ(i,o);if(uO(a)){const c=qZ(i,o==null?void 0:o.encoding);return fu(c)}if(lO(a)){const c=a.receiverPublicKey,l=a.senderPublicKey;s=await this.generateSharedKey(c,l)}try{const c=this.getSymKey(s),l=HZ({symKey:c,encoded:i,encoding:o==null?void 0:o.encoding});return fu(l)}catch(c){this.logger.error(`Failed to decode message from topic: '${s}', clientId: '${await this.getClientId()}'`),this.logger.error(c)}}),Mn(this,"getPayloadType",(s,i=ts)=>{const o=qg({encoded:s,encoding:i});return yu(o.type)}),Mn(this,"getPayloadSenderPublicKey",(s,i=ts)=>{const o=qg({encoded:s,encoding:i});return o.senderPublicKey?as(o.senderPublicKey,$r):void 0}),this.core=e,this.logger=vr(t,this.name),this.keychain=r||new zte(this.core,this.logger)}get context(){return hs(this.logger)}async setPrivateKey(e,t){return await this.keychain.set(e,t),e}getPrivateKey(e){return this.keychain.get(e)}async getClientSeed(){let e="";try{e=this.keychain.get(OO)}catch{e=YA(),await this.keychain.set(OO,e)}return Hte(e,"base16")}getSymKey(e){return this.keychain.get(e)}isInitialized(){if(!this.initialized){const{message:e}=re("NOT_INITIALIZED",this.name);throw new Error(e)}}};var Yte=Object.defineProperty,Qte=Object.defineProperties,Zte=Object.getOwnPropertyDescriptors,MO=Object.getOwnPropertySymbols,Jte=Object.prototype.hasOwnProperty,Xte=Object.prototype.propertyIsEnumerable,rC=(n,e,t)=>e in n?Yte(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,ene=(n,e)=>{for(var t in e||(e={}))Jte.call(e,t)&&rC(n,t,e[t]);if(MO)for(var t of MO(e))Xte.call(e,t)&&rC(n,t,e[t]);return n},tne=(n,e)=>Qte(n,Zte(e)),ps=(n,e,t)=>rC(n,typeof e!="symbol"?e+"":e,t);let nne=class extends FH{constructor(e,t){super(e,t),this.logger=e,this.core=t,ps(this,"messages",new Map),ps(this,"messagesWithoutClientAck",new Map),ps(this,"name",zX),ps(this,"version",WX),ps(this,"initialized",!1),ps(this,"storagePrefix",Co),ps(this,"init",async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const r=await this.getRelayerMessages();typeof r<"u"&&(this.messages=r);const s=await this.getRelayerMessagesWithoutClientAck();typeof s<"u"&&(this.messagesWithoutClientAck=s),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(r){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(r)}finally{this.initialized=!0}}}),ps(this,"set",async(r,s,i)=>{this.isInitialized();const o=Gs(s);let a=this.messages.get(r);if(typeof a>"u"&&(a={}),typeof a[o]<"u")return o;if(a[o]=s,this.messages.set(r,a),i===Xw.inbound){const c=this.messagesWithoutClientAck.get(r)||{};this.messagesWithoutClientAck.set(r,tne(ene({},c),{[o]:s}))}return await this.persist(),o}),ps(this,"get",r=>{this.isInitialized();let s=this.messages.get(r);return typeof s>"u"&&(s={}),s}),ps(this,"getWithoutAck",r=>{this.isInitialized();const s={};for(const i of r){const o=this.messagesWithoutClientAck.get(i)||{};s[i]=Object.values(o)}return s}),ps(this,"has",(r,s)=>{this.isInitialized();const i=this.get(r),o=Gs(s);return typeof i[o]<"u"}),ps(this,"ack",async(r,s)=>{this.isInitialized();const i=this.messagesWithoutClientAck.get(r);if(typeof i>"u")return;const o=Gs(s);delete i[o],Object.keys(i).length===0?this.messagesWithoutClientAck.delete(r):this.messagesWithoutClientAck.set(r,i),await this.persist()}),ps(this,"del",async r=>{this.isInitialized(),this.messages.delete(r),this.messagesWithoutClientAck.delete(r),await this.persist()}),this.logger=vr(e,this.name),this.core=t}get context(){return hs(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get storageKeyWithoutClientAck(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name+"_withoutClientAck"}async setRelayerMessages(e){await this.core.storage.setItem(this.storageKey,LA(e))}async setRelayerMessagesWithoutClientAck(e){await this.core.storage.setItem(this.storageKeyWithoutClientAck,LA(e))}async getRelayerMessages(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?BA(e):void 0}async getRelayerMessagesWithoutClientAck(){const e=await this.core.storage.getItem(this.storageKeyWithoutClientAck);return typeof e<"u"?BA(e):void 0}async persist(){await this.setRelayerMessages(this.messages),await this.setRelayerMessagesWithoutClientAck(this.messagesWithoutClientAck)}isInitialized(){if(!this.initialized){const{message:e}=re("NOT_INITIALIZED",this.name);throw new Error(e)}}};var rne=Object.defineProperty,sne=Object.defineProperties,ine=Object.getOwnPropertyDescriptors,LO=Object.getOwnPropertySymbols,one=Object.prototype.hasOwnProperty,ane=Object.prototype.propertyIsEnumerable,sC=(n,e,t)=>e in n?rne(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,ih=(n,e)=>{for(var t in e||(e={}))one.call(e,t)&&sC(n,t,e[t]);if(LO)for(var t of LO(e))ane.call(e,t)&&sC(n,t,e[t]);return n},BO=(n,e)=>sne(n,ine(e)),$s=(n,e,t)=>sC(n,typeof e!="symbol"?e+"":e,t);let cne=class extends jH{constructor(e,t){super(e,t),this.relayer=e,this.logger=t,$s(this,"events",new ii.EventEmitter),$s(this,"name",KX),$s(this,"queue",new Map),$s(this,"publishTimeout",ne.toMiliseconds(ne.ONE_MINUTE)),$s(this,"initialPublishTimeout",ne.toMiliseconds(ne.ONE_SECOND*15)),$s(this,"needsTransportRestart",!1),$s(this,"publish",async(r,s,i)=>{var o,a,c,l,u;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:r,message:s,opts:i}});const h=(i==null?void 0:i.ttl)||GX,d=(i==null?void 0:i.prompt)||!1,f=(i==null?void 0:i.tag)||0,p=(i==null?void 0:i.id)||Ic().toString(),g=Mh(L0().protocol),m={id:p,method:(i==null?void 0:i.publishMethod)||g.publish,params:ih({topic:r,message:s,ttl:h,prompt:d,tag:f,attestation:i==null?void 0:i.attestation},(i==null?void 0:i.tvf)&&{tvf:i.tvf})},w=`Failed to publish payload, please try again. id:${p} tag:${f}`;try{Nn((o=m.params)==null?void 0:o.prompt)&&((a=m.params)==null||delete a.prompt),Nn((c=m.params)==null?void 0:c.tag)&&((l=m.params)==null||delete l.tag);const v=new Promise(async A=>{const T=({id:R})=>{var M;((M=m.id)==null?void 0:M.toString())===R.toString()&&(this.removeRequestFromQueue(R),this.relayer.events.removeListener(en.publish,T),A())};this.relayer.events.on(en.publish,T);const N=ho(new Promise((R,M)=>{this.rpcPublish(m,i).then(R).catch(D=>{this.logger.warn(D,D==null?void 0:D.message),M(D)})}),this.initialPublishTimeout,`Failed initial publish, retrying.... id:${p} tag:${f}`);try{await N,this.events.removeListener(en.publish,T)}catch(R){this.queue.set(p,{request:m,opts:i,attempt:1}),this.logger.warn(R,R==null?void 0:R.message)}});this.logger.trace({type:"method",method:"publish",params:{id:p,topic:r,message:s,opts:i}}),await ho(v,this.publishTimeout,w)}catch(v){if(this.logger.debug("Failed to Publish Payload"),this.logger.error(v),(u=i==null?void 0:i.internal)!=null&&u.throwOnFailedPublish)throw v}finally{this.queue.delete(p)}}),$s(this,"publishCustom",async r=>{var s,i,o,a,c;this.logger.debug("Publishing custom payload"),this.logger.trace({type:"method",method:"publishCustom",params:r});const{payload:l,opts:u={}}=r,{attestation:h,tvf:d,publishMethod:f,prompt:p,tag:g,ttl:m=ne.FIVE_MINUTES}=u,w=u.id||Ic().toString(),v=Mh(L0().protocol),A=f||v.publish,T={id:w,method:A,params:ih(BO(ih({},l),{ttl:m,prompt:p,tag:g,attestation:h}),d)},N=`Failed to publish custom payload, please try again. id:${w} tag:${g}`;try{Nn((s=T.params)==null?void 0:s.prompt)&&((i=T.params)==null||delete i.prompt),Nn((o=T.params)==null?void 0:o.tag)&&((a=T.params)==null||delete a.tag);const R=new Promise(async M=>{const D=({id:$})=>{var P;((P=T.id)==null?void 0:P.toString())===$.toString()&&(this.removeRequestFromQueue($),this.relayer.events.removeListener(en.publish,D),M())};this.relayer.events.on(en.publish,D);const S=ho(new Promise(($,P)=>{this.rpcPublish(T,u).then($).catch(L=>{this.logger.warn(L,L==null?void 0:L.message),P(L)})}),this.initialPublishTimeout,`Failed initial custom payload publish, retrying.... method:${A} id:${w} tag:${g}`);try{await S,this.events.removeListener(en.publish,D)}catch($){this.queue.set(w,{request:T,opts:u,attempt:1}),this.logger.warn($,$==null?void 0:$.message)}});this.logger.trace({type:"method",method:"publish",params:{id:w,payload:l,opts:u}}),await ho(R,this.publishTimeout,N)}catch(R){if(this.logger.debug("Failed to Publish Payload"),this.logger.error(R),(c=u==null?void 0:u.internal)!=null&&c.throwOnFailedPublish)throw R}finally{this.queue.delete(w)}}),$s(this,"on",(r,s)=>{this.events.on(r,s)}),$s(this,"once",(r,s)=>{this.events.once(r,s)}),$s(this,"off",(r,s)=>{this.events.off(r,s)}),$s(this,"removeListener",(r,s)=>{this.events.removeListener(r,s)}),this.relayer=e,this.logger=vr(t,this.name),this.registerEventListeners()}get context(){return hs(this.logger)}async rpcPublish(e,t){this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:e});const r=await this.relayer.request(e);return this.relayer.events.emit(en.publish,ih(ih({},e),t)),this.logger.debug("Successfully Published Payload"),r}removeRequestFromQueue(e){this.queue.delete(e)}checkQueue(){this.queue.forEach(async(e,t)=>{var r;const s=e.attempt+1;this.queue.set(t,BO(ih({},e),{attempt:s})),this.logger.warn({},`Publisher: queue->publishing: ${e.request.id}, tag: ${(r=e.request.params)==null?void 0:r.tag}, attempt: ${s}`),await this.rpcPublish(e.request,e.opts),this.logger.warn({},`Publisher: queue->published: ${e.request.id}`)})}registerEventListeners(){this.relayer.core.heartbeat.on(Bu.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(en.connection_stalled);return}this.checkQueue()}),this.relayer.on(en.message_ack,e=>{this.removeRequestFromQueue(e.id.toString())})}};var lne=Object.defineProperty,une=(n,e,t)=>e in n?lne(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,oh=(n,e,t)=>une(n,typeof e!="symbol"?e+"":e,t);let hne=class{constructor(){oh(this,"map",new Map),oh(this,"set",(e,t)=>{const r=this.get(e);this.exists(e,t)||this.map.set(e,[...r,t])}),oh(this,"get",e=>this.map.get(e)||[]),oh(this,"exists",(e,t)=>this.get(e).includes(t)),oh(this,"delete",(e,t)=>{if(typeof t>"u"){this.map.delete(e);return}if(!this.map.has(e))return;const r=this.get(e);if(!this.exists(e,t))return;const s=r.filter(i=>i!==t);if(!s.length){this.map.delete(e);return}this.map.set(e,s)}),oh(this,"clear",()=>{this.map.clear()})}get topics(){return Array.from(this.map.keys())}};var dne=Object.defineProperty,fne=Object.defineProperties,pne=Object.getOwnPropertyDescriptors,FO=Object.getOwnPropertySymbols,gne=Object.prototype.hasOwnProperty,mne=Object.prototype.propertyIsEnumerable,iC=(n,e,t)=>e in n?dne(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,yp=(n,e)=>{for(var t in e||(e={}))gne.call(e,t)&&iC(n,t,e[t]);if(FO)for(var t of FO(e))mne.call(e,t)&&iC(n,t,e[t]);return n},r1=(n,e)=>fne(n,pne(e)),Dt=(n,e,t)=>iC(n,typeof e!="symbol"?e+"":e,t);let yne=class extends qH{constructor(e,t){super(e,t),this.relayer=e,this.logger=t,Dt(this,"subscriptions",new Map),Dt(this,"topicMap",new hne),Dt(this,"events",new ii.EventEmitter),Dt(this,"name",tee),Dt(this,"version",nee),Dt(this,"pending",new Map),Dt(this,"cached",[]),Dt(this,"initialized",!1),Dt(this,"storagePrefix",Co),Dt(this,"subscribeTimeout",ne.toMiliseconds(ne.ONE_MINUTE)),Dt(this,"initialSubscribeTimeout",ne.toMiliseconds(ne.ONE_SECOND*15)),Dt(this,"clientId"),Dt(this,"batchSubscribeTopicsLimit",500),Dt(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),await this.restore()),this.initialized=!0}),Dt(this,"subscribe",async(r,s)=>{var i;this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:r,opts:s}});try{const o=L0(s),a={topic:r,relay:o,transportType:s==null?void 0:s.transportType};(i=s==null?void 0:s.internal)!=null&&i.skipSubscribe||this.pending.set(r,a);const c=await this.rpcSubscribe(r,o,s);return typeof c=="string"&&(this.onSubscribe(c,a),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:r,opts:s}})),c}catch(o){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(o),o}}),Dt(this,"unsubscribe",async(r,s)=>{this.isInitialized(),typeof(s==null?void 0:s.id)<"u"?await this.unsubscribeById(r,s.id,s):await this.unsubscribeByTopic(r,s)}),Dt(this,"isSubscribed",r=>new Promise(s=>{s(this.topicMap.topics.includes(r))})),Dt(this,"isKnownTopic",r=>new Promise(s=>{s(this.topicMap.topics.includes(r)||this.pending.has(r)||this.cached.some(i=>i.topic===r))})),Dt(this,"on",(r,s)=>{this.events.on(r,s)}),Dt(this,"once",(r,s)=>{this.events.once(r,s)}),Dt(this,"off",(r,s)=>{this.events.off(r,s)}),Dt(this,"removeListener",(r,s)=>{this.events.removeListener(r,s)}),Dt(this,"start",async()=>{await this.onConnect()}),Dt(this,"stop",async()=>{await this.onDisconnect()}),Dt(this,"restart",async()=>{await this.restore(),await this.onRestart()}),Dt(this,"checkPending",async()=>{if(this.pending.size===0&&(!this.initialized||!this.relayer.connected))return;const r=[];this.pending.forEach(s=>{r.push(s)}),await this.batchSubscribe(r)}),Dt(this,"registerEventListeners",()=>{this.relayer.core.heartbeat.on(Bu.pulse,async()=>{await this.checkPending()}),this.events.on(ms.created,async r=>{const s=ms.created;this.logger.info(`Emitting ${s}`),this.logger.debug({type:"event",event:s,data:r}),await this.persist()}),this.events.on(ms.deleted,async r=>{const s=ms.deleted;this.logger.info(`Emitting ${s}`),this.logger.debug({type:"event",event:s,data:r}),await this.persist()})}),this.relayer=e,this.logger=vr(t,this.name),this.clientId=""}get context(){return hs(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.relayer.core.customStoragePrefix+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}get hasAnyTopics(){return this.topicMap.topics.length>0||this.pending.size>0||this.cached.length>0||this.subscriptions.size>0}hasSubscription(e,t){let r=!1;try{r=this.getSubscription(e).topic===t}catch{}return r}reset(){this.cached=[],this.initialized=!0}onDisable(){this.values.length>0&&(this.cached=this.values),this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(e,t){const r=this.topicMap.get(e);await Promise.all(r.map(async s=>await this.unsubscribeById(e,s,t)))}async unsubscribeById(e,t,r){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:t,opts:r}});try{const s=L0(r);await this.restartToComplete({topic:e,id:t,relay:s}),await this.rpcUnsubscribe(e,t,s);const i=zt("USER_DISCONNECTED",`${this.name}, ${e}`);await this.onUnsubscribe(e,t,i),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:t,opts:r}})}catch(s){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(s),s}}async rpcSubscribe(e,t,r){var s,i;const o=await this.getSubscriptionId(e);if((s=r==null?void 0:r.internal)!=null&&s.skipSubscribe)return o;(!r||(r==null?void 0:r.transportType)===Lt.relay)&&await this.restartToComplete({topic:e,id:e,relay:t});const a={method:Mh(t.protocol).subscribe,params:{topic:e}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:a});const c=(i=r==null?void 0:r.internal)==null?void 0:i.throwOnFailedPublish;try{if((r==null?void 0:r.transportType)===Lt.link_mode)return setTimeout(()=>{(this.relayer.connected||this.relayer.connecting)&&this.relayer.request(a).catch(h=>this.logger.warn(h))},ne.toMiliseconds(ne.ONE_SECOND)),o;const l=new Promise(async h=>{const d=f=>{f.topic===e&&(this.events.removeListener(ms.created,d),h(f.id))};this.events.on(ms.created,d);try{const f=await ho(new Promise((p,g)=>{this.relayer.request(a).catch(m=>{this.logger.warn(m,m==null?void 0:m.message),g(m)}).then(p)}),this.initialSubscribeTimeout,`Subscribing to ${e} failed, please try again`);this.events.removeListener(ms.created,d),h(f)}catch{}}),u=await ho(l,this.subscribeTimeout,`Subscribing to ${e} failed, please try again`);if(!u&&c)throw new Error(`Subscribing to ${e} failed, please try again`);return u?o:null}catch(l){if(this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(en.connection_stalled),c)throw l}return null}async rpcBatchSubscribe(e){if(!e.length)return;const t=e[0].relay,r={method:Mh(t.protocol).batchSubscribe,params:{topics:e.map(s=>s.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:r});try{await await ho(new Promise(s=>{this.relayer.request(r).catch(i=>this.logger.warn(i)).then(s)}),this.subscribeTimeout,"rpcBatchSubscribe failed, please try again")}catch{this.relayer.events.emit(en.connection_stalled)}}async rpcBatchFetchMessages(e){if(!e.length)return;const t=e[0].relay,r={method:Mh(t.protocol).batchFetchMessages,params:{topics:e.map(i=>i.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:r});let s;try{s=await await ho(new Promise((i,o)=>{this.relayer.request(r).catch(a=>{this.logger.warn(a),o(a)}).then(i)}),this.subscribeTimeout,"rpcBatchFetchMessages failed, please try again")}catch{this.relayer.events.emit(en.connection_stalled)}return s}rpcUnsubscribe(e,t,r){const s={method:Mh(r.protocol).unsubscribe,params:{topic:e,id:t}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s}),this.relayer.request(s)}onSubscribe(e,t){this.setSubscription(e,r1(yp({},t),{id:e})),this.pending.delete(t.topic)}onBatchSubscribe(e){e.length&&e.forEach(t=>{this.setSubscription(t.id,yp({},t)),this.pending.delete(t.topic)})}async onUnsubscribe(e,t,r){this.events.removeAllListeners(t),this.hasSubscription(t,e)&&this.deleteSubscription(t,r),await this.relayer.messages.del(e)}async setRelayerSubscriptions(e){await this.relayer.core.storage.setItem(this.storageKey,e)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(e,t){this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:e,subscription:t}),this.addSubscription(e,t)}addSubscription(e,t){this.subscriptions.set(e,yp({},t)),this.topicMap.set(t.topic,e),this.events.emit(ms.created,t)}getSubscription(e){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:e});const t=this.subscriptions.get(e);if(!t){const{message:r}=re("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(r)}return t}deleteSubscription(e,t){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:e,reason:t});const r=this.getSubscription(e);this.subscriptions.delete(e),this.topicMap.delete(r.topic,e),this.events.emit(ms.deleted,r1(yp({},r),{reason:t}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(ms.sync)}async onRestart(){if(this.cached.length){const e=[...this.cached],t=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let r=0;r<t;r++){const s=e.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(s)}}this.events.emit(ms.resubscribed)}async restore(){try{const e=await this.getRelayerSubscriptions();if(typeof e>"u"||!e.length)return;if(this.subscriptions.size&&!e.every(t=>{var r;return t.topic===((r=this.subscriptions.get(t.id))==null?void 0:r.topic)})){const{message:t}=re("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(e){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(e)}}async batchSubscribe(e){e.length&&(await this.rpcBatchSubscribe(e),this.onBatchSubscribe(await Promise.all(e.map(async t=>r1(yp({},t),{id:await this.getSubscriptionId(t.topic)})))))}async batchFetchMessages(e){if(!e.length)return;this.logger.trace(`Fetching batch messages for ${e.length} subscriptions`);const t=await this.rpcBatchFetchMessages(e);t&&t.messages&&(await oY(ne.toMiliseconds(ne.ONE_SECOND)),await this.relayer.handleBatchMessageEvents(t.messages))}async onConnect(){await this.restart(),this.reset()}onDisconnect(){this.onDisable()}isInitialized(){if(!this.initialized){const{message:e}=re("NOT_INITIALIZED",this.name);throw new Error(e)}}async restartToComplete(e){!this.relayer.connected&&!this.relayer.connecting&&(this.cached.push(e),await this.relayer.transportOpen())}async getClientId(){return this.clientId||(this.clientId=await this.relayer.core.crypto.getClientId()),this.clientId}async getSubscriptionId(e){return Gs(e+await this.getClientId())}};var wne=Object.defineProperty,jO=Object.getOwnPropertySymbols,bne=Object.prototype.hasOwnProperty,Ene=Object.prototype.propertyIsEnumerable,oC=(n,e,t)=>e in n?wne(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,HO=(n,e)=>{for(var t in e||(e={}))bne.call(e,t)&&oC(n,t,e[t]);if(jO)for(var t of jO(e))Ene.call(e,t)&&oC(n,t,e[t]);return n},ft=(n,e,t)=>oC(n,typeof e!="symbol"?e+"":e,t);let vne=class extends HH{constructor(e){super(e),ft(this,"protocol","wc"),ft(this,"version",2),ft(this,"core"),ft(this,"logger"),ft(this,"events",new ii.EventEmitter),ft(this,"provider"),ft(this,"messages"),ft(this,"subscriber"),ft(this,"publisher"),ft(this,"name",QX),ft(this,"transportExplicitlyClosed",!1),ft(this,"initialized",!1),ft(this,"connectionAttemptInProgress",!1),ft(this,"relayUrl"),ft(this,"projectId"),ft(this,"packageName"),ft(this,"bundleId"),ft(this,"hasExperiencedNetworkDisruption",!1),ft(this,"pingTimeout"),ft(this,"heartBeatTimeout",ne.toMiliseconds(ne.THIRTY_SECONDS+ne.FIVE_SECONDS)),ft(this,"reconnectTimeout"),ft(this,"connectPromise"),ft(this,"reconnectInProgress",!1),ft(this,"requestsInFlight",[]),ft(this,"connectTimeout",ne.toMiliseconds(ne.ONE_SECOND*15)),ft(this,"request",async t=>{var r,s;this.logger.debug("Publishing Request Payload");const i=t.id||Ic().toString();await this.toEstablishConnection();try{this.logger.trace({id:i,method:t.method,topic:(r=t.params)==null?void 0:r.topic},"relayer.request - publishing...");const o=`${i}:${((s=t.params)==null?void 0:s.tag)||""}`;this.requestsInFlight.push(o);const a=await this.provider.request(t);return this.requestsInFlight=this.requestsInFlight.filter(c=>c!==o),a}catch(o){throw this.logger.debug(`Failed to Publish Request: ${i}`),o}}),ft(this,"resetPingTimeout",()=>{D0()&&(clearTimeout(this.pingTimeout),this.pingTimeout=setTimeout(()=>{var t,r,s,i;try{this.logger.debug({},"pingTimeout: Connection stalled, terminating..."),(i=(s=(r=(t=this.provider)==null?void 0:t.connection)==null?void 0:r.socket)==null?void 0:s.terminate)==null||i.call(s)}catch(o){this.logger.warn(o,o==null?void 0:o.message)}},this.heartBeatTimeout))}),ft(this,"onPayloadHandler",t=>{this.onProviderPayload(t),this.resetPingTimeout()}),ft(this,"onConnectHandler",()=>{this.logger.warn({},"Relayer connected 🛜"),this.startPingTimeout(),this.events.emit(en.connect)}),ft(this,"onDisconnectHandler",()=>{this.logger.warn({},"Relayer disconnected 🛑"),this.requestsInFlight=[],this.onProviderDisconnect()}),ft(this,"onProviderErrorHandler",t=>{this.logger.fatal(`Fatal socket error: ${t.message}`),this.events.emit(en.error,t),this.logger.fatal("Fatal socket error received, closing transport"),this.transportClose()}),ft(this,"registerProviderListeners",()=>{this.provider.on(Us.payload,this.onPayloadHandler),this.provider.on(Us.connect,this.onConnectHandler),this.provider.on(Us.disconnect,this.onDisconnectHandler),this.provider.on(Us.error,this.onProviderErrorHandler)}),this.core=e.core,this.logger=typeof e.logger<"u"&&typeof e.logger!="string"?vr(e.logger,this.name):cy(Rf({level:e.logger||YX})),this.messages=new nne(this.logger,e.core),this.subscriber=new yne(this,this.logger),this.publisher=new cne(this,this.logger),this.projectId=e==null?void 0:e.projectId,this.relayUrl=(e==null?void 0:e.relayUrl)||$$,qK()?this.packageName=R2():zK()&&(this.bundleId=R2()),this.provider={}}async init(){this.logger.trace("Initialized"),this.registerEventListeners(),await Promise.all([this.messages.init(),this.subscriber.init()]),this.initialized=!0,this.transportOpen().catch(e=>this.logger.warn(e,e==null?void 0:e.message))}get context(){return hs(this.logger)}get connected(){var e,t,r;return((r=(t=(e=this.provider)==null?void 0:e.connection)==null?void 0:t.socket)==null?void 0:r.readyState)===1||!1}get connecting(){var e,t,r;return((r=(t=(e=this.provider)==null?void 0:e.connection)==null?void 0:t.socket)==null?void 0:r.readyState)===0||this.connectPromise!==void 0||!1}async publish(e,t,r){this.isInitialized(),await this.publisher.publish(e,t,r),await this.recordMessageEvent({topic:e,message:t,publishedAt:Date.now(),transportType:Lt.relay},Xw.outbound)}async publishCustom(e){this.isInitialized(),await this.publisher.publishCustom(e)}async subscribe(e,t){var r,s,i;this.isInitialized(),(!(t!=null&&t.transportType)||(t==null?void 0:t.transportType)==="relay")&&await this.toEstablishConnection();const o=typeof((r=t==null?void 0:t.internal)==null?void 0:r.throwOnFailedPublish)>"u"?!0:(s=t==null?void 0:t.internal)==null?void 0:s.throwOnFailedPublish;let a=((i=this.subscriber.topicMap.get(e))==null?void 0:i[0])||"",c;const l=u=>{u.topic===e&&(this.subscriber.off(ms.created,l),c())};return await Promise.all([new Promise(u=>{c=u,this.subscriber.on(ms.created,l)}),new Promise(async(u,h)=>{a=await this.subscriber.subscribe(e,HO({internal:{throwOnFailedPublish:o}},t)).catch(d=>{o&&h(d)})||a,u()})]),a}async unsubscribe(e,t){this.isInitialized(),await this.subscriber.unsubscribe(e,t)}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async transportDisconnect(){this.provider.disconnect&&(this.hasExperiencedNetworkDisruption||this.connected)?await ho(this.provider.disconnect(),2e3,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.onProviderDisconnect()}async transportClose(){this.transportExplicitlyClosed=!0,await this.transportDisconnect()}async transportOpen(e){if(!this.subscriber.hasAnyTopics){this.logger.info("Starting WS connection skipped because the client has no topics to work with.");return}if(this.connectPromise?(this.logger.debug({},"Waiting for existing connection attempt to resolve..."),await this.connectPromise,this.logger.debug({},"Existing connection attempt resolved")):(this.connectPromise=new Promise(async(t,r)=>{await this.connect(e).then(t).catch(r).finally(()=>{this.connectPromise=void 0})}),await this.connectPromise),!this.connected)throw new Error(`Couldn't establish socket connection to the relay server: ${this.relayUrl}`)}async restartTransport(e){this.logger.debug({},"Restarting transport..."),!this.connectionAttemptInProgress&&(this.relayUrl=e||this.relayUrl,await this.confirmOnlineStateOrThrow(),await this.transportClose(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await vO())throw new Error("No internet connection detected. Please restart your network and try again.")}async handleBatchMessageEvents(e){if((e==null?void 0:e.length)===0){this.logger.trace("Batch message events is empty. Ignoring...");return}const t=e.sort((r,s)=>r.publishedAt-s.publishedAt);this.logger.debug(`Batch of ${t.length} message events sorted`);for(const r of t)try{await this.onMessageEvent(r)}catch(s){this.logger.warn(s,"Error while processing batch message event: "+(s==null?void 0:s.message))}this.logger.trace(`Batch of ${t.length} message events processed`)}async onLinkMessageEvent(e,t){const{topic:r}=e;if(!t.sessionExists){const s=bn(ne.FIVE_MINUTES),i={topic:r,expiry:s,relay:{protocol:"irn"},active:!1};await this.core.pairing.pairings.set(r,i)}this.events.emit(en.message,e),await this.recordMessageEvent(e,Xw.inbound)}async connect(e){await this.confirmOnlineStateOrThrow(),e&&e!==this.relayUrl&&(this.relayUrl=e,await this.transportDisconnect()),this.connectionAttemptInProgress=!0,this.transportExplicitlyClosed=!1;let t=1;for(;t<6;){try{if(this.transportExplicitlyClosed)break;this.logger.debug({},`Connecting to ${this.relayUrl}, attempt: ${t}...`),await this.createProvider(),await new Promise(async(r,s)=>{const i=()=>{s(new Error("Connection interrupted while trying to connect"))};this.provider.once(Us.disconnect,i),await ho(new Promise((o,a)=>{this.provider.connect().then(o).catch(a)}),this.connectTimeout,`Socket stalled when trying to connect to ${this.relayUrl}`).catch(o=>{s(o)}).finally(()=>{this.provider.off(Us.disconnect,i),clearTimeout(this.reconnectTimeout)}),await new Promise(async(o,a)=>{const c=()=>{s(new Error("Connection interrupted while trying to subscribe"))};this.provider.once(Us.disconnect,c),await this.subscriber.start().then(o).catch(a).finally(()=>{this.provider.off(Us.disconnect,c)})}),this.hasExperiencedNetworkDisruption=!1,r()})}catch(r){await this.subscriber.stop();const s=r;this.logger.warn({},s.message),this.hasExperiencedNetworkDisruption=!0}finally{this.connectionAttemptInProgress=!1}if(this.connected){this.logger.debug({},`Connected to ${this.relayUrl} successfully on attempt: ${t}`);break}await new Promise(r=>setTimeout(r,ne.toMiliseconds(t*1))),t++}}startPingTimeout(){var e,t,r,s,i;if(D0())try{(t=(e=this.provider)==null?void 0:e.connection)!=null&&t.socket&&((i=(s=(r=this.provider)==null?void 0:r.connection)==null?void 0:s.socket)==null||i.on("ping",()=>{this.resetPingTimeout()})),this.resetPingTimeout()}catch(o){this.logger.warn(o,o==null?void 0:o.message)}}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();const e=await this.core.crypto.signJWT(this.relayUrl);this.provider=new oi(new MX(QK({sdkVersion:eC,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:e,useOnCloseEvent:!0,bundleId:this.bundleId,packageName:this.packageName}))),this.registerProviderListeners()}async recordMessageEvent(e,t){const{topic:r,message:s}=e;await this.messages.set(r,s,t)}async shouldIgnoreMessageEvent(e){const{topic:t,message:r}=e;if(!r||r.length===0)return this.logger.warn(`Ignoring invalid/empty message: ${r}`),!0;if(!await this.subscriber.isKnownTopic(t))return this.logger.warn(`Ignoring message for unknown topic ${t}`),!0;const s=this.messages.has(t,r);return s&&this.logger.warn(`Ignoring duplicate message: ${r}`),s}async onProviderPayload(e){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:e}),k_(e)){if(!e.method.endsWith(ZX))return;const t=e.params,{topic:r,message:s,publishedAt:i,attestation:o}=t.data,a={topic:r,message:s,publishedAt:i,transportType:Lt.relay,attestation:o};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(HO({type:"event",event:t.id},a)),this.events.emit(t.id,a),await this.acknowledgePayload(e),await this.onMessageEvent(a)}else aE(e)&&this.events.emit(en.message_ack,e)}async onMessageEvent(e){await this.shouldIgnoreMessageEvent(e)||(await this.recordMessageEvent(e,Xw.inbound),this.events.emit(en.message,e))}async acknowledgePayload(e){const t=Wg(e.id,!0);await this.provider.connection.send(t)}unregisterProviderListeners(){this.provider.off(Us.payload,this.onPayloadHandler),this.provider.off(Us.connect,this.onConnectHandler),this.provider.off(Us.disconnect,this.onDisconnectHandler),this.provider.off(Us.error,this.onProviderErrorHandler),clearTimeout(this.pingTimeout)}async registerEventListeners(){let e=await vO();LJ(async t=>{e!==t&&(e=t,t?await this.transportOpen().catch(r=>this.logger.error(r,r==null?void 0:r.message)):(this.hasExperiencedNetworkDisruption=!0,await this.transportDisconnect(),this.transportExplicitlyClosed=!1))}),this.core.heartbeat.on(Bu.pulse,async()=>{if(!this.transportExplicitlyClosed&&!this.connected&&jJ())try{await this.confirmOnlineStateOrThrow(),await this.transportOpen()}catch(t){this.logger.warn(t,t==null?void 0:t.message)}})}async onProviderDisconnect(){clearTimeout(this.pingTimeout),this.events.emit(en.disconnect),this.connectionAttemptInProgress=!1,!this.reconnectInProgress&&(this.reconnectInProgress=!0,await this.subscriber.stop(),this.subscriber.hasAnyTopics&&(this.transportExplicitlyClosed||(this.reconnectTimeout=setTimeout(async()=>{await this.transportOpen().catch(e=>this.logger.error(e,e==null?void 0:e.message)),this.reconnectTimeout=void 0,this.reconnectInProgress=!1},ne.toMiliseconds(JX)))))}isInitialized(){if(!this.initialized){const{message:e}=re("NOT_INITIALIZED",this.name);throw new Error(e)}}async toEstablishConnection(){if(await this.confirmOnlineStateOrThrow(),!this.connected){if(this.connectPromise){await this.connectPromise;return}await this.connect()}}};function Ane(n,e){return n===e||Number.isNaN(n)&&Number.isNaN(e)}function VO(n){return Object.getOwnPropertySymbols(n).filter(e=>Object.prototype.propertyIsEnumerable.call(n,e))}function qO(n){return n==null?n===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(n)}const Cne="[object RegExp]",Ine="[object String]",_ne="[object Number]",Sne="[object Boolean]",zO="[object Arguments]",Tne="[object Symbol]",Nne="[object Date]",One="[object Map]",xne="[object Set]",Rne="[object Array]",Pne="[object Function]",kne="[object ArrayBuffer]",s1="[object Object]",Dne="[object Error]",Une="[object DataView]",$ne="[object Uint8Array]",Mne="[object Uint8ClampedArray]",Lne="[object Uint16Array]",Bne="[object Uint32Array]",Fne="[object BigUint64Array]",jne="[object Int8Array]",Hne="[object Int16Array]",Vne="[object Int32Array]",qne="[object BigInt64Array]",zne="[object Float32Array]",Wne="[object Float64Array]";function Gne(){}function WO(n){if(!n||typeof n!="object")return!1;const e=Object.getPrototypeOf(n);return e===null||e===Object.prototype||Object.getPrototypeOf(e)===null?Object.prototype.toString.call(n)==="[object Object]":!1}function Kne(n,e,t){return Rp(n,e,void 0,void 0,void 0,void 0,t)}function Rp(n,e,t,r,s,i,o){const a=o(n,e,t,r,s,i);if(a!==void 0)return a;if(typeof n==typeof e)switch(typeof n){case"bigint":case"string":case"boolean":case"symbol":case"undefined":return n===e;case"number":return n===e||Object.is(n,e);case"function":return n===e;case"object":return eg(n,e,i,o)}return eg(n,e,i,o)}function eg(n,e,t,r){if(Object.is(n,e))return!0;let s=qO(n),i=qO(e);if(s===zO&&(s=s1),i===zO&&(i=s1),s!==i)return!1;switch(s){case Ine:return n.toString()===e.toString();case _ne:{const c=n.valueOf(),l=e.valueOf();return Ane(c,l)}case Sne:case Nne:case Tne:return Object.is(n.valueOf(),e.valueOf());case Cne:return n.source===e.source&&n.flags===e.flags;case Pne:return n===e}t=t??new Map;const o=t.get(n),a=t.get(e);if(o!=null&&a!=null)return o===e;t.set(n,e),t.set(e,n);try{switch(s){case One:{if(n.size!==e.size)return!1;for(const[c,l]of n.entries())if(!e.has(c)||!Rp(l,e.get(c),c,n,e,t,r))return!1;return!0}case xne:{if(n.size!==e.size)return!1;const c=Array.from(n.values()),l=Array.from(e.values());for(let u=0;u<c.length;u++){const h=c[u],d=l.findIndex(f=>Rp(h,f,void 0,n,e,t,r));if(d===-1)return!1;l.splice(d,1)}return!0}case Rne:case $ne:case Mne:case Lne:case Bne:case Fne:case jne:case Hne:case Vne:case qne:case zne:case Wne:{if(typeof Buffer<"u"&&Buffer.isBuffer(n)!==Buffer.isBuffer(e)||n.length!==e.length)return!1;for(let c=0;c<n.length;c++)if(!Rp(n[c],e[c],c,n,e,t,r))return!1;return!0}case kne:return n.byteLength!==e.byteLength?!1:eg(new Uint8Array(n),new Uint8Array(e),t,r);case Une:return n.byteLength!==e.byteLength||n.byteOffset!==e.byteOffset?!1:eg(new Uint8Array(n),new Uint8Array(e),t,r);case Dne:return n.name===e.name&&n.message===e.message;case s1:{if(!(eg(n.constructor,e.constructor,t,r)||WO(n)&&WO(e)))return!1;const c=[...Object.keys(n),...VO(n)],l=[...Object.keys(e),...VO(e)];if(c.length!==l.length)return!1;for(let u=0;u<c.length;u++){const h=c[u],d=n[h];if(!Object.hasOwn(e,h))return!1;const f=e[h];if(!Rp(d,f,h,n,e,t,r))return!1}return!0}default:return!1}}finally{t.delete(n),t.delete(e)}}function Yne(n,e){return Kne(n,e,Gne)}var Qne=Object.defineProperty,GO=Object.getOwnPropertySymbols,Zne=Object.prototype.hasOwnProperty,Jne=Object.prototype.propertyIsEnumerable,aC=(n,e,t)=>e in n?Qne(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,KO=(n,e)=>{for(var t in e||(e={}))Zne.call(e,t)&&aC(n,t,e[t]);if(GO)for(var t of GO(e))Jne.call(e,t)&&aC(n,t,e[t]);return n},Wr=(n,e,t)=>aC(n,typeof e!="symbol"?e+"":e,t);let Hu=class extends VH{constructor(e,t,r,s=Co,i=void 0){super(e,t,r,s),this.core=e,this.logger=t,this.name=r,Wr(this,"map",new Map),Wr(this,"version",XX),Wr(this,"cached",[]),Wr(this,"initialized",!1),Wr(this,"getKey"),Wr(this,"storagePrefix",Co),Wr(this,"recentlyDeleted",[]),Wr(this,"recentlyDeletedLimit",200),Wr(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(o=>{this.getKey&&o!==null&&!Nn(o)?this.map.set(this.getKey(o),o):gJ(o)?this.map.set(o.id,o):mJ(o)&&this.map.set(o.topic,o)}),this.cached=[],this.initialized=!0)}),Wr(this,"set",async(o,a)=>{this.isInitialized(),this.map.has(o)?await this.update(o,a):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:o,value:a}),this.map.set(o,a),await this.persist())}),Wr(this,"get",o=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:o}),this.getData(o))),Wr(this,"getAll",o=>(this.isInitialized(),o?this.values.filter(a=>Object.keys(o).every(c=>Yne(a[c],o[c]))):this.values)),Wr(this,"update",async(o,a)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:o,update:a});const c=KO(KO({},this.getData(o)),a);this.map.set(o,c),await this.persist()}),Wr(this,"delete",async(o,a)=>{this.isInitialized(),this.map.has(o)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:o,reason:a}),this.map.delete(o),this.addToRecentlyDeleted(o),await this.persist())}),this.logger=vr(t,this.name),this.storagePrefix=s,this.getKey=i}get context(){return hs(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}addToRecentlyDeleted(e){this.recentlyDeleted.push(e),this.recentlyDeleted.length>=this.recentlyDeletedLimit&&this.recentlyDeleted.splice(0,this.recentlyDeletedLimit/2)}async setDataStore(e){await this.core.storage.setItem(this.storageKey,e)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(e){const t=this.map.get(e);if(!t){if(this.recentlyDeleted.includes(e)){const{message:s}=re("MISSING_OR_INVALID",`Record was recently deleted - ${this.name}: ${e}`);throw this.logger.error(s),new Error(s)}const{message:r}=re("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(r),new Error(r)}return t}async persist(){await this.setDataStore(this.values)}async restore(){try{const e=await this.getDataStore();if(typeof e>"u"||!e.length)return;if(this.map.size){const{message:t}=re("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(e){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(e)}}isInitialized(){if(!this.initialized){const{message:e}=re("NOT_INITIALIZED",this.name);throw new Error(e)}}};var Xne=Object.defineProperty,ere=(n,e,t)=>e in n?Xne(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Xe=(n,e,t)=>ere(n,typeof e!="symbol"?e+"":e,t);let tre=class{constructor(e,t){this.core=e,this.logger=t,Xe(this,"name",ree),Xe(this,"version",see),Xe(this,"events",new t_),Xe(this,"pairings"),Xe(this,"initialized",!1),Xe(this,"storagePrefix",Co),Xe(this,"ignoredPayloadTypes",[la]),Xe(this,"registeredMethods",[]),Xe(this,"init",async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))}),Xe(this,"register",({methods:r})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...r])]}),Xe(this,"create",async r=>{this.isInitialized();const s=YA(),i=await this.core.crypto.setSymKey(s),o=bn(ne.FIVE_MINUTES),a={protocol:U$},c={topic:i,expiry:o,relay:a,active:!1,methods:r==null?void 0:r.methods},l=dO({protocol:this.core.protocol,version:this.core.version,topic:i,symKey:s,relay:a,expiryTimestamp:o,methods:r==null?void 0:r.methods});return this.events.emit(pl.create,c),this.core.expirer.set(i,o),await this.pairings.set(i,c),await this.core.relayer.subscribe(i,{transportType:r==null?void 0:r.transportType,internal:r==null?void 0:r.internal}),{topic:i,uri:l}}),Xe(this,"pair",async r=>{this.isInitialized();const s=this.core.eventClient.createEvent({properties:{topic:r==null?void 0:r.uri,trace:[Gi.pairing_started]}});this.isValidPair(r,s);const{topic:i,symKey:o,relay:a,expiryTimestamp:c,methods:l}=hO(r.uri);s.props.properties.topic=i,s.addTrace(Gi.pairing_uri_validation_success),s.addTrace(Gi.pairing_uri_not_expired);let u;if(this.pairings.keys.includes(i)){if(u=this.pairings.get(i),s.addTrace(Gi.existing_pairing),u.active)throw s.setError(Lo.active_pairing_already_exists),new Error(`Pairing already exists: ${i}. Please try again with a new connection URI.`);s.addTrace(Gi.pairing_not_expired)}const h=c||bn(ne.FIVE_MINUTES),d={topic:i,relay:a,expiry:h,active:!1,methods:l};this.core.expirer.set(i,h),await this.pairings.set(i,d),s.addTrace(Gi.store_new_pairing),r.activatePairing&&await this.activate({topic:i}),this.events.emit(pl.create,d),s.addTrace(Gi.emit_inactive_pairing),this.core.crypto.keychain.has(i)||await this.core.crypto.setSymKey(o,i),s.addTrace(Gi.subscribing_pairing_topic);try{await this.core.relayer.confirmOnlineStateOrThrow()}catch{s.setError(Lo.no_internet_connection)}try{await this.core.relayer.subscribe(i,{relay:a})}catch(f){throw s.setError(Lo.subscribe_pairing_topic_failure),f}return s.addTrace(Gi.subscribe_pairing_topic_success),d}),Xe(this,"activate",async({topic:r})=>{this.isInitialized();const s=bn(ne.FIVE_MINUTES);this.core.expirer.set(r,s),await this.pairings.update(r,{active:!0,expiry:s})}),Xe(this,"ping",async r=>{this.isInitialized(),await this.isValidPing(r),this.logger.warn("ping() is deprecated and will be removed in the next major release.");const{topic:s}=r;if(this.pairings.keys.includes(s)){const i=await this.sendRequest(s,"wc_pairingPing",{}),{done:o,resolve:a,reject:c}=ll();this.events.once(At("pairing_ping",i),({error:l})=>{l?c(l):a()}),await o()}}),Xe(this,"updateExpiry",async({topic:r,expiry:s})=>{this.isInitialized(),await this.pairings.update(r,{expiry:s})}),Xe(this,"updateMetadata",async({topic:r,metadata:s})=>{this.isInitialized(),await this.pairings.update(r,{peerMetadata:s})}),Xe(this,"getPairings",()=>(this.isInitialized(),this.pairings.values)),Xe(this,"disconnect",async r=>{this.isInitialized(),await this.isValidDisconnect(r);const{topic:s}=r;this.pairings.keys.includes(s)&&(await this.sendRequest(s,"wc_pairingDelete",zt("USER_DISCONNECTED")),await this.deletePairing(s))}),Xe(this,"formatUriFromPairing",r=>{this.isInitialized();const{topic:s,relay:i,expiry:o,methods:a}=r,c=this.core.crypto.keychain.get(s);return dO({protocol:this.core.protocol,version:this.core.version,topic:s,symKey:c,relay:i,expiryTimestamp:o,methods:a})}),Xe(this,"sendRequest",async(r,s,i)=>{const o=io(s,i),a=await this.core.crypto.encode(r,o),c=pp[s].req;return this.core.history.set(r,o),this.core.relayer.publish(r,a,c),o.id}),Xe(this,"sendResult",async(r,s,i)=>{const o=Wg(r,i),a=await this.core.crypto.encode(s,o),c=(await this.core.history.get(s,r)).request.method,l=pp[c].res;await this.core.relayer.publish(s,a,l),await this.core.history.resolve(o)}),Xe(this,"sendError",async(r,s,i)=>{const o=oE(r,i),a=await this.core.crypto.encode(s,o),c=(await this.core.history.get(s,r)).request.method,l=pp[c]?pp[c].res:pp.unregistered_method.res;await this.core.relayer.publish(s,a,l),await this.core.history.resolve(o)}),Xe(this,"deletePairing",async(r,s)=>{await this.core.relayer.unsubscribe(r),await Promise.all([this.pairings.delete(r,zt("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(r),s?Promise.resolve():this.core.expirer.del(r)])}),Xe(this,"cleanup",async()=>{const r=this.pairings.getAll().filter(s=>Qa(s.expiry));await Promise.all(r.map(s=>this.deletePairing(s.topic)))}),Xe(this,"onRelayEventRequest",async r=>{const{topic:s,payload:i}=r;switch(i.method){case"wc_pairingPing":return await this.onPairingPingRequest(s,i);case"wc_pairingDelete":return await this.onPairingDeleteRequest(s,i);default:return await this.onUnknownRpcMethodRequest(s,i)}}),Xe(this,"onRelayEventResponse",async r=>{const{topic:s,payload:i}=r,o=(await this.core.history.get(s,i.id)).request.method;switch(o){case"wc_pairingPing":return this.onPairingPingResponse(s,i);default:return this.onUnknownRpcMethodResponse(o)}}),Xe(this,"onPairingPingRequest",async(r,s)=>{const{id:i}=s;try{this.isValidPing({topic:r}),await this.sendResult(i,r,!0),this.events.emit(pl.ping,{id:i,topic:r})}catch(o){await this.sendError(i,r,o),this.logger.error(o)}}),Xe(this,"onPairingPingResponse",(r,s)=>{const{id:i}=s;setTimeout(()=>{Yi(s)?this.events.emit(At("pairing_ping",i),{}):Ks(s)&&this.events.emit(At("pairing_ping",i),{error:s.error})},500)}),Xe(this,"onPairingDeleteRequest",async(r,s)=>{const{id:i}=s;try{this.isValidDisconnect({topic:r}),await this.deletePairing(r),this.events.emit(pl.delete,{id:i,topic:r})}catch(o){await this.sendError(i,r,o),this.logger.error(o)}}),Xe(this,"onUnknownRpcMethodRequest",async(r,s)=>{const{id:i,method:o}=s;try{if(this.registeredMethods.includes(o))return;const a=zt("WC_METHOD_UNSUPPORTED",o);await this.sendError(i,r,a),this.logger.error(a)}catch(a){await this.sendError(i,r,a),this.logger.error(a)}}),Xe(this,"onUnknownRpcMethodResponse",r=>{this.registeredMethods.includes(r)||this.logger.error(zt("WC_METHOD_UNSUPPORTED",r))}),Xe(this,"isValidPair",(r,s)=>{var i;if(!Yr(r)){const{message:a}=re("MISSING_OR_INVALID",`pair() params: ${r}`);throw s.setError(Lo.malformed_pairing_uri),new Error(a)}if(!pJ(r.uri)){const{message:a}=re("MISSING_OR_INVALID",`pair() uri: ${r.uri}`);throw s.setError(Lo.malformed_pairing_uri),new Error(a)}const o=hO(r==null?void 0:r.uri);if(!((i=o==null?void 0:o.relay)!=null&&i.protocol)){const{message:a}=re("MISSING_OR_INVALID","pair() uri#relay-protocol");throw s.setError(Lo.malformed_pairing_uri),new Error(a)}if(!(o!=null&&o.symKey)){const{message:a}=re("MISSING_OR_INVALID","pair() uri#symKey");throw s.setError(Lo.malformed_pairing_uri),new Error(a)}if(o!=null&&o.expiryTimestamp&&ne.toMiliseconds(o==null?void 0:o.expiryTimestamp)<Date.now()){s.setError(Lo.pairing_expired);const{message:a}=re("EXPIRED","pair() URI has expired. Please try again with a new connection URI.");throw new Error(a)}}),Xe(this,"isValidPing",async r=>{if(!Yr(r)){const{message:i}=re("MISSING_OR_INVALID",`ping() params: ${r}`);throw new Error(i)}const{topic:s}=r;await this.isValidPairingTopic(s)}),Xe(this,"isValidDisconnect",async r=>{if(!Yr(r)){const{message:i}=re("MISSING_OR_INVALID",`disconnect() params: ${r}`);throw new Error(i)}const{topic:s}=r;await this.isValidPairingTopic(s)}),Xe(this,"isValidPairingTopic",async r=>{if(!fn(r,!1)){const{message:s}=re("MISSING_OR_INVALID",`pairing topic should be a string: ${r}`);throw new Error(s)}if(!this.pairings.keys.includes(r)){const{message:s}=re("NO_MATCHING_KEY",`pairing topic doesn't exist: ${r}`);throw new Error(s)}if(Qa(this.pairings.get(r).expiry)){await this.deletePairing(r);const{message:s}=re("EXPIRED",`pairing topic: ${r}`);throw new Error(s)}}),this.core=e,this.logger=vr(t,this.name),this.pairings=new Hu(this.core,this.logger,this.name,this.storagePrefix)}get context(){return hs(this.logger)}isInitialized(){if(!this.initialized){const{message:e}=re("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.core.relayer.on(en.message,async e=>{const{topic:t,message:r,transportType:s}=e;if(this.pairings.keys.includes(t)&&s!==Lt.link_mode&&!this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(r)))try{const i=await this.core.crypto.decode(t,r);k_(i)?(this.core.history.set(t,i),await this.onRelayEventRequest({topic:t,payload:i})):aE(i)&&(await this.core.history.resolve(i),await this.onRelayEventResponse({topic:t,payload:i}),this.core.history.delete(t,i.id)),await this.core.relayer.messages.ack(t,r)}catch(i){this.logger.error(i)}})}registerExpirerEvents(){this.core.expirer.on(Fs.expired,async e=>{const{topic:t}=kU(e.target);t&&this.pairings.keys.includes(t)&&(await this.deletePairing(t,!0),this.events.emit(pl.expire,{topic:t}))})}};var nre=Object.defineProperty,rre=(n,e,t)=>e in n?nre(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Ln=(n,e,t)=>rre(n,typeof e!="symbol"?e+"":e,t);let sre=class extends BH{constructor(e,t){super(e,t),this.core=e,this.logger=t,Ln(this,"records",new Map),Ln(this,"events",new ii.EventEmitter),Ln(this,"name",iee),Ln(this,"version",oee),Ln(this,"cached",[]),Ln(this,"initialized",!1),Ln(this,"storagePrefix",Co),Ln(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(r=>this.records.set(r.id,r)),this.cached=[],this.registerEventListeners(),this.initialized=!0)}),Ln(this,"set",(r,s,i)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:r,request:s,chainId:i}),this.records.has(s.id))return;const o={id:s.id,topic:r,request:{method:s.method,params:s.params||null},chainId:i,expiry:bn(ne.THIRTY_DAYS)};this.records.set(o.id,o),this.persist(),this.events.emit(hi.created,o)}),Ln(this,"resolve",async r=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:r}),!this.records.has(r.id))return;const s=await this.getRecord(r.id);typeof s.response>"u"&&(s.response=Ks(r)?{error:r.error}:{result:r.result},this.records.set(s.id,s),this.persist(),this.events.emit(hi.updated,s))}),Ln(this,"get",async(r,s)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:r,id:s}),await this.getRecord(s))),Ln(this,"delete",(r,s)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:s}),this.values.forEach(i=>{if(i.topic===r){if(typeof s<"u"&&i.id!==s)return;this.records.delete(i.id),this.events.emit(hi.deleted,i)}}),this.persist()}),Ln(this,"exists",async(r,s)=>(this.isInitialized(),this.records.has(s)?(await this.getRecord(s)).topic===r:!1)),Ln(this,"on",(r,s)=>{this.events.on(r,s)}),Ln(this,"once",(r,s)=>{this.events.once(r,s)}),Ln(this,"off",(r,s)=>{this.events.off(r,s)}),Ln(this,"removeListener",(r,s)=>{this.events.removeListener(r,s)}),this.logger=vr(t,this.name)}get context(){return hs(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const e=[];return this.values.forEach(t=>{if(typeof t.response<"u")return;const r={topic:t.topic,request:io(t.request.method,t.request.params,t.id),chainId:t.chainId};return e.push(r)}),e}async setJsonRpcRecords(e){await this.core.storage.setItem(this.storageKey,e)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(e){this.isInitialized();const t=this.records.get(e);if(!t){const{message:r}=re("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(r)}return t}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(hi.sync)}async restore(){try{const e=await this.getJsonRpcRecords();if(typeof e>"u"||!e.length)return;if(this.records.size){const{message:t}=re("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(e){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(e)}}registerEventListeners(){this.events.on(hi.created,e=>{const t=hi.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e})}),this.events.on(hi.updated,e=>{const t=hi.updated;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e})}),this.events.on(hi.deleted,e=>{const t=hi.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e})}),this.core.heartbeat.on(Bu.pulse,()=>{this.cleanup()})}cleanup(){try{this.isInitialized();let e=!1;this.records.forEach(t=>{ne.toMiliseconds(t.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${t.id}`),this.records.delete(t.id),this.events.emit(hi.deleted,t,!1),e=!0)}),e&&this.persist()}catch(e){this.logger.warn(e)}}isInitialized(){if(!this.initialized){const{message:e}=re("NOT_INITIALIZED",this.name);throw new Error(e)}}};var ire=Object.defineProperty,ore=(n,e,t)=>e in n?ire(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,rr=(n,e,t)=>ore(n,typeof e!="symbol"?e+"":e,t);class are extends zH{constructor(e,t){super(e,t),this.core=e,this.logger=t,rr(this,"expirations",new Map),rr(this,"events",new ii.EventEmitter),rr(this,"name",aee),rr(this,"version",cee),rr(this,"cached",[]),rr(this,"initialized",!1),rr(this,"storagePrefix",Co),rr(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(r=>this.expirations.set(r.target,r)),this.cached=[],this.registerEventListeners(),this.initialized=!0)}),rr(this,"has",r=>{try{const s=this.formatTarget(r);return typeof this.getExpiration(s)<"u"}catch{return!1}}),rr(this,"set",(r,s)=>{this.isInitialized();const i=this.formatTarget(r),o={target:i,expiry:s};this.expirations.set(i,o),this.checkExpiry(i,o),this.events.emit(Fs.created,{target:i,expiration:o})}),rr(this,"get",r=>{this.isInitialized();const s=this.formatTarget(r);return this.getExpiration(s)}),rr(this,"del",r=>{if(this.isInitialized(),this.has(r)){const s=this.formatTarget(r),i=this.getExpiration(s);this.expirations.delete(s),this.events.emit(Fs.deleted,{target:s,expiration:i})}}),rr(this,"on",(r,s)=>{this.events.on(r,s)}),rr(this,"once",(r,s)=>{this.events.once(r,s)}),rr(this,"off",(r,s)=>{this.events.off(r,s)}),rr(this,"removeListener",(r,s)=>{this.events.removeListener(r,s)}),this.logger=vr(t,this.name)}get context(){return hs(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(e){if(typeof e=="string")return ZK(e);if(typeof e=="number")return JK(e);const{message:t}=re("UNKNOWN_TYPE",`Target type: ${typeof e}`);throw new Error(t)}async setExpirations(e){await this.core.storage.setItem(this.storageKey,e)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(Fs.sync)}async restore(){try{const e=await this.getExpirations();if(typeof e>"u"||!e.length)return;if(this.expirations.size){const{message:t}=re("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(e){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(e)}}getExpiration(e){const t=this.expirations.get(e);if(!t){const{message:r}=re("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.warn(r),new Error(r)}return t}checkExpiry(e,t){const{expiry:r}=t;ne.toMiliseconds(r)-Date.now()<=0&&this.expire(e,t)}expire(e,t){this.expirations.delete(e),this.events.emit(Fs.expired,{target:e,expiration:t})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((e,t)=>this.checkExpiry(t,e))}registerEventListeners(){this.core.heartbeat.on(Bu.pulse,()=>this.checkExpirations()),this.events.on(Fs.created,e=>{const t=Fs.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()}),this.events.on(Fs.expired,e=>{const t=Fs.expired;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()}),this.events.on(Fs.deleted,e=>{const t=Fs.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=re("NOT_INITIALIZED",this.name);throw new Error(e)}}}var cre=Object.defineProperty,lre=(n,e,t)=>e in n?cre(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,cn=(n,e,t)=>lre(n,typeof e!="symbol"?e+"":e,t);let ure=class extends WH{constructor(e,t,r){super(e,t,r),this.core=e,this.logger=t,this.store=r,cn(this,"name",lee),cn(this,"abortController"),cn(this,"isDevEnv"),cn(this,"verifyUrlV3",hee),cn(this,"storagePrefix",Co),cn(this,"version",D$),cn(this,"publicKey"),cn(this,"fetchPromise"),cn(this,"init",async()=>{var s;this.isDevEnv||(this.publicKey=await this.store.getItem(this.storeKey),this.publicKey&&ne.toMiliseconds((s=this.publicKey)==null?void 0:s.expiresAt)<Date.now()&&(this.logger.debug("verify v2 public key expired"),await this.removePublicKey()))}),cn(this,"register",async s=>{if(!Mf()||this.isDevEnv)return;const i=window.location.origin,{id:o,decryptedId:a}=s,c=`${this.verifyUrlV3}/attestation?projectId=${this.core.projectId}&origin=${i}&id=${o}&decryptedId=${a}`;try{const l=pu(),u=this.startAbortTimer(ne.ONE_SECOND*5),h=await new Promise((d,f)=>{const p=()=>{window.removeEventListener("message",m),l.body.removeChild(g),f("attestation aborted")};this.abortController.signal.addEventListener("abort",p);const g=l.createElement("iframe");g.src=c,g.style.display="none",g.addEventListener("error",p,{signal:this.abortController.signal});const m=w=>{if(w.data&&typeof w.data=="string")try{const v=JSON.parse(w.data);if(v.type==="verify_attestation"){if(xA(v.attestation).payload.id!==o)return;clearInterval(u),l.body.removeChild(g),this.abortController.signal.removeEventListener("abort",p),window.removeEventListener("message",m),d(v.attestation===null?"":v.attestation)}}catch(v){this.logger.warn(v)}};l.body.appendChild(g),window.addEventListener("message",m,{signal:this.abortController.signal})});return this.logger.debug("jwt attestation",h),h}catch(l){this.logger.warn(l)}return""}),cn(this,"resolve",async s=>{if(this.isDevEnv)return"";const{attestationId:i,hash:o,encryptedId:a}=s;if(i===""){this.logger.debug("resolve: attestationId is empty, skipping");return}if(i){if(xA(i).payload.id!==a)return;const l=await this.isValidJwtAttestation(i);if(l){if(!l.isVerified){this.logger.warn("resolve: jwt attestation: origin url not verified");return}return l}}if(!o)return;const c=this.getVerifyUrl(s==null?void 0:s.verifyUrl);return this.fetchAttestation(o,c)}),cn(this,"fetchAttestation",async(s,i)=>{this.logger.debug(`resolving attestation: ${s} from url: ${i}`);const o=this.startAbortTimer(ne.ONE_SECOND*5),a=await fetch(`${i}/attestation/${s}?v2Supported=true`,{signal:this.abortController.signal});return clearTimeout(o),a.status===200?await a.json():void 0}),cn(this,"getVerifyUrl",s=>{let i=s||Xp;return dee.includes(i)||(this.logger.info(`verify url: ${i}, not included in trusted list, assigning default: ${Xp}`),i=Xp),i}),cn(this,"fetchPublicKey",async()=>{try{this.logger.debug(`fetching public key from: ${this.verifyUrlV3}`);const s=this.startAbortTimer(ne.FIVE_SECONDS),i=await fetch(`${this.verifyUrlV3}/public-key`,{signal:this.abortController.signal});return clearTimeout(s),await i.json()}catch(s){this.logger.warn(s)}}),cn(this,"persistPublicKey",async s=>{this.logger.debug("persisting public key to local storage",s),await this.store.setItem(this.storeKey,s),this.publicKey=s}),cn(this,"removePublicKey",async()=>{this.logger.debug("removing verify v2 public key from storage"),await this.store.removeItem(this.storeKey),this.publicKey=void 0}),cn(this,"isValidJwtAttestation",async s=>{const i=await this.getPublicKey();try{if(i)return this.validateAttestation(s,i)}catch(a){this.logger.error(a),this.logger.warn("error validating attestation")}const o=await this.fetchAndPersistPublicKey();try{if(o)return this.validateAttestation(s,o)}catch(a){this.logger.error(a),this.logger.warn("error validating attestation")}}),cn(this,"getPublicKey",async()=>this.publicKey?this.publicKey:await this.fetchAndPersistPublicKey()),cn(this,"fetchAndPersistPublicKey",async()=>{if(this.fetchPromise)return await this.fetchPromise,this.publicKey;this.fetchPromise=new Promise(async i=>{const o=await this.fetchPublicKey();o&&(await this.persistPublicKey(o),i(o))});const s=await this.fetchPromise;return this.fetchPromise=void 0,s}),cn(this,"validateAttestation",(s,i)=>{const o=GZ(s,i.publicKey),a={hasExpired:ne.toMiliseconds(o.exp)<Date.now(),payload:o};if(a.hasExpired)throw this.logger.warn("resolve: jwt attestation expired"),new Error("JWT attestation expired");return{origin:a.payload.origin,isScam:a.payload.isScam,isVerified:a.payload.isVerified}}),this.logger=vr(t,this.name),this.abortController=new AbortController,this.isDevEnv=w_(),this.init()}get storeKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//verify:public:key"}get context(){return hs(this.logger)}startAbortTimer(e){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),ne.toMiliseconds(e))}};var hre=Object.defineProperty,dre=(n,e,t)=>e in n?hre(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,YO=(n,e,t)=>dre(n,typeof e!="symbol"?e+"":e,t);let fre=class extends GH{constructor(e,t){super(e,t),this.projectId=e,this.logger=t,YO(this,"context",fee),YO(this,"registerDeviceToken",async r=>{const{clientId:s,token:i,notificationType:o,enableEncrypted:a=!1}=r,c=`${pee}/${this.projectId}/clients`;await fetch(c,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_id:s,type:o,token:i,always_raw:a})})}),this.logger=vr(t,this.context)}};var pre=Object.defineProperty,QO=Object.getOwnPropertySymbols,gre=Object.prototype.hasOwnProperty,mre=Object.prototype.propertyIsEnumerable,cC=(n,e,t)=>e in n?pre(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,wp=(n,e)=>{for(var t in e||(e={}))gre.call(e,t)&&cC(n,t,e[t]);if(QO)for(var t of QO(e))mre.call(e,t)&&cC(n,t,e[t]);return n},Cn=(n,e,t)=>cC(n,typeof e!="symbol"?e+"":e,t);let yre=class extends KH{constructor(e,t,r=!0){super(e,t,r),this.core=e,this.logger=t,Cn(this,"context",mee),Cn(this,"storagePrefix",Co),Cn(this,"storageVersion",gee),Cn(this,"events",new Map),Cn(this,"shouldPersist",!1),Cn(this,"init",async()=>{if(!w_())try{const s={eventId:k2(),timestamp:Date.now(),domain:this.getAppDomain(),props:{event:"INIT",type:"",properties:{client_id:await this.core.crypto.getClientId(),user_agent:RU(this.core.relayer.protocol,this.core.relayer.version,eC)}}};await this.sendEvent([s])}catch(s){this.logger.warn(s)}}),Cn(this,"createEvent",s=>{const{event:i="ERROR",type:o="",properties:{topic:a,trace:c}}=s,l=k2(),u=this.core.projectId||"",h=Date.now(),d=wp({eventId:l,timestamp:h,props:{event:i,type:o,properties:{topic:a,trace:c}},bundleId:u,domain:this.getAppDomain()},this.setMethods(l));return this.telemetryEnabled&&(this.events.set(l,d),this.shouldPersist=!0),d}),Cn(this,"getEvent",s=>{const{eventId:i,topic:o}=s;if(i)return this.events.get(i);const a=Array.from(this.events.values()).find(c=>c.props.properties.topic===o);if(a)return wp(wp({},a),this.setMethods(a.eventId))}),Cn(this,"deleteEvent",s=>{const{eventId:i}=s;this.events.delete(i),this.shouldPersist=!0}),Cn(this,"setEventListeners",()=>{this.core.heartbeat.on(Bu.pulse,async()=>{this.shouldPersist&&await this.persist(),this.events.forEach(s=>{ne.fromMiliseconds(Date.now())-ne.fromMiliseconds(s.timestamp)>yee&&(this.events.delete(s.eventId),this.shouldPersist=!0)})})}),Cn(this,"setMethods",s=>({addTrace:i=>this.addTrace(s,i),setError:i=>this.setError(s,i)})),Cn(this,"addTrace",(s,i)=>{const o=this.events.get(s);o&&(o.props.properties.trace.push(i),this.events.set(s,o),this.shouldPersist=!0)}),Cn(this,"setError",(s,i)=>{const o=this.events.get(s);o&&(o.props.type=i,o.timestamp=Date.now(),this.events.set(s,o),this.shouldPersist=!0)}),Cn(this,"persist",async()=>{await this.core.storage.setItem(this.storageKey,Array.from(this.events.values())),this.shouldPersist=!1}),Cn(this,"restore",async()=>{try{const s=await this.core.storage.getItem(this.storageKey)||[];if(!s.length)return;s.forEach(i=>{this.events.set(i.eventId,wp(wp({},i),this.setMethods(i.eventId)))})}catch(s){this.logger.warn(s)}}),Cn(this,"submit",async()=>{if(!this.telemetryEnabled||this.events.size===0)return;const s=[];for(const[i,o]of this.events)o.props.type&&s.push(o);if(s.length!==0)try{if((await this.sendEvent(s)).ok)for(const i of s)this.events.delete(i.eventId),this.shouldPersist=!0}catch(i){this.logger.warn(i)}}),Cn(this,"sendEvent",async s=>{const i=this.getAppDomain()?"":"&sp=desktop";return await fetch(`${wee}?projectId=${this.core.projectId}&st=events_sdk&sv=js-${eC}${i}`,{method:"POST",body:JSON.stringify(s)})}),Cn(this,"getAppDomain",()=>xU().url),this.logger=vr(t,this.context),this.telemetryEnabled=r,r?this.restore().then(async()=>{await this.submit(),this.setEventListeners()}):this.persist()}get storageKey(){return this.storagePrefix+this.storageVersion+this.core.customStoragePrefix+"//"+this.context}};var wre=Object.defineProperty,ZO=Object.getOwnPropertySymbols,bre=Object.prototype.hasOwnProperty,Ere=Object.prototype.propertyIsEnumerable,lC=(n,e,t)=>e in n?wre(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,JO=(n,e)=>{for(var t in e||(e={}))bre.call(e,t)&&lC(n,t,e[t]);if(ZO)for(var t of ZO(e))Ere.call(e,t)&&lC(n,t,e[t]);return n},$t=(n,e,t)=>lC(n,typeof e!="symbol"?e+"":e,t);let vre=class Y$ extends UH{constructor(e){var t;super(e),$t(this,"protocol",k$),$t(this,"version",D$),$t(this,"name",F0),$t(this,"relayUrl"),$t(this,"projectId"),$t(this,"customStoragePrefix"),$t(this,"events",new ii.EventEmitter),$t(this,"logger"),$t(this,"heartbeat"),$t(this,"relayer"),$t(this,"crypto"),$t(this,"storage"),$t(this,"history"),$t(this,"expirer"),$t(this,"pairing"),$t(this,"verify"),$t(this,"echoClient"),$t(this,"linkModeSupportedApps"),$t(this,"eventClient"),$t(this,"initialized",!1),$t(this,"logChunkController"),$t(this,"on",(a,c)=>this.events.on(a,c)),$t(this,"once",(a,c)=>this.events.once(a,c)),$t(this,"off",(a,c)=>this.events.off(a,c)),$t(this,"removeListener",(a,c)=>this.events.removeListener(a,c)),$t(this,"dispatchEnvelope",({topic:a,message:c,sessionExists:l})=>{if(!a||!c)return;const u={topic:a,message:c,publishedAt:Date.now(),transportType:Lt.link_mode};this.relayer.onLinkMessageEvent(u,{sessionExists:l})});const r=this.getGlobalCore(e==null?void 0:e.customStoragePrefix);if(r)try{return this.customStoragePrefix=r.customStoragePrefix,this.logger=r.logger,this.heartbeat=r.heartbeat,this.crypto=r.crypto,this.history=r.history,this.expirer=r.expirer,this.storage=r.storage,this.relayer=r.relayer,this.pairing=r.pairing,this.verify=r.verify,this.echoClient=r.echoClient,this.linkModeSupportedApps=r.linkModeSupportedApps,this.eventClient=r.eventClient,this.initialized=r.initialized,this.logChunkController=r.logChunkController,r}catch(a){console.warn("Failed to copy global core",a)}this.projectId=e==null?void 0:e.projectId,this.relayUrl=(e==null?void 0:e.relayUrl)||$$,this.customStoragePrefix=e!=null&&e.customStoragePrefix?`:${e.customStoragePrefix}`:"";const s=Rf({level:typeof(e==null?void 0:e.logger)=="string"&&e.logger?e.logger:BX.logger,name:F0}),{logger:i,chunkLoggerController:o}=r_({opts:s,maxSizeInBytes:e==null?void 0:e.maxLogBlobSizeInBytes,loggerOverride:e==null?void 0:e.logger});this.logChunkController=o,(t=this.logChunkController)!=null&&t.downloadLogsBlobInBrowser&&(window.downloadLogsBlobInBrowser=async()=>{var a,c;(a=this.logChunkController)!=null&&a.downloadLogsBlobInBrowser&&((c=this.logChunkController)==null||c.downloadLogsBlobInBrowser({clientId:await this.crypto.getClientId()}))}),this.logger=vr(i,this.name),this.heartbeat=new Nj,this.crypto=new Kte(this,this.logger,e==null?void 0:e.keychain),this.history=new sre(this,this.logger),this.expirer=new are(this,this.logger),this.storage=e!=null&&e.storage?e.storage:new iH(JO(JO({},FX),e==null?void 0:e.storageOptions)),this.relayer=new vne({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new tre(this,this.logger),this.verify=new ure(this,this.logger,this.storage),this.echoClient=new fre(this.projectId||"",this.logger),this.linkModeSupportedApps=[],this.eventClient=new yre(this,this.logger,e==null?void 0:e.telemetryEnabled),this.setGlobalCore(this)}static async init(e){const t=new Y$(e);await t.initialize();const r=await t.crypto.getClientId();return await t.storage.setItem(eee,r),t}get context(){return hs(this.logger)}async start(){this.initialized||await this.initialize()}async getLogsBlob(){var e;return(e=this.logChunkController)==null?void 0:e.logsToBlob({clientId:await this.crypto.getClientId()})}async addLinkModeSupportedApp(e){this.linkModeSupportedApps.includes(e)||(this.linkModeSupportedApps.push(e),await this.storage.setItem(xO,this.linkModeSupportedApps))}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.linkModeSupportedApps=await this.storage.getItem(xO)||[],this.initialized=!0,this.logger.info("Core Initialization Success")}catch(e){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,e),this.logger.error(e.message),e}}getGlobalCore(e=""){try{if(this.isGlobalCoreDisabled())return;const t=`_walletConnectCore_${e}`,r=`${t}_count`;return globalThis[r]=(globalThis[r]||0)+1,globalThis[r]>1&&console.warn(`WalletConnect Core is already initialized. This is probably a mistake and can lead to unexpected behavior. Init() was called ${globalThis[r]} times.`),globalThis[t]}catch(t){console.warn("Failed to get global WalletConnect core",t);return}}setGlobalCore(e){var t;try{if(this.isGlobalCoreDisabled())return;const r=`_walletConnectCore_${((t=e.opts)==null?void 0:t.customStoragePrefix)||""}`;globalThis[r]=e}catch(r){console.warn("Failed to set global WalletConnect core",r)}}isGlobalCoreDisabled(){try{return typeof process<"u"&&LX.DISABLE_GLOBAL_CORE==="true"}catch{return!0}}};const Are=vre,Q$="wc",Z$=2,J$="client",D_=`${Q$}@${Z$}:${J$}:`,i1={name:J$,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.org"},XO="WALLETCONNECT_DEEPLINK_CHOICE",Cre="proposal",ex="Proposal expired",Ire="session",ah=ne.SEVEN_DAYS,_re="engine",Bn={wc_sessionPropose:{req:{ttl:ne.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:ne.FIVE_MINUTES,prompt:!1,tag:1101},reject:{ttl:ne.FIVE_MINUTES,prompt:!1,tag:1120},autoReject:{ttl:ne.FIVE_MINUTES,prompt:!1,tag:1121}},wc_sessionSettle:{req:{ttl:ne.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:ne.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:ne.ONE_DAY,prompt:!1,tag:1104},res:{ttl:ne.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:ne.ONE_DAY,prompt:!1,tag:1106},res:{ttl:ne.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:ne.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:ne.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:ne.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:ne.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:ne.ONE_DAY,prompt:!1,tag:1112},res:{ttl:ne.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:ne.ONE_DAY,prompt:!1,tag:1114},res:{ttl:ne.ONE_DAY,prompt:!1,tag:1115}},wc_sessionAuthenticate:{req:{ttl:ne.ONE_HOUR,prompt:!0,tag:1116},res:{ttl:ne.ONE_HOUR,prompt:!1,tag:1117},reject:{ttl:ne.FIVE_MINUTES,prompt:!1,tag:1118},autoReject:{ttl:ne.FIVE_MINUTES,prompt:!1,tag:1119}}},o1={min:ne.FIVE_MINUTES,max:ne.SEVEN_DAYS},zi={idle:"IDLE",active:"ACTIVE"},Sre={eth_sendTransaction:{key:""},eth_sendRawTransaction:{key:""},wallet_sendCalls:{key:""},solana_signTransaction:{key:"signature"},solana_signAllTransactions:{key:"transactions"},solana_signAndSendTransaction:{key:"signature"},sui_signAndExecuteTransaction:{key:"digest"},sui_signTransaction:{key:""},hedera_signAndExecuteTransaction:{key:"transactionId"},hedera_executeTransaction:{key:"transactionId"},near_signTransaction:{key:""},near_signTransactions:{key:""},tron_signTransaction:{key:"txID"},xrpl_signTransaction:{key:""},xrpl_signTransactionFor:{key:""},algo_signTxn:{key:""},sendTransfer:{key:"txid"},stacks_stxTransfer:{key:"txId"},polkadot_signTransaction:{key:""},cosmos_signDirect:{key:""}},Tre="request",Nre=["wc_sessionPropose","wc_sessionRequest","wc_authRequest","wc_sessionAuthenticate"],Ore="wc",xre="auth",Rre="authKeys",Pre="pairingTopics",kre="requests",lE=`${Ore}@${1.5}:${xre}:`,e0=`${lE}:PUB_KEY`;var Dre=Object.defineProperty,Ure=Object.defineProperties,$re=Object.getOwnPropertyDescriptors,tx=Object.getOwnPropertySymbols,Mre=Object.prototype.hasOwnProperty,Lre=Object.prototype.propertyIsEnumerable,uC=(n,e,t)=>e in n?Dre(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,_t=(n,e)=>{for(var t in e||(e={}))Mre.call(e,t)&&uC(n,t,e[t]);if(tx)for(var t of tx(e))Lre.call(e,t)&&uC(n,t,e[t]);return n},sr=(n,e)=>Ure(n,$re(e)),Y=(n,e,t)=>uC(n,typeof e!="symbol"?e+"":e,t);let Bre=class extends JH{constructor(e){super(e),Y(this,"name",_re),Y(this,"events",new t_),Y(this,"initialized",!1),Y(this,"requestQueue",{state:zi.idle,queue:[]}),Y(this,"sessionRequestQueue",{state:zi.idle,queue:[]}),Y(this,"emittedSessionRequests",new aY({limit:500})),Y(this,"requestQueueDelay",ne.ONE_SECOND),Y(this,"expectedPairingMethodMap",new Map),Y(this,"recentlyDeletedMap",new Map),Y(this,"recentlyDeletedLimit",200),Y(this,"relayMessageCache",[]),Y(this,"pendingSessions",new Map),Y(this,"init",async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.registerPairingEvents(),await this.registerLinkModeListeners(),this.client.core.pairing.register({methods:Object.keys(Bn)}),this.initialized=!0,setTimeout(async()=>{await this.processPendingMessageEvents(),this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()},ne.toMiliseconds(this.requestQueueDelay)))}),Y(this,"connect",async t=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();const r=sr(_t({},t),{requiredNamespaces:t.requiredNamespaces||{},optionalNamespaces:t.optionalNamespaces||{}});await this.isValidConnect(r),r.optionalNamespaces=lJ(r.requiredNamespaces,r.optionalNamespaces),r.requiredNamespaces={};const{pairingTopic:s,requiredNamespaces:i,optionalNamespaces:o,sessionProperties:a,scopedProperties:c,relays:l}=r;let u=s,h,d=!1;try{if(u){const R=this.client.core.pairing.pairings.get(u);this.client.logger.warn("connect() with existing pairing topic is deprecated and will be removed in the next major release."),d=R.active}}catch(R){throw this.client.logger.error(`connect() -> pairing.get(${u}) failed`),R}if(!u||!d){const{topic:R,uri:M}=await this.client.core.pairing.create({internal:{skipSubscribe:!0}});u=R,h=M}if(!u){const{message:R}=re("NO_MATCHING_KEY",`connect() pairing topic: ${u}`);throw new Error(R)}const f=await this.client.core.crypto.generateKeyPair(),p=Bn.wc_sessionPropose.req.ttl||ne.FIVE_MINUTES,g=bn(p),m=sr(_t(_t({requiredNamespaces:i,optionalNamespaces:o,relays:l??[{protocol:U$}],proposer:{publicKey:f,metadata:this.client.metadata},expiryTimestamp:g,pairingTopic:u},a&&{sessionProperties:a}),c&&{scopedProperties:c}),{id:Ki()}),w=At("session_connect",m.id),{reject:v,resolve:A,done:T}=ll(p,ex),N=({id:R})=>{R===m.id&&(this.client.events.off("proposal_expire",N),this.pendingSessions.delete(m.id),this.events.emit(w,{error:{message:ex,code:0}}))};return this.client.events.on("proposal_expire",N),this.events.once(w,({error:R,session:M})=>{this.client.events.off("proposal_expire",N),R?v(R):M&&A(M)}),await this.sendProposeSession({proposal:m,publishOpts:{internal:{throwOnFailedPublish:!0},tvf:{correlationId:m.id}}}),await this.setProposal(m.id,m),{uri:h,approval:T}}),Y(this,"pair",async t=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{return await this.client.core.pairing.pair(t)}catch(r){throw this.client.logger.error("pair() failed"),r}}),Y(this,"approve",async t=>{var r,s,i;const o=this.client.core.eventClient.createEvent({properties:{topic:(r=t==null?void 0:t.id)==null?void 0:r.toString(),trace:[Va.session_approve_started]}});try{this.isInitialized(),await this.confirmOnlineStateOrThrow()}catch(S){throw o.setError(gp.no_internet_connection),S}try{await this.isValidProposalId(t==null?void 0:t.id)}catch(S){throw this.client.logger.error(`approve() -> proposal.get(${t==null?void 0:t.id}) failed`),o.setError(gp.proposal_not_found),S}try{await this.isValidApprove(t)}catch(S){throw this.client.logger.error("approve() -> isValidApprove() failed"),o.setError(gp.session_approve_namespace_validation_failure),S}const{id:a,relayProtocol:c,namespaces:l,sessionProperties:u,scopedProperties:h,sessionConfig:d}=t,f=this.client.proposal.get(a);this.client.core.eventClient.deleteEvent({eventId:o.eventId});const{pairingTopic:p,proposer:g,requiredNamespaces:m,optionalNamespaces:w}=f;let v=(s=this.client.core.eventClient)==null?void 0:s.getEvent({topic:p});v||(v=(i=this.client.core.eventClient)==null?void 0:i.createEvent({type:Va.session_approve_started,properties:{topic:p,trace:[Va.session_approve_started,Va.session_namespaces_validation_success]}}));const A=await this.client.core.crypto.generateKeyPair(),T=g.publicKey,N=await this.client.core.crypto.generateSharedKey(A,T),R=_t(_t(_t({relay:{protocol:c??"irn"},namespaces:l,controller:{publicKey:A,metadata:this.client.metadata},expiry:bn(ah)},u&&{sessionProperties:u}),h&&{scopedProperties:h}),d&&{sessionConfig:d}),M=Lt.relay;v.addTrace(Va.subscribing_session_topic);try{await this.client.core.relayer.subscribe(N,{transportType:M,internal:{skipSubscribe:!0}})}catch(S){throw v.setError(gp.subscribe_session_topic_failure),S}v.addTrace(Va.subscribe_session_topic_success);const D=sr(_t({},R),{topic:N,requiredNamespaces:m,optionalNamespaces:w,pairingTopic:p,acknowledged:!1,self:R.controller,peer:{publicKey:g.publicKey,metadata:g.metadata},controller:A,transportType:Lt.relay});await this.client.session.set(N,D),v.addTrace(Va.store_session);try{await this.sendApproveSession({sessionTopic:N,proposal:f,pairingProposalResponse:{relay:{protocol:c??"irn"},responderPublicKey:A},sessionSettleRequest:R,publishOpts:{internal:{throwOnFailedPublish:!0},tvf:{correlationId:a}}}),v.addTrace(Va.session_approve_publish_success)}catch(S){throw this.client.logger.error(S),this.client.session.delete(N,zt("USER_DISCONNECTED")),await this.client.core.relayer.unsubscribe(N),S}return this.client.core.eventClient.deleteEvent({eventId:v.eventId}),await this.client.core.pairing.updateMetadata({topic:p,metadata:g.metadata}),await this.deleteProposal(a),await this.client.core.pairing.activate({topic:p}),await this.setExpiry(N,bn(ah)),{topic:N,acknowledged:()=>Promise.resolve(this.client.session.get(N))}}),Y(this,"reject",async t=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidReject(t)}catch(o){throw this.client.logger.error("reject() -> isValidReject() failed"),o}const{id:r,reason:s}=t;let i;try{i=this.client.proposal.get(r).pairingTopic}catch(o){throw this.client.logger.error(`reject() -> proposal.get(${r}) failed`),o}i&&await this.sendError({id:r,topic:i,error:s,rpcOpts:Bn.wc_sessionPropose.reject}),await this.deleteProposal(r)}),Y(this,"update",async t=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidUpdate(t)}catch(h){throw this.client.logger.error("update() -> isValidUpdate() failed"),h}const{topic:r,namespaces:s}=t,{done:i,resolve:o,reject:a}=ll(),c=Ki(),l=Ic().toString(),u=this.client.session.get(r).namespaces;return this.events.once(At("session_update",c),({error:h})=>{h?a(h):o()}),await this.client.session.update(r,{namespaces:s}),await this.sendRequest({topic:r,method:"wc_sessionUpdate",params:{namespaces:s},throwOnFailedPublish:!0,clientRpcId:c,relayRpcId:l}).catch(h=>{this.client.logger.error(h),this.client.session.update(r,{namespaces:u}),a(h)}),{acknowledged:i}}),Y(this,"extend",async t=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidExtend(t)}catch(c){throw this.client.logger.error("extend() -> isValidExtend() failed"),c}const{topic:r}=t,s=Ki(),{done:i,resolve:o,reject:a}=ll();return this.events.once(At("session_extend",s),({error:c})=>{c?a(c):o()}),await this.setExpiry(r,bn(ah)),this.sendRequest({topic:r,method:"wc_sessionExtend",params:{},clientRpcId:s,throwOnFailedPublish:!0}).catch(c=>{a(c)}),{acknowledged:i}}),Y(this,"request",async t=>{this.isInitialized();try{await this.isValidRequest(t)}catch(m){throw this.client.logger.error("request() -> isValidRequest() failed"),m}const{chainId:r,request:s,topic:i,expiry:o=Bn.wc_sessionRequest.req.ttl}=t,a=this.client.session.get(i);(a==null?void 0:a.transportType)===Lt.relay&&await this.confirmOnlineStateOrThrow();const c=Ki(),l=Ic().toString(),{done:u,resolve:h,reject:d}=ll(o,"Request expired. Please try again.");this.events.once(At("session_request",c),({error:m,result:w})=>{m?d(m):h(w)});const f="wc_sessionRequest",p=this.getAppLinkIfEnabled(a.peer.metadata,a.transportType);if(p)return await this.sendRequest({clientRpcId:c,relayRpcId:l,topic:i,method:f,params:{request:sr(_t({},s),{expiryTimestamp:bn(o)}),chainId:r},expiry:o,throwOnFailedPublish:!0,appLink:p}).catch(m=>d(m)),this.client.events.emit("session_request_sent",{topic:i,request:s,chainId:r,id:c}),await u();const g={request:sr(_t({},s),{expiryTimestamp:bn(o)}),chainId:r};return await Promise.all([new Promise(async m=>{await this.sendRequest({clientRpcId:c,relayRpcId:l,topic:i,method:f,params:g,expiry:o,throwOnFailedPublish:!0,tvf:this.getTVFParams(c,g)}).catch(w=>d(w)),this.client.events.emit("session_request_sent",{topic:i,request:s,chainId:r,id:c}),m()}),new Promise(async m=>{var w;if(!((w=a.sessionConfig)!=null&&w.disableDeepLink)){const v=await nY(this.client.core.storage,XO);await XK({id:c,topic:i,wcDeepLink:v})}m()}),u()]).then(m=>m[2])}),Y(this,"respond",async t=>{this.isInitialized(),await this.isValidRespond(t);const{topic:r,response:s}=t,{id:i}=s,o=this.client.session.get(r);o.transportType===Lt.relay&&await this.confirmOnlineStateOrThrow();const a=this.getAppLinkIfEnabled(o.peer.metadata,o.transportType);Yi(s)?await this.sendResult({id:i,topic:r,result:s.result,throwOnFailedPublish:!0,appLink:a}):Ks(s)&&await this.sendError({id:i,topic:r,error:s.error,appLink:a}),this.cleanupAfterResponse(t)}),Y(this,"ping",async t=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidPing(t)}catch(s){throw this.client.logger.error("ping() -> isValidPing() failed"),s}const{topic:r}=t;if(this.client.session.keys.includes(r)){const s=Ki(),i=Ic().toString(),{done:o,resolve:a,reject:c}=ll();this.events.once(At("session_ping",s),({error:l})=>{l?c(l):a()}),await Promise.all([this.sendRequest({topic:r,method:"wc_sessionPing",params:{},throwOnFailedPublish:!0,clientRpcId:s,relayRpcId:i}),o()])}else this.client.core.pairing.pairings.keys.includes(r)&&(this.client.logger.warn("ping() on pairing topic is deprecated and will be removed in the next major release."),await this.client.core.pairing.ping({topic:r}))}),Y(this,"emit",async t=>{this.isInitialized(),await this.confirmOnlineStateOrThrow(),await this.isValidEmit(t);const{topic:r,event:s,chainId:i}=t,o=Ic().toString(),a=Ki();await this.sendRequest({topic:r,method:"wc_sessionEvent",params:{event:s,chainId:i},throwOnFailedPublish:!0,relayRpcId:o,clientRpcId:a})}),Y(this,"disconnect",async t=>{this.isInitialized(),await this.confirmOnlineStateOrThrow(),await this.isValidDisconnect(t);const{topic:r}=t;if(this.client.session.keys.includes(r))await this.sendRequest({topic:r,method:"wc_sessionDelete",params:zt("USER_DISCONNECTED"),throwOnFailedPublish:!0}),await this.deleteSession({topic:r,emitEvent:!1});else if(this.client.core.pairing.pairings.keys.includes(r))await this.client.core.pairing.disconnect({topic:r});else{const{message:s}=re("MISMATCHED_TOPIC",`Session or pairing topic not found: ${r}`);throw new Error(s)}}),Y(this,"find",t=>(this.isInitialized(),this.client.session.getAll().filter(r=>dJ(r,t)))),Y(this,"getPendingSessionRequests",()=>this.client.pendingRequest.getAll()),Y(this,"authenticate",async(t,r)=>{var s;this.isInitialized(),this.isValidAuthenticate(t);const i=r&&this.client.core.linkModeSupportedApps.includes(r)&&((s=this.client.metadata.redirect)==null?void 0:s.linkMode),o=i?Lt.link_mode:Lt.relay;o===Lt.relay&&await this.confirmOnlineStateOrThrow();const{chains:a,statement:c="",uri:l,domain:u,nonce:h,type:d,exp:f,nbf:p,methods:g=[],expiry:m}=t,w=[...t.resources||[]],{topic:v,uri:A}=await this.client.core.pairing.create({methods:["wc_sessionAuthenticate"],transportType:o});this.client.logger.info({message:"Generated new pairing",pairing:{topic:v,uri:A}});const T=await this.client.core.crypto.generateKeyPair(),N=Jw(T);if(await Promise.all([this.client.auth.authKeys.set(e0,{responseTopic:N,publicKey:T}),this.client.auth.pairingTopics.set(N,{topic:N,pairingTopic:v})]),await this.client.core.relayer.subscribe(N,{transportType:o}),this.client.logger.info(`sending request to new pairing topic: ${v}`),g.length>0){const{namespace:k}=ou(a[0]);let j=wQ(k,"request",g);Zw(w)&&(j=EQ(j,w.pop())),w.push(j)}const R=m&&m>Bn.wc_sessionAuthenticate.req.ttl?m:Bn.wc_sessionAuthenticate.req.ttl,M={authPayload:{type:d??"caip122",chains:a,statement:c,aud:l,domain:u,version:"1",nonce:h,iat:new Date().toISOString(),exp:f,nbf:p,resources:w},requester:{publicKey:T,metadata:this.client.metadata},expiryTimestamp:bn(R)},D={eip155:{chains:a,methods:[...new Set(["personal_sign",...g])],events:["chainChanged","accountsChanged"]}},S={requiredNamespaces:{},optionalNamespaces:D,relays:[{protocol:"irn"}],pairingTopic:v,proposer:{publicKey:T,metadata:this.client.metadata},expiryTimestamp:bn(Bn.wc_sessionPropose.req.ttl),id:Ki()},{done:$,resolve:P,reject:L}=ll(R,"Request expired"),V=Ki(),G=At("session_connect",S.id),E=At("session_request",V),C=async({error:k,session:j})=>{this.events.off(E,O),k?L(k):j&&P({session:j})},O=async k=>{var j,q,X;if(await this.deletePendingAuthRequest(V,{message:"fulfilled",code:0}),k.error){const Me=zt("WC_METHOD_UNSUPPORTED","wc_sessionAuthenticate");return k.error.code===Me.code?void 0:(this.events.off(G,C),L(k.error.message))}await this.deleteProposal(S.id),this.events.off(G,C);const{cacaos:ce,responder:te}=k.result,de=[],De=[];for(const Me of ce){await q2({cacao:Me,projectId:this.client.core.projectId})||(this.client.logger.error(Me,"Signature verification failed"),L(zt("SESSION_SETTLEMENT_FAILED","Signature verification failed")));const{p:Ot}=Me,an=Zw(Ot.resources),jr=[FA(Ot.iss)],Zn=U0(Ot.iss);if(an){const ds=z2(an),Ku=W2(an);de.push(...ds),jr.push(...Ku)}for(const ds of jr)De.push(`${ds}:${Zn}`)}const Qe=await this.client.core.crypto.generateSharedKey(T,te.publicKey);let Je;de.length>0&&(Je={topic:Qe,acknowledged:!0,self:{publicKey:T,metadata:this.client.metadata},peer:te,controller:te.publicKey,expiry:bn(ah),requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:v,namespaces:mO([...new Set(de)],[...new Set(De)]),transportType:o},await this.client.core.relayer.subscribe(Qe,{transportType:o}),await this.client.session.set(Qe,Je),v&&await this.client.core.pairing.updateMetadata({topic:v,metadata:te.metadata}),Je=this.client.session.get(Qe)),(j=this.client.metadata.redirect)!=null&&j.linkMode&&(q=te.metadata.redirect)!=null&&q.linkMode&&(X=te.metadata.redirect)!=null&&X.universal&&r&&(this.client.core.addLinkModeSupportedApp(te.metadata.redirect.universal),this.client.session.update(Qe,{transportType:Lt.link_mode})),P({auths:ce,session:Je})};this.events.once(G,C),this.events.once(E,O);let U;try{if(i){const k=io("wc_sessionAuthenticate",M,V);this.client.core.history.set(v,k);const j=await this.client.core.crypto.encode("",k,{type:gy,encoding:nc});U=yw(r,v,j)}else await Promise.all([this.sendRequest({topic:v,method:"wc_sessionAuthenticate",params:M,expiry:t.expiry,throwOnFailedPublish:!0,clientRpcId:V}),this.sendRequest({topic:v,method:"wc_sessionPropose",params:S,expiry:Bn.wc_sessionPropose.req.ttl,throwOnFailedPublish:!0,clientRpcId:S.id})])}catch(k){throw this.events.off(G,C),this.events.off(E,O),k}return await this.setProposal(S.id,S),await this.setAuthRequest(V,{request:sr(_t({},M),{verifyContext:{}}),pairingTopic:v,transportType:o}),{uri:U??A,response:$}}),Y(this,"approveSessionAuthenticate",async t=>{const{id:r,auths:s}=t,i=this.client.core.eventClient.createEvent({properties:{topic:r.toString(),trace:[sl.authenticated_session_approve_started]}});try{this.isInitialized()}catch(m){throw i.setError(mp.no_internet_connection),m}const o=this.getPendingAuthRequest(r);if(!o)throw i.setError(mp.authenticated_session_pending_request_not_found),new Error(`Could not find pending auth request with id ${r}`);const a=o.transportType||Lt.relay;a===Lt.relay&&await this.confirmOnlineStateOrThrow();const c=o.requester.publicKey,l=await this.client.core.crypto.generateKeyPair(),u=Jw(c),h={type:la,receiverPublicKey:c,senderPublicKey:l},d=[],f=[];for(const m of s){if(!await q2({cacao:m,projectId:this.client.core.projectId})){i.setError(mp.invalid_cacao);const N=zt("SESSION_SETTLEMENT_FAILED","Signature verification failed");throw await this.sendError({id:r,topic:u,error:N,encodeOpts:h}),new Error(N.message)}i.addTrace(sl.cacaos_verified);const{p:w}=m,v=Zw(w.resources),A=[FA(w.iss)],T=U0(w.iss);if(v){const N=z2(v),R=W2(v);d.push(...N),A.push(...R)}for(const N of A)f.push(`${N}:${T}`)}const p=await this.client.core.crypto.generateSharedKey(l,c);i.addTrace(sl.create_authenticated_session_topic);let g;if((d==null?void 0:d.length)>0){g={topic:p,acknowledged:!0,self:{publicKey:l,metadata:this.client.metadata},peer:{publicKey:c,metadata:o.requester.metadata},controller:c,expiry:bn(ah),authentication:s,requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:o.pairingTopic,namespaces:mO([...new Set(d)],[...new Set(f)]),transportType:a},i.addTrace(sl.subscribing_authenticated_session_topic);try{await this.client.core.relayer.subscribe(p,{transportType:a})}catch(m){throw i.setError(mp.subscribe_authenticated_session_topic_failure),m}i.addTrace(sl.subscribe_authenticated_session_topic_success),await this.client.session.set(p,g),i.addTrace(sl.store_authenticated_session),await this.client.core.pairing.updateMetadata({topic:o.pairingTopic,metadata:o.requester.metadata})}i.addTrace(sl.publishing_authenticated_session_approve);try{await this.sendResult({topic:u,id:r,result:{cacaos:s,responder:{publicKey:l,metadata:this.client.metadata}},encodeOpts:h,throwOnFailedPublish:!0,appLink:this.getAppLinkIfEnabled(o.requester.metadata,a)})}catch(m){throw i.setError(mp.authenticated_session_approve_publish_failure),m}return await this.client.auth.requests.delete(r,{message:"fulfilled",code:0}),await this.client.core.pairing.activate({topic:o.pairingTopic}),this.client.core.eventClient.deleteEvent({eventId:i.eventId}),{session:g}}),Y(this,"rejectSessionAuthenticate",async t=>{this.isInitialized();const{id:r,reason:s}=t,i=this.getPendingAuthRequest(r);if(!i)throw new Error(`Could not find pending auth request with id ${r}`);i.transportType===Lt.relay&&await this.confirmOnlineStateOrThrow();const o=i.requester.publicKey,a=await this.client.core.crypto.generateKeyPair(),c=Jw(o),l={type:la,receiverPublicKey:o,senderPublicKey:a};await this.sendError({id:r,topic:c,error:s,encodeOpts:l,rpcOpts:Bn.wc_sessionAuthenticate.reject,appLink:this.getAppLinkIfEnabled(i.requester.metadata,i.transportType)}),await this.client.auth.requests.delete(r,{message:"rejected",code:0}),await this.deleteProposal(r)}),Y(this,"formatAuthMessage",t=>{this.isInitialized();const{request:r,iss:s}=t;return KU(r,s)}),Y(this,"processRelayMessageCache",()=>{setTimeout(async()=>{if(this.relayMessageCache.length!==0)for(;this.relayMessageCache.length>0;)try{const t=this.relayMessageCache.shift();t&&await this.onRelayMessage(t)}catch(t){this.client.logger.error(t)}},50)}),Y(this,"cleanupDuplicatePairings",async t=>{if(t.pairingTopic)try{const r=this.client.core.pairing.pairings.get(t.pairingTopic),s=this.client.core.pairing.pairings.getAll().filter(i=>{var o,a;return((o=i.peerMetadata)==null?void 0:o.url)&&((a=i.peerMetadata)==null?void 0:a.url)===t.peer.metadata.url&&i.topic&&i.topic!==r.topic});if(s.length===0)return;this.client.logger.info(`Cleaning up ${s.length} duplicate pairing(s)`),await Promise.all(s.map(i=>this.client.core.pairing.disconnect({topic:i.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(r){this.client.logger.error(r)}}),Y(this,"deleteSession",async t=>{var r;const{topic:s,expirerHasDeleted:i=!1,emitEvent:o=!0,id:a=0}=t,{self:c}=this.client.session.get(s);await this.client.core.relayer.unsubscribe(s),await this.client.session.delete(s,zt("USER_DISCONNECTED")),this.addToRecentlyDeleted(s,"session"),this.client.core.crypto.keychain.has(c.publicKey)&&await this.client.core.crypto.deleteKeyPair(c.publicKey),this.client.core.crypto.keychain.has(s)&&await this.client.core.crypto.deleteSymKey(s),i||this.client.core.expirer.del(s),this.client.core.storage.removeItem(XO).catch(l=>this.client.logger.warn(l)),this.getPendingSessionRequests().forEach(l=>{l.topic===s&&this.deletePendingSessionRequest(l.id,zt("USER_DISCONNECTED"))}),s===((r=this.sessionRequestQueue.queue[0])==null?void 0:r.topic)&&(this.sessionRequestQueue.state=zi.idle),o&&this.client.events.emit("session_delete",{id:a,topic:s})}),Y(this,"deleteProposal",async(t,r)=>{if(r)try{const s=this.client.proposal.get(t),i=this.client.core.eventClient.getEvent({topic:s.pairingTopic});i==null||i.setError(gp.proposal_expired)}catch{}await Promise.all([this.client.proposal.delete(t,zt("USER_DISCONNECTED")),r?Promise.resolve():this.client.core.expirer.del(t)]),this.addToRecentlyDeleted(t,"proposal")}),Y(this,"deletePendingSessionRequest",async(t,r,s=!1)=>{await Promise.all([this.client.pendingRequest.delete(t,r),s?Promise.resolve():this.client.core.expirer.del(t)]),this.addToRecentlyDeleted(t,"request"),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter(i=>i.id!==t),s&&(this.sessionRequestQueue.state=zi.idle,this.client.events.emit("session_request_expire",{id:t}))}),Y(this,"deletePendingAuthRequest",async(t,r,s=!1)=>{await Promise.all([this.client.auth.requests.delete(t,r),s?Promise.resolve():this.client.core.expirer.del(t)])}),Y(this,"setExpiry",async(t,r)=>{this.client.session.keys.includes(t)&&(this.client.core.expirer.set(t,r),await this.client.session.update(t,{expiry:r}))}),Y(this,"setProposal",async(t,r)=>{this.client.core.expirer.set(t,bn(Bn.wc_sessionPropose.req.ttl)),await this.client.proposal.set(t,r)}),Y(this,"setAuthRequest",async(t,r)=>{const{request:s,pairingTopic:i,transportType:o=Lt.relay}=r;this.client.core.expirer.set(t,s.expiryTimestamp),await this.client.auth.requests.set(t,{authPayload:s.authPayload,requester:s.requester,expiryTimestamp:s.expiryTimestamp,id:t,pairingTopic:i,verifyContext:s.verifyContext,transportType:o})}),Y(this,"setPendingSessionRequest",async t=>{const{id:r,topic:s,params:i,verifyContext:o}=t,a=i.request.expiryTimestamp||bn(Bn.wc_sessionRequest.req.ttl);this.client.core.expirer.set(r,a),await this.client.pendingRequest.set(r,{id:r,topic:s,params:i,verifyContext:o})}),Y(this,"sendRequest",async t=>{const{topic:r,method:s,params:i,expiry:o,relayRpcId:a,clientRpcId:c,throwOnFailedPublish:l,appLink:u,tvf:h,publishOpts:d={}}=t,f=io(s,i,c);let p;const g=!!u;try{const v=g?nc:ts;p=await this.client.core.crypto.encode(r,f,{encoding:v})}catch(v){throw await this.cleanup(),this.client.logger.error(`sendRequest() -> core.crypto.encode() for topic ${r} failed`),v}let m;if(Nre.includes(s)){const v=Gs(JSON.stringify(f)),A=Gs(p);m=await this.client.core.verify.register({id:A,decryptedId:v})}const w=_t(_t({},Bn[s].req),d);if(w.attestation=m,o&&(w.ttl=o),a&&(w.id=a),this.client.core.history.set(r,f),g){const v=yw(u,r,p);await globalThis.Linking.openURL(v,this.client.name)}else w.tvf=sr(_t({},h),{correlationId:f.id}),l?(w.internal=sr(_t({},w.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(r,p,w)):this.client.core.relayer.publish(r,p,w).catch(v=>this.client.logger.error(v));return f.id}),Y(this,"sendProposeSession",async t=>{const{proposal:r,publishOpts:s}=t,i=io("wc_sessionPropose",r,r.id);this.client.core.history.set(r.pairingTopic,i);const o=await this.client.core.crypto.encode(r.pairingTopic,i,{encoding:ts}),a=Gs(JSON.stringify(i)),c=Gs(o),l=await this.client.core.verify.register({id:c,decryptedId:a});await this.client.core.relayer.publishCustom({payload:{pairingTopic:r.pairingTopic,sessionProposal:o},opts:sr(_t({},s),{publishMethod:"wc_proposeSession",attestation:l})})}),Y(this,"sendApproveSession",async t=>{const{sessionTopic:r,pairingProposalResponse:s,proposal:i,sessionSettleRequest:o,publishOpts:a}=t,c=Wg(i.id,s),l=await this.client.core.crypto.encode(i.pairingTopic,c,{encoding:ts}),u=io("wc_sessionSettle",o,a==null?void 0:a.id),h=await this.client.core.crypto.encode(r,u,{encoding:ts});this.client.core.history.set(r,u),await this.client.core.relayer.publishCustom({payload:{sessionTopic:r,pairingTopic:i.pairingTopic,sessionProposalResponse:l,sessionSettlementRequest:h},opts:sr(_t({},a),{publishMethod:"wc_approveSession"})})}),Y(this,"sendResult",async t=>{const{id:r,topic:s,result:i,throwOnFailedPublish:o,encodeOpts:a,appLink:c}=t,l=Wg(r,i);let u;const h=c&&typeof(global==null?void 0:global.Linking)<"u";try{const p=h?nc:ts;u=await this.client.core.crypto.encode(s,l,sr(_t({},a||{}),{encoding:p}))}catch(p){throw await this.cleanup(),this.client.logger.error(`sendResult() -> core.crypto.encode() for topic ${s} failed`),p}let d,f;try{d=await this.client.core.history.get(s,r);const p=d.request;try{f=this.getTVFParams(r,p.params,i)}catch(g){this.client.logger.warn(`sendResult() -> getTVFParams() failed: ${g==null?void 0:g.message}`)}}catch(p){throw this.client.logger.error(`sendResult() -> history.get(${s}, ${r}) failed`),p}if(h){const p=yw(c,s,u);await globalThis.Linking.openURL(p,this.client.name)}else{const p=d.request.method,g=Bn[p].res;g.tvf=sr(_t({},f),{correlationId:r}),o?(g.internal=sr(_t({},g.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(s,u,g)):this.client.core.relayer.publish(s,u,g).catch(m=>this.client.logger.error(m))}await this.client.core.history.resolve(l)}),Y(this,"sendError",async t=>{const{id:r,topic:s,error:i,encodeOpts:o,rpcOpts:a,appLink:c}=t,l=oE(r,i);let u;const h=c&&typeof(global==null?void 0:global.Linking)<"u";try{const f=h?nc:ts;u=await this.client.core.crypto.encode(s,l,sr(_t({},o||{}),{encoding:f}))}catch(f){throw await this.cleanup(),this.client.logger.error(`sendError() -> core.crypto.encode() for topic ${s} failed`),f}let d;try{d=await this.client.core.history.get(s,r)}catch(f){throw this.client.logger.error(`sendError() -> history.get(${s}, ${r}) failed`),f}if(h){const f=yw(c,s,u);await globalThis.Linking.openURL(f,this.client.name)}else{const f=d.request.method,p=a||Bn[f].res;this.client.core.relayer.publish(s,u,p)}await this.client.core.history.resolve(l)}),Y(this,"cleanup",async()=>{const t=[],r=[];this.client.session.getAll().forEach(s=>{let i=!1;Qa(s.expiry)&&(i=!0),this.client.core.crypto.keychain.has(s.topic)||(i=!0),i&&t.push(s.topic)}),this.client.proposal.getAll().forEach(s=>{Qa(s.expiryTimestamp)&&r.push(s.id)}),await Promise.all([...t.map(s=>this.deleteSession({topic:s})),...r.map(s=>this.deleteProposal(s))])}),Y(this,"onProviderMessageEvent",async t=>{!this.initialized||this.relayMessageCache.length>0?this.relayMessageCache.push(t):await this.onRelayMessage(t)}),Y(this,"onRelayEventRequest",async t=>{this.requestQueue.queue.push(t),await this.processRequestsQueue()}),Y(this,"processRequestsQueue",async()=>{if(this.requestQueue.state===zi.active){this.client.logger.info("Request queue already active, skipping...");return}for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=zi.active;const t=this.requestQueue.queue.shift();if(t)try{await this.processRequest(t)}catch(r){this.client.logger.warn(r)}}this.requestQueue.state=zi.idle}),Y(this,"processRequest",async t=>{const{topic:r,payload:s,attestation:i,transportType:o,encryptedId:a}=t,c=s.method;if(!this.shouldIgnorePairingRequest({topic:r,requestMethod:c}))switch(c){case"wc_sessionPropose":return await this.onSessionProposeRequest({topic:r,payload:s,attestation:i,encryptedId:a});case"wc_sessionSettle":return await this.onSessionSettleRequest(r,s);case"wc_sessionUpdate":return await this.onSessionUpdateRequest(r,s);case"wc_sessionExtend":return await this.onSessionExtendRequest(r,s);case"wc_sessionPing":return await this.onSessionPingRequest(r,s);case"wc_sessionDelete":return await this.onSessionDeleteRequest(r,s);case"wc_sessionRequest":return await this.onSessionRequest({topic:r,payload:s,attestation:i,encryptedId:a,transportType:o});case"wc_sessionEvent":return await this.onSessionEventRequest(r,s);case"wc_sessionAuthenticate":return await this.onSessionAuthenticateRequest({topic:r,payload:s,attestation:i,encryptedId:a,transportType:o});default:return this.client.logger.info(`Unsupported request method ${c}`)}}),Y(this,"onRelayEventResponse",async t=>{const{topic:r,payload:s,transportType:i}=t,o=(await this.client.core.history.get(r,s.id)).request.method;switch(o){case"wc_sessionPropose":return this.onSessionProposeResponse(r,s,i);case"wc_sessionSettle":return this.onSessionSettleResponse(r,s);case"wc_sessionUpdate":return this.onSessionUpdateResponse(r,s);case"wc_sessionExtend":return this.onSessionExtendResponse(r,s);case"wc_sessionPing":return this.onSessionPingResponse(r,s);case"wc_sessionRequest":return this.onSessionRequestResponse(r,s);case"wc_sessionAuthenticate":return this.onSessionAuthenticateResponse(r,s);default:return this.client.logger.info(`Unsupported response method ${o}`)}}),Y(this,"onRelayEventUnknownPayload",t=>{const{topic:r}=t,{message:s}=re("MISSING_OR_INVALID",`Decoded payload on topic ${r} is not identifiable as a JSON-RPC request or a response.`);throw new Error(s)}),Y(this,"shouldIgnorePairingRequest",t=>{const{topic:r,requestMethod:s}=t,i=this.expectedPairingMethodMap.get(r);return!i||i.includes(s)?!1:!!(i.includes("wc_sessionAuthenticate")&&this.client.events.listenerCount("session_authenticate")>0)}),Y(this,"onSessionProposeRequest",async t=>{const{topic:r,payload:s,attestation:i,encryptedId:o}=t,{params:a,id:c}=s;try{const l=this.client.core.eventClient.getEvent({topic:r});this.client.events.listenerCount("session_proposal")===0&&(console.warn("No listener for session_proposal event"),l==null||l.setError(Lo.proposal_listener_not_found)),this.isValidConnect(_t({},s.params));const u=a.expiryTimestamp||bn(Bn.wc_sessionPropose.req.ttl),h=_t({id:c,pairingTopic:r,expiryTimestamp:u,attestation:i,encryptedId:o},a);await this.setProposal(c,h);const d=await this.getVerifyContext({attestationId:i,hash:Gs(JSON.stringify(s)),encryptedId:o,metadata:h.proposer.metadata});l==null||l.addTrace(Gi.emit_session_proposal),this.client.events.emit("session_proposal",{id:c,params:h,verifyContext:d})}catch(l){await this.sendError({id:c,topic:r,error:l,rpcOpts:Bn.wc_sessionPropose.autoReject}),this.client.logger.error(l)}}),Y(this,"onSessionProposeResponse",async(t,r,s)=>{const{id:i}=r;if(Yi(r)){const{result:o}=r;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:o});const a=this.client.proposal.get(i);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:a});const c=a.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:c});const l=o.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:l});const u=await this.client.core.crypto.generateSharedKey(c,l);this.pendingSessions.set(i,{sessionTopic:u,pairingTopic:t,proposalId:i,publicKey:c});const h=await this.client.core.relayer.subscribe(u,{transportType:s});this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:h}),await this.client.core.pairing.activate({topic:t})}else if(Ks(r)){await this.deleteProposal(i);const o=At("session_connect",i);if(this.events.listenerCount(o)===0)throw new Error(`emitting ${o} without any listeners, 954`);this.events.emit(o,{error:r.error})}}),Y(this,"onSessionSettleRequest",async(t,r)=>{const{id:s,params:i}=r;try{this.isValidSessionSettleRequest(i);const{relay:o,controller:a,expiry:c,namespaces:l,sessionProperties:u,scopedProperties:h,sessionConfig:d}=r.params,f=[...this.pendingSessions.values()].find(m=>m.sessionTopic===t);if(!f)return this.client.logger.error(`Pending session not found for topic ${t}`);const p=this.client.proposal.get(f.proposalId),g=sr(_t(_t(_t({topic:t,relay:o,expiry:c,namespaces:l,acknowledged:!0,pairingTopic:f.pairingTopic,requiredNamespaces:p.requiredNamespaces,optionalNamespaces:p.optionalNamespaces,controller:a.publicKey,self:{publicKey:f.publicKey,metadata:this.client.metadata},peer:{publicKey:a.publicKey,metadata:a.metadata}},u&&{sessionProperties:u}),h&&{scopedProperties:h}),d&&{sessionConfig:d}),{transportType:Lt.relay});await this.client.session.set(g.topic,g),await this.setExpiry(g.topic,g.expiry),await this.client.core.pairing.updateMetadata({topic:f.pairingTopic,metadata:g.peer.metadata}),this.client.events.emit("session_connect",{session:g}),this.events.emit(At("session_connect",f.proposalId),{session:g}),this.pendingSessions.delete(f.proposalId),this.deleteProposal(f.proposalId,!1),this.cleanupDuplicatePairings(g),await this.sendResult({id:r.id,topic:t,result:!0})}catch(o){await this.sendError({id:s,topic:t,error:o}),this.client.logger.error(o)}}),Y(this,"onSessionSettleResponse",async(t,r)=>{const{id:s}=r;Yi(r)?(await this.client.session.update(t,{acknowledged:!0}),this.events.emit(At("session_approve",s),{})):Ks(r)&&(await this.client.session.delete(t,zt("USER_DISCONNECTED")),this.events.emit(At("session_approve",s),{error:r.error}))}),Y(this,"onSessionUpdateRequest",async(t,r)=>{const{params:s,id:i}=r;try{const o=`${t}_session_update`,a=fp.get(o);if(a&&this.isRequestOutOfSync(a,i)){this.client.logger.warn(`Discarding out of sync request - ${i}`),this.sendError({id:i,topic:t,error:zt("INVALID_UPDATE_REQUEST")});return}this.isValidUpdate(_t({topic:t},s));try{fp.set(o,i),await this.client.session.update(t,{namespaces:s.namespaces}),await this.sendResult({id:i,topic:t,result:!0})}catch(c){throw fp.delete(o),c}this.client.events.emit("session_update",{id:i,topic:t,params:s})}catch(o){await this.sendError({id:i,topic:t,error:o}),this.client.logger.error(o)}}),Y(this,"isRequestOutOfSync",(t,r)=>r.toString().slice(0,-3)<t.toString().slice(0,-3)),Y(this,"onSessionUpdateResponse",(t,r)=>{const{id:s}=r,i=At("session_update",s);if(this.events.listenerCount(i)===0)throw new Error(`emitting ${i} without any listeners`);Yi(r)?this.events.emit(At("session_update",s),{}):Ks(r)&&this.events.emit(At("session_update",s),{error:r.error})}),Y(this,"onSessionExtendRequest",async(t,r)=>{const{id:s}=r;try{this.isValidExtend({topic:t}),await this.setExpiry(t,bn(ah)),await this.sendResult({id:s,topic:t,result:!0}),this.client.events.emit("session_extend",{id:s,topic:t})}catch(i){await this.sendError({id:s,topic:t,error:i}),this.client.logger.error(i)}}),Y(this,"onSessionExtendResponse",(t,r)=>{const{id:s}=r,i=At("session_extend",s);if(this.events.listenerCount(i)===0)throw new Error(`emitting ${i} without any listeners`);Yi(r)?this.events.emit(At("session_extend",s),{}):Ks(r)&&this.events.emit(At("session_extend",s),{error:r.error})}),Y(this,"onSessionPingRequest",async(t,r)=>{const{id:s}=r;try{this.isValidPing({topic:t}),await this.sendResult({id:s,topic:t,result:!0,throwOnFailedPublish:!0}),this.client.events.emit("session_ping",{id:s,topic:t})}catch(i){await this.sendError({id:s,topic:t,error:i}),this.client.logger.error(i)}}),Y(this,"onSessionPingResponse",(t,r)=>{const{id:s}=r,i=At("session_ping",s);setTimeout(()=>{if(this.events.listenerCount(i)===0)throw new Error(`emitting ${i} without any listeners 2176`);Yi(r)?this.events.emit(At("session_ping",s),{}):Ks(r)&&this.events.emit(At("session_ping",s),{error:r.error})},500)}),Y(this,"onSessionDeleteRequest",async(t,r)=>{const{id:s}=r;try{this.isValidDisconnect({topic:t,reason:r.params}),await Promise.all([new Promise(i=>{this.client.core.relayer.once(en.publish,async()=>{i(await this.deleteSession({topic:t,id:s}))})}),this.sendResult({id:s,topic:t,result:!0}),this.cleanupPendingSentRequestsForTopic({topic:t,error:zt("USER_DISCONNECTED")})]).catch(i=>this.client.logger.error(i))}catch(i){this.client.logger.error(i)}}),Y(this,"onSessionRequest",async t=>{var r,s,i;const{topic:o,payload:a,attestation:c,encryptedId:l,transportType:u}=t,{id:h,params:d}=a;try{await this.isValidRequest(_t({topic:o},d));const f=this.client.session.get(o),p=await this.getVerifyContext({attestationId:c,hash:Gs(JSON.stringify(io("wc_sessionRequest",d,h))),encryptedId:l,metadata:f.peer.metadata,transportType:u}),g={id:h,topic:o,params:d,verifyContext:p};await this.setPendingSessionRequest(g),u===Lt.link_mode&&(r=f.peer.metadata.redirect)!=null&&r.universal&&this.client.core.addLinkModeSupportedApp((s=f.peer.metadata.redirect)==null?void 0:s.universal),(i=this.client.signConfig)!=null&&i.disableRequestQueue?this.emitSessionRequest(g):(this.addSessionRequestToSessionRequestQueue(g),this.processSessionRequestQueue())}catch(f){await this.sendError({id:h,topic:o,error:f}),this.client.logger.error(f)}}),Y(this,"onSessionRequestResponse",(t,r)=>{const{id:s}=r,i=At("session_request",s);if(this.events.listenerCount(i)===0)throw new Error(`emitting ${i} without any listeners`);Yi(r)?this.events.emit(At("session_request",s),{result:r.result}):Ks(r)&&this.events.emit(At("session_request",s),{error:r.error})}),Y(this,"onSessionEventRequest",async(t,r)=>{const{id:s,params:i}=r;try{const o=`${t}_session_event_${i.event.name}`,a=fp.get(o);if(a&&this.isRequestOutOfSync(a,s)){this.client.logger.info(`Discarding out of sync request - ${s}`);return}this.isValidEmit(_t({topic:t},i)),this.client.events.emit("session_event",{id:s,topic:t,params:i}),fp.set(o,s)}catch(o){await this.sendError({id:s,topic:t,error:o}),this.client.logger.error(o)}}),Y(this,"onSessionAuthenticateResponse",(t,r)=>{const{id:s}=r;this.client.logger.trace({type:"method",method:"onSessionAuthenticateResponse",topic:t,payload:r}),Yi(r)?this.events.emit(At("session_request",s),{result:r.result}):Ks(r)&&this.events.emit(At("session_request",s),{error:r.error})}),Y(this,"onSessionAuthenticateRequest",async t=>{var r;const{topic:s,payload:i,attestation:o,encryptedId:a,transportType:c}=t;try{const{requester:l,authPayload:u,expiryTimestamp:h}=i.params,d=await this.getVerifyContext({attestationId:o,hash:Gs(JSON.stringify(i)),encryptedId:a,metadata:l.metadata,transportType:c}),f={requester:l,pairingTopic:s,id:i.id,authPayload:u,verifyContext:d,expiryTimestamp:h};await this.setAuthRequest(i.id,{request:f,pairingTopic:s,transportType:c}),c===Lt.link_mode&&(r=l.metadata.redirect)!=null&&r.universal&&this.client.core.addLinkModeSupportedApp(l.metadata.redirect.universal),this.client.events.emit("session_authenticate",{topic:s,params:i.params,id:i.id,verifyContext:d})}catch(l){this.client.logger.error(l);const u=i.params.requester.publicKey,h=await this.client.core.crypto.generateKeyPair(),d=this.getAppLinkIfEnabled(i.params.requester.metadata,c),f={type:la,receiverPublicKey:u,senderPublicKey:h};await this.sendError({id:i.id,topic:s,error:l,encodeOpts:f,rpcOpts:Bn.wc_sessionAuthenticate.autoReject,appLink:d})}}),Y(this,"addSessionRequestToSessionRequestQueue",t=>{this.sessionRequestQueue.queue.push(t)}),Y(this,"cleanupAfterResponse",t=>{this.deletePendingSessionRequest(t.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.sessionRequestQueue.state=zi.idle,this.processSessionRequestQueue()},ne.toMiliseconds(this.requestQueueDelay))}),Y(this,"cleanupPendingSentRequestsForTopic",({topic:t,error:r})=>{const s=this.client.core.history.pending;s.length>0&&s.filter(i=>i.topic===t&&i.request.method==="wc_sessionRequest").forEach(i=>{const o=i.request.id,a=At("session_request",o);if(this.events.listenerCount(a)===0)throw new Error(`emitting ${a} without any listeners`);this.events.emit(At("session_request",i.request.id),{error:r})})}),Y(this,"processSessionRequestQueue",()=>{if(this.sessionRequestQueue.state===zi.active){this.client.logger.info("session request queue is already active.");return}const t=this.sessionRequestQueue.queue[0];if(!t){this.client.logger.info("session request queue is empty.");return}try{this.emitSessionRequest(t)}catch(r){this.client.logger.error(r)}}),Y(this,"emitSessionRequest",t=>{if(this.emittedSessionRequests.has(t.id)){this.client.logger.warn({id:t.id},`Skipping emitting \`session_request\` event for duplicate request. id: ${t.id}`);return}this.sessionRequestQueue.state=zi.active,this.emittedSessionRequests.add(t.id),this.client.events.emit("session_request",t)}),Y(this,"onPairingCreated",t=>{if(t.methods&&this.expectedPairingMethodMap.set(t.topic,t.methods),t.active)return;const r=this.client.proposal.getAll().find(s=>s.pairingTopic===t.topic);r&&this.onSessionProposeRequest({topic:t.topic,payload:io("wc_sessionPropose",sr(_t({},r),{requiredNamespaces:r.requiredNamespaces,optionalNamespaces:r.optionalNamespaces,relays:r.relays,proposer:r.proposer,sessionProperties:r.sessionProperties,scopedProperties:r.scopedProperties}),r.id),attestation:r.attestation,encryptedId:r.encryptedId})}),Y(this,"isValidConnect",async t=>{if(!Yr(t)){const{message:l}=re("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(t)}`);throw new Error(l)}const{pairingTopic:r,requiredNamespaces:s,optionalNamespaces:i,sessionProperties:o,scopedProperties:a,relays:c}=t;if(Nn(r)||await this.isValidPairingTopic(r),!IJ(c)){const{message:l}=re("MISSING_OR_INVALID",`connect() relays: ${c}`);throw new Error(l)}if(!Nn(s)&&bo(s)!==0){const l="requiredNamespaces are deprecated and are automatically assigned to optionalNamespaces";["fatal","error","silent"].includes(this.client.logger.level)?console.warn(l):this.client.logger.warn(l),this.validateNamespaces(s,"requiredNamespaces")}if(!Nn(i)&&bo(i)!==0&&this.validateNamespaces(i,"optionalNamespaces"),Nn(o)||this.validateSessionProps(o,"sessionProperties"),!Nn(a)){this.validateSessionProps(a,"scopedProperties");const l=Object.keys(s||{}).concat(Object.keys(i||{}));if(!Object.keys(a).every(u=>l.includes(u.split(":")[0])))throw new Error(`Scoped properties must be a subset of required/optional namespaces, received: ${JSON.stringify(a)}, required/optional namespaces: ${JSON.stringify(l)}`)}}),Y(this,"validateNamespaces",(t,r)=>{const s=CJ(t,"connect()",r);if(s)throw new Error(s.message)}),Y(this,"isValidApprove",async t=>{if(!Yr(t))throw new Error(re("MISSING_OR_INVALID",`approve() params: ${t}`).message);const{id:r,namespaces:s,relayProtocol:i,sessionProperties:o,scopedProperties:a}=t;this.checkRecentlyDeleted(r),await this.isValidProposalId(r);const c=this.client.proposal.get(r),l=e1(s,"approve()");if(l)throw new Error(l.message);const u=bO(c.requiredNamespaces,s,"approve()");if(u)throw new Error(u.message);if(!fn(i,!0)){const{message:h}=re("MISSING_OR_INVALID",`approve() relayProtocol: ${i}`);throw new Error(h)}if(Nn(o)||this.validateSessionProps(o,"sessionProperties"),!Nn(a)){this.validateSessionProps(a,"scopedProperties");const h=new Set(Object.keys(s));if(!Object.keys(a).every(d=>h.has(d.split(":")[0])))throw new Error(`Scoped properties must be a subset of approved namespaces, received: ${JSON.stringify(a)}, approved namespaces: ${Array.from(h).join(", ")}`)}}),Y(this,"isValidReject",async t=>{if(!Yr(t)){const{message:i}=re("MISSING_OR_INVALID",`reject() params: ${t}`);throw new Error(i)}const{id:r,reason:s}=t;if(this.checkRecentlyDeleted(r),await this.isValidProposalId(r),!SJ(s)){const{message:i}=re("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(s)}`);throw new Error(i)}}),Y(this,"isValidSessionSettleRequest",t=>{if(!Yr(t)){const{message:l}=re("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${t}`);throw new Error(l)}const{relay:r,controller:s,namespaces:i,expiry:o}=t;if(!_$(r)){const{message:l}=re("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(l)}const a=yJ(s,"onSessionSettleRequest()");if(a)throw new Error(a.message);const c=e1(i,"onSessionSettleRequest()");if(c)throw new Error(c.message);if(Qa(o)){const{message:l}=re("EXPIRED","onSessionSettleRequest()");throw new Error(l)}}),Y(this,"isValidUpdate",async t=>{if(!Yr(t)){const{message:c}=re("MISSING_OR_INVALID",`update() params: ${t}`);throw new Error(c)}const{topic:r,namespaces:s}=t;this.checkRecentlyDeleted(r),await this.isValidSessionTopic(r);const i=this.client.session.get(r),o=e1(s,"update()");if(o)throw new Error(o.message);const a=bO(i.requiredNamespaces,s,"update()");if(a)throw new Error(a.message)}),Y(this,"isValidExtend",async t=>{if(!Yr(t)){const{message:s}=re("MISSING_OR_INVALID",`extend() params: ${t}`);throw new Error(s)}const{topic:r}=t;this.checkRecentlyDeleted(r),await this.isValidSessionTopic(r)}),Y(this,"isValidRequest",async t=>{if(!Yr(t)){const{message:c}=re("MISSING_OR_INVALID",`request() params: ${t}`);throw new Error(c)}const{topic:r,request:s,chainId:i,expiry:o}=t;this.checkRecentlyDeleted(r),await this.isValidSessionTopic(r);const{namespaces:a}=this.client.session.get(r);if(!wO(a,i)){const{message:c}=re("MISSING_OR_INVALID",`request() chainId: ${i}`);throw new Error(c)}if(!TJ(s)){const{message:c}=re("MISSING_OR_INVALID",`request() ${JSON.stringify(s)}`);throw new Error(c)}if(!xJ(a,i,s.method)){const{message:c}=re("MISSING_OR_INVALID",`request() method: ${s.method}`);throw new Error(c)}if(o&&!DJ(o,o1)){const{message:c}=re("MISSING_OR_INVALID",`request() expiry: ${o}. Expiry must be a number (in seconds) between ${o1.min} and ${o1.max}`);throw new Error(c)}}),Y(this,"isValidRespond",async t=>{var r;if(!Yr(t)){const{message:o}=re("MISSING_OR_INVALID",`respond() params: ${t}`);throw new Error(o)}const{topic:s,response:i}=t;try{await this.isValidSessionTopic(s)}catch(o){throw(r=t==null?void 0:t.response)!=null&&r.id&&this.cleanupAfterResponse(t),o}if(!NJ(i)){const{message:o}=re("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(i)}`);throw new Error(o)}}),Y(this,"isValidPing",async t=>{if(!Yr(t)){const{message:s}=re("MISSING_OR_INVALID",`ping() params: ${t}`);throw new Error(s)}const{topic:r}=t;await this.isValidSessionOrPairingTopic(r)}),Y(this,"isValidEmit",async t=>{if(!Yr(t)){const{message:a}=re("MISSING_OR_INVALID",`emit() params: ${t}`);throw new Error(a)}const{topic:r,event:s,chainId:i}=t;await this.isValidSessionTopic(r);const{namespaces:o}=this.client.session.get(r);if(!wO(o,i)){const{message:a}=re("MISSING_OR_INVALID",`emit() chainId: ${i}`);throw new Error(a)}if(!OJ(s)){const{message:a}=re("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(s)}`);throw new Error(a)}if(!RJ(o,i,s.name)){const{message:a}=re("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(s)}`);throw new Error(a)}}),Y(this,"isValidDisconnect",async t=>{if(!Yr(t)){const{message:s}=re("MISSING_OR_INVALID",`disconnect() params: ${t}`);throw new Error(s)}const{topic:r}=t;await this.isValidSessionOrPairingTopic(r)}),Y(this,"isValidAuthenticate",t=>{const{chains:r,uri:s,domain:i,nonce:o}=t;if(!Array.isArray(r)||r.length===0)throw new Error("chains is required and must be a non-empty array");if(!fn(s,!1))throw new Error("uri is required parameter");if(!fn(i,!1))throw new Error("domain is required parameter");if(!fn(o,!1))throw new Error("nonce is required parameter");if([...new Set(r.map(c=>ou(c).namespace))].length>1)throw new Error("Multi-namespace requests are not supported. Please request single namespace only.");const{namespace:a}=ou(r[0]);if(a!=="eip155")throw new Error("Only eip155 namespace is supported for authenticated sessions. Please use .connect() for non-eip155 chains.")}),Y(this,"getVerifyContext",async t=>{const{attestationId:r,hash:s,encryptedId:i,metadata:o,transportType:a}=t,c={verified:{verifyUrl:o.verifyUrl||Xp,validation:"UNKNOWN",origin:o.url||""}};try{if(a===Lt.link_mode){const u=this.getAppLinkIfEnabled(o,a);return c.verified.validation=u&&new URL(u).origin===new URL(o.url).origin?"VALID":"INVALID",c}const l=await this.client.core.verify.resolve({attestationId:r,hash:s,encryptedId:i,verifyUrl:o.verifyUrl});l&&(c.verified.origin=l.origin,c.verified.isScam=l.isScam,c.verified.validation=l.origin===new URL(o.url).origin?"VALID":"INVALID")}catch(l){this.client.logger.warn(l)}return this.client.logger.debug(`Verify context: ${JSON.stringify(c)}`),c}),Y(this,"validateSessionProps",(t,r)=>{Object.values(t).forEach((s,i)=>{if(s==null){const{message:o}=re("MISSING_OR_INVALID",`${r} must contain an existing value for each key. Received: ${s} for key ${Object.keys(t)[i]}`);throw new Error(o)}})}),Y(this,"getPendingAuthRequest",t=>{const r=this.client.auth.requests.get(t);return typeof r=="object"?r:void 0}),Y(this,"addToRecentlyDeleted",(t,r)=>{if(this.recentlyDeletedMap.set(t,r),this.recentlyDeletedMap.size>=this.recentlyDeletedLimit){let s=0;const i=this.recentlyDeletedLimit/2;for(const o of this.recentlyDeletedMap.keys()){if(s++>=i)break;this.recentlyDeletedMap.delete(o)}}}),Y(this,"checkRecentlyDeleted",t=>{const r=this.recentlyDeletedMap.get(t);if(r){const{message:s}=re("MISSING_OR_INVALID",`Record was recently deleted - ${r}: ${t}`);throw new Error(s)}}),Y(this,"isLinkModeEnabled",(t,r)=>{var s,i,o,a,c,l,u,h,d;return!t||r!==Lt.link_mode?!1:((i=(s=this.client.metadata)==null?void 0:s.redirect)==null?void 0:i.linkMode)===!0&&((a=(o=this.client.metadata)==null?void 0:o.redirect)==null?void 0:a.universal)!==void 0&&((l=(c=this.client.metadata)==null?void 0:c.redirect)==null?void 0:l.universal)!==""&&((u=t==null?void 0:t.redirect)==null?void 0:u.universal)!==void 0&&((h=t==null?void 0:t.redirect)==null?void 0:h.universal)!==""&&((d=t==null?void 0:t.redirect)==null?void 0:d.linkMode)===!0&&this.client.core.linkModeSupportedApps.includes(t.redirect.universal)&&typeof(global==null?void 0:global.Linking)<"u"}),Y(this,"getAppLinkIfEnabled",(t,r)=>{var s;return this.isLinkModeEnabled(t,r)?(s=t==null?void 0:t.redirect)==null?void 0:s.universal:void 0}),Y(this,"handleLinkModeMessage",({url:t})=>{if(!t||!t.includes("wc_ev")||!t.includes("topic"))return;const r=P2(t,"topic")||"",s=decodeURIComponent(P2(t,"wc_ev")||""),i=this.client.session.keys.includes(r);i&&this.client.session.update(r,{transportType:Lt.link_mode}),this.client.core.dispatchEnvelope({topic:r,message:s,sessionExists:i})}),Y(this,"registerLinkModeListeners",async()=>{var t;if(w_()||zc()&&(t=this.client.metadata.redirect)!=null&&t.linkMode){const r=global==null?void 0:global.Linking;if(typeof r<"u"){r.addEventListener("url",this.handleLinkModeMessage,this.client.name);const s=await r.getInitialURL();s&&setTimeout(()=>{this.handleLinkModeMessage({url:s})},50)}}}),Y(this,"getTVFParams",(t,r,s)=>{var i,o,a;if(!((i=r.request)!=null&&i.method))return{};const c={correlationId:t,rpcMethods:[r.request.method],chainId:r.chainId};try{const l=this.extractTxHashesFromResult(r.request,s);c.txHashes=l,c.contractAddresses=this.isValidContractData(r.request.params)?[(a=(o=r.request.params)==null?void 0:o[0])==null?void 0:a.to]:[]}catch(l){this.client.logger.warn("Error getting TVF params",l)}return c}),Y(this,"isValidContractData",t=>{var r;if(!t)return!1;try{const s=(t==null?void 0:t.data)||((r=t==null?void 0:t[0])==null?void 0:r.data);if(!s.startsWith("0x"))return!1;const i=s.slice(2);return/^[0-9a-fA-F]*$/.test(i)?i.length%2===0:!1}catch{}return!1}),Y(this,"extractTxHashesFromResult",(t,r)=>{var s;try{if(!r)return[];const i=t.method,o=Sre[i];if(i==="sui_signTransaction")return[nQ(r.transactionBytes)];if(i==="near_signTransaction")return[F2(r)];if(i==="near_signTransactions")return r.map(c=>F2(c));if(i==="xrpl_signTransactionFor"||i==="xrpl_signTransaction")return[(s=r.tx_json)==null?void 0:s.hash];if(i==="polkadot_signTransaction")return[YJ({transaction:t.params.transactionPayload,signature:r.signature})];if(i==="algo_signTxn")return ua(r)?r.map(c=>j2(c)):[j2(r)];if(i==="cosmos_signDirect")return[sQ(r)];if(typeof r=="string")return[r];const a=r[o.key];if(ua(a))return i==="solana_signAllTransactions"?a.map(c=>tQ(c)):a;if(typeof a=="string")return[a]}catch(i){this.client.logger.warn("Error extracting tx hashes from result",i)}return[]})}async processPendingMessageEvents(){try{const e=this.client.session.keys,t=this.client.core.relayer.messages.getWithoutAck(e);for(const[r,s]of Object.entries(t))for(const i of s)try{await this.onProviderMessageEvent({topic:r,message:i,publishedAt:Date.now()})}catch{this.client.logger.warn(`Error processing pending message event for topic: ${r}, message: ${i}`)}}catch(e){this.client.logger.warn("processPendingMessageEvents failed",e)}}isInitialized(){if(!this.initialized){const{message:e}=re("NOT_INITIALIZED",this.name);throw new Error(e)}}async confirmOnlineStateOrThrow(){await this.client.core.relayer.confirmOnlineStateOrThrow()}registerRelayerEvents(){this.client.core.relayer.on(en.message,e=>{this.onProviderMessageEvent(e)})}async onRelayMessage(e){const{topic:t,message:r,attestation:s,transportType:i}=e,{publicKey:o}=this.client.auth.authKeys.keys.includes(e0)?this.client.auth.authKeys.get(e0):{responseTopic:void 0,publicKey:void 0};try{const a=await this.client.core.crypto.decode(t,r,{receiverPublicKey:o,encoding:i===Lt.link_mode?nc:ts});k_(a)?(this.client.core.history.set(t,a),await this.onRelayEventRequest({topic:t,payload:a,attestation:s,transportType:i,encryptedId:Gs(r)})):aE(a)?(await this.client.core.history.resolve(a),await this.onRelayEventResponse({topic:t,payload:a,transportType:i}),this.client.core.history.delete(t,a.id)):await this.onRelayEventUnknownPayload({topic:t,payload:a,transportType:i}),await this.client.core.relayer.messages.ack(t,r)}catch(a){this.client.logger.error(a)}}registerExpirerEvents(){this.client.core.expirer.on(Fs.expired,async e=>{const{topic:t,id:r}=kU(e.target);if(r&&this.client.pendingRequest.keys.includes(r))return await this.deletePendingSessionRequest(r,re("EXPIRED"),!0);if(r&&this.client.auth.requests.keys.includes(r))return await this.deletePendingAuthRequest(r,re("EXPIRED"),!0);t?this.client.session.keys.includes(t)&&(await this.deleteSession({topic:t,expirerHasDeleted:!0}),this.client.events.emit("session_expire",{topic:t})):r&&(await this.deleteProposal(r,!0),this.client.events.emit("proposal_expire",{id:r}))})}registerPairingEvents(){this.client.core.pairing.events.on(pl.create,e=>this.onPairingCreated(e)),this.client.core.pairing.events.on(pl.delete,e=>{this.addToRecentlyDeleted(e.topic,"pairing")})}isValidPairingTopic(e){if(!fn(e,!1)){const{message:t}=re("MISSING_OR_INVALID",`pairing topic should be a string: ${e}`);throw new Error(t)}if(!this.client.core.pairing.pairings.keys.includes(e)){const{message:t}=re("NO_MATCHING_KEY",`pairing topic doesn't exist: ${e}`);throw new Error(t)}if(Qa(this.client.core.pairing.pairings.get(e).expiry)){const{message:t}=re("EXPIRED",`pairing topic: ${e}`);throw new Error(t)}}async isValidSessionTopic(e){if(!fn(e,!1)){const{message:t}=re("MISSING_OR_INVALID",`session topic should be a string: ${e}`);throw new Error(t)}if(this.checkRecentlyDeleted(e),!this.client.session.keys.includes(e)){const{message:t}=re("NO_MATCHING_KEY",`session topic doesn't exist: ${e}`);throw new Error(t)}if(Qa(this.client.session.get(e).expiry)){await this.deleteSession({topic:e});const{message:t}=re("EXPIRED",`session topic: ${e}`);throw new Error(t)}if(!this.client.core.crypto.keychain.has(e)){const{message:t}=re("MISSING_OR_INVALID",`session topic does not exist in keychain: ${e}`);throw await this.deleteSession({topic:e}),new Error(t)}}async isValidSessionOrPairingTopic(e){if(this.checkRecentlyDeleted(e),this.client.session.keys.includes(e))await this.isValidSessionTopic(e);else if(this.client.core.pairing.pairings.keys.includes(e))this.isValidPairingTopic(e);else if(fn(e,!1)){const{message:t}=re("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${e}`);throw new Error(t)}else{const{message:t}=re("MISSING_OR_INVALID",`session or pairing topic should be a string: ${e}`);throw new Error(t)}}async isValidProposalId(e){if(!_J(e)){const{message:t}=re("MISSING_OR_INVALID",`proposal id should be a number: ${e}`);throw new Error(t)}if(!this.client.proposal.keys.includes(e)){const{message:t}=re("NO_MATCHING_KEY",`proposal id doesn't exist: ${e}`);throw new Error(t)}if(Qa(this.client.proposal.get(e).expiryTimestamp)){await this.deleteProposal(e);const{message:t}=re("EXPIRED",`proposal id: ${e}`);throw new Error(t)}}},Fre=class extends Hu{constructor(e,t){super(e,t,Cre,D_),this.core=e,this.logger=t}},jre=class extends Hu{constructor(e,t){super(e,t,Ire,D_),this.core=e,this.logger=t}},Hre=class extends Hu{constructor(e,t){super(e,t,Tre,D_,r=>r.id),this.core=e,this.logger=t}},Vre=class extends Hu{constructor(e,t){super(e,t,Rre,lE,()=>e0),this.core=e,this.logger=t}},qre=class extends Hu{constructor(e,t){super(e,t,Pre,lE),this.core=e,this.logger=t}},zre=class extends Hu{constructor(e,t){super(e,t,kre,lE,r=>r.id),this.core=e,this.logger=t}};var Wre=Object.defineProperty,Gre=(n,e,t)=>e in n?Wre(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,a1=(n,e,t)=>Gre(n,typeof e!="symbol"?e+"":e,t);let Kre=class{constructor(e,t){this.core=e,this.logger=t,a1(this,"authKeys"),a1(this,"pairingTopics"),a1(this,"requests"),this.authKeys=new Vre(this.core,this.logger),this.pairingTopics=new qre(this.core,this.logger),this.requests=new zre(this.core,this.logger)}async init(){await this.authKeys.init(),await this.pairingTopics.init(),await this.requests.init()}};var Yre=Object.defineProperty,Qre=(n,e,t)=>e in n?Yre(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,et=(n,e,t)=>Qre(n,typeof e!="symbol"?e+"":e,t);let Zre=class X$ extends ZH{constructor(e){super(e),et(this,"protocol",Q$),et(this,"version",Z$),et(this,"name",i1.name),et(this,"metadata"),et(this,"core"),et(this,"logger"),et(this,"events",new ii.EventEmitter),et(this,"engine"),et(this,"session"),et(this,"proposal"),et(this,"pendingRequest"),et(this,"auth"),et(this,"signConfig"),et(this,"on",(r,s)=>this.events.on(r,s)),et(this,"once",(r,s)=>this.events.once(r,s)),et(this,"off",(r,s)=>this.events.off(r,s)),et(this,"removeListener",(r,s)=>this.events.removeListener(r,s)),et(this,"removeAllListeners",r=>this.events.removeAllListeners(r)),et(this,"connect",async r=>{try{return await this.engine.connect(r)}catch(s){throw this.logger.error(s.message),s}}),et(this,"pair",async r=>{try{return await this.engine.pair(r)}catch(s){throw this.logger.error(s.message),s}}),et(this,"approve",async r=>{try{return await this.engine.approve(r)}catch(s){throw this.logger.error(s.message),s}}),et(this,"reject",async r=>{try{return await this.engine.reject(r)}catch(s){throw this.logger.error(s.message),s}}),et(this,"update",async r=>{try{return await this.engine.update(r)}catch(s){throw this.logger.error(s.message),s}}),et(this,"extend",async r=>{try{return await this.engine.extend(r)}catch(s){throw this.logger.error(s.message),s}}),et(this,"request",async r=>{try{return await this.engine.request(r)}catch(s){throw this.logger.error(s.message),s}}),et(this,"respond",async r=>{try{return await this.engine.respond(r)}catch(s){throw this.logger.error(s.message),s}}),et(this,"ping",async r=>{try{return await this.engine.ping(r)}catch(s){throw this.logger.error(s.message),s}}),et(this,"emit",async r=>{try{return await this.engine.emit(r)}catch(s){throw this.logger.error(s.message),s}}),et(this,"disconnect",async r=>{try{return await this.engine.disconnect(r)}catch(s){throw this.logger.error(s.message),s}}),et(this,"find",r=>{try{return this.engine.find(r)}catch(s){throw this.logger.error(s.message),s}}),et(this,"getPendingSessionRequests",()=>{try{return this.engine.getPendingSessionRequests()}catch(r){throw this.logger.error(r.message),r}}),et(this,"authenticate",async(r,s)=>{try{return await this.engine.authenticate(r,s)}catch(i){throw this.logger.error(i.message),i}}),et(this,"formatAuthMessage",r=>{try{return this.engine.formatAuthMessage(r)}catch(s){throw this.logger.error(s.message),s}}),et(this,"approveSessionAuthenticate",async r=>{try{return await this.engine.approveSessionAuthenticate(r)}catch(s){throw this.logger.error(s.message),s}}),et(this,"rejectSessionAuthenticate",async r=>{try{return await this.engine.rejectSessionAuthenticate(r)}catch(s){throw this.logger.error(s.message),s}}),this.name=(e==null?void 0:e.name)||i1.name,this.metadata=GK(e==null?void 0:e.metadata),this.signConfig=e==null?void 0:e.signConfig;const t=typeof(e==null?void 0:e.logger)<"u"&&typeof(e==null?void 0:e.logger)!="string"?e.logger:cy(Rf({level:(e==null?void 0:e.logger)||i1.logger}));this.core=(e==null?void 0:e.core)||new Are(e),this.logger=vr(t,this.name),this.session=new jre(this.core,this.logger),this.proposal=new Fre(this.core,this.logger),this.pendingRequest=new Hre(this.core,this.logger),this.engine=new Bre(this),this.auth=new Kre(this.core,this.logger)}static async init(e){const t=new X$(e);return await t.initialize(),t}get context(){return hs(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.auth.init(),await this.engine.init(),this.logger.info("SignClient Initialization Success")}catch(e){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(e.message),e}}};var hC={exports:{}};(function(n,e){var t=typeof globalThis<"u"&&globalThis||typeof self<"u"&&self||typeof so<"u"&&so,r=function(){function i(){this.fetch=!1,this.DOMException=t.DOMException}return i.prototype=t,new i}();(function(i){(function(o){var a=typeof i<"u"&&i||typeof self<"u"&&self||typeof so<"u"&&so||{},c={searchParams:"URLSearchParams"in a,iterable:"Symbol"in a&&"iterator"in Symbol,blob:"FileReader"in a&&"Blob"in a&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in a,arrayBuffer:"ArrayBuffer"in a};function l(E){return E&&DataView.prototype.isPrototypeOf(E)}if(c.arrayBuffer)var u=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],h=ArrayBuffer.isView||function(E){return E&&u.indexOf(Object.prototype.toString.call(E))>-1};function d(E){if(typeof E!="string"&&(E=String(E)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(E)||E==="")throw new TypeError('Invalid character in header field name: "'+E+'"');return E.toLowerCase()}function f(E){return typeof E!="string"&&(E=String(E)),E}function p(E){var C={next:function(){var O=E.shift();return{done:O===void 0,value:O}}};return c.iterable&&(C[Symbol.iterator]=function(){return C}),C}function g(E){this.map={},E instanceof g?E.forEach(function(C,O){this.append(O,C)},this):Array.isArray(E)?E.forEach(function(C){if(C.length!=2)throw new TypeError("Headers constructor: expected name/value pair to be length 2, found"+C.length);this.append(C[0],C[1])},this):E&&Object.getOwnPropertyNames(E).forEach(function(C){this.append(C,E[C])},this)}g.prototype.append=function(E,C){E=d(E),C=f(C);var O=this.map[E];this.map[E]=O?O+", "+C:C},g.prototype.delete=function(E){delete this.map[d(E)]},g.prototype.get=function(E){return E=d(E),this.has(E)?this.map[E]:null},g.prototype.has=function(E){return this.map.hasOwnProperty(d(E))},g.prototype.set=function(E,C){this.map[d(E)]=f(C)},g.prototype.forEach=function(E,C){for(var O in this.map)this.map.hasOwnProperty(O)&&E.call(C,this.map[O],O,this)},g.prototype.keys=function(){var E=[];return this.forEach(function(C,O){E.push(O)}),p(E)},g.prototype.values=function(){var E=[];return this.forEach(function(C){E.push(C)}),p(E)},g.prototype.entries=function(){var E=[];return this.forEach(function(C,O){E.push([O,C])}),p(E)},c.iterable&&(g.prototype[Symbol.iterator]=g.prototype.entries);function m(E){if(!E._noBody){if(E.bodyUsed)return Promise.reject(new TypeError("Already read"));E.bodyUsed=!0}}function w(E){return new Promise(function(C,O){E.onload=function(){C(E.result)},E.onerror=function(){O(E.error)}})}function v(E){var C=new FileReader,O=w(C);return C.readAsArrayBuffer(E),O}function A(E){var C=new FileReader,O=w(C),U=/charset=([A-Za-z0-9_-]+)/.exec(E.type),k=U?U[1]:"utf-8";return C.readAsText(E,k),O}function T(E){for(var C=new Uint8Array(E),O=new Array(C.length),U=0;U<C.length;U++)O[U]=String.fromCharCode(C[U]);return O.join("")}function N(E){if(E.slice)return E.slice(0);var C=new Uint8Array(E.byteLength);return C.set(new Uint8Array(E)),C.buffer}function R(){return this.bodyUsed=!1,this._initBody=function(E){this.bodyUsed=this.bodyUsed,this._bodyInit=E,E?typeof E=="string"?this._bodyText=E:c.blob&&Blob.prototype.isPrototypeOf(E)?this._bodyBlob=E:c.formData&&FormData.prototype.isPrototypeOf(E)?this._bodyFormData=E:c.searchParams&&URLSearchParams.prototype.isPrototypeOf(E)?this._bodyText=E.toString():c.arrayBuffer&&c.blob&&l(E)?(this._bodyArrayBuffer=N(E.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):c.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(E)||h(E))?this._bodyArrayBuffer=N(E):this._bodyText=E=Object.prototype.toString.call(E):(this._noBody=!0,this._bodyText=""),this.headers.get("content-type")||(typeof E=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):c.searchParams&&URLSearchParams.prototype.isPrototypeOf(E)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},c.blob&&(this.blob=function(){var E=m(this);if(E)return E;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))}),this.arrayBuffer=function(){if(this._bodyArrayBuffer){var E=m(this);return E||(ArrayBuffer.isView(this._bodyArrayBuffer)?Promise.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):Promise.resolve(this._bodyArrayBuffer))}else{if(c.blob)return this.blob().then(v);throw new Error("could not read as ArrayBuffer")}},this.text=function(){var E=m(this);if(E)return E;if(this._bodyBlob)return A(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(T(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},c.formData&&(this.formData=function(){return this.text().then($)}),this.json=function(){return this.text().then(JSON.parse)},this}var M=["CONNECT","DELETE","GET","HEAD","OPTIONS","PATCH","POST","PUT","TRACE"];function D(E){var C=E.toUpperCase();return M.indexOf(C)>-1?C:E}function S(E,C){if(!(this instanceof S))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');C=C||{};var O=C.body;if(E instanceof S){if(E.bodyUsed)throw new TypeError("Already read");this.url=E.url,this.credentials=E.credentials,C.headers||(this.headers=new g(E.headers)),this.method=E.method,this.mode=E.mode,this.signal=E.signal,!O&&E._bodyInit!=null&&(O=E._bodyInit,E.bodyUsed=!0)}else this.url=String(E);if(this.credentials=C.credentials||this.credentials||"same-origin",(C.headers||!this.headers)&&(this.headers=new g(C.headers)),this.method=D(C.method||this.method||"GET"),this.mode=C.mode||this.mode||null,this.signal=C.signal||this.signal||function(){if("AbortController"in a){var j=new AbortController;return j.signal}}(),this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&O)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(O),(this.method==="GET"||this.method==="HEAD")&&(C.cache==="no-store"||C.cache==="no-cache")){var U=/([?&])_=[^&]*/;if(U.test(this.url))this.url=this.url.replace(U,"$1_="+new Date().getTime());else{var k=/\?/;this.url+=(k.test(this.url)?"&":"?")+"_="+new Date().getTime()}}}S.prototype.clone=function(){return new S(this,{body:this._bodyInit})};function $(E){var C=new FormData;return E.trim().split("&").forEach(function(O){if(O){var U=O.split("="),k=U.shift().replace(/\+/g," "),j=U.join("=").replace(/\+/g," ");C.append(decodeURIComponent(k),decodeURIComponent(j))}}),C}function P(E){var C=new g,O=E.replace(/\r?\n[\t ]+/g," ");return O.split("\r").map(function(U){return U.indexOf(`
`)===0?U.substr(1,U.length):U}).forEach(function(U){var k=U.split(":"),j=k.shift().trim();if(j){var q=k.join(":").trim();try{C.append(j,q)}catch(X){console.warn("Response "+X.message)}}}),C}R.call(S.prototype);function L(E,C){if(!(this instanceof L))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');if(C||(C={}),this.type="default",this.status=C.status===void 0?200:C.status,this.status<200||this.status>599)throw new RangeError("Failed to construct 'Response': The status provided (0) is outside the range [200, 599].");this.ok=this.status>=200&&this.status<300,this.statusText=C.statusText===void 0?"":""+C.statusText,this.headers=new g(C.headers),this.url=C.url||"",this._initBody(E)}R.call(L.prototype),L.prototype.clone=function(){return new L(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new g(this.headers),url:this.url})},L.error=function(){var E=new L(null,{status:200,statusText:""});return E.ok=!1,E.status=0,E.type="error",E};var V=[301,302,303,307,308];L.redirect=function(E,C){if(V.indexOf(C)===-1)throw new RangeError("Invalid status code");return new L(null,{status:C,headers:{location:E}})},o.DOMException=a.DOMException;try{new o.DOMException}catch{o.DOMException=function(C,O){this.message=C,this.name=O;var U=Error(C);this.stack=U.stack},o.DOMException.prototype=Object.create(Error.prototype),o.DOMException.prototype.constructor=o.DOMException}function G(E,C){return new Promise(function(O,U){var k=new S(E,C);if(k.signal&&k.signal.aborted)return U(new o.DOMException("Aborted","AbortError"));var j=new XMLHttpRequest;function q(){j.abort()}j.onload=function(){var te={statusText:j.statusText,headers:P(j.getAllResponseHeaders()||"")};k.url.indexOf("file://")===0&&(j.status<200||j.status>599)?te.status=200:te.status=j.status,te.url="responseURL"in j?j.responseURL:te.headers.get("X-Request-URL");var de="response"in j?j.response:j.responseText;setTimeout(function(){O(new L(de,te))},0)},j.onerror=function(){setTimeout(function(){U(new TypeError("Network request failed"))},0)},j.ontimeout=function(){setTimeout(function(){U(new TypeError("Network request timed out"))},0)},j.onabort=function(){setTimeout(function(){U(new o.DOMException("Aborted","AbortError"))},0)};function X(te){try{return te===""&&a.location.href?a.location.href:te}catch{return te}}if(j.open(k.method,X(k.url),!0),k.credentials==="include"?j.withCredentials=!0:k.credentials==="omit"&&(j.withCredentials=!1),"responseType"in j&&(c.blob?j.responseType="blob":c.arrayBuffer&&(j.responseType="arraybuffer")),C&&typeof C.headers=="object"&&!(C.headers instanceof g||a.Headers&&C.headers instanceof a.Headers)){var ce=[];Object.getOwnPropertyNames(C.headers).forEach(function(te){ce.push(d(te)),j.setRequestHeader(te,f(C.headers[te]))}),k.headers.forEach(function(te,de){ce.indexOf(de)===-1&&j.setRequestHeader(de,te)})}else k.headers.forEach(function(te,de){j.setRequestHeader(de,te)});k.signal&&(k.signal.addEventListener("abort",q),j.onreadystatechange=function(){j.readyState===4&&k.signal.removeEventListener("abort",q)}),j.send(typeof k._bodyInit>"u"?null:k._bodyInit)})}return G.polyfill=!0,a.fetch||(a.fetch=G,a.Headers=g,a.Request=S,a.Response=L),o.Headers=g,o.Request=S,o.Response=L,o.fetch=G,Object.defineProperty(o,"__esModule",{value:!0}),o})({})})(r),r.fetch.ponyfill=!0,delete r.fetch.polyfill;var s=t.fetch?t:r;e=s.fetch,e.default=s.fetch,e.fetch=s.fetch,e.Headers=s.Headers,e.Request=s.Request,e.Response=s.Response,n.exports=e})(hC,hC.exports);var Jre=hC.exports;const nx=FI(Jre);var Xre=Object.defineProperty,ese=Object.defineProperties,tse=Object.getOwnPropertyDescriptors,rx=Object.getOwnPropertySymbols,nse=Object.prototype.hasOwnProperty,rse=Object.prototype.propertyIsEnumerable,sx=(n,e,t)=>e in n?Xre(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,ix=(n,e)=>{for(var t in e||(e={}))nse.call(e,t)&&sx(n,t,e[t]);if(rx)for(var t of rx(e))rse.call(e,t)&&sx(n,t,e[t]);return n},ox=(n,e)=>ese(n,tse(e));const sse={Accept:"application/json","Content-Type":"application/json"},ise="POST",ax={headers:sse,method:ise},cx=10;let Bi=class{constructor(e,t=!1){if(this.url=e,this.disableProviderPing=t,this.events=new ii.EventEmitter,this.isAvailable=!1,this.registering=!1,!_O(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);this.url=e,this.disableProviderPing=t}get connected(){return this.isAvailable}get connecting(){return this.registering}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async open(e=this.url){await this.register(e)}async close(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}async send(e){this.isAvailable||await this.register();try{const t=ma(e),r=await(await nx(this.url,ox(ix({},ax),{body:t}))).json();this.onPayload({data:r})}catch(t){this.onError(e.id,t)}}async register(e=this.url){if(!_O(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);if(this.registering){const t=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=t||this.events.listenerCount("open")>=t)&&this.events.setMaxListeners(t+1),new Promise((r,s)=>{this.events.once("register_error",i=>{this.resetMaxListeners(),s(i)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return s(new Error("HTTP connection is missing or invalid"));r()})})}this.url=e,this.registering=!0;try{if(!this.disableProviderPing){const t=ma({id:1,jsonrpc:"2.0",method:"test",params:[]});await nx(e,ox(ix({},ax),{body:t}))}this.onOpen()}catch(t){const r=this.parseError(t);throw this.events.emit("register_error",r),this.onClose(),r}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(e){if(typeof e.data>"u")return;const t=typeof e.data=="string"?fu(e.data):e.data;this.events.emit("payload",t)}onError(e,t){const r=this.parseError(t),s=r.message||r.toString(),i=oE(e,s);this.events.emit("payload",i)}parseError(e,t=this.url){return N$(e,t,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>cx&&this.events.setMaxListeners(cx)}};const lx="error",ose="wss://relay.walletconnect.org",ase="wc",cse="universal_provider",ww=`${ase}@2:${cse}:`,eM="https://rpc.walletconnect.org/v1/",tM="generic",lse=`${eM}bundler`,ai={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};function U_(n){return n==null||typeof n!="object"&&typeof n!="function"}function nM(n){return Object.getOwnPropertySymbols(n).filter(e=>Object.prototype.propertyIsEnumerable.call(n,e))}function rM(n){return n==null?n===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(n)}const use="[object RegExp]",sM="[object String]",iM="[object Number]",oM="[object Boolean]",aM="[object Arguments]",hse="[object Symbol]",dse="[object Date]",fse="[object Map]",pse="[object Set]",gse="[object Array]",mse="[object ArrayBuffer]",yse="[object Object]",wse="[object DataView]",bse="[object Uint8Array]",Ese="[object Uint8ClampedArray]",vse="[object Uint16Array]",Ase="[object Uint32Array]",Cse="[object Int8Array]",Ise="[object Int16Array]",_se="[object Int32Array]",Sse="[object Float32Array]",Tse="[object Float64Array]";function $_(n){return ArrayBuffer.isView(n)&&!(n instanceof DataView)}function Nse(n,e){return Bh(n,void 0,n,new Map,e)}function Bh(n,e,t,r=new Map,s=void 0){const i=s==null?void 0:s(n,e,t,r);if(i!=null)return i;if(U_(n))return n;if(r.has(n))return r.get(n);if(Array.isArray(n)){const o=new Array(n.length);r.set(n,o);for(let a=0;a<n.length;a++)o[a]=Bh(n[a],a,t,r,s);return Object.hasOwn(n,"index")&&(o.index=n.index),Object.hasOwn(n,"input")&&(o.input=n.input),o}if(n instanceof Date)return new Date(n.getTime());if(n instanceof RegExp){const o=new RegExp(n.source,n.flags);return o.lastIndex=n.lastIndex,o}if(n instanceof Map){const o=new Map;r.set(n,o);for(const[a,c]of n)o.set(a,Bh(c,a,t,r,s));return o}if(n instanceof Set){const o=new Set;r.set(n,o);for(const a of n)o.add(Bh(a,void 0,t,r,s));return o}if(typeof Buffer<"u"&&Buffer.isBuffer(n))return n.subarray();if($_(n)){const o=new(Object.getPrototypeOf(n)).constructor(n.length);r.set(n,o);for(let a=0;a<n.length;a++)o[a]=Bh(n[a],a,t,r,s);return o}if(n instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&n instanceof SharedArrayBuffer)return n.slice(0);if(n instanceof DataView){const o=new DataView(n.buffer.slice(0),n.byteOffset,n.byteLength);return r.set(n,o),gl(o,n,t,r,s),o}if(typeof File<"u"&&n instanceof File){const o=new File([n],n.name,{type:n.type});return r.set(n,o),gl(o,n,t,r,s),o}if(n instanceof Blob){const o=new Blob([n],{type:n.type});return r.set(n,o),gl(o,n,t,r,s),o}if(n instanceof Error){const o=new n.constructor;return r.set(n,o),o.message=n.message,o.name=n.name,o.stack=n.stack,o.cause=n.cause,gl(o,n,t,r,s),o}if(typeof n=="object"&&Ose(n)){const o=Object.create(Object.getPrototypeOf(n));return r.set(n,o),gl(o,n,t,r,s),o}return n}function gl(n,e,t=n,r,s){const i=[...Object.keys(e),...nM(e)];for(let o=0;o<i.length;o++){const a=i[o],c=Object.getOwnPropertyDescriptor(n,a);(c==null||c.writable)&&(n[a]=Bh(e[a],a,t,r,s))}}function Ose(n){switch(rM(n)){case aM:case gse:case mse:case wse:case oM:case dse:case Sse:case Tse:case Cse:case Ise:case _se:case fse:case iM:case yse:case use:case pse:case sM:case hse:case bse:case Ese:case vse:case Ase:return!0;default:return!1}}function xse(n,e){return Nse(n,(t,r,s,i)=>{if(typeof n=="object")switch(Object.prototype.toString.call(n)){case iM:case sM:case oM:{const o=new n.constructor(n==null?void 0:n.valueOf());return gl(o,n),o}case aM:{const o={};return gl(o,n),o.length=n.length,o[Symbol.iterator]=n[Symbol.iterator],o}default:return}})}function ux(n){return xse(n)}function hx(n){return n!==null&&typeof n=="object"&&rM(n)==="[object Arguments]"}function dx(n){return typeof n=="object"&&n!==null}function Rse(){}function Pse(n){return $_(n)}function kse(n){var t;if(typeof n!="object"||n==null)return!1;if(Object.getPrototypeOf(n)===null)return!0;if(Object.prototype.toString.call(n)!=="[object Object]"){const r=n[Symbol.toStringTag];return r==null||!((t=Object.getOwnPropertyDescriptor(n,Symbol.toStringTag))!=null&&t.writable)?!1:n.toString()===`[object ${r}]`}let e=n;for(;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(n)===e}function Dse(n){if(U_(n))return n;if(Array.isArray(n)||$_(n)||n instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&n instanceof SharedArrayBuffer)return n.slice(0);const e=Object.getPrototypeOf(n),t=e.constructor;if(n instanceof Date||n instanceof Map||n instanceof Set)return new t(n);if(n instanceof RegExp){const r=new t(n);return r.lastIndex=n.lastIndex,r}if(n instanceof DataView)return new t(n.buffer.slice(0));if(n instanceof Error){const r=new t(n.message);return r.stack=n.stack,r.name=n.name,r.cause=n.cause,r}if(typeof File<"u"&&n instanceof File)return new t([n],n.name,{type:n.type,lastModified:n.lastModified});if(typeof n=="object"){const r=Object.create(e);return Object.assign(r,n)}return n}function Use(n,...e){const t=e.slice(0,-1),r=e[e.length-1];let s=n;for(let i=0;i<t.length;i++){const o=t[i];s=dC(s,o,r,new Map)}return s}function dC(n,e,t,r){if(U_(n)&&(n=Object(n)),e==null||typeof e!="object")return n;if(r.has(e))return Dse(r.get(e));if(r.set(e,n),Array.isArray(e)){e=e.slice();for(let i=0;i<e.length;i++)e[i]=e[i]??void 0}const s=[...Object.keys(e),...nM(e)];for(let i=0;i<s.length;i++){const o=s[i];let a=e[o],c=n[o];if(hx(a)&&(a={...a}),hx(c)&&(c={...c}),typeof Buffer<"u"&&Buffer.isBuffer(a)&&(a=ux(a)),Array.isArray(a))if(typeof c=="object"&&c!=null){const u=[],h=Reflect.ownKeys(c);for(let d=0;d<h.length;d++){const f=h[d];u[f]=c[f]}c=u}else c=[];const l=t(c,a,o,n,e,r);l!=null?n[o]=l:Array.isArray(a)||dx(c)&&dx(a)?n[o]=dC(c,a,t,r):c==null&&kse(a)?n[o]=dC({},a,t,r):c==null&&Pse(a)?n[o]=ux(a):(c===void 0||a!==void 0)&&(n[o]=a)}return n}function $se(n,...e){return Use(n,...e,Rse)}var Mse=Object.defineProperty,Lse=Object.defineProperties,Bse=Object.getOwnPropertyDescriptors,fx=Object.getOwnPropertySymbols,Fse=Object.prototype.hasOwnProperty,jse=Object.prototype.propertyIsEnumerable,px=(n,e,t)=>e in n?Mse(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,bw=(n,e)=>{for(var t in e||(e={}))Fse.call(e,t)&&px(n,t,e[t]);if(fx)for(var t of fx(e))jse.call(e,t)&&px(n,t,e[t]);return n},Hse=(n,e)=>Lse(n,Bse(e));function Os(n,e,t){var r;const s=ou(n);return((r=e.rpcMap)==null?void 0:r[s.reference])||`${eM}?chainId=${s.namespace}:${s.reference}&projectId=${t}`}function Vu(n){return n.includes(":")?n.split(":")[1]:n}function cM(n){return n.map(e=>`${e.split(":")[0]}:${e.split(":")[1]}`)}function Vse(n,e){const t=Object.keys(e.namespaces).filter(s=>s.includes(n));if(!t.length)return[];const r=[];return t.forEach(s=>{const i=e.namespaces[s].accounts;r.push(...i)}),r}function gx(n){return Object.fromEntries(Object.entries(n).filter(([e,t])=>{var r,s;return((r=t==null?void 0:t.chains)==null?void 0:r.length)&&((s=t==null?void 0:t.chains)==null?void 0:s.length)>0}))}function Ew(n={},e={}){const t=gx(mx(n)),r=gx(mx(e));return $se(t,r)}function mx(n){var e,t,r,s,i;const o={};if(!bo(n))return o;for(const[a,c]of Object.entries(n)){const l=iE(a)?[a]:c.chains,u=c.methods||[],h=c.events||[],d=c.rpcMap||{},f=Lh(a);o[f]=Hse(bw(bw({},o[f]),c),{chains:wo(l,(e=o[f])==null?void 0:e.chains),methods:wo(u,(t=o[f])==null?void 0:t.methods),events:wo(h,(r=o[f])==null?void 0:r.events)}),(bo(d)||bo(((s=o[f])==null?void 0:s.rpcMap)||{}))&&(o[f].rpcMap=bw(bw({},d),(i=o[f])==null?void 0:i.rpcMap))}return o}function yx(n){return n.includes(":")?n.split(":")[2]:n}function wx(n){const e={};for(const[t,r]of Object.entries(n)){const s=r.methods||[],i=r.events||[],o=r.accounts||[],a=iE(t)?[t]:r.chains?r.chains:cM(r.accounts);e[t]={chains:a,methods:s,events:i,accounts:o}}return e}function c1(n){return typeof n=="number"?n:n.includes("0x")?parseInt(n,16):(n=n.includes(":")?n.split(":")[1]:n,isNaN(Number(n))?n:Number(n))}const lM={},wt=n=>lM[n],l1=(n,e)=>{lM[n]=e};var qse=Object.defineProperty,bx=Object.getOwnPropertySymbols,zse=Object.prototype.hasOwnProperty,Wse=Object.prototype.propertyIsEnumerable,Ex=(n,e,t)=>e in n?qse(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,vx=(n,e)=>{for(var t in e||(e={}))zse.call(e,t)&&Ex(n,t,e[t]);if(bx)for(var t of bx(e))Wse.call(e,t)&&Ex(n,t,e[t]);return n};const Ax="eip155",Gse=["atomic","flow-control","paymasterService","sessionKeys","auxiliaryFunds"],Kse=n=>n&&n.startsWith("0x")?BigInt(n).toString(10):n,u1=n=>n&&n.startsWith("0x")?n:`0x${BigInt(n).toString(16)}`,Cx=n=>Object.keys(n).filter(e=>Gse.includes(e)).reduce((e,t)=>(e[t]=n[t],e),{}),Yse=(n,e,t)=>{const{sessionProperties:r={},scopedProperties:s={}}=n,i={};if(!bo(s)&&!bo(r))return;const o=Cx(r);for(const a of t){const c=Kse(a);if(!c)continue;i[u1(c)]=o;const l=s==null?void 0:s[`${Ax}:${c}`];if(l){const u=l==null?void 0:l[`${Ax}:${c}:${e}`];i[u1(c)]=vx(vx({},i[u1(c)]),Cx(u||l))}}for(const[a,c]of Object.entries(i))Object.keys(c).length===0&&delete i[a];return Object.keys(i).length>0?i:void 0};var Qse=Object.defineProperty,Zse=(n,e,t)=>e in n?Qse(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,ch=(n,e,t)=>Zse(n,typeof e!="symbol"?e+"":e,t);let Jse=class{constructor(e){ch(this,"name","polkadot"),ch(this,"client"),ch(this,"httpProviders"),ch(this,"events"),ch(this,"namespace"),ch(this,"chainId"),this.namespace=e.namespace,this.events=wt("events"),this.client=wt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(ai.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getAccounts(){const e=this.namespace.accounts;return e?e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var r;const s=Vu(t);e[s]=this.createHttpProvider(s,(r=this.namespace.rpcMap)==null?void 0:r[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const r=this.createHttpProvider(e,t);r&&(this.httpProviders[e]=r)}createHttpProvider(e,t){const r=t||Os(e,this.namespace,this.client.core.projectId);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);return new oi(new Bi(r,wt("disableProviderPing")))}};var Xse=Object.defineProperty,eie=Object.defineProperties,tie=Object.getOwnPropertyDescriptors,Ix=Object.getOwnPropertySymbols,nie=Object.prototype.hasOwnProperty,rie=Object.prototype.propertyIsEnumerable,fC=(n,e,t)=>e in n?Xse(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,_x=(n,e)=>{for(var t in e||(e={}))nie.call(e,t)&&fC(n,t,e[t]);if(Ix)for(var t of Ix(e))rie.call(e,t)&&fC(n,t,e[t]);return n},Sx=(n,e)=>eie(n,tie(e)),lh=(n,e,t)=>fC(n,typeof e!="symbol"?e+"":e,t);let sie=class{constructor(e){lh(this,"name","eip155"),lh(this,"client"),lh(this,"chainId"),lh(this,"namespace"),lh(this,"httpProviders"),lh(this,"events"),this.namespace=e.namespace,this.events=wt("events"),this.client=wt("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(e){switch(e.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(e);case"eth_chainId":return parseInt(this.getDefaultChain());case"wallet_getCapabilities":return await this.getCapabilities(e);case"wallet_getCallsStatus":return await this.getCallStatus(e)}return this.namespace.methods.includes(e.request.method)?await this.client.request(e):this.getHttpProvider().request(e.request)}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(parseInt(e),t),this.chainId=parseInt(e),this.events.emit(ai.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}createHttpProvider(e,t){const r=t||Os(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);return new oi(new Bi(r,wt("disableProviderPing")))}setHttpProvider(e,t){const r=this.createHttpProvider(e,t);r&&(this.httpProviders[e]=r)}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var r;const s=parseInt(Vu(t));e[s]=this.createHttpProvider(s,(r=this.namespace.rpcMap)==null?void 0:r[t])}),e}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}getHttpProvider(){const e=this.chainId,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}async handleSwitchChain(e){var t,r;let s=e.request.params?(t=e.request.params[0])==null?void 0:t.chainId:"0x0";s=s.startsWith("0x")?s:`0x${s}`;const i=parseInt(s,16);if(this.isChainApproved(i))this.setDefaultChain(`${i}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:e.topic,request:{method:e.request.method,params:[{chainId:s}]},chainId:(r=this.namespace.chains)==null?void 0:r[0]}),this.setDefaultChain(`${i}`);else throw new Error(`Failed to switch to chain 'eip155:${i}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(e){return this.namespace.chains.includes(`${this.name}:${e}`)}async getCapabilities(e){var t,r,s,i,o;const a=(r=(t=e.request)==null?void 0:t.params)==null?void 0:r[0],c=((i=(s=e.request)==null?void 0:s.params)==null?void 0:i[1])||[];if(!a)throw new Error("Missing address parameter in `wallet_getCapabilities` request");const l=this.client.session.get(e.topic),u=((o=l==null?void 0:l.sessionProperties)==null?void 0:o.capabilities)||{},h=`${a}${c.join(",")}`,d=u==null?void 0:u[h];if(d)return d;let f;try{f=Yse(l,a,c)}catch(g){console.warn("Failed to extract capabilities from session",g)}if(f)return f;const p=await this.client.request(e);try{await this.client.session.update(e.topic,{sessionProperties:Sx(_x({},l.sessionProperties||{}),{capabilities:Sx(_x({},u||{}),{[h]:p})})})}catch(g){console.warn("Failed to update session with capabilities",g)}return p}async getCallStatus(e){var t,r;const s=this.client.session.get(e.topic),i=(t=s.sessionProperties)==null?void 0:t.bundler_name;if(i){const a=this.getBundlerUrl(e.chainId,i);try{return await this.getUserOperationReceipt(a,e)}catch(c){console.warn("Failed to fetch call status from bundler",c,a)}}const o=(r=s.sessionProperties)==null?void 0:r.bundler_url;if(o)try{return await this.getUserOperationReceipt(o,e)}catch(a){console.warn("Failed to fetch call status from custom bundler",a,o)}if(this.namespace.methods.includes(e.request.method))return await this.client.request(e);throw new Error("Fetching call status not approved by the wallet.")}async getUserOperationReceipt(e,t){var r;const s=new URL(e),i=await fetch(s,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(io("eth_getUserOperationReceipt",[(r=t.request.params)==null?void 0:r[0]]))});if(!i.ok)throw new Error(`Failed to fetch user operation receipt - ${i.status}`);return await i.json()}getBundlerUrl(e,t){return`${lse}?projectId=${this.client.core.projectId}&chainId=${e}&bundler=${t}`}};var iie=Object.defineProperty,oie=(n,e,t)=>e in n?iie(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,uh=(n,e,t)=>oie(n,typeof e!="symbol"?e+"":e,t);let aie=class{constructor(e){uh(this,"name","solana"),uh(this,"client"),uh(this,"httpProviders"),uh(this,"events"),uh(this,"namespace"),uh(this,"chainId"),this.namespace=e.namespace,this.events=wt("events"),this.client=wt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(ai.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var r;const s=Vu(t);e[s]=this.createHttpProvider(s,(r=this.namespace.rpcMap)==null?void 0:r[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const r=this.createHttpProvider(e,t);r&&(this.httpProviders[e]=r)}createHttpProvider(e,t){const r=t||Os(e,this.namespace,this.client.core.projectId);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);return new oi(new Bi(r,wt("disableProviderPing")))}};var cie=Object.defineProperty,lie=(n,e,t)=>e in n?cie(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,hh=(n,e,t)=>lie(n,typeof e!="symbol"?e+"":e,t);let uie=class{constructor(e){hh(this,"name","cosmos"),hh(this,"client"),hh(this,"httpProviders"),hh(this,"events"),hh(this,"namespace"),hh(this,"chainId"),this.namespace=e.namespace,this.events=wt("events"),this.client=wt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(ai.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var r;const s=Vu(t);e[s]=this.createHttpProvider(s,(r=this.namespace.rpcMap)==null?void 0:r[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const r=this.createHttpProvider(e,t);r&&(this.httpProviders[e]=r)}createHttpProvider(e,t){const r=t||Os(e,this.namespace,this.client.core.projectId);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);return new oi(new Bi(r,wt("disableProviderPing")))}};var hie=Object.defineProperty,die=(n,e,t)=>e in n?hie(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,dh=(n,e,t)=>die(n,typeof e!="symbol"?e+"":e,t);let fie=class{constructor(e){dh(this,"name","algorand"),dh(this,"client"),dh(this,"httpProviders"),dh(this,"events"),dh(this,"namespace"),dh(this,"chainId"),this.namespace=e.namespace,this.events=wt("events"),this.client=wt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(!this.httpProviders[e]){const r=t||Os(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,r)}this.chainId=e,this.events.emit(ai.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var r;e[t]=this.createHttpProvider(t,(r=this.namespace.rpcMap)==null?void 0:r[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const r=this.createHttpProvider(e,t);r&&(this.httpProviders[e]=r)}createHttpProvider(e,t){const r=t||Os(e,this.namespace,this.client.core.projectId);return typeof r>"u"?void 0:new oi(new Bi(r,wt("disableProviderPing")))}};var pie=Object.defineProperty,gie=(n,e,t)=>e in n?pie(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,fh=(n,e,t)=>gie(n,typeof e!="symbol"?e+"":e,t);let mie=class{constructor(e){fh(this,"name","cip34"),fh(this,"client"),fh(this,"httpProviders"),fh(this,"events"),fh(this,"namespace"),fh(this,"chainId"),this.namespace=e.namespace,this.events=wt("events"),this.client=wt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(ai.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{const r=this.getCardanoRPCUrl(t),s=Vu(t);e[s]=this.createHttpProvider(s,r)}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}getCardanoRPCUrl(e){const t=this.namespace.rpcMap;if(t)return t[e]}setHttpProvider(e,t){const r=this.createHttpProvider(e,t);r&&(this.httpProviders[e]=r)}createHttpProvider(e,t){const r=t||this.getCardanoRPCUrl(e);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);return new oi(new Bi(r,wt("disableProviderPing")))}};var yie=Object.defineProperty,wie=(n,e,t)=>e in n?yie(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,ph=(n,e,t)=>wie(n,typeof e!="symbol"?e+"":e,t);let bie=class{constructor(e){ph(this,"name","elrond"),ph(this,"client"),ph(this,"httpProviders"),ph(this,"events"),ph(this,"namespace"),ph(this,"chainId"),this.namespace=e.namespace,this.events=wt("events"),this.client=wt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(ai.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var r;const s=Vu(t);e[s]=this.createHttpProvider(s,(r=this.namespace.rpcMap)==null?void 0:r[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const r=this.createHttpProvider(e,t);r&&(this.httpProviders[e]=r)}createHttpProvider(e,t){const r=t||Os(e,this.namespace,this.client.core.projectId);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);return new oi(new Bi(r,wt("disableProviderPing")))}};var Eie=Object.defineProperty,vie=(n,e,t)=>e in n?Eie(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,gh=(n,e,t)=>vie(n,typeof e!="symbol"?e+"":e,t);let Aie=class{constructor(e){gh(this,"name","multiversx"),gh(this,"client"),gh(this,"httpProviders"),gh(this,"events"),gh(this,"namespace"),gh(this,"chainId"),this.namespace=e.namespace,this.events=wt("events"),this.client=wt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(ai.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var r;const s=Vu(t);e[s]=this.createHttpProvider(s,(r=this.namespace.rpcMap)==null?void 0:r[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const r=this.createHttpProvider(e,t);r&&(this.httpProviders[e]=r)}createHttpProvider(e,t){const r=t||Os(e,this.namespace,this.client.core.projectId);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);return new oi(new Bi(r,wt("disableProviderPing")))}};var Cie=Object.defineProperty,Iie=(n,e,t)=>e in n?Cie(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,mh=(n,e,t)=>Iie(n,typeof e!="symbol"?e+"":e,t);let _ie=class{constructor(e){mh(this,"name","near"),mh(this,"client"),mh(this,"httpProviders"),mh(this,"events"),mh(this,"namespace"),mh(this,"chainId"),this.namespace=e.namespace,this.events=wt("events"),this.client=wt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(this.chainId=e,!this.httpProviders[e]){const r=t||Os(`${this.name}:${e}`,this.namespace);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,r)}this.events.emit(ai.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var r;e[t]=this.createHttpProvider(t,(r=this.namespace.rpcMap)==null?void 0:r[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const r=this.createHttpProvider(e,t);r&&(this.httpProviders[e]=r)}createHttpProvider(e,t){const r=t||Os(e,this.namespace);return typeof r>"u"?void 0:new oi(new Bi(r,wt("disableProviderPing")))}};var Sie=Object.defineProperty,Tie=(n,e,t)=>e in n?Sie(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,yh=(n,e,t)=>Tie(n,typeof e!="symbol"?e+"":e,t);let Nie=class{constructor(e){yh(this,"name","tezos"),yh(this,"client"),yh(this,"httpProviders"),yh(this,"events"),yh(this,"namespace"),yh(this,"chainId"),this.namespace=e.namespace,this.events=wt("events"),this.client=wt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(this.chainId=e,!this.httpProviders[e]){const r=t||Os(`${this.name}:${e}`,this.namespace);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,r)}this.events.emit(ai.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{e[t]=this.createHttpProvider(t)}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const r=this.createHttpProvider(e,t);r&&(this.httpProviders[e]=r)}createHttpProvider(e,t){const r=t||Os(e,this.namespace);return typeof r>"u"?void 0:new oi(new Bi(r))}};var Oie=Object.defineProperty,xie=(n,e,t)=>e in n?Oie(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,wh=(n,e,t)=>xie(n,typeof e!="symbol"?e+"":e,t);let Rie=class{constructor(e){wh(this,"name",tM),wh(this,"client"),wh(this,"httpProviders"),wh(this,"events"),wh(this,"namespace"),wh(this,"chainId"),this.namespace=e.namespace,this.events=wt("events"),this.client=wt("client"),this.chainId=this.getDefaultChain(),this.name=this.getNamespaceName(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace.chains=[...new Set((this.namespace.chains||[]).concat(e.chains||[]))],this.namespace.accounts=[...new Set((this.namespace.accounts||[]).concat(e.accounts||[]))],this.namespace.methods=[...new Set((this.namespace.methods||[]).concat(e.methods||[]))],this.namespace.events=[...new Set((this.namespace.events||[]).concat(e.events||[]))],this.httpProviders=this.createHttpProviders()}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider(e.chainId).request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(ai.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getNamespaceName(){const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return ou(e).namespace}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){var e,t;const r={};return(t=(e=this.namespace)==null?void 0:e.accounts)==null||t.forEach(s=>{const i=ou(s);r[i.reference]=this.createHttpProvider(s)}),r}getHttpProvider(e){const t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const r=this.createHttpProvider(e,t);r&&(this.httpProviders[e]=r)}createHttpProvider(e,t){const r=t||Os(e,this.namespace,this.client.core.projectId);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);return new oi(new Bi(r,wt("disableProviderPing")))}};var Pie=Object.defineProperty,kie=Object.defineProperties,Die=Object.getOwnPropertyDescriptors,Tx=Object.getOwnPropertySymbols,Uie=Object.prototype.hasOwnProperty,$ie=Object.prototype.propertyIsEnumerable,pC=(n,e,t)=>e in n?Pie(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,vw=(n,e)=>{for(var t in e||(e={}))Uie.call(e,t)&&pC(n,t,e[t]);if(Tx)for(var t of Tx(e))$ie.call(e,t)&&pC(n,t,e[t]);return n},h1=(n,e)=>kie(n,Die(e)),Ms=(n,e,t)=>pC(n,typeof e!="symbol"?e+"":e,t);let Mie=class uM{constructor(e){Ms(this,"client"),Ms(this,"namespaces"),Ms(this,"optionalNamespaces"),Ms(this,"sessionProperties"),Ms(this,"scopedProperties"),Ms(this,"events",new t_),Ms(this,"rpcProviders",{}),Ms(this,"session"),Ms(this,"providerOpts"),Ms(this,"logger"),Ms(this,"uri"),Ms(this,"disableProviderPing",!1),this.providerOpts=e,this.logger=typeof(e==null?void 0:e.logger)<"u"&&typeof(e==null?void 0:e.logger)!="string"?e.logger:cy(Rf({level:(e==null?void 0:e.logger)||lx})),this.disableProviderPing=(e==null?void 0:e.disableProviderPing)||!1}static async init(e){const t=new uM(e);return await t.initialize(),t}async request(e,t,r){const[s,i]=this.validateChain(t);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(s).request({request:vw({},e),chainId:`${s}:${i}`,topic:this.session.topic,expiry:r})}sendAsync(e,t,r,s){const i=new Date().getTime();this.request(e,r,s).then(o=>t(null,Wg(i,o))).catch(o=>t(o,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties,scopedProperties:this.scopedProperties}),await this.requestAccounts()}async disconnect(){var e;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(e=this.session)==null?void 0:e.topic,reason:zt("USER_DISCONNECTED")}),await this.cleanup()}async connect(e){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(e),this.cleanupPendingPairings(),!e.skipPairing)return await this.pair(e.pairingTopic)}async authenticate(e,t){if(!this.client)throw new Error("Sign Client not initialized");this.setNamespaces(e),await this.cleanupPendingPairings();const{uri:r,response:s}=await this.client.authenticate(e,t);r&&(this.uri=r,this.events.emit("display_uri",r));const i=await s();if(this.session=i.session,this.session){const o=wx(this.session.namespaces);this.namespaces=Ew(this.namespaces,o),await this.persist("namespaces",this.namespaces),this.onConnect()}return i}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}removeListener(e,t){this.events.removeListener(e,t)}off(e,t){this.events.off(e,t)}get isWalletConnect(){return!0}async pair(e){const{uri:t,approval:r}=await this.client.connect({pairingTopic:e,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties,scopedProperties:this.scopedProperties});t&&(this.uri=t,this.events.emit("display_uri",t));const s=await r();this.session=s;const i=wx(s.namespaces);return this.namespaces=Ew(this.namespaces,i),await this.persist("namespaces",this.namespaces),await this.persist("optionalNamespaces",this.optionalNamespaces),this.onConnect(),this.session}setDefaultChain(e,t){try{if(!this.session)return;const[r,s]=this.validateChain(e);this.getProvider(r).setDefaultChain(s,t)}catch(r){if(!/Please call connect/.test(r.message))throw r}}async cleanupPendingPairings(e={}){try{this.logger.info("Cleaning up inactive pairings...");const t=this.client.pairing.getAll();if(!ua(t))return;for(const r of t)e.deletePairings?this.client.core.expirer.set(r.topic,0):await this.client.core.relayer.subscriber.unsubscribe(r.topic);this.logger.info(`Inactive pairings cleared: ${t.length}`)}catch(t){this.logger.warn("Failed to cleanup pending pairings",t)}}abortPairingAttempt(){this.logger.warn("abortPairingAttempt is deprecated. This is now a no-op.")}async checkStorage(){this.namespaces=await this.getFromStore("namespaces")||{},this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.session&&this.createProviders()}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){var e,t;if(this.client=this.providerOpts.client||await Zre.init({core:this.providerOpts.core,logger:this.providerOpts.logger||lx,relayUrl:this.providerOpts.relayUrl||ose,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,storage:this.providerOpts.storage,name:this.providerOpts.name,customStoragePrefix:this.providerOpts.customStoragePrefix,telemetryEnabled:this.providerOpts.telemetryEnabled}),this.providerOpts.session)try{this.session=this.client.session.get(this.providerOpts.session.topic)}catch(r){throw this.logger.error("Failed to get session",r),new Error(`The provided session: ${(t=(e=this.providerOpts)==null?void 0:e.session)==null?void 0:t.topic} doesn't exist in the Sign client`)}else{const r=this.client.session.getAll();this.session=r[0]}this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const e=[...new Set(Object.keys(this.session.namespaces).map(t=>Lh(t)))];l1("client",this.client),l1("events",this.events),l1("disableProviderPing",this.disableProviderPing),e.forEach(t=>{if(!this.session)return;const r=Vse(t,this.session);if((r==null?void 0:r.length)===0)return;const s=cM(r),i=Ew(this.namespaces,this.optionalNamespaces),o=h1(vw({},i[t]),{accounts:r,chains:s});switch(t){case"eip155":this.rpcProviders[t]=new sie({namespace:o});break;case"algorand":this.rpcProviders[t]=new fie({namespace:o});break;case"solana":this.rpcProviders[t]=new aie({namespace:o});break;case"cosmos":this.rpcProviders[t]=new uie({namespace:o});break;case"polkadot":this.rpcProviders[t]=new Jse({namespace:o});break;case"cip34":this.rpcProviders[t]=new mie({namespace:o});break;case"elrond":this.rpcProviders[t]=new bie({namespace:o});break;case"multiversx":this.rpcProviders[t]=new Aie({namespace:o});break;case"near":this.rpcProviders[t]=new _ie({namespace:o});break;case"tezos":this.rpcProviders[t]=new Nie({namespace:o});break;default:this.rpcProviders[t]=new Rie({namespace:o})}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",e=>{var t;const{topic:r}=e;r===((t=this.session)==null?void 0:t.topic)&&this.events.emit("session_ping",e)}),this.client.on("session_event",e=>{var t;const{params:r,topic:s}=e;if(s!==((t=this.session)==null?void 0:t.topic))return;const{event:i}=r;if(i.name==="accountsChanged"){const o=i.data;o&&ua(o)&&this.events.emit("accountsChanged",o.map(yx))}else if(i.name==="chainChanged"){const o=r.chainId,a=r.event.data,c=Lh(o),l=c1(o)!==c1(a)?`${c}:${c1(a)}`:o;this.onChainChanged(l)}else this.events.emit(i.name,i.data);this.events.emit("session_event",e)}),this.client.on("session_update",({topic:e,params:t})=>{var r,s;if(e!==((r=this.session)==null?void 0:r.topic))return;const{namespaces:i}=t,o=(s=this.client)==null?void 0:s.session.get(e);this.session=h1(vw({},o),{namespaces:i}),this.onSessionUpdate(),this.events.emit("session_update",{topic:e,params:t})}),this.client.on("session_delete",async e=>{var t;e.topic===((t=this.session)==null?void 0:t.topic)&&(await this.cleanup(),this.events.emit("session_delete",e),this.events.emit("disconnect",h1(vw({},zt("USER_DISCONNECTED")),{data:e.topic})))}),this.on(ai.DEFAULT_CHAIN_CHANGED,e=>{this.onChainChanged(e,!0)})}getProvider(e){return this.rpcProviders[e]||this.rpcProviders[tM]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(e=>{var t;this.getProvider(e).updateNamespace((t=this.session)==null?void 0:t.namespaces[e])})}setNamespaces(e){const{namespaces:t={},optionalNamespaces:r={},sessionProperties:s,scopedProperties:i}=e;this.optionalNamespaces=Ew(t,r),this.sessionProperties=s,this.scopedProperties=i}validateChain(e){const[t,r]=(e==null?void 0:e.split(":"))||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[t,r];if(t&&!Object.keys(this.namespaces||{}).map(o=>Lh(o)).includes(t))throw new Error(`Namespace '${t}' is not configured. Please call connect() first with namespace config.`);if(t&&r)return[t,r];const s=Lh(Object.keys(this.namespaces)[0]),i=this.rpcProviders[s].getDefaultChain();return[s,i]}async requestAccounts(){const[e]=this.validateChain();return await this.getProvider(e).requestAccounts()}async onChainChanged(e,t=!1){if(!this.namespaces)return;const[r,s]=this.validateChain(e);if(!s)return;this.updateNamespaceChain(r,s);const i=this.getProvider(r).getDefaultChain();t?(this.events.emit("chainChanged",s),this.emitAccountsChangedOnChainChange({namespace:r,previousChainId:i,newChainId:e})):this.getProvider(r).setDefaultChain(s),await this.persist("namespaces",this.namespaces)}emitAccountsChangedOnChainChange({namespace:e,previousChainId:t,newChainId:r}){var s,i;try{if(t===r)return;const o=(i=(s=this.session)==null?void 0:s.namespaces[e])==null?void 0:i.accounts;if(!o)return;const a=o.filter(c=>c.includes(`${r}:`)).map(yx);if(!ua(a))return;this.events.emit("accountsChanged",a)}catch(o){this.logger.warn("Failed to emit accountsChanged on chain change",o)}}updateNamespaceChain(e,t){if(!this.namespaces)return;const r=this.namespaces[e]?e:`${e}:${t}`,s={chains:[],methods:[],events:[],defaultChain:t};this.namespaces[r]?this.namespaces[r]&&(this.namespaces[r].defaultChain=t):this.namespaces[r]=s}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,await this.deleteFromStore("namespaces"),await this.deleteFromStore("optionalNamespaces"),await this.deleteFromStore("sessionProperties"),this.session=void 0,this.cleanupPendingPairings({deletePairings:!0}),await this.cleanupStorage()}async persist(e,t){var r;const s=((r=this.session)==null?void 0:r.topic)||"";await this.client.core.storage.setItem(`${ww}/${e}${s}`,t)}async getFromStore(e){var t;const r=((t=this.session)==null?void 0:t.topic)||"";return await this.client.core.storage.getItem(`${ww}/${e}${r}`)}async deleteFromStore(e){var t;const r=((t=this.session)==null?void 0:t.topic)||"";await this.client.core.storage.removeItem(`${ww}/${e}${r}`)}async cleanupStorage(){var e;try{if(((e=this.client)==null?void 0:e.session.length)>0)return;const t=await this.client.core.storage.getKeys();for(const r of t)r.startsWith(ww)&&await this.client.core.storage.removeItem(r)}catch(t){this.logger.warn("Failed to cleanup storage",t)}}},il=null;const Cs={getSIWX(){return z.state.siwx},async initializeIfEnabled(n=I.getActiveCaipAddress()){var i,o,a;const e=z.state.siwx;if(!(e&&n))return;const[t,r,s]=n.split(":");if(I.checkIfSupportedNetwork(t,`${t}:${r}`))try{if((i=z.state.remoteFeatures)!=null&&i.emailCapture){const l=(o=I.getAccountData(t))==null?void 0:o.user;await tt.open({view:"DataCapture",data:{email:(l==null?void 0:l.email)??void 0}});return}if(il&&await il,(await e.getSessions(`${t}:${r}`,s)).length)return;await tt.open({view:"SIWXSignMessage"})}catch(c){console.error("SIWXUtil:initializeIfEnabled",c),ut.sendEvent({type:"track",event:"SIWX_AUTH_ERROR",properties:this.getSIWXEventProperties()}),await((a=ie._getClient())==null?void 0:a.disconnect().catch(console.error)),Pe.reset("Connect"),uo.showError("A problem occurred while trying initialize authentication")}},async requestSignMessage(){const n=z.state.siwx,e=ye.getPlainAddress(I.getActiveCaipAddress()),t=Tp(),r=ie._getClient();if(!n)throw new Error("SIWX is not enabled");if(!e)throw new Error("No ActiveCaipAddress found");if(!t)throw new Error("No ActiveCaipNetwork or client found");if(!r)throw new Error("No ConnectionController client found");try{const s=await n.createMessage({chainId:t.caipNetworkId,accountAddress:e}),i=s.toString();se.getConnectorId(t.chainNamespace)===H.CONNECTOR_ID.AUTH&&Pe.pushTransactionStack({});const a=await r.signMessage(i);await n.addSession({data:s,message:i,signature:a}),I.setLastConnectedSIWECaipNetwork(t),tt.close(),ut.sendEvent({type:"track",event:"SIWX_AUTH_SUCCESS",properties:this.getSIWXEventProperties()})}catch(s){const i=this.getSIWXEventProperties();(!tt.state.open||Pe.state.view==="ApproveTransaction")&&await tt.open({view:"SIWXSignMessage"}),uo.showError("Error signing message"),ut.sendEvent({type:"track",event:"SIWX_AUTH_ERROR",properties:i}),console.error("SWIXUtil:requestSignMessage",s)}},async cancelSignMessage(){var n;try{const e=this.getSIWX();if((n=e==null?void 0:e.getRequired)==null?void 0:n.call(e)){const r=I.getLastConnectedSIWECaipNetwork();if(r){const s=await(e==null?void 0:e.getSessions(r==null?void 0:r.caipNetworkId,ye.getPlainAddress(I.getActiveCaipAddress())||""));s&&s.length>0?await I.switchActiveNetwork(r):await ie.disconnect()}else await ie.disconnect()}else tt.close();tt.close(),ut.sendEvent({event:"CLICK_CANCEL_SIWX",type:"track",properties:this.getSIWXEventProperties()})}catch(e){console.error("SIWXUtil:cancelSignMessage",e)}},async getAllSessions(){const n=this.getSIWX(),e=I.getAllRequestedCaipNetworks(),t=[];return await Promise.all(e.map(async r=>{const s=await(n==null?void 0:n.getSessions(r.caipNetworkId,ye.getPlainAddress(I.getActiveCaipAddress())||""));s&&t.push(...s)})),t},async getSessions(n){const e=z.state.siwx;let t=n==null?void 0:n.address;if(!t){const s=I.getActiveCaipAddress();t=ye.getPlainAddress(s)}let r=n==null?void 0:n.caipNetworkId;if(!r){const s=I.getActiveCaipNetwork();r=s==null?void 0:s.caipNetworkId}return e&&t&&r?e.getSessions(r,t):[]},async isSIWXCloseDisabled(){var e;const n=this.getSIWX();if(n){const t=Pe.state.view==="ApproveTransaction",r=Pe.state.view==="SIWXSignMessage";if(t||r)return((e=n.getRequired)==null?void 0:e.call(n))&&(await this.getSessions()).length===0}return!1},async authConnectorAuthenticate({authConnector:n,chainId:e,socialUri:t,preferredAccountType:r,chainNamespace:s}){var h;const i=Cs.getSIWX(),o=Tp();if(!i||!s.includes(H.CHAIN.EVM)||(h=z.state.remoteFeatures)!=null&&h.emailCapture){const d=await n.connect({chainId:e,socialUri:t,preferredAccountType:r});return{address:d.address,chainId:d.chainId,accounts:d.accounts}}const a=`${s}:${e}`,c=await i.createMessage({chainId:a,accountAddress:"<<AccountAddress>>"}),l={accountAddress:c.accountAddress,chainId:c.chainId,domain:c.domain,uri:c.uri,version:c.version,nonce:c.nonce,notBefore:c.notBefore,statement:c.statement,resources:c.resources,requestId:c.requestId,issuedAt:c.issuedAt,expirationTime:c.expirationTime,serializedMessage:c.toString()},u=await n.connect({chainId:e,socialUri:t,siwxMessage:l,preferredAccountType:r});return l.accountAddress=u.address,l.serializedMessage=u.message||"",u.signature&&u.message&&await Cs.addEmbeddedWalletSession(l,u.message,u.signature),I.setLastConnectedSIWECaipNetwork(o),{address:u.address,chainId:u.chainId,accounts:u.accounts}},async addEmbeddedWalletSession(n,e,t){if(il)return il;const r=Cs.getSIWX();return r?(il=r.addSession({data:n,message:e,signature:t}).finally(()=>{il=null}),il):Promise.resolve()},async universalProviderAuthenticate({universalProvider:n,chains:e,methods:t}){var c,l,u;const r=Cs.getSIWX(),s=Tp(),i=new Set(e.map(h=>h.split(":")[0]));if(!r||i.size!==1||!i.has("eip155"))return!1;const o=await r.createMessage({chainId:((c=Tp())==null?void 0:c.caipNetworkId)||"",accountAddress:""}),a=await n.authenticate({nonce:o.nonce,domain:o.domain,uri:o.uri,exp:o.expirationTime,iat:o.issuedAt,nbf:o.notBefore,requestId:o.requestId,version:o.version,resources:o.resources,statement:o.statement,chainId:o.chainId,methods:t,chains:[o.chainId,...e.filter(h=>h!==o.chainId)]});if(uo.showLoading("Authenticating...",{autoClose:!1}),ge.setConnectedWalletInfo({...a.session.peer.metadata,name:a.session.peer.metadata.name,icon:(l=a.session.peer.metadata.icons)==null?void 0:l[0],type:"WALLET_CONNECT"},Array.from(i)[0]),(u=a==null?void 0:a.auths)!=null&&u.length){const h=a.auths.map(d=>{const f=n.client.formatAuthMessage({request:d.p,iss:d.p.iss});return{data:{...d.p,accountAddress:d.p.iss.split(":").slice(-1).join(""),chainId:d.p.iss.split(":").slice(2,4).join(":"),uri:d.p.aud,version:d.p.version||o.version,expirationTime:d.p.exp,issuedAt:d.p.iat,notBefore:d.p.nbf},message:f,signature:d.s.s,cacao:d}});try{await r.setSessions(h),s&&I.setLastConnectedSIWECaipNetwork(s),ut.sendEvent({type:"track",event:"SIWX_AUTH_SUCCESS",properties:Cs.getSIWXEventProperties()})}catch(d){throw console.error("SIWX:universalProviderAuth - failed to set sessions",d),ut.sendEvent({type:"track",event:"SIWX_AUTH_ERROR",properties:Cs.getSIWXEventProperties()}),await n.disconnect().catch(console.error),d}finally{uo.hide()}}return!0},getSIWXEventProperties(){var e;const n=I.state.activeChain;if(!n)throw new Error("SIWXUtil:getSIWXEventProperties - namespace is required");return{network:((e=I.state.activeCaipNetwork)==null?void 0:e.caipNetworkId)||"",isSmartAccount:Ns(n)===vn.ACCOUNT_TYPES.SMART_ACCOUNT}},async clearSessions(){const n=this.getSIWX();n&&await n.setSessions([])}},lt={METMASK_CONNECTOR_NAME:"MetaMask",TRUST_CONNECTOR_NAME:"Trust Wallet",SOLFLARE_CONNECTOR_NAME:"Solflare",PHANTOM_CONNECTOR_NAME:"Phantom",COIN98_CONNECTOR_NAME:"Coin98",MAGIC_EDEN_CONNECTOR_NAME:"Magic Eden",BACKPACK_CONNECTOR_NAME:"Backpack",BITGET_CONNECTOR_NAME:"Bitget Wallet",FRONTIER_CONNECTOR_NAME:"Frontier",XVERSE_CONNECTOR_NAME:"Xverse Wallet",LEATHER_CONNECTOR_NAME:"Leather",OKX_CONNECTOR_NAME:"OKX Wallet",EIP155:H.CHAIN.EVM,ADD_CHAIN_METHOD:"wallet_addEthereumChain",EIP6963_ANNOUNCE_EVENT:"eip6963:announceProvider",EIP6963_REQUEST_EVENT:"eip6963:requestProvider",CONNECTOR_RDNS_MAP:{coinbaseWallet:"com.coinbase.wallet",coinbaseWalletSDK:"com.coinbase.wallet"},CONNECTOR_TYPE_EXTERNAL:"EXTERNAL",CONNECTOR_TYPE_WALLET_CONNECT:"WALLET_CONNECT",CONNECTOR_TYPE_INJECTED:"INJECTED",CONNECTOR_TYPE_ANNOUNCED:"ANNOUNCED",CONNECTOR_TYPE_AUTH:"AUTH",CONNECTOR_TYPE_MULTI_CHAIN:"MULTI_CHAIN",CONNECTOR_TYPE_W3M_AUTH:"ID_AUTH"},oo={ConnectorExplorerIds:{[H.CONNECTOR_ID.COINBASE]:"fd20dc426fb37566d803205b19bbc1d4096b248ac04548e3cfb6b3a38bd033aa",[H.CONNECTOR_ID.COINBASE_SDK]:"fd20dc426fb37566d803205b19bbc1d4096b248ac04548e3cfb6b3a38bd033aa",[H.CONNECTOR_ID.SAFE]:"225affb176778569276e484e1b92637ad061b01e13a048b35a9d280c3b58970f",[H.CONNECTOR_ID.LEDGER]:"19177a98252e07ddfc9af2083ba8e07ef627cb6103467ffebb3f8f4205fd7927",[H.CONNECTOR_ID.OKX]:"971e689d0a5be527bac79629b4ee9b925e82208e5168b733496a09c0faed0709",[lt.METMASK_CONNECTOR_NAME]:"c57ca95b47569778a828d19178114f4db188b89b763c899ba0be274e97267d96",[lt.TRUST_CONNECTOR_NAME]:"4622a2b2d6af1c9844944291e5e7351a6aa24cd7b23099efac1b2fd875da31a0",[lt.SOLFLARE_CONNECTOR_NAME]:"1ca0bdd4747578705b1939af023d120677c64fe6ca76add81fda36e350605e79",[lt.PHANTOM_CONNECTOR_NAME]:"a797aa35c0fadbfc1a53e7f675162ed5226968b44a19ee3d24385c64d1d3c393",[lt.COIN98_CONNECTOR_NAME]:"2a3c89040ac3b723a1972a33a125b1db11e258a6975d3a61252cd64e6ea5ea01",[lt.MAGIC_EDEN_CONNECTOR_NAME]:"8b830a2b724a9c3fbab63af6f55ed29c9dfa8a55e732dc88c80a196a2ba136c6",[lt.BACKPACK_CONNECTOR_NAME]:"2bd8c14e035c2d48f184aaa168559e86b0e3433228d3c4075900a221785019b0",[lt.BITGET_CONNECTOR_NAME]:"38f5d18bd8522c244bdd70cb4a68e0e718865155811c043f052fb9f1c51de662",[lt.FRONTIER_CONNECTOR_NAME]:"85db431492aa2e8672e93f4ea7acf10c88b97b867b0d373107af63dc4880f041",[lt.XVERSE_CONNECTOR_NAME]:"2a87d74ae02e10bdd1f51f7ce6c4e1cc53cd5f2c0b6b5ad0d7b3007d2b13de7b",[lt.LEATHER_CONNECTOR_NAME]:"483afe1df1df63daf313109971ff3ef8356ddf1cc4e45877d205eee0b7893a13",[lt.OKX_CONNECTOR_NAME]:"971e689d0a5be527bac79629b4ee9b925e82208e5168b733496a09c0faed0709"},NetworkImageIds:{1:"ba0ba0cd-17c6-4806-ad93-f9d174f17900",42161:"3bff954d-5cb0-47a0-9a23-d20192e74600",43114:"30c46e53-e989-45fb-4549-be3bd4eb3b00",56:"93564157-2e8e-4ce7-81df-b264dbee9b00",250:"06b26297-fe0c-4733-5d6b-ffa5498aac00",10:"ab9c186a-c52f-464b-2906-ca59d760a400",137:"41d04d42-da3b-4453-8506-668cc0727900",5e3:"e86fae9b-b770-4eea-e520-150e12c81100",295:"6a97d510-cac8-4e58-c7ce-e8681b044c00",11155111:"e909ea0a-f92a-4512-c8fc-748044ea6800",84532:"a18a7ecd-e307-4360-4746-283182228e00",1301:"4eeea7ef-0014-4649-5d1d-07271a80f600",130:"2257980a-3463-48c6-cbac-a42d2a956e00",10143:"0a728e83-bacb-46db-7844-948f05434900",100:"02b53f6a-e3d4-479e-1cb4-21178987d100",9001:"f926ff41-260d-4028-635e-91913fc28e00",324:"b310f07f-4ef7-49f3-7073-2a0a39685800",314:"5a73b3dd-af74-424e-cae0-0de859ee9400",4689:"34e68754-e536-40da-c153-6ef2e7188a00",1088:"3897a66d-40b9-4833-162f-a2c90531c900",1284:"161038da-44ae-4ec7-1208-0ea569454b00",1285:"f1d73bb6-5450-4e18-38f7-fb6484264a00",7777777:"845c60df-d429-4991-e687-91ae45791600",42220:"ab781bbc-ccc6-418d-d32d-789b15da1f00",8453:"7289c336-3981-4081-c5f4-efc26ac64a00",1313161554:"3ff73439-a619-4894-9262-4470c773a100",2020:"b8101fc0-9c19-4b6f-ec65-f6dfff106e00",2021:"b8101fc0-9c19-4b6f-ec65-f6dfff106e00",80094:"e329c2c9-59b0-4a02-83e4-212ff3779900",2741:"fc2427d1-5af9-4a9c-8da5-6f94627cd900","5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp":"a1b58899-f671-4276-6a5e-56ca5bd59700","4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z":"a1b58899-f671-4276-6a5e-56ca5bd59700",EtWTRABZaYq6iMfeYKouRu166VU2xqa1:"a1b58899-f671-4276-6a5e-56ca5bd59700","000000000019d6689c085ae165831e93":"0b4838db-0161-4ffe-022d-532bf03dba00","000000000933ea01ad0ee984209779ba":"39354064-d79b-420b-065d-f980c4b78200"},ConnectorImageIds:{[H.CONNECTOR_ID.COINBASE]:"0c2840c3-5b04-4c44-9661-fbd4b49e1800",[H.CONNECTOR_ID.COINBASE_SDK]:"0c2840c3-5b04-4c44-9661-fbd4b49e1800",[H.CONNECTOR_ID.SAFE]:"461db637-8616-43ce-035a-d89b8a1d5800",[H.CONNECTOR_ID.LEDGER]:"54a1aa77-d202-4f8d-0fb2-5d2bb6db0300",[H.CONNECTOR_ID.WALLET_CONNECT]:"ef1a1fcf-7fe8-4d69-bd6d-fda1345b4400",[H.CONNECTOR_ID.INJECTED]:"07ba87ed-43aa-4adf-4540-9e6a2b9cae00"},ConnectorNamesMap:{[H.CONNECTOR_ID.INJECTED]:"Browser Wallet",[H.CONNECTOR_ID.WALLET_CONNECT]:"WalletConnect",[H.CONNECTOR_ID.COINBASE]:"Coinbase",[H.CONNECTOR_ID.COINBASE_SDK]:"Coinbase",[H.CONNECTOR_ID.LEDGER]:"Ledger",[H.CONNECTOR_ID.SAFE]:"Safe"},ConnectorTypesMap:{[H.CONNECTOR_ID.INJECTED]:"INJECTED",[H.CONNECTOR_ID.WALLET_CONNECT]:"WALLET_CONNECT",[H.CONNECTOR_ID.EIP6963]:"ANNOUNCED",[H.CONNECTOR_ID.AUTH]:"AUTH",[lt.CONNECTOR_TYPE_AUTH]:"AUTH"},WalletConnectRpcChainIds:[1,5,11155111,10,420,42161,421613,137,80001,42220,1313161554,1313161555,56,97,43114,43113,100,8453,84531,7777777,999,324,280]},zn={getCaipTokens(n){if(!n)return;const e={};return Object.entries(n).forEach(([t,r])=>{e[`${lt.EIP155}:${t}`]=r}),e},isLowerCaseMatch(n,e){return(n==null?void 0:n.toLowerCase())===(e==null?void 0:e.toLowerCase())},getActiveNamespaceConnectedToAuth(){const n=I.state.activeChain;return H.AUTH_CONNECTOR_SUPPORTED_CHAINS.find(e=>se.getConnectorId(e)===H.CONNECTOR_ID.AUTH&&e===n)},withRetry({conditionFn:n,intervalMs:e,maxRetries:t}){let r=0;return new Promise(s=>{async function i(){return r+=1,await n()?s(!0):r>=t?s(!1):(setTimeout(i,e),null)}i()})}},Lie=new AbortController,lr={EmbeddedWalletAbortController:Lie,UniversalProviderErrors:{UNAUTHORIZED_DOMAIN_NOT_ALLOWED:{message:"Unauthorized: origin not allowed",alertErrorKey:"ORIGIN_NOT_ALLOWED"},JWT_VALIDATION_ERROR:{message:"JWT validation error: JWT Token is not yet valid",alertErrorKey:"JWT_TOKEN_NOT_VALID"},INVALID_KEY:{message:"Unauthorized: invalid key",alertErrorKey:"INVALID_PROJECT_ID"}},ALERT_ERRORS:{SWITCH_NETWORK_NOT_FOUND:{code:"APKT001",displayMessage:"Network Not Found",debugMessage:"The specified network is not recognized. Please ensure it is included in the `networks` array of your `createAppKit` configuration."},ORIGIN_NOT_ALLOWED:{code:"APKT002",displayMessage:"Invalid App Configuration",debugMessage:()=>`The origin ${$h()?window.origin:"unknown"} is not in your allow list. Please update your allowed domains at https://dashboard.reown.com.`},IFRAME_LOAD_FAILED:{code:"APKT003",displayMessage:"Network Error: Wallet Load Failed",debugMessage:()=>"Failed to load the embedded wallet. This may be due to network issues or server downtime. Please check your network connection and try again shortly. Contact support if the issue persists."},IFRAME_REQUEST_TIMEOUT:{code:"APKT004",displayMessage:"Wallet Request Timeout",debugMessage:()=>"The request to the embedded wallet timed out. Please check your network connection and try again shortly. Contact support if the issue persists."},UNVERIFIED_DOMAIN:{code:"APKT005",displayMessage:"Unverified Domain",debugMessage:()=>"Embedded wallet load failed. Ensure your domain is verified in https://dashboard.reown.com."},JWT_TOKEN_NOT_VALID:{code:"APKT006",displayMessage:"Session Expired",debugMessage:"Your session is invalid or expired. Please check your system’s date and time settings, then reconnect."},INVALID_PROJECT_ID:{code:"APKT007",displayMessage:"Invalid Project ID",debugMessage:"The specified project ID is invalid. Please visit https://dashboard.reown.com to obtain a valid project ID."},PROJECT_ID_NOT_CONFIGURED:{code:"APKT008",displayMessage:"Project ID Missing",debugMessage:"No project ID is configured. You can create and configure a project ID at https://dashboard.reown.com."},SERVER_ERROR_APP_CONFIGURATION:{code:"APKT009",displayMessage:"Server Error",debugMessage:n=>`Unable to fetch App Configuration. ${n}. Please check your network connection and try again shortly. Contact support if the issue persists.`},RATE_LIMITED_APP_CONFIGURATION:{code:"APKT010",displayMessage:"Rate Limited",debugMessage:"You have been rate limited while retrieving App Configuration. Please wait a few minutes and try again. Contact support if the issue persists."}},ALERT_WARNINGS:{LOCAL_CONFIGURATION_IGNORED:{debugMessage:n=>`[Reown Config Notice] ${n}`}}},Bie={createLogger(n,e="error"){const t=Rf({level:e}),{logger:r}=r_({opts:t});return r.error=(...s)=>{for(const i of s)if(i instanceof Error){n(i,...s);return}n(void 0,...s)},r}},Fie="rpc.walletconnect.org";function Nx(n,e){const t=new URL("https://rpc.walletconnect.org/v1/");return t.searchParams.set("chainId",n),t.searchParams.set("projectId",e),t.toString()}const d1=["near:mainnet","solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp","eip155:1101","eip155:56","eip155:42161","eip155:7777777","eip155:59144","eip155:324","solana:EtWTRABZaYq6iMfeYKouRu166VU2xqa1","eip155:5000","solana:4sgjmw1sunhzsxgspuhpqldx6wiyjntz","eip155:80084","eip155:5003","eip155:100","eip155:8453","eip155:42220","eip155:1313161555","eip155:17000","eip155:1","eip155:300","eip155:1313161554","eip155:1329","eip155:84532","eip155:421614","eip155:11155111","eip155:8217","eip155:43114","solana:4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z","eip155:999999999","eip155:11155420","eip155:80002","eip155:97","eip155:43113","eip155:137","eip155:10","eip155:1301","eip155:80094","eip155:80069","eip155:560048","eip155:31","eip155:2818","eip155:57054","eip155:911867","eip155:534351","eip155:1112","eip155:534352","eip155:1111","eip155:146","eip155:130","eip155:1284","eip155:30","eip155:2810","bip122:000000000019d6689c085ae165831e93","bip122:000000000933ea01ad0ee984209779ba"],Th={extendRpcUrlWithProjectId(n,e){let t=!1;try{t=new URL(n).host===Fie}catch{t=!1}if(t){const r=new URL(n);return r.searchParams.has("projectId")||r.searchParams.set("projectId",e),r.toString()}return n},isCaipNetwork(n){return"chainNamespace"in n&&"caipNetworkId"in n},getChainNamespace(n){return this.isCaipNetwork(n)?n.chainNamespace:H.CHAIN.EVM},getCaipNetworkId(n){return this.isCaipNetwork(n)?n.caipNetworkId:`${H.CHAIN.EVM}:${n.id}`},getDefaultRpcUrl(n,e,t){var s,i,o;const r=(o=(i=(s=n.rpcUrls)==null?void 0:s.default)==null?void 0:i.http)==null?void 0:o[0];return d1.includes(e)?Nx(e,t):r||""},extendCaipNetwork(n,{customNetworkImageUrls:e,projectId:t,customRpcUrls:r}){var d,f,p,g,m,w,v;const s=this.getChainNamespace(n),i=this.getCaipNetworkId(n),o=(p=(f=(d=n.rpcUrls)==null?void 0:d.default)==null?void 0:f.http)==null?void 0:p[0],a=this.getDefaultRpcUrl(n,i,t),c=((w=(m=(g=n==null?void 0:n.rpcUrls)==null?void 0:g.chainDefault)==null?void 0:m.http)==null?void 0:w[0])||o,l=((v=r==null?void 0:r[i])==null?void 0:v.map(A=>A.url))||[],u=[...l,...a?[a]:[]],h=[...l];return c&&!h.includes(c)&&h.push(c),{...n,chainNamespace:s,caipNetworkId:i,assets:{imageId:oo.NetworkImageIds[n.id],imageUrl:e==null?void 0:e[n.id]},rpcUrls:{...n.rpcUrls,default:{http:u},chainDefault:{http:h}}}},extendCaipNetworks(n,{customNetworkImageUrls:e,projectId:t,customRpcUrls:r}){return n.map(s=>Th.extendCaipNetwork(s,{customNetworkImageUrls:e,customRpcUrls:r,projectId:t}))},getViemTransport(n,e,t){var s,i,o;const r=[];return t==null||t.forEach(a=>{r.push(nw(a.url,a.config))}),d1.includes(n.caipNetworkId)&&r.push(nw(Nx(n.caipNetworkId,e),{fetchOptions:{headers:{"Content-Type":"text/plain"}}})),(o=(i=(s=n==null?void 0:n.rpcUrls)==null?void 0:s.default)==null?void 0:i.http)==null||o.forEach(a=>{r.push(nw(a))}),TN(r)},extendWagmiTransports(n,e,t){if(d1.includes(n.caipNetworkId)){const r=this.getDefaultRpcUrl(n,n.caipNetworkId,e);return TN([t,nw(r)])}return t},getUnsupportedNetwork(n){return{id:n.split(":")[1],caipNetworkId:n,name:H.UNSUPPORTED_NETWORK_NAME,chainNamespace:n.split(":")[0],nativeCurrency:{name:"",decimals:0,symbol:""},rpcUrls:{default:{http:[]}}}},getCaipNetworkFromStorage(n){var c;const e=Q.getActiveCaipNetworkId(),t=I.getAllRequestedCaipNetworks(),r=Array.from(((c=I.state.chains)==null?void 0:c.keys())||[]),s=e==null?void 0:e.split(":")[0],i=s?r.includes(s):!1,o=t==null?void 0:t.find(l=>l.caipNetworkId===e);return i&&!o&&e?this.getUnsupportedNetwork(e):o||n||(t==null?void 0:t[0])}},jie=Symbol(),Ox=Object.getPrototypeOf,xx=new WeakMap,Hie=n=>n&&(xx.has(n)?xx.get(n):Ox(n)===Object.prototype||Ox(n)===Array.prototype),Vie=n=>Hie(n)&&n[jie]||null;var gC={BASE_URL:"./",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const M_=n=>typeof n=="object"&&n!==null,qie=n=>M_(n)&&!L_.has(n)&&(Array.isArray(n)||!(Symbol.iterator in n))&&!(n instanceof WeakMap)&&!(n instanceof WeakSet)&&!(n instanceof Error)&&!(n instanceof Number)&&!(n instanceof Date)&&!(n instanceof String)&&!(n instanceof RegExp)&&!(n instanceof ArrayBuffer)&&!(n instanceof Promise),zie=(n,e,t,r)=>({deleteProperty(s,i){const o=Reflect.get(s,i);t(i);const a=Reflect.deleteProperty(s,i);return a&&r(["delete",[i],o]),a},set(s,i,o,a){const c=!n()&&Reflect.has(s,i),l=Reflect.get(s,i,a);if(c&&(Rx(l,o)||H0.has(o)&&Rx(l,H0.get(o))))return!0;t(i),M_(o)&&(o=Vie(o)||o);const u=!j0.has(o)&&Gie(o)?hM(o):o;return e(i,u),Reflect.set(s,i,u,a),r(["set",[i],o,l]),!0}}),j0=new WeakMap,L_=new WeakSet,Aw=[1,1],H0=new WeakMap;let Rx=Object.is,Wie=(n,e)=>new Proxy(n,e),Gie=qie,Kie=zie;function hM(n={}){if(!M_(n))throw new Error("object required");const e=H0.get(n);if(e)return e;let t=Aw[0];const r=new Set,s=(m,w=++Aw[0])=>{t!==w&&(t=w,r.forEach(v=>v(m,w)))};let i=Aw[1];const o=(m=++Aw[1])=>(i!==m&&!r.size&&(i=m,c.forEach(([w])=>{const v=w[1](m);v>t&&(t=v)})),t),a=m=>(w,v)=>{const A=[...w];A[1]=[m,...A[1]],s(A,v)},c=new Map,l=(m,w)=>{const v=!L_.has(w)&&j0.get(w);if(v){if((gC?"production":void 0)!=="production"&&c.has(m))throw new Error("prop listener already exists");if(r.size){const A=v[2](a(m));c.set(m,[v,A])}else c.set(m,[v])}},u=m=>{var w;const v=c.get(m);v&&(c.delete(m),(w=v[1])==null||w.call(v))},h=m=>(r.add(m),r.size===1&&c.forEach(([v,A],T)=>{if((gC?"production":void 0)!=="production"&&A)throw new Error("remove already exists");const N=v[2](a(T));c.set(T,[v,N])}),()=>{r.delete(m),r.size===0&&c.forEach(([v,A],T)=>{A&&(A(),c.set(T,[v]))})});let d=!0;const f=Kie(()=>d,l,u,s),p=Wie(n,f);H0.set(n,p);const g=[n,o,h];return j0.set(p,g),Reflect.ownKeys(n).forEach(m=>{const w=Object.getOwnPropertyDescriptor(n,m);"value"in w&&w.writable&&(p[m]=n[m])}),d=!1,p}function mC(n,e,t){const r=j0.get(n);(gC?"production":void 0)!=="production"&&!r&&console.warn("Please use proxy object");let s;const i=[],o=r[2];let a=!1;const l=o(u=>{i.push(u),s||(s=Promise.resolve().then(()=>{s=void 0,a&&e(i.splice(0))}))});return a=!0,()=>{a=!1,l()}}function Yie(n){return L_.add(n),n}function Qie(n,e,t,r){let s=n[e];return mC(n,()=>{const i=n[e];Object.is(s,i)||t(s=i)})}const V0={eip155:void 0,solana:void 0,polkadot:void 0,bip122:void 0,cosmos:void 0,sui:void 0,stacks:void 0},Gr=hM({providers:{...V0},providerIds:{...V0}}),mt={state:Gr,subscribeKey(n,e){return Qie(Gr,n,e)},subscribe(n){return mC(Gr,()=>{n(Gr)})},subscribeProviders(n){return mC(Gr.providers,()=>n(Gr.providers))},setProvider(n,e){n&&e&&(Gr.providers[n]=Yie(e))},getProvider(n){if(n)return Gr.providers[n]},setProviderId(n,e){e&&(Gr.providerIds[n]=e)},getProviderId(n){if(n)return Gr.providerIds[n]},reset(){Gr.providers={...V0},Gr.providerIds={...V0}},resetChain(n){Gr.providers[n]=void 0,Gr.providerIds[n]=void 0}},Px={address:/^0x(?:[A-Fa-f0-9]{40})$/u,transactionHash:/^0x(?:[A-Fa-f0-9]{64})$/u,signedMessage:/^0x(?:[a-fA-F0-9]{62,})$/u},Fn={set(n,e){Is.isClient&&localStorage.setItem(`${ve.STORAGE_KEY}${n}`,e)},get(n){return Is.isClient?localStorage.getItem(`${ve.STORAGE_KEY}${n}`):null},delete(n,e){Is.isClient&&(e?localStorage.removeItem(n):localStorage.removeItem(`${ve.STORAGE_KEY}${n}`))}},Cw=30*1e3,Is={checkIfAllowedToTriggerEmail(){const n=Fn.get(ve.LAST_EMAIL_LOGIN_TIME);if(n){const e=Date.now()-Number(n);if(e<Cw){const t=Math.ceil((Cw-e)/1e3);throw new Error(`Please try again after ${t} seconds`)}}},getTimeToNextEmailLogin(){const n=Fn.get(ve.LAST_EMAIL_LOGIN_TIME);if(n){const e=Date.now()-Number(n);if(e<Cw)return Math.ceil((Cw-e)/1e3)}return 0},checkIfRequestExists(n){return vn.NOT_SAFE_RPC_METHODS.includes(n.method)||vn.SAFE_RPC_METHODS.includes(n.method)},getResponseType(n){return typeof n=="string"&&((n==null?void 0:n.match(Px.transactionHash))||(n==null?void 0:n.match(Px.signedMessage)))?ve.RPC_RESPONSE_TYPE_TX:ve.RPC_RESPONSE_TYPE_OBJECT},checkIfRequestIsSafe(n){return vn.SAFE_RPC_METHODS.includes(n.method)},isClient:typeof window<"u"};var yt;(function(n){n.assertEqual=s=>s;function e(s){}n.assertIs=e;function t(s){throw new Error}n.assertNever=t,n.arrayToEnum=s=>{const i={};for(const o of s)i[o]=o;return i},n.getValidEnumValues=s=>{const i=n.objectKeys(s).filter(a=>typeof s[s[a]]!="number"),o={};for(const a of i)o[a]=s[a];return n.objectValues(o)},n.objectValues=s=>n.objectKeys(s).map(function(i){return s[i]}),n.objectKeys=typeof Object.keys=="function"?s=>Object.keys(s):s=>{const i=[];for(const o in s)Object.prototype.hasOwnProperty.call(s,o)&&i.push(o);return i},n.find=(s,i)=>{for(const o of s)if(i(o))return o},n.isInteger=typeof Number.isInteger=="function"?s=>Number.isInteger(s):s=>typeof s=="number"&&isFinite(s)&&Math.floor(s)===s;function r(s,i=" | "){return s.map(o=>typeof o=="string"?`'${o}'`:o).join(i)}n.joinValues=r,n.jsonStringifyReplacer=(s,i)=>typeof i=="bigint"?i.toString():i})(yt||(yt={}));var yC;(function(n){n.mergeShapes=(e,t)=>({...e,...t})})(yC||(yC={}));const he=yt.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),rc=n=>{switch(typeof n){case"undefined":return he.undefined;case"string":return he.string;case"number":return isNaN(n)?he.nan:he.number;case"boolean":return he.boolean;case"function":return he.function;case"bigint":return he.bigint;case"symbol":return he.symbol;case"object":return Array.isArray(n)?he.array:n===null?he.null:n.then&&typeof n.then=="function"&&n.catch&&typeof n.catch=="function"?he.promise:typeof Map<"u"&&n instanceof Map?he.map:typeof Set<"u"&&n instanceof Set?he.set:typeof Date<"u"&&n instanceof Date?he.date:he.object;default:return he.unknown}},ee=yt.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),Zie=n=>JSON.stringify(n,null,2).replace(/"([^"]+)":/g,"$1:");class Oi extends Error{constructor(e){super(),this.issues=[],this.addIssue=r=>{this.issues=[...this.issues,r]},this.addIssues=(r=[])=>{this.issues=[...this.issues,...r]};const t=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,this.name="ZodError",this.issues=e}get errors(){return this.issues}format(e){const t=e||function(i){return i.message},r={_errors:[]},s=i=>{for(const o of i.issues)if(o.code==="invalid_union")o.unionErrors.map(s);else if(o.code==="invalid_return_type")s(o.returnTypeError);else if(o.code==="invalid_arguments")s(o.argumentsError);else if(o.path.length===0)r._errors.push(t(o));else{let a=r,c=0;for(;c<o.path.length;){const l=o.path[c];c===o.path.length-1?(a[l]=a[l]||{_errors:[]},a[l]._errors.push(t(o))):a[l]=a[l]||{_errors:[]},a=a[l],c++}}};return s(this),r}toString(){return this.message}get message(){return JSON.stringify(this.issues,yt.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=t=>t.message){const t={},r=[];for(const s of this.issues)s.path.length>0?(t[s.path[0]]=t[s.path[0]]||[],t[s.path[0]].push(e(s))):r.push(e(s));return{formErrors:r,fieldErrors:t}}get formErrors(){return this.flatten()}}Oi.create=n=>new Oi(n);const Gg=(n,e)=>{let t;switch(n.code){case ee.invalid_type:n.received===he.undefined?t="Required":t=`Expected ${n.expected}, received ${n.received}`;break;case ee.invalid_literal:t=`Invalid literal value, expected ${JSON.stringify(n.expected,yt.jsonStringifyReplacer)}`;break;case ee.unrecognized_keys:t=`Unrecognized key(s) in object: ${yt.joinValues(n.keys,", ")}`;break;case ee.invalid_union:t="Invalid input";break;case ee.invalid_union_discriminator:t=`Invalid discriminator value. Expected ${yt.joinValues(n.options)}`;break;case ee.invalid_enum_value:t=`Invalid enum value. Expected ${yt.joinValues(n.options)}, received '${n.received}'`;break;case ee.invalid_arguments:t="Invalid function arguments";break;case ee.invalid_return_type:t="Invalid function return type";break;case ee.invalid_date:t="Invalid date";break;case ee.invalid_string:typeof n.validation=="object"?"includes"in n.validation?(t=`Invalid input: must include "${n.validation.includes}"`,typeof n.validation.position=="number"&&(t=`${t} at one or more positions greater than or equal to ${n.validation.position}`)):"startsWith"in n.validation?t=`Invalid input: must start with "${n.validation.startsWith}"`:"endsWith"in n.validation?t=`Invalid input: must end with "${n.validation.endsWith}"`:yt.assertNever(n.validation):n.validation!=="regex"?t=`Invalid ${n.validation}`:t="Invalid";break;case ee.too_small:n.type==="array"?t=`Array must contain ${n.exact?"exactly":n.inclusive?"at least":"more than"} ${n.minimum} element(s)`:n.type==="string"?t=`String must contain ${n.exact?"exactly":n.inclusive?"at least":"over"} ${n.minimum} character(s)`:n.type==="number"?t=`Number must be ${n.exact?"exactly equal to ":n.inclusive?"greater than or equal to ":"greater than "}${n.minimum}`:n.type==="date"?t=`Date must be ${n.exact?"exactly equal to ":n.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(n.minimum))}`:t="Invalid input";break;case ee.too_big:n.type==="array"?t=`Array must contain ${n.exact?"exactly":n.inclusive?"at most":"less than"} ${n.maximum} element(s)`:n.type==="string"?t=`String must contain ${n.exact?"exactly":n.inclusive?"at most":"under"} ${n.maximum} character(s)`:n.type==="number"?t=`Number must be ${n.exact?"exactly":n.inclusive?"less than or equal to":"less than"} ${n.maximum}`:n.type==="bigint"?t=`BigInt must be ${n.exact?"exactly":n.inclusive?"less than or equal to":"less than"} ${n.maximum}`:n.type==="date"?t=`Date must be ${n.exact?"exactly":n.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(n.maximum))}`:t="Invalid input";break;case ee.custom:t="Invalid input";break;case ee.invalid_intersection_types:t="Intersection results could not be merged";break;case ee.not_multiple_of:t=`Number must be a multiple of ${n.multipleOf}`;break;case ee.not_finite:t="Number must be finite";break;default:t=e.defaultError,yt.assertNever(n)}return{message:t}};let dM=Gg;function Jie(n){dM=n}function q0(){return dM}const z0=n=>{const{data:e,path:t,errorMaps:r,issueData:s}=n,i=[...t,...s.path||[]],o={...s,path:i};let a="";const c=r.filter(l=>!!l).slice().reverse();for(const l of c)a=l(o,{data:e,defaultError:a}).message;return{...s,path:i,message:s.message||a}},Xie=[];function me(n,e){const t=z0({issueData:e,data:n.data,path:n.path,errorMaps:[n.common.contextualErrorMap,n.schemaErrorMap,q0(),Gg].filter(r=>!!r)});n.common.issues.push(t)}class br{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,t){const r=[];for(const s of t){if(s.status==="aborted")return je;s.status==="dirty"&&e.dirty(),r.push(s.value)}return{status:e.value,value:r}}static async mergeObjectAsync(e,t){const r=[];for(const s of t)r.push({key:await s.key,value:await s.value});return br.mergeObjectSync(e,r)}static mergeObjectSync(e,t){const r={};for(const s of t){const{key:i,value:o}=s;if(i.status==="aborted"||o.status==="aborted")return je;i.status==="dirty"&&e.dirty(),o.status==="dirty"&&e.dirty(),i.value!=="__proto__"&&(typeof o.value<"u"||s.alwaysSet)&&(r[i.value]=o.value)}return{status:e.value,value:r}}}const je=Object.freeze({status:"aborted"}),fM=n=>({status:"dirty",value:n}),Br=n=>({status:"valid",value:n}),wC=n=>n.status==="aborted",bC=n=>n.status==="dirty",Kg=n=>n.status==="valid",W0=n=>typeof Promise<"u"&&n instanceof Promise;var Oe;(function(n){n.errToObj=e=>typeof e=="string"?{message:e}:e||{},n.toString=e=>typeof e=="string"?e:e==null?void 0:e.message})(Oe||(Oe={}));class Io{constructor(e,t,r,s){this._cachedPath=[],this.parent=e,this.data=t,this._path=r,this._key=s}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const kx=(n,e)=>{if(Kg(e))return{success:!0,data:e.value};if(!n.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const t=new Oi(n.common.issues);return this._error=t,this._error}}};function qe(n){if(!n)return{};const{errorMap:e,invalid_type_error:t,required_error:r,description:s}=n;if(e&&(t||r))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:s}:{errorMap:(o,a)=>o.code!=="invalid_type"?{message:a.defaultError}:typeof a.data>"u"?{message:r??a.defaultError}:{message:t??a.defaultError},description:s}}class Ye{constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this)}get description(){return this._def.description}_getType(e){return rc(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:rc(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new br,ctx:{common:e.parent.common,data:e.data,parsedType:rc(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const t=this._parse(e);if(W0(t))throw new Error("Synchronous parse encountered promise.");return t}_parseAsync(e){const t=this._parse(e);return Promise.resolve(t)}parse(e,t){const r=this.safeParse(e,t);if(r.success)return r.data;throw r.error}safeParse(e,t){var r;const s={common:{issues:[],async:(r=t==null?void 0:t.async)!==null&&r!==void 0?r:!1,contextualErrorMap:t==null?void 0:t.errorMap},path:(t==null?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:rc(e)},i=this._parseSync({data:e,path:s.path,parent:s});return kx(s,i)}async parseAsync(e,t){const r=await this.safeParseAsync(e,t);if(r.success)return r.data;throw r.error}async safeParseAsync(e,t){const r={common:{issues:[],contextualErrorMap:t==null?void 0:t.errorMap,async:!0},path:(t==null?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:rc(e)},s=this._parse({data:e,path:r.path,parent:r}),i=await(W0(s)?s:Promise.resolve(s));return kx(r,i)}refine(e,t){const r=s=>typeof t=="string"||typeof t>"u"?{message:t}:typeof t=="function"?t(s):t;return this._refinement((s,i)=>{const o=e(s),a=()=>i.addIssue({code:ee.custom,...r(s)});return typeof Promise<"u"&&o instanceof Promise?o.then(c=>c?!0:(a(),!1)):o?!0:(a(),!1)})}refinement(e,t){return this._refinement((r,s)=>e(r)?!0:(s.addIssue(typeof t=="function"?t(r,s):t),!1))}_refinement(e){return new ki({schema:this,typeName:ke.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}optional(){return ha.create(this,this._def)}nullable(){return Eu.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return xi.create(this,this._def)}promise(){return cf.create(this,this._def)}or(e){return Jg.create([this,e],this._def)}and(e){return Xg.create(this,e,this._def)}transform(e){return new ki({...qe(this._def),schema:this,typeName:ke.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const t=typeof e=="function"?e:()=>e;return new sm({...qe(this._def),innerType:this,defaultValue:t,typeName:ke.ZodDefault})}brand(){return new gM({typeName:ke.ZodBranded,type:this,...qe(this._def)})}catch(e){const t=typeof e=="function"?e:()=>e;return new Q0({...qe(this._def),innerType:this,catchValue:t,typeName:ke.ZodCatch})}describe(e){const t=this.constructor;return new t({...this._def,description:e})}pipe(e){return yy.create(this,e)}readonly(){return J0.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const eoe=/^c[^\s-]{8,}$/i,toe=/^[a-z][a-z0-9]*$/,noe=/^[0-9A-HJKMNP-TV-Z]{26}$/,roe=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,soe=/^(?!\.)(?!.*\.\.)([A-Z0-9_+-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,ioe="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let f1;const ooe=/^(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))$/,aoe=/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,coe=n=>n.precision?n.offset?new RegExp(`^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}\\.\\d{${n.precision}}(([+-]\\d{2}(:?\\d{2})?)|Z)$`):new RegExp(`^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}\\.\\d{${n.precision}}Z$`):n.precision===0?n.offset?new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(([+-]\\d{2}(:?\\d{2})?)|Z)$"):new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}Z$"):n.offset?new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d+)?(([+-]\\d{2}(:?\\d{2})?)|Z)$"):new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d+)?Z$");function loe(n,e){return!!((e==="v4"||!e)&&ooe.test(n)||(e==="v6"||!e)&&aoe.test(n))}class Ti extends Ye{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==he.string){const i=this._getOrReturnCtx(e);return me(i,{code:ee.invalid_type,expected:he.string,received:i.parsedType}),je}const r=new br;let s;for(const i of this._def.checks)if(i.kind==="min")e.data.length<i.value&&(s=this._getOrReturnCtx(e,s),me(s,{code:ee.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),r.dirty());else if(i.kind==="max")e.data.length>i.value&&(s=this._getOrReturnCtx(e,s),me(s,{code:ee.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),r.dirty());else if(i.kind==="length"){const o=e.data.length>i.value,a=e.data.length<i.value;(o||a)&&(s=this._getOrReturnCtx(e,s),o?me(s,{code:ee.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}):a&&me(s,{code:ee.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}),r.dirty())}else if(i.kind==="email")soe.test(e.data)||(s=this._getOrReturnCtx(e,s),me(s,{validation:"email",code:ee.invalid_string,message:i.message}),r.dirty());else if(i.kind==="emoji")f1||(f1=new RegExp(ioe,"u")),f1.test(e.data)||(s=this._getOrReturnCtx(e,s),me(s,{validation:"emoji",code:ee.invalid_string,message:i.message}),r.dirty());else if(i.kind==="uuid")roe.test(e.data)||(s=this._getOrReturnCtx(e,s),me(s,{validation:"uuid",code:ee.invalid_string,message:i.message}),r.dirty());else if(i.kind==="cuid")eoe.test(e.data)||(s=this._getOrReturnCtx(e,s),me(s,{validation:"cuid",code:ee.invalid_string,message:i.message}),r.dirty());else if(i.kind==="cuid2")toe.test(e.data)||(s=this._getOrReturnCtx(e,s),me(s,{validation:"cuid2",code:ee.invalid_string,message:i.message}),r.dirty());else if(i.kind==="ulid")noe.test(e.data)||(s=this._getOrReturnCtx(e,s),me(s,{validation:"ulid",code:ee.invalid_string,message:i.message}),r.dirty());else if(i.kind==="url")try{new URL(e.data)}catch{s=this._getOrReturnCtx(e,s),me(s,{validation:"url",code:ee.invalid_string,message:i.message}),r.dirty()}else i.kind==="regex"?(i.regex.lastIndex=0,i.regex.test(e.data)||(s=this._getOrReturnCtx(e,s),me(s,{validation:"regex",code:ee.invalid_string,message:i.message}),r.dirty())):i.kind==="trim"?e.data=e.data.trim():i.kind==="includes"?e.data.includes(i.value,i.position)||(s=this._getOrReturnCtx(e,s),me(s,{code:ee.invalid_string,validation:{includes:i.value,position:i.position},message:i.message}),r.dirty()):i.kind==="toLowerCase"?e.data=e.data.toLowerCase():i.kind==="toUpperCase"?e.data=e.data.toUpperCase():i.kind==="startsWith"?e.data.startsWith(i.value)||(s=this._getOrReturnCtx(e,s),me(s,{code:ee.invalid_string,validation:{startsWith:i.value},message:i.message}),r.dirty()):i.kind==="endsWith"?e.data.endsWith(i.value)||(s=this._getOrReturnCtx(e,s),me(s,{code:ee.invalid_string,validation:{endsWith:i.value},message:i.message}),r.dirty()):i.kind==="datetime"?coe(i).test(e.data)||(s=this._getOrReturnCtx(e,s),me(s,{code:ee.invalid_string,validation:"datetime",message:i.message}),r.dirty()):i.kind==="ip"?loe(e.data,i.version)||(s=this._getOrReturnCtx(e,s),me(s,{validation:"ip",code:ee.invalid_string,message:i.message}),r.dirty()):yt.assertNever(i);return{status:r.value,value:e.data}}_regex(e,t,r){return this.refinement(s=>e.test(s),{validation:t,code:ee.invalid_string,...Oe.errToObj(r)})}_addCheck(e){return new Ti({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...Oe.errToObj(e)})}url(e){return this._addCheck({kind:"url",...Oe.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...Oe.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...Oe.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...Oe.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...Oe.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...Oe.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...Oe.errToObj(e)})}datetime(e){var t;return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,offset:(t=e==null?void 0:e.offset)!==null&&t!==void 0?t:!1,...Oe.errToObj(e==null?void 0:e.message)})}regex(e,t){return this._addCheck({kind:"regex",regex:e,...Oe.errToObj(t)})}includes(e,t){return this._addCheck({kind:"includes",value:e,position:t==null?void 0:t.position,...Oe.errToObj(t==null?void 0:t.message)})}startsWith(e,t){return this._addCheck({kind:"startsWith",value:e,...Oe.errToObj(t)})}endsWith(e,t){return this._addCheck({kind:"endsWith",value:e,...Oe.errToObj(t)})}min(e,t){return this._addCheck({kind:"min",value:e,...Oe.errToObj(t)})}max(e,t){return this._addCheck({kind:"max",value:e,...Oe.errToObj(t)})}length(e,t){return this._addCheck({kind:"length",value:e,...Oe.errToObj(t)})}nonempty(e){return this.min(1,Oe.errToObj(e))}trim(){return new Ti({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new Ti({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new Ti({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get minLength(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxLength(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}}Ti.create=n=>{var e;return new Ti({checks:[],typeName:ke.ZodString,coerce:(e=n==null?void 0:n.coerce)!==null&&e!==void 0?e:!1,...qe(n)})};function uoe(n,e){const t=(n.toString().split(".")[1]||"").length,r=(e.toString().split(".")[1]||"").length,s=t>r?t:r,i=parseInt(n.toFixed(s).replace(".","")),o=parseInt(e.toFixed(s).replace(".",""));return i%o/Math.pow(10,s)}class Mc extends Ye{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==he.number){const i=this._getOrReturnCtx(e);return me(i,{code:ee.invalid_type,expected:he.number,received:i.parsedType}),je}let r;const s=new br;for(const i of this._def.checks)i.kind==="int"?yt.isInteger(e.data)||(r=this._getOrReturnCtx(e,r),me(r,{code:ee.invalid_type,expected:"integer",received:"float",message:i.message}),s.dirty()):i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(r=this._getOrReturnCtx(e,r),me(r,{code:ee.too_small,minimum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),s.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(r=this._getOrReturnCtx(e,r),me(r,{code:ee.too_big,maximum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),s.dirty()):i.kind==="multipleOf"?uoe(e.data,i.value)!==0&&(r=this._getOrReturnCtx(e,r),me(r,{code:ee.not_multiple_of,multipleOf:i.value,message:i.message}),s.dirty()):i.kind==="finite"?Number.isFinite(e.data)||(r=this._getOrReturnCtx(e,r),me(r,{code:ee.not_finite,message:i.message}),s.dirty()):yt.assertNever(i);return{status:s.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,Oe.toString(t))}gt(e,t){return this.setLimit("min",e,!1,Oe.toString(t))}lte(e,t){return this.setLimit("max",e,!0,Oe.toString(t))}lt(e,t){return this.setLimit("max",e,!1,Oe.toString(t))}setLimit(e,t,r,s){return new Mc({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:r,message:Oe.toString(s)}]})}_addCheck(e){return new Mc({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:Oe.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:Oe.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:Oe.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:Oe.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:Oe.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:Oe.toString(t)})}finite(e){return this._addCheck({kind:"finite",message:Oe.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:Oe.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:Oe.toString(e)})}get minValue(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&yt.isInteger(e.value))}get isFinite(){let e=null,t=null;for(const r of this._def.checks){if(r.kind==="finite"||r.kind==="int"||r.kind==="multipleOf")return!0;r.kind==="min"?(t===null||r.value>t)&&(t=r.value):r.kind==="max"&&(e===null||r.value<e)&&(e=r.value)}return Number.isFinite(t)&&Number.isFinite(e)}}Mc.create=n=>new Mc({checks:[],typeName:ke.ZodNumber,coerce:(n==null?void 0:n.coerce)||!1,...qe(n)});class Lc extends Ye{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce&&(e.data=BigInt(e.data)),this._getType(e)!==he.bigint){const i=this._getOrReturnCtx(e);return me(i,{code:ee.invalid_type,expected:he.bigint,received:i.parsedType}),je}let r;const s=new br;for(const i of this._def.checks)i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(r=this._getOrReturnCtx(e,r),me(r,{code:ee.too_small,type:"bigint",minimum:i.value,inclusive:i.inclusive,message:i.message}),s.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(r=this._getOrReturnCtx(e,r),me(r,{code:ee.too_big,type:"bigint",maximum:i.value,inclusive:i.inclusive,message:i.message}),s.dirty()):i.kind==="multipleOf"?e.data%i.value!==BigInt(0)&&(r=this._getOrReturnCtx(e,r),me(r,{code:ee.not_multiple_of,multipleOf:i.value,message:i.message}),s.dirty()):yt.assertNever(i);return{status:s.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,Oe.toString(t))}gt(e,t){return this.setLimit("min",e,!1,Oe.toString(t))}lte(e,t){return this.setLimit("max",e,!0,Oe.toString(t))}lt(e,t){return this.setLimit("max",e,!1,Oe.toString(t))}setLimit(e,t,r,s){return new Lc({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:r,message:Oe.toString(s)}]})}_addCheck(e){return new Lc({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:Oe.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:Oe.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:Oe.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:Oe.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:Oe.toString(t)})}get minValue(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}}Lc.create=n=>{var e;return new Lc({checks:[],typeName:ke.ZodBigInt,coerce:(e=n==null?void 0:n.coerce)!==null&&e!==void 0?e:!1,...qe(n)})};class Yg extends Ye{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==he.boolean){const r=this._getOrReturnCtx(e);return me(r,{code:ee.invalid_type,expected:he.boolean,received:r.parsedType}),je}return Br(e.data)}}Yg.create=n=>new Yg({typeName:ke.ZodBoolean,coerce:(n==null?void 0:n.coerce)||!1,...qe(n)});class wu extends Ye{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==he.date){const i=this._getOrReturnCtx(e);return me(i,{code:ee.invalid_type,expected:he.date,received:i.parsedType}),je}if(isNaN(e.data.getTime())){const i=this._getOrReturnCtx(e);return me(i,{code:ee.invalid_date}),je}const r=new br;let s;for(const i of this._def.checks)i.kind==="min"?e.data.getTime()<i.value&&(s=this._getOrReturnCtx(e,s),me(s,{code:ee.too_small,message:i.message,inclusive:!0,exact:!1,minimum:i.value,type:"date"}),r.dirty()):i.kind==="max"?e.data.getTime()>i.value&&(s=this._getOrReturnCtx(e,s),me(s,{code:ee.too_big,message:i.message,inclusive:!0,exact:!1,maximum:i.value,type:"date"}),r.dirty()):yt.assertNever(i);return{status:r.value,value:new Date(e.data.getTime())}}_addCheck(e){return new wu({...this._def,checks:[...this._def.checks,e]})}min(e,t){return this._addCheck({kind:"min",value:e.getTime(),message:Oe.toString(t)})}max(e,t){return this._addCheck({kind:"max",value:e.getTime(),message:Oe.toString(t)})}get minDate(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e!=null?new Date(e):null}}wu.create=n=>new wu({checks:[],coerce:(n==null?void 0:n.coerce)||!1,typeName:ke.ZodDate,...qe(n)});class G0 extends Ye{_parse(e){if(this._getType(e)!==he.symbol){const r=this._getOrReturnCtx(e);return me(r,{code:ee.invalid_type,expected:he.symbol,received:r.parsedType}),je}return Br(e.data)}}G0.create=n=>new G0({typeName:ke.ZodSymbol,...qe(n)});class Qg extends Ye{_parse(e){if(this._getType(e)!==he.undefined){const r=this._getOrReturnCtx(e);return me(r,{code:ee.invalid_type,expected:he.undefined,received:r.parsedType}),je}return Br(e.data)}}Qg.create=n=>new Qg({typeName:ke.ZodUndefined,...qe(n)});class Zg extends Ye{_parse(e){if(this._getType(e)!==he.null){const r=this._getOrReturnCtx(e);return me(r,{code:ee.invalid_type,expected:he.null,received:r.parsedType}),je}return Br(e.data)}}Zg.create=n=>new Zg({typeName:ke.ZodNull,...qe(n)});class af extends Ye{constructor(){super(...arguments),this._any=!0}_parse(e){return Br(e.data)}}af.create=n=>new af({typeName:ke.ZodAny,...qe(n)});class au extends Ye{constructor(){super(...arguments),this._unknown=!0}_parse(e){return Br(e.data)}}au.create=n=>new au({typeName:ke.ZodUnknown,...qe(n)});class wa extends Ye{_parse(e){const t=this._getOrReturnCtx(e);return me(t,{code:ee.invalid_type,expected:he.never,received:t.parsedType}),je}}wa.create=n=>new wa({typeName:ke.ZodNever,...qe(n)});class K0 extends Ye{_parse(e){if(this._getType(e)!==he.undefined){const r=this._getOrReturnCtx(e);return me(r,{code:ee.invalid_type,expected:he.void,received:r.parsedType}),je}return Br(e.data)}}K0.create=n=>new K0({typeName:ke.ZodVoid,...qe(n)});class xi extends Ye{_parse(e){const{ctx:t,status:r}=this._processInputParams(e),s=this._def;if(t.parsedType!==he.array)return me(t,{code:ee.invalid_type,expected:he.array,received:t.parsedType}),je;if(s.exactLength!==null){const o=t.data.length>s.exactLength.value,a=t.data.length<s.exactLength.value;(o||a)&&(me(t,{code:o?ee.too_big:ee.too_small,minimum:a?s.exactLength.value:void 0,maximum:o?s.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:s.exactLength.message}),r.dirty())}if(s.minLength!==null&&t.data.length<s.minLength.value&&(me(t,{code:ee.too_small,minimum:s.minLength.value,type:"array",inclusive:!0,exact:!1,message:s.minLength.message}),r.dirty()),s.maxLength!==null&&t.data.length>s.maxLength.value&&(me(t,{code:ee.too_big,maximum:s.maxLength.value,type:"array",inclusive:!0,exact:!1,message:s.maxLength.message}),r.dirty()),t.common.async)return Promise.all([...t.data].map((o,a)=>s.type._parseAsync(new Io(t,o,t.path,a)))).then(o=>br.mergeArray(r,o));const i=[...t.data].map((o,a)=>s.type._parseSync(new Io(t,o,t.path,a)));return br.mergeArray(r,i)}get element(){return this._def.type}min(e,t){return new xi({...this._def,minLength:{value:e,message:Oe.toString(t)}})}max(e,t){return new xi({...this._def,maxLength:{value:e,message:Oe.toString(t)}})}length(e,t){return new xi({...this._def,exactLength:{value:e,message:Oe.toString(t)}})}nonempty(e){return this.min(1,e)}}xi.create=(n,e)=>new xi({type:n,minLength:null,maxLength:null,exactLength:null,typeName:ke.ZodArray,...qe(e)});function Nh(n){if(n instanceof Wt){const e={};for(const t in n.shape){const r=n.shape[t];e[t]=ha.create(Nh(r))}return new Wt({...n._def,shape:()=>e})}else return n instanceof xi?new xi({...n._def,type:Nh(n.element)}):n instanceof ha?ha.create(Nh(n.unwrap())):n instanceof Eu?Eu.create(Nh(n.unwrap())):n instanceof _o?_o.create(n.items.map(e=>Nh(e))):n}class Wt extends Ye{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const e=this._def.shape(),t=yt.objectKeys(e);return this._cached={shape:e,keys:t}}_parse(e){if(this._getType(e)!==he.object){const l=this._getOrReturnCtx(e);return me(l,{code:ee.invalid_type,expected:he.object,received:l.parsedType}),je}const{status:r,ctx:s}=this._processInputParams(e),{shape:i,keys:o}=this._getCached(),a=[];if(!(this._def.catchall instanceof wa&&this._def.unknownKeys==="strip"))for(const l in s.data)o.includes(l)||a.push(l);const c=[];for(const l of o){const u=i[l],h=s.data[l];c.push({key:{status:"valid",value:l},value:u._parse(new Io(s,h,s.path,l)),alwaysSet:l in s.data})}if(this._def.catchall instanceof wa){const l=this._def.unknownKeys;if(l==="passthrough")for(const u of a)c.push({key:{status:"valid",value:u},value:{status:"valid",value:s.data[u]}});else if(l==="strict")a.length>0&&(me(s,{code:ee.unrecognized_keys,keys:a}),r.dirty());else if(l!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const l=this._def.catchall;for(const u of a){const h=s.data[u];c.push({key:{status:"valid",value:u},value:l._parse(new Io(s,h,s.path,u)),alwaysSet:u in s.data})}}return s.common.async?Promise.resolve().then(async()=>{const l=[];for(const u of c){const h=await u.key;l.push({key:h,value:await u.value,alwaysSet:u.alwaysSet})}return l}).then(l=>br.mergeObjectSync(r,l)):br.mergeObjectSync(r,c)}get shape(){return this._def.shape()}strict(e){return Oe.errToObj,new Wt({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(t,r)=>{var s,i,o,a;const c=(o=(i=(s=this._def).errorMap)===null||i===void 0?void 0:i.call(s,t,r).message)!==null&&o!==void 0?o:r.defaultError;return t.code==="unrecognized_keys"?{message:(a=Oe.errToObj(e).message)!==null&&a!==void 0?a:c}:{message:c}}}:{}})}strip(){return new Wt({...this._def,unknownKeys:"strip"})}passthrough(){return new Wt({...this._def,unknownKeys:"passthrough"})}extend(e){return new Wt({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new Wt({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:ke.ZodObject})}setKey(e,t){return this.augment({[e]:t})}catchall(e){return new Wt({...this._def,catchall:e})}pick(e){const t={};return yt.objectKeys(e).forEach(r=>{e[r]&&this.shape[r]&&(t[r]=this.shape[r])}),new Wt({...this._def,shape:()=>t})}omit(e){const t={};return yt.objectKeys(this.shape).forEach(r=>{e[r]||(t[r]=this.shape[r])}),new Wt({...this._def,shape:()=>t})}deepPartial(){return Nh(this)}partial(e){const t={};return yt.objectKeys(this.shape).forEach(r=>{const s=this.shape[r];e&&!e[r]?t[r]=s:t[r]=s.optional()}),new Wt({...this._def,shape:()=>t})}required(e){const t={};return yt.objectKeys(this.shape).forEach(r=>{if(e&&!e[r])t[r]=this.shape[r];else{let i=this.shape[r];for(;i instanceof ha;)i=i._def.innerType;t[r]=i}}),new Wt({...this._def,shape:()=>t})}keyof(){return pM(yt.objectKeys(this.shape))}}Wt.create=(n,e)=>new Wt({shape:()=>n,unknownKeys:"strip",catchall:wa.create(),typeName:ke.ZodObject,...qe(e)});Wt.strictCreate=(n,e)=>new Wt({shape:()=>n,unknownKeys:"strict",catchall:wa.create(),typeName:ke.ZodObject,...qe(e)});Wt.lazycreate=(n,e)=>new Wt({shape:n,unknownKeys:"strip",catchall:wa.create(),typeName:ke.ZodObject,...qe(e)});class Jg extends Ye{_parse(e){const{ctx:t}=this._processInputParams(e),r=this._def.options;function s(i){for(const a of i)if(a.result.status==="valid")return a.result;for(const a of i)if(a.result.status==="dirty")return t.common.issues.push(...a.ctx.common.issues),a.result;const o=i.map(a=>new Oi(a.ctx.common.issues));return me(t,{code:ee.invalid_union,unionErrors:o}),je}if(t.common.async)return Promise.all(r.map(async i=>{const o={...t,common:{...t.common,issues:[]},parent:null};return{result:await i._parseAsync({data:t.data,path:t.path,parent:o}),ctx:o}})).then(s);{let i;const o=[];for(const c of r){const l={...t,common:{...t.common,issues:[]},parent:null},u=c._parseSync({data:t.data,path:t.path,parent:l});if(u.status==="valid")return u;u.status==="dirty"&&!i&&(i={result:u,ctx:l}),l.common.issues.length&&o.push(l.common.issues)}if(i)return t.common.issues.push(...i.ctx.common.issues),i.result;const a=o.map(c=>new Oi(c));return me(t,{code:ee.invalid_union,unionErrors:a}),je}}get options(){return this._def.options}}Jg.create=(n,e)=>new Jg({options:n,typeName:ke.ZodUnion,...qe(e)});const t0=n=>n instanceof tm?t0(n.schema):n instanceof ki?t0(n.innerType()):n instanceof nm?[n.value]:n instanceof Bc?n.options:n instanceof rm?Object.keys(n.enum):n instanceof sm?t0(n._def.innerType):n instanceof Qg?[void 0]:n instanceof Zg?[null]:null;class uE extends Ye{_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==he.object)return me(t,{code:ee.invalid_type,expected:he.object,received:t.parsedType}),je;const r=this.discriminator,s=t.data[r],i=this.optionsMap.get(s);return i?t.common.async?i._parseAsync({data:t.data,path:t.path,parent:t}):i._parseSync({data:t.data,path:t.path,parent:t}):(me(t,{code:ee.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[r]}),je)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,t,r){const s=new Map;for(const i of t){const o=t0(i.shape[e]);if(!o)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(const a of o){if(s.has(a))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(a)}`);s.set(a,i)}}return new uE({typeName:ke.ZodDiscriminatedUnion,discriminator:e,options:t,optionsMap:s,...qe(r)})}}function EC(n,e){const t=rc(n),r=rc(e);if(n===e)return{valid:!0,data:n};if(t===he.object&&r===he.object){const s=yt.objectKeys(e),i=yt.objectKeys(n).filter(a=>s.indexOf(a)!==-1),o={...n,...e};for(const a of i){const c=EC(n[a],e[a]);if(!c.valid)return{valid:!1};o[a]=c.data}return{valid:!0,data:o}}else if(t===he.array&&r===he.array){if(n.length!==e.length)return{valid:!1};const s=[];for(let i=0;i<n.length;i++){const o=n[i],a=e[i],c=EC(o,a);if(!c.valid)return{valid:!1};s.push(c.data)}return{valid:!0,data:s}}else return t===he.date&&r===he.date&&+n==+e?{valid:!0,data:n}:{valid:!1}}class Xg extends Ye{_parse(e){const{status:t,ctx:r}=this._processInputParams(e),s=(i,o)=>{if(wC(i)||wC(o))return je;const a=EC(i.value,o.value);return a.valid?((bC(i)||bC(o))&&t.dirty(),{status:t.value,value:a.data}):(me(r,{code:ee.invalid_intersection_types}),je)};return r.common.async?Promise.all([this._def.left._parseAsync({data:r.data,path:r.path,parent:r}),this._def.right._parseAsync({data:r.data,path:r.path,parent:r})]).then(([i,o])=>s(i,o)):s(this._def.left._parseSync({data:r.data,path:r.path,parent:r}),this._def.right._parseSync({data:r.data,path:r.path,parent:r}))}}Xg.create=(n,e,t)=>new Xg({left:n,right:e,typeName:ke.ZodIntersection,...qe(t)});class _o extends Ye{_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==he.array)return me(r,{code:ee.invalid_type,expected:he.array,received:r.parsedType}),je;if(r.data.length<this._def.items.length)return me(r,{code:ee.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),je;!this._def.rest&&r.data.length>this._def.items.length&&(me(r,{code:ee.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),t.dirty());const i=[...r.data].map((o,a)=>{const c=this._def.items[a]||this._def.rest;return c?c._parse(new Io(r,o,r.path,a)):null}).filter(o=>!!o);return r.common.async?Promise.all(i).then(o=>br.mergeArray(t,o)):br.mergeArray(t,i)}get items(){return this._def.items}rest(e){return new _o({...this._def,rest:e})}}_o.create=(n,e)=>{if(!Array.isArray(n))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new _o({items:n,typeName:ke.ZodTuple,rest:null,...qe(e)})};class em extends Ye{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==he.object)return me(r,{code:ee.invalid_type,expected:he.object,received:r.parsedType}),je;const s=[],i=this._def.keyType,o=this._def.valueType;for(const a in r.data)s.push({key:i._parse(new Io(r,a,r.path,a)),value:o._parse(new Io(r,r.data[a],r.path,a))});return r.common.async?br.mergeObjectAsync(t,s):br.mergeObjectSync(t,s)}get element(){return this._def.valueType}static create(e,t,r){return t instanceof Ye?new em({keyType:e,valueType:t,typeName:ke.ZodRecord,...qe(r)}):new em({keyType:Ti.create(),valueType:e,typeName:ke.ZodRecord,...qe(t)})}}class Y0 extends Ye{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==he.map)return me(r,{code:ee.invalid_type,expected:he.map,received:r.parsedType}),je;const s=this._def.keyType,i=this._def.valueType,o=[...r.data.entries()].map(([a,c],l)=>({key:s._parse(new Io(r,a,r.path,[l,"key"])),value:i._parse(new Io(r,c,r.path,[l,"value"]))}));if(r.common.async){const a=new Map;return Promise.resolve().then(async()=>{for(const c of o){const l=await c.key,u=await c.value;if(l.status==="aborted"||u.status==="aborted")return je;(l.status==="dirty"||u.status==="dirty")&&t.dirty(),a.set(l.value,u.value)}return{status:t.value,value:a}})}else{const a=new Map;for(const c of o){const l=c.key,u=c.value;if(l.status==="aborted"||u.status==="aborted")return je;(l.status==="dirty"||u.status==="dirty")&&t.dirty(),a.set(l.value,u.value)}return{status:t.value,value:a}}}}Y0.create=(n,e,t)=>new Y0({valueType:e,keyType:n,typeName:ke.ZodMap,...qe(t)});class bu extends Ye{_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==he.set)return me(r,{code:ee.invalid_type,expected:he.set,received:r.parsedType}),je;const s=this._def;s.minSize!==null&&r.data.size<s.minSize.value&&(me(r,{code:ee.too_small,minimum:s.minSize.value,type:"set",inclusive:!0,exact:!1,message:s.minSize.message}),t.dirty()),s.maxSize!==null&&r.data.size>s.maxSize.value&&(me(r,{code:ee.too_big,maximum:s.maxSize.value,type:"set",inclusive:!0,exact:!1,message:s.maxSize.message}),t.dirty());const i=this._def.valueType;function o(c){const l=new Set;for(const u of c){if(u.status==="aborted")return je;u.status==="dirty"&&t.dirty(),l.add(u.value)}return{status:t.value,value:l}}const a=[...r.data.values()].map((c,l)=>i._parse(new Io(r,c,r.path,l)));return r.common.async?Promise.all(a).then(c=>o(c)):o(a)}min(e,t){return new bu({...this._def,minSize:{value:e,message:Oe.toString(t)}})}max(e,t){return new bu({...this._def,maxSize:{value:e,message:Oe.toString(t)}})}size(e,t){return this.min(e,t).max(e,t)}nonempty(e){return this.min(1,e)}}bu.create=(n,e)=>new bu({valueType:n,minSize:null,maxSize:null,typeName:ke.ZodSet,...qe(e)});class Qh extends Ye{constructor(){super(...arguments),this.validate=this.implement}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==he.function)return me(t,{code:ee.invalid_type,expected:he.function,received:t.parsedType}),je;function r(a,c){return z0({data:a,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,q0(),Gg].filter(l=>!!l),issueData:{code:ee.invalid_arguments,argumentsError:c}})}function s(a,c){return z0({data:a,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,q0(),Gg].filter(l=>!!l),issueData:{code:ee.invalid_return_type,returnTypeError:c}})}const i={errorMap:t.common.contextualErrorMap},o=t.data;if(this._def.returns instanceof cf){const a=this;return Br(async function(...c){const l=new Oi([]),u=await a._def.args.parseAsync(c,i).catch(f=>{throw l.addIssue(r(c,f)),l}),h=await Reflect.apply(o,this,u);return await a._def.returns._def.type.parseAsync(h,i).catch(f=>{throw l.addIssue(s(h,f)),l})})}else{const a=this;return Br(function(...c){const l=a._def.args.safeParse(c,i);if(!l.success)throw new Oi([r(c,l.error)]);const u=Reflect.apply(o,this,l.data),h=a._def.returns.safeParse(u,i);if(!h.success)throw new Oi([s(u,h.error)]);return h.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new Qh({...this._def,args:_o.create(e).rest(au.create())})}returns(e){return new Qh({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,t,r){return new Qh({args:e||_o.create([]).rest(au.create()),returns:t||au.create(),typeName:ke.ZodFunction,...qe(r)})}}class tm extends Ye{get schema(){return this._def.getter()}_parse(e){const{ctx:t}=this._processInputParams(e);return this._def.getter()._parse({data:t.data,path:t.path,parent:t})}}tm.create=(n,e)=>new tm({getter:n,typeName:ke.ZodLazy,...qe(e)});class nm extends Ye{_parse(e){if(e.data!==this._def.value){const t=this._getOrReturnCtx(e);return me(t,{received:t.data,code:ee.invalid_literal,expected:this._def.value}),je}return{status:"valid",value:e.data}}get value(){return this._def.value}}nm.create=(n,e)=>new nm({value:n,typeName:ke.ZodLiteral,...qe(e)});function pM(n,e){return new Bc({values:n,typeName:ke.ZodEnum,...qe(e)})}class Bc extends Ye{_parse(e){if(typeof e.data!="string"){const t=this._getOrReturnCtx(e),r=this._def.values;return me(t,{expected:yt.joinValues(r),received:t.parsedType,code:ee.invalid_type}),je}if(this._def.values.indexOf(e.data)===-1){const t=this._getOrReturnCtx(e),r=this._def.values;return me(t,{received:t.data,code:ee.invalid_enum_value,options:r}),je}return Br(e.data)}get options(){return this._def.values}get enum(){const e={};for(const t of this._def.values)e[t]=t;return e}get Values(){const e={};for(const t of this._def.values)e[t]=t;return e}get Enum(){const e={};for(const t of this._def.values)e[t]=t;return e}extract(e){return Bc.create(e)}exclude(e){return Bc.create(this.options.filter(t=>!e.includes(t)))}}Bc.create=pM;class rm extends Ye{_parse(e){const t=yt.getValidEnumValues(this._def.values),r=this._getOrReturnCtx(e);if(r.parsedType!==he.string&&r.parsedType!==he.number){const s=yt.objectValues(t);return me(r,{expected:yt.joinValues(s),received:r.parsedType,code:ee.invalid_type}),je}if(t.indexOf(e.data)===-1){const s=yt.objectValues(t);return me(r,{received:r.data,code:ee.invalid_enum_value,options:s}),je}return Br(e.data)}get enum(){return this._def.values}}rm.create=(n,e)=>new rm({values:n,typeName:ke.ZodNativeEnum,...qe(e)});class cf extends Ye{unwrap(){return this._def.type}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==he.promise&&t.common.async===!1)return me(t,{code:ee.invalid_type,expected:he.promise,received:t.parsedType}),je;const r=t.parsedType===he.promise?t.data:Promise.resolve(t.data);return Br(r.then(s=>this._def.type.parseAsync(s,{path:t.path,errorMap:t.common.contextualErrorMap})))}}cf.create=(n,e)=>new cf({type:n,typeName:ke.ZodPromise,...qe(e)});class ki extends Ye{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===ke.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:t,ctx:r}=this._processInputParams(e),s=this._def.effect||null,i={addIssue:o=>{me(r,o),o.fatal?t.abort():t.dirty()},get path(){return r.path}};if(i.addIssue=i.addIssue.bind(i),s.type==="preprocess"){const o=s.transform(r.data,i);return r.common.issues.length?{status:"dirty",value:r.data}:r.common.async?Promise.resolve(o).then(a=>this._def.schema._parseAsync({data:a,path:r.path,parent:r})):this._def.schema._parseSync({data:o,path:r.path,parent:r})}if(s.type==="refinement"){const o=a=>{const c=s.refinement(a,i);if(r.common.async)return Promise.resolve(c);if(c instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return a};if(r.common.async===!1){const a=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});return a.status==="aborted"?je:(a.status==="dirty"&&t.dirty(),o(a.value),{status:t.value,value:a.value})}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(a=>a.status==="aborted"?je:(a.status==="dirty"&&t.dirty(),o(a.value).then(()=>({status:t.value,value:a.value}))))}if(s.type==="transform")if(r.common.async===!1){const o=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});if(!Kg(o))return o;const a=s.transform(o.value,i);if(a instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:t.value,value:a}}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(o=>Kg(o)?Promise.resolve(s.transform(o.value,i)).then(a=>({status:t.value,value:a})):o);yt.assertNever(s)}}ki.create=(n,e,t)=>new ki({schema:n,typeName:ke.ZodEffects,effect:e,...qe(t)});ki.createWithPreprocess=(n,e,t)=>new ki({schema:e,effect:{type:"preprocess",transform:n},typeName:ke.ZodEffects,...qe(t)});class ha extends Ye{_parse(e){return this._getType(e)===he.undefined?Br(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}ha.create=(n,e)=>new ha({innerType:n,typeName:ke.ZodOptional,...qe(e)});class Eu extends Ye{_parse(e){return this._getType(e)===he.null?Br(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Eu.create=(n,e)=>new Eu({innerType:n,typeName:ke.ZodNullable,...qe(e)});class sm extends Ye{_parse(e){const{ctx:t}=this._processInputParams(e);let r=t.data;return t.parsedType===he.undefined&&(r=this._def.defaultValue()),this._def.innerType._parse({data:r,path:t.path,parent:t})}removeDefault(){return this._def.innerType}}sm.create=(n,e)=>new sm({innerType:n,typeName:ke.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...qe(e)});class Q0 extends Ye{_parse(e){const{ctx:t}=this._processInputParams(e),r={...t,common:{...t.common,issues:[]}},s=this._def.innerType._parse({data:r.data,path:r.path,parent:{...r}});return W0(s)?s.then(i=>({status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new Oi(r.common.issues)},input:r.data})})):{status:"valid",value:s.status==="valid"?s.value:this._def.catchValue({get error(){return new Oi(r.common.issues)},input:r.data})}}removeCatch(){return this._def.innerType}}Q0.create=(n,e)=>new Q0({innerType:n,typeName:ke.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...qe(e)});class Z0 extends Ye{_parse(e){if(this._getType(e)!==he.nan){const r=this._getOrReturnCtx(e);return me(r,{code:ee.invalid_type,expected:he.nan,received:r.parsedType}),je}return{status:"valid",value:e.data}}}Z0.create=n=>new Z0({typeName:ke.ZodNaN,...qe(n)});const hoe=Symbol("zod_brand");class gM extends Ye{_parse(e){const{ctx:t}=this._processInputParams(e),r=t.data;return this._def.type._parse({data:r,path:t.path,parent:t})}unwrap(){return this._def.type}}class yy extends Ye{_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.common.async)return(async()=>{const i=await this._def.in._parseAsync({data:r.data,path:r.path,parent:r});return i.status==="aborted"?je:i.status==="dirty"?(t.dirty(),fM(i.value)):this._def.out._parseAsync({data:i.value,path:r.path,parent:r})})();{const s=this._def.in._parseSync({data:r.data,path:r.path,parent:r});return s.status==="aborted"?je:s.status==="dirty"?(t.dirty(),{status:"dirty",value:s.value}):this._def.out._parseSync({data:s.value,path:r.path,parent:r})}}static create(e,t){return new yy({in:e,out:t,typeName:ke.ZodPipeline})}}class J0 extends Ye{_parse(e){const t=this._def.innerType._parse(e);return Kg(t)&&(t.value=Object.freeze(t.value)),t}}J0.create=(n,e)=>new J0({innerType:n,typeName:ke.ZodReadonly,...qe(e)});const mM=(n,e={},t)=>n?af.create().superRefine((r,s)=>{var i,o;if(!n(r)){const a=typeof e=="function"?e(r):typeof e=="string"?{message:e}:e,c=(o=(i=a.fatal)!==null&&i!==void 0?i:t)!==null&&o!==void 0?o:!0,l=typeof a=="string"?{message:a}:a;s.addIssue({code:"custom",...l,fatal:c})}}):af.create(),doe={object:Wt.lazycreate};var ke;(function(n){n.ZodString="ZodString",n.ZodNumber="ZodNumber",n.ZodNaN="ZodNaN",n.ZodBigInt="ZodBigInt",n.ZodBoolean="ZodBoolean",n.ZodDate="ZodDate",n.ZodSymbol="ZodSymbol",n.ZodUndefined="ZodUndefined",n.ZodNull="ZodNull",n.ZodAny="ZodAny",n.ZodUnknown="ZodUnknown",n.ZodNever="ZodNever",n.ZodVoid="ZodVoid",n.ZodArray="ZodArray",n.ZodObject="ZodObject",n.ZodUnion="ZodUnion",n.ZodDiscriminatedUnion="ZodDiscriminatedUnion",n.ZodIntersection="ZodIntersection",n.ZodTuple="ZodTuple",n.ZodRecord="ZodRecord",n.ZodMap="ZodMap",n.ZodSet="ZodSet",n.ZodFunction="ZodFunction",n.ZodLazy="ZodLazy",n.ZodLiteral="ZodLiteral",n.ZodEnum="ZodEnum",n.ZodEffects="ZodEffects",n.ZodNativeEnum="ZodNativeEnum",n.ZodOptional="ZodOptional",n.ZodNullable="ZodNullable",n.ZodDefault="ZodDefault",n.ZodCatch="ZodCatch",n.ZodPromise="ZodPromise",n.ZodBranded="ZodBranded",n.ZodPipeline="ZodPipeline",n.ZodReadonly="ZodReadonly"})(ke||(ke={}));const foe=(n,e={message:`Input not instance of ${n.name}`})=>mM(t=>t instanceof n,e),yM=Ti.create,wM=Mc.create,poe=Z0.create,goe=Lc.create,bM=Yg.create,moe=wu.create,yoe=G0.create,woe=Qg.create,boe=Zg.create,Eoe=af.create,voe=au.create,Aoe=wa.create,Coe=K0.create,Ioe=xi.create,_oe=Wt.create,Soe=Wt.strictCreate,Toe=Jg.create,Noe=uE.create,Ooe=Xg.create,xoe=_o.create,Roe=em.create,Poe=Y0.create,koe=bu.create,Doe=Qh.create,Uoe=tm.create,$oe=nm.create,Moe=Bc.create,Loe=rm.create,Boe=cf.create,Dx=ki.create,Foe=ha.create,joe=Eu.create,Hoe=ki.createWithPreprocess,Voe=yy.create,qoe=()=>yM().optional(),zoe=()=>wM().optional(),Woe=()=>bM().optional(),Goe={string:n=>Ti.create({...n,coerce:!0}),number:n=>Mc.create({...n,coerce:!0}),boolean:n=>Yg.create({...n,coerce:!0}),bigint:n=>Lc.create({...n,coerce:!0}),date:n=>wu.create({...n,coerce:!0})},Koe=je;var b=Object.freeze({__proto__:null,defaultErrorMap:Gg,setErrorMap:Jie,getErrorMap:q0,makeIssue:z0,EMPTY_PATH:Xie,addIssueToContext:me,ParseStatus:br,INVALID:je,DIRTY:fM,OK:Br,isAborted:wC,isDirty:bC,isValid:Kg,isAsync:W0,get util(){return yt},get objectUtil(){return yC},ZodParsedType:he,getParsedType:rc,ZodType:Ye,ZodString:Ti,ZodNumber:Mc,ZodBigInt:Lc,ZodBoolean:Yg,ZodDate:wu,ZodSymbol:G0,ZodUndefined:Qg,ZodNull:Zg,ZodAny:af,ZodUnknown:au,ZodNever:wa,ZodVoid:K0,ZodArray:xi,ZodObject:Wt,ZodUnion:Jg,ZodDiscriminatedUnion:uE,ZodIntersection:Xg,ZodTuple:_o,ZodRecord:em,ZodMap:Y0,ZodSet:bu,ZodFunction:Qh,ZodLazy:tm,ZodLiteral:nm,ZodEnum:Bc,ZodNativeEnum:rm,ZodPromise:cf,ZodEffects:ki,ZodTransformer:ki,ZodOptional:ha,ZodNullable:Eu,ZodDefault:sm,ZodCatch:Q0,ZodNaN:Z0,BRAND:hoe,ZodBranded:gM,ZodPipeline:yy,ZodReadonly:J0,custom:mM,Schema:Ye,ZodSchema:Ye,late:doe,get ZodFirstPartyTypeKind(){return ke},coerce:Goe,any:Eoe,array:Ioe,bigint:goe,boolean:bM,date:moe,discriminatedUnion:Noe,effect:Dx,enum:Moe,function:Doe,instanceof:foe,intersection:Ooe,lazy:Uoe,literal:$oe,map:Poe,nan:poe,nativeEnum:Loe,never:Aoe,null:boe,nullable:joe,number:wM,object:_oe,oboolean:Woe,onumber:zoe,optional:Foe,ostring:qoe,pipeline:Voe,preprocess:Hoe,promise:Boe,record:Roe,set:koe,strictObject:Soe,string:yM,symbol:yoe,transformer:Dx,tuple:xoe,undefined:woe,union:Toe,unknown:voe,void:Coe,NEVER:Koe,ZodIssueCode:ee,quotelessJson:Zie,ZodError:Oi});const Yt=b.object({message:b.string()});function fe(n){return b.literal(ve[n])}const hE=b.object({serializedMessage:b.string().optional(),accountAddress:b.string(),chainId:b.string(),notBefore:b.string().optional(),domain:b.string(),uri:b.string(),version:b.string(),nonce:b.string(),statement:b.string().optional(),resources:b.array(b.string()).optional(),requestId:b.string().optional(),issuedAt:b.string().optional(),expirationTime:b.string().optional()});b.object({accessList:b.array(b.string()),blockHash:b.string().nullable(),blockNumber:b.string().nullable(),chainId:b.string().or(b.number()),from:b.string(),gas:b.string(),hash:b.string(),input:b.string().nullable(),maxFeePerGas:b.string(),maxPriorityFeePerGas:b.string(),nonce:b.string(),r:b.string(),s:b.string(),to:b.string(),transactionIndex:b.string().nullable(),type:b.string(),v:b.string(),value:b.string()});const Yoe=b.object({chainId:b.string().or(b.number()),rpcUrl:b.optional(b.string())}),Qoe=b.object({email:b.string().email()}),Zoe=b.object({otp:b.string()}),Joe=b.object({uri:b.string(),preferredAccountType:b.optional(b.string()),chainId:b.optional(b.string().or(b.number())),siwxMessage:b.optional(hE),rpcUrl:b.optional(b.string())}),Xoe=b.object({chainId:b.optional(b.string().or(b.number())),preferredAccountType:b.optional(b.string()),socialUri:b.optional(b.string()),siwxMessage:b.optional(hE),rpcUrl:b.optional(b.string())}),eae=b.object({provider:b.enum(["google","github","apple","facebook","x","discord"])}),tae=b.object({email:b.string().email()}),nae=b.object({otp:b.string()}),rae=b.object({otp:b.string()}),sae=b.object({themeMode:b.optional(b.enum(["light","dark"])),themeVariables:b.optional(b.record(b.string(),b.string().or(b.number()))),w3mThemeVariables:b.optional(b.record(b.string(),b.string()))}),iae=b.object({metadata:b.object({name:b.string(),description:b.string(),url:b.string(),icons:b.array(b.string())}).optional(),sdkVersion:b.string().optional(),sdkType:b.string().optional(),projectId:b.string()}),oae=b.object({type:b.string()}),aae=b.object({action:b.enum(["VERIFY_DEVICE","VERIFY_OTP","CONNECT"])}),cae=b.object({url:b.string()}),lae=b.object({userName:b.string()}),uae=b.object({email:b.string().optional().nullable(),address:b.string(),chainId:b.string().or(b.number()),accounts:b.array(b.object({address:b.string(),type:b.enum([vn.ACCOUNT_TYPES.EOA,vn.ACCOUNT_TYPES.SMART_ACCOUNT])})).optional(),userName:b.string().optional().nullable(),preferredAccountType:b.optional(b.string()),signature:b.string().optional(),message:b.string().optional(),siwxMessage:b.optional(hE)}),hae=b.object({action:b.enum(["VERIFY_PRIMARY_OTP","VERIFY_SECONDARY_OTP"])}),dae=b.object({email:b.string().email().optional().nullable(),address:b.string(),chainId:b.string().or(b.number()),smartAccountDeployed:b.optional(b.boolean()),accounts:b.array(b.object({address:b.string(),type:b.enum([vn.ACCOUNT_TYPES.EOA,vn.ACCOUNT_TYPES.SMART_ACCOUNT])})).optional(),preferredAccountType:b.optional(b.string()),signature:b.string().optional(),message:b.string().optional(),siwxMessage:b.optional(hE)}),fae=b.object({uri:b.string()}),pae=b.object({isConnected:b.boolean()}),gae=b.object({chainId:b.string().or(b.number())}),mae=b.object({chainId:b.string().or(b.number())}),yae=b.object({newEmail:b.string().email()}),wae=b.object({smartAccountEnabledNetworks:b.array(b.number())});b.object({address:b.string(),isDeployed:b.boolean()});const bae=b.object({version:b.string().optional()}),Eae=b.object({type:b.string(),address:b.string()}),vae=b.any(),Aae=b.object({method:b.literal("eth_accounts")}),Cae=b.object({method:b.literal("eth_blockNumber")}),Iae=b.object({method:b.literal("eth_call"),params:b.array(b.any())}),_ae=b.object({method:b.literal("eth_chainId")}),Sae=b.object({method:b.literal("eth_estimateGas"),params:b.array(b.any())}),Tae=b.object({method:b.literal("eth_feeHistory"),params:b.array(b.any())}),Nae=b.object({method:b.literal("eth_gasPrice")}),Oae=b.object({method:b.literal("eth_getAccount"),params:b.array(b.any())}),xae=b.object({method:b.literal("eth_getBalance"),params:b.array(b.any())}),Rae=b.object({method:b.literal("eth_getBlockByHash"),params:b.array(b.any())}),Pae=b.object({method:b.literal("eth_getBlockByNumber"),params:b.array(b.any())}),kae=b.object({method:b.literal("eth_getBlockReceipts"),params:b.array(b.any())}),Dae=b.object({method:b.literal("eth_getBlockTransactionCountByHash"),params:b.array(b.any())}),Uae=b.object({method:b.literal("eth_getBlockTransactionCountByNumber"),params:b.array(b.any())}),$ae=b.object({method:b.literal("eth_getCode"),params:b.array(b.any())}),Mae=b.object({method:b.literal("eth_getFilterChanges"),params:b.array(b.any())}),Lae=b.object({method:b.literal("eth_getFilterLogs"),params:b.array(b.any())}),Bae=b.object({method:b.literal("eth_getLogs"),params:b.array(b.any())}),Fae=b.object({method:b.literal("eth_getProof"),params:b.array(b.any())}),jae=b.object({method:b.literal("eth_getStorageAt"),params:b.array(b.any())}),Hae=b.object({method:b.literal("eth_getTransactionByBlockHashAndIndex"),params:b.array(b.any())}),Vae=b.object({method:b.literal("eth_getTransactionByBlockNumberAndIndex"),params:b.array(b.any())}),qae=b.object({method:b.literal("eth_getTransactionByHash"),params:b.array(b.any())}),zae=b.object({method:b.literal("eth_getTransactionCount"),params:b.array(b.any())}),Wae=b.object({method:b.literal("eth_getTransactionReceipt"),params:b.array(b.any())}),Gae=b.object({method:b.literal("eth_getUncleCountByBlockHash"),params:b.array(b.any())}),Kae=b.object({method:b.literal("eth_getUncleCountByBlockNumber"),params:b.array(b.any())}),Yae=b.object({method:b.literal("eth_maxPriorityFeePerGas")}),Qae=b.object({method:b.literal("eth_newBlockFilter")}),Zae=b.object({method:b.literal("eth_newFilter"),params:b.array(b.any())}),Jae=b.object({method:b.literal("eth_newPendingTransactionFilter")}),Xae=b.object({method:b.literal("eth_sendRawTransaction"),params:b.array(b.any())}),ece=b.object({method:b.literal("eth_syncing"),params:b.array(b.any())}),tce=b.object({method:b.literal("eth_uninstallFilter"),params:b.array(b.any())}),Ux=b.object({method:b.literal("personal_sign"),params:b.array(b.any())}),nce=b.object({method:b.literal("eth_signTypedData_v4"),params:b.array(b.any())}),rce=b.object({method:b.literal("eth_sendTransaction"),params:b.array(b.any())}),sce=b.object({method:b.literal("solana_signMessage"),params:b.object({message:b.string(),pubkey:b.string()})}),ice=b.object({method:b.literal("solana_signTransaction"),params:b.object({transaction:b.string()})}),oce=b.object({method:b.literal("solana_signAllTransactions"),params:b.object({transactions:b.array(b.string())})}),ace=b.object({method:b.literal("solana_signAndSendTransaction"),params:b.object({transaction:b.string(),options:b.object({skipPreflight:b.boolean().optional(),preflightCommitment:b.enum(["processed","confirmed","finalized","recent","single","singleGossip","root","max"]).optional(),maxRetries:b.number().optional(),minContextSlot:b.number().optional()}).optional()})}),cce=b.object({method:b.literal("wallet_sendCalls"),params:b.array(b.object({chainId:b.string().or(b.number()).optional(),from:b.string().optional(),version:b.string().optional(),capabilities:b.any().optional(),calls:b.array(b.object({to:b.string().startsWith("0x"),data:b.string().startsWith("0x").optional(),value:b.string().optional()}))}))}),lce=b.object({method:b.literal("wallet_getCallsStatus"),params:b.array(b.string())}),uce=b.object({method:b.literal("wallet_getCapabilities"),params:b.array(b.string().or(b.number()).optional()).optional()}),hce=b.object({method:b.literal("wallet_grantPermissions"),params:b.array(b.any())}),dce=b.object({method:b.literal("wallet_revokePermissions"),params:b.any()}),fce=b.object({method:b.literal("wallet_getAssets"),params:b.any()}),$x=b.object({token:b.string()}),pe=b.object({id:b.string().optional()}),p1={appEvent:pe.extend({type:fe("APP_SWITCH_NETWORK"),payload:Yoe}).or(pe.extend({type:fe("APP_CONNECT_EMAIL"),payload:Qoe})).or(pe.extend({type:fe("APP_CONNECT_DEVICE")})).or(pe.extend({type:fe("APP_CONNECT_OTP"),payload:Zoe})).or(pe.extend({type:fe("APP_CONNECT_SOCIAL"),payload:Joe})).or(pe.extend({type:fe("APP_GET_FARCASTER_URI")})).or(pe.extend({type:fe("APP_CONNECT_FARCASTER")})).or(pe.extend({type:fe("APP_GET_USER"),payload:b.optional(Xoe)})).or(pe.extend({type:fe("APP_GET_SOCIAL_REDIRECT_URI"),payload:eae})).or(pe.extend({type:fe("APP_SIGN_OUT")})).or(pe.extend({type:fe("APP_IS_CONNECTED"),payload:b.optional($x)})).or(pe.extend({type:fe("APP_GET_CHAIN_ID")})).or(pe.extend({type:fe("APP_GET_SMART_ACCOUNT_ENABLED_NETWORKS")})).or(pe.extend({type:fe("APP_INIT_SMART_ACCOUNT")})).or(pe.extend({type:fe("APP_SET_PREFERRED_ACCOUNT"),payload:oae})).or(pe.extend({type:fe("APP_RPC_REQUEST"),payload:Ux.or(fce).or(Aae).or(Cae).or(Iae).or(_ae).or(Sae).or(Tae).or(Nae).or(Oae).or(xae).or(Rae).or(Pae).or(kae).or(Dae).or(Uae).or($ae).or(Mae).or(Lae).or(Bae).or(Fae).or(jae).or(Hae).or(Vae).or(qae).or(zae).or(Wae).or(Gae).or(Kae).or(Yae).or(Qae).or(Zae).or(Jae).or(Xae).or(ece).or(tce).or(Ux).or(nce).or(rce).or(sce).or(ice).or(oce).or(ace).or(lce).or(cce).or(uce).or(hce).or(dce).and(b.object({chainId:b.string().or(b.number()).optional(),chainNamespace:b.enum(["eip155","solana","polkadot","bip122","cosmos"]).optional(),rpcUrl:b.string().optional()}))})).or(pe.extend({type:fe("APP_UPDATE_EMAIL"),payload:tae})).or(pe.extend({type:fe("APP_UPDATE_EMAIL_PRIMARY_OTP"),payload:nae})).or(pe.extend({type:fe("APP_UPDATE_EMAIL_SECONDARY_OTP"),payload:rae})).or(pe.extend({type:fe("APP_SYNC_THEME"),payload:sae})).or(pe.extend({type:fe("APP_SYNC_DAPP_DATA"),payload:iae})).or(pe.extend({type:fe("APP_RELOAD")})).or(pe.extend({type:fe("APP_RPC_ABORT")})),frameEvent:pe.extend({type:fe("FRAME_SWITCH_NETWORK_ERROR"),payload:Yt}).or(pe.extend({type:fe("FRAME_SWITCH_NETWORK_SUCCESS"),payload:mae})).or(pe.extend({type:fe("FRAME_CONNECT_EMAIL_SUCCESS"),payload:aae})).or(pe.extend({type:fe("FRAME_CONNECT_EMAIL_ERROR"),payload:Yt})).or(pe.extend({type:fe("FRAME_GET_FARCASTER_URI_SUCCESS"),payload:cae})).or(pe.extend({type:fe("FRAME_GET_FARCASTER_URI_ERROR"),payload:Yt})).or(pe.extend({type:fe("FRAME_CONNECT_FARCASTER_SUCCESS"),payload:lae})).or(pe.extend({type:fe("FRAME_CONNECT_FARCASTER_ERROR"),payload:Yt})).or(pe.extend({type:fe("FRAME_CONNECT_OTP_ERROR"),payload:Yt})).or(pe.extend({type:fe("FRAME_CONNECT_OTP_SUCCESS")})).or(pe.extend({type:fe("FRAME_CONNECT_DEVICE_ERROR"),payload:Yt})).or(pe.extend({type:fe("FRAME_CONNECT_DEVICE_SUCCESS")})).or(pe.extend({type:fe("FRAME_CONNECT_SOCIAL_SUCCESS"),payload:uae})).or(pe.extend({type:fe("FRAME_CONNECT_SOCIAL_ERROR"),payload:Yt})).or(pe.extend({type:fe("FRAME_GET_USER_ERROR"),payload:Yt})).or(pe.extend({type:fe("FRAME_GET_USER_SUCCESS"),payload:dae})).or(pe.extend({type:fe("FRAME_GET_SOCIAL_REDIRECT_URI_ERROR"),payload:Yt})).or(pe.extend({type:fe("FRAME_GET_SOCIAL_REDIRECT_URI_SUCCESS"),payload:fae})).or(pe.extend({type:fe("FRAME_SIGN_OUT_ERROR"),payload:Yt})).or(pe.extend({type:fe("FRAME_SIGN_OUT_SUCCESS")})).or(pe.extend({type:fe("FRAME_IS_CONNECTED_ERROR"),payload:Yt})).or(pe.extend({type:fe("FRAME_IS_CONNECTED_SUCCESS"),payload:pae})).or(pe.extend({type:fe("FRAME_GET_CHAIN_ID_ERROR"),payload:Yt})).or(pe.extend({type:fe("FRAME_GET_CHAIN_ID_SUCCESS"),payload:gae})).or(pe.extend({type:fe("FRAME_RPC_REQUEST_ERROR"),payload:Yt})).or(pe.extend({type:fe("FRAME_RPC_REQUEST_SUCCESS"),payload:vae})).or(pe.extend({type:fe("FRAME_SESSION_UPDATE"),payload:$x})).or(pe.extend({type:fe("FRAME_UPDATE_EMAIL_ERROR"),payload:Yt})).or(pe.extend({type:fe("FRAME_UPDATE_EMAIL_SUCCESS"),payload:hae})).or(pe.extend({type:fe("FRAME_UPDATE_EMAIL_PRIMARY_OTP_ERROR"),payload:Yt})).or(pe.extend({type:fe("FRAME_UPDATE_EMAIL_PRIMARY_OTP_SUCCESS")})).or(pe.extend({type:fe("FRAME_UPDATE_EMAIL_SECONDARY_OTP_ERROR"),payload:Yt})).or(pe.extend({type:fe("FRAME_UPDATE_EMAIL_SECONDARY_OTP_SUCCESS"),payload:yae})).or(pe.extend({type:fe("FRAME_SYNC_THEME_ERROR"),payload:Yt})).or(pe.extend({type:fe("FRAME_SYNC_THEME_SUCCESS")})).or(pe.extend({type:fe("FRAME_SYNC_DAPP_DATA_ERROR"),payload:Yt})).or(pe.extend({type:fe("FRAME_SYNC_DAPP_DATA_SUCCESS")})).or(pe.extend({type:fe("FRAME_GET_SMART_ACCOUNT_ENABLED_NETWORKS_SUCCESS"),payload:wae})).or(pe.extend({type:fe("FRAME_GET_SMART_ACCOUNT_ENABLED_NETWORKS_ERROR"),payload:Yt})).or(pe.extend({type:fe("FRAME_INIT_SMART_ACCOUNT_ERROR"),payload:Yt})).or(pe.extend({type:fe("FRAME_SET_PREFERRED_ACCOUNT_SUCCESS"),payload:Eae})).or(pe.extend({type:fe("FRAME_SET_PREFERRED_ACCOUNT_ERROR"),payload:Yt})).or(pe.extend({type:fe("FRAME_READY"),payload:bae})).or(pe.extend({type:fe("FRAME_RELOAD_ERROR"),payload:Yt})).or(pe.extend({type:fe("FRAME_RELOAD_SUCCESS")}))};function g1(n,e={}){var t;return typeof(e==null?void 0:e.type)=="string"&&((t=e==null?void 0:e.type)==null?void 0:t.includes(n))}function pce({projectId:n,chainId:e,enableLogger:t,rpcUrl:r=H.BLOCKCHAIN_API_RPC_URL,enableCloudAuthAccount:s=!1}){const i=new URL(w9);return i.searchParams.set("projectId",n),i.searchParams.set("chainId",String(e)),i.searchParams.set("version",E9),i.searchParams.set("enableLogger",String(t)),i.searchParams.set("rpcUrl",r),s&&i.searchParams.set("enableCloudAuthAccount","true"),i.toString()}class gce{constructor({projectId:e,isAppClient:t=!1,chainId:r="eip155:1",enableLogger:s=!0,enableCloudAuthAccount:i=!1,rpcUrl:o=H.BLOCKCHAIN_API_RPC_URL}){if(this.iframe=null,this.iframeIsReady=!1,this.initFrame=()=>{const a=document.getElementById("w3m-iframe");this.iframe&&!a&&document.body.appendChild(this.iframe)},this.events={registerFrameEventHandler:(a,c,l)=>{function u({data:h}){var f;if(!g1(ve.FRAME_EVENT_KEY,h))return;const d=p1.frameEvent.safeParse(h);if(!d.success){console.warn("W3mFrame: invalid frame event",d.error.message);return}((f=d.data)==null?void 0:f.id)===a&&(c(d.data),window.removeEventListener("message",u))}Is.isClient&&(window.addEventListener("message",u),l.addEventListener("abort",()=>{window.removeEventListener("message",u)}))},onFrameEvent:a=>{Is.isClient&&window.addEventListener("message",({data:c})=>{if(!g1(ve.FRAME_EVENT_KEY,c))return;const l=p1.frameEvent.safeParse(c);l.success?a(l.data):console.warn("W3mFrame: invalid frame event",l.error.message)})},onAppEvent:a=>{Is.isClient&&window.addEventListener("message",({data:c})=>{if(!g1(ve.APP_EVENT_KEY,c))return;const l=p1.appEvent.safeParse(c);l.success||console.warn("W3mFrame: invalid app event",l.error.message),a(c)})},postAppEvent:a=>{var c;if(Is.isClient){if(!((c=this.iframe)!=null&&c.contentWindow))throw new Error("W3mFrame: iframe is not set");this.iframe.contentWindow.postMessage(a,"*")}},postFrameEvent:a=>{if(Is.isClient){if(!parent)throw new Error("W3mFrame: parent is not set");parent.postMessage(a,"*")}}},this.projectId=e,this.frameLoadPromise=new Promise((a,c)=>{this.frameLoadPromiseResolver={resolve:a,reject:c}}),this.rpcUrl=o,t&&(this.frameLoadPromise=new Promise((a,c)=>{this.frameLoadPromiseResolver={resolve:a,reject:c}}),Is.isClient)){const a=document.createElement("iframe");a.id="w3m-iframe",a.src=pce({projectId:e,chainId:r,enableLogger:s,rpcUrl:this.rpcUrl,enableCloudAuthAccount:i}),a.name="w3m-secure-iframe",a.style.position="fixed",a.style.zIndex="999999",a.style.display="none",a.style.border="none",a.style.animationDelay="0s, 50ms",a.style.borderBottomLeftRadius="clamp(0px, var(--wui-border-radius-l), 44px)",a.style.borderBottomRightRadius="clamp(0px, var(--wui-border-radius-l), 44px)",this.iframe=a,this.iframe.onerror=()=>{var c;(c=this.frameLoadPromiseResolver)==null||c.reject("Unable to load email login dependency")},this.events.onFrameEvent(c=>{var l;c.type==="@w3m-frame/READY"&&(this.iframeIsReady=!0,(l=this.frameLoadPromiseResolver)==null||l.resolve(void 0))})}}get networks(){const e=["eip155:1","eip155:5","eip155:11155111","eip155:10","eip155:420","eip155:42161","eip155:421613","eip155:137","eip155:80001","eip155:42220","eip155:1313161554","eip155:1313161555","eip155:56","eip155:97","eip155:43114","eip155:43113","eip155:324","eip155:280","eip155:100","eip155:8453","eip155:84531","eip155:84532","eip155:7777777","eip155:999","solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp","solana:4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z","solana:EtWTRABZaYq6iMfeYKouRu166VU2xqa1"].map(t=>({[t]:{rpcUrl:`${this.rpcUrl}/v1/?chainId=${t}&projectId=${this.projectId}`,chainId:t}}));return Object.assign({},...e)}}class mce{constructor(e){var i;const t=Rf({level:b9}),{logger:r,chunkLoggerController:s}=r_({opts:t});this.logger=vr(r,this.constructor.name),this.chunkLoggerController=s,typeof window<"u"&&((i=this.chunkLoggerController)!=null&&i.downloadLogsBlobInBrowser)&&(window.downloadAppKitLogsBlob||(window.downloadAppKitLogsBlob={}),window.downloadAppKitLogsBlob.sdk=()=>{var o;(o=this.chunkLoggerController)!=null&&o.downloadLogsBlobInBrowser&&this.chunkLoggerController.downloadLogsBlobInBrowser({projectId:e})})}}class yce{constructor({projectId:e,chainId:t,enableLogger:r=!0,onTimeout:s,abortController:i,getActiveCaipNetwork:o,getCaipNetworks:a,enableCloudAuthAccount:c}){this.openRpcRequests=[],this.isInitialized=!1,r&&(this.w3mLogger=new mce(e)),this.abortController=i,this.getActiveCaipNetwork=o,this.getCaipNetworks=a;const l=this.getRpcUrl(t);this.w3mFrame=new gce({projectId:e,isAppClient:!0,chainId:t,enableLogger:r,rpcUrl:l,enableCloudAuthAccount:c}),this.onTimeout=s,this.getLoginEmailUsed()&&this.createFrame()}async createFrame(){this.w3mFrame.initFrame(),this.initPromise=new Promise(e=>{this.w3mFrame.events.onFrameEvent(t=>{t.type===ve.FRAME_READY&&setTimeout(()=>{e()},500)})}),await this.initPromise,this.isInitialized=!0,this.initPromise=void 0}async init(){if(!this.isInitialized){if(this.initPromise){await this.initPromise;return}await this.createFrame()}}getLoginEmailUsed(){return!!Fn.get(ve.EMAIL_LOGIN_USED_KEY)}getEmail(){return Fn.get(ve.EMAIL)}getUsername(){return Fn.get(ve.SOCIAL_USERNAME)}async reload(){var e;try{await this.appEvent({type:ve.APP_RELOAD})}catch(t){throw(e=this.w3mLogger)==null||e.logger.error({error:t},"Error reloading iframe"),t}}async connectEmail(e){var t;try{Is.checkIfAllowedToTriggerEmail(),await this.init();const r=await this.appEvent({type:ve.APP_CONNECT_EMAIL,payload:e});return this.setNewLastEmailLoginTime(),r}catch(r){throw(t=this.w3mLogger)==null||t.logger.error({error:r},"Error connecting email"),r}}async connectDevice(){var e;try{return this.appEvent({type:ve.APP_CONNECT_DEVICE})}catch(t){throw(e=this.w3mLogger)==null||e.logger.error({error:t},"Error connecting device"),t}}async connectOtp(e){var t;try{return this.appEvent({type:ve.APP_CONNECT_OTP,payload:e})}catch(r){throw(t=this.w3mLogger)==null||t.logger.error({error:r},"Error connecting otp"),r}}async isConnected(){var e;try{if(!this.getLoginEmailUsed())return{isConnected:!1};const t=await this.appEvent({type:ve.APP_IS_CONNECTED});return t!=null&&t.isConnected||this.deleteAuthLoginCache(),t}catch(t){throw this.deleteAuthLoginCache(),(e=this.w3mLogger)==null||e.logger.error({error:t},"Error checking connection"),t}}async getChainId(){var e;try{const t=await this.appEvent({type:ve.APP_GET_CHAIN_ID});return this.setLastUsedChainId(t.chainId),t}catch(t){throw(e=this.w3mLogger)==null||e.logger.error({error:t},"Error getting chain id"),t}}async getSocialRedirectUri(e){var t;try{return await this.init(),this.appEvent({type:ve.APP_GET_SOCIAL_REDIRECT_URI,payload:e})}catch(r){throw(t=this.w3mLogger)==null||t.logger.error({error:r},"Error getting social redirect uri"),r}}async updateEmail(e){var t;try{const r=await this.appEvent({type:ve.APP_UPDATE_EMAIL,payload:e});return this.setNewLastEmailLoginTime(),r}catch(r){throw(t=this.w3mLogger)==null||t.logger.error({error:r},"Error updating email"),r}}async updateEmailPrimaryOtp(e){var t;try{return this.appEvent({type:ve.APP_UPDATE_EMAIL_PRIMARY_OTP,payload:e})}catch(r){throw(t=this.w3mLogger)==null||t.logger.error({error:r},"Error updating email primary otp"),r}}async updateEmailSecondaryOtp(e){var t;try{const r=await this.appEvent({type:ve.APP_UPDATE_EMAIL_SECONDARY_OTP,payload:e});return this.setLoginSuccess(r.newEmail),r}catch(r){throw(t=this.w3mLogger)==null||t.logger.error({error:r},"Error updating email secondary otp"),r}}async syncTheme(e){var t;try{return this.appEvent({type:ve.APP_SYNC_THEME,payload:e})}catch(r){throw(t=this.w3mLogger)==null||t.logger.error({error:r},"Error syncing theme"),r}}async syncDappData(e){var t;try{return this.appEvent({type:ve.APP_SYNC_DAPP_DATA,payload:e})}catch(r){throw(t=this.w3mLogger)==null||t.logger.error({error:r},"Error syncing dapp data"),r}}async getSmartAccountEnabledNetworks(){var e;try{const t=await this.appEvent({type:ve.APP_GET_SMART_ACCOUNT_ENABLED_NETWORKS});return this.persistSmartAccountEnabledNetworks(t.smartAccountEnabledNetworks),t}catch(t){throw this.persistSmartAccountEnabledNetworks([]),(e=this.w3mLogger)==null||e.logger.error({error:t},"Error getting smart account enabled networks"),t}}async setPreferredAccount(e){var t;try{return this.appEvent({type:ve.APP_SET_PREFERRED_ACCOUNT,payload:{type:e}})}catch(r){throw(t=this.w3mLogger)==null||t.logger.error({error:r},"Error setting preferred account"),r}}async connect(e){var t,r;if(e!=null&&e.socialUri)try{await this.init();const s=this.getRpcUrl(e.chainId),i=await this.appEvent({type:ve.APP_CONNECT_SOCIAL,payload:{uri:e.socialUri,preferredAccountType:e.preferredAccountType,chainId:e.chainId,siwxMessage:e.siwxMessage,rpcUrl:s}});return i.userName&&this.setSocialLoginSuccess(i.userName),this.setLoginSuccess(i.email),this.setLastUsedChainId(i.chainId),this.user=i,i}catch(s){throw(t=this.w3mLogger)==null||t.logger.error({error:s},"Error connecting social"),s}else try{const s=(e==null?void 0:e.chainId)||this.getLastUsedChainId()||1,i=await this.getUser({chainId:s,preferredAccountType:e==null?void 0:e.preferredAccountType,siwxMessage:e==null?void 0:e.siwxMessage,rpcUrl:this.getRpcUrl(s)});return this.setLoginSuccess(i.email),this.setLastUsedChainId(i.chainId),this.user=i,i}catch(s){throw(r=this.w3mLogger)==null||r.logger.error({error:s},"Error connecting"),s}}async getUser(e){var t;try{await this.init();const r=(e==null?void 0:e.chainId)||this.getLastUsedChainId()||1,s=await this.appEvent({type:ve.APP_GET_USER,payload:{...e,chainId:r,rpcUrl:this.getRpcUrl(r)}});return this.user=s,s}catch(r){throw(t=this.w3mLogger)==null||t.logger.error({error:r},"Error connecting"),r}}async connectSocial({uri:e,chainId:t,preferredAccountType:r}){var s;try{await this.init();const i=this.getRpcUrl(t),o=await this.appEvent({type:ve.APP_CONNECT_SOCIAL,payload:{uri:e,chainId:t,rpcUrl:i,preferredAccountType:r}});return o.userName&&this.setSocialLoginSuccess(o.userName),o}catch(i){throw(s=this.w3mLogger)==null||s.logger.error({error:i},"Error connecting social"),i}}async getFarcasterUri(){var e;try{return await this.init(),await this.appEvent({type:ve.APP_GET_FARCASTER_URI})}catch(t){throw(e=this.w3mLogger)==null||e.logger.error({error:t},"Error getting farcaster uri"),t}}async connectFarcaster(){var e;try{const t=await this.appEvent({type:ve.APP_CONNECT_FARCASTER});return t.userName&&this.setSocialLoginSuccess(t.userName),t}catch(t){throw(e=this.w3mLogger)==null||e.logger.error({error:t},"Error connecting farcaster"),t}}async switchNetwork({chainId:e}){var t;try{const r=this.getRpcUrl(e),s=await this.appEvent({type:ve.APP_SWITCH_NETWORK,payload:{chainId:e,rpcUrl:r}});return this.setLastUsedChainId(s.chainId),s}catch(r){throw(t=this.w3mLogger)==null||t.logger.error({error:r},"Error switching network"),r}}async disconnect(){var e;try{return this.deleteAuthLoginCache(),await new Promise(async r=>{const s=setTimeout(()=>{r()},3e3);await this.appEvent({type:ve.APP_SIGN_OUT}),clearTimeout(s),r()})}catch(t){throw(e=this.w3mLogger)==null||e.logger.error({error:t},"Error disconnecting"),t}}async request(e){var r,s,i,o,a;const t=e;try{if(vn.GET_CHAIN_ID===e.method)return this.getLastUsedChainId();const c=e.chainNamespace||"eip155",l=(r=this.getActiveCaipNetwork(c))==null?void 0:r.id;t.chainNamespace=c,t.chainId=l,t.rpcUrl=this.getRpcUrl(l),(s=this.rpcRequestHandler)==null||s.call(this,e);const u=await this.appEvent({type:ve.APP_RPC_REQUEST,payload:t});return(i=this.rpcSuccessHandler)==null||i.call(this,u,t),u}catch(c){throw(o=this.rpcErrorHandler)==null||o.call(this,c,t),(a=this.w3mLogger)==null||a.logger.error({error:c},"Error requesting"),c}}onRpcRequest(e){this.rpcRequestHandler=e}onRpcSuccess(e){this.rpcSuccessHandler=e}onRpcError(e){this.rpcErrorHandler=e}onIsConnected(e){this.w3mFrame.events.onFrameEvent(t=>{t.type===ve.FRAME_IS_CONNECTED_SUCCESS&&t.payload.isConnected&&e()})}onNotConnected(e){this.w3mFrame.events.onFrameEvent(t=>{t.type===ve.FRAME_IS_CONNECTED_ERROR&&e(),t.type===ve.FRAME_IS_CONNECTED_SUCCESS&&!t.payload.isConnected&&e()})}onConnect(e){this.w3mFrame.events.onFrameEvent(t=>{t.type===ve.FRAME_GET_USER_SUCCESS&&e(t.payload)})}onSocialConnected(e){this.w3mFrame.events.onFrameEvent(t=>{t.type===ve.FRAME_CONNECT_SOCIAL_SUCCESS&&e(t.payload)})}async getCapabilities(){try{return await this.request({method:"wallet_getCapabilities"})||{}}catch{return{}}}onSetPreferredAccount(e){this.w3mFrame.events.onFrameEvent(t=>{t.type===ve.FRAME_SET_PREFERRED_ACCOUNT_SUCCESS?e(t.payload):t.type===ve.FRAME_SET_PREFERRED_ACCOUNT_ERROR&&e({type:vn.ACCOUNT_TYPES.EOA})})}getAvailableChainIds(){return Object.keys(this.w3mFrame.networks)}async rejectRpcRequests(){var e;try{await Promise.all(this.openRpcRequests.map(async({abortController:t,method:r})=>{vn.SAFE_RPC_METHODS.includes(r)||t.abort(),await this.appEvent({type:ve.APP_RPC_ABORT})})),this.openRpcRequests=[]}catch(t){(e=this.w3mLogger)==null||e.logger.error({error:t},"Error aborting RPC request")}}async appEvent(e){let t,r;function s(c){return c.replace("@w3m-app/","")}const i=[ve.APP_SYNC_DAPP_DATA,ve.APP_SYNC_THEME,ve.APP_SET_PREFERRED_ACCOUNT],o=s(e.type);return!this.w3mFrame.iframeIsReady&&!i.includes(e.type)&&(r=setTimeout(()=>{var c;(c=this.onTimeout)==null||c.call(this,"iframe_load_failed"),this.abortController.abort()},2e4)),await this.w3mFrame.frameLoadPromise,clearTimeout(r),[ve.APP_CONNECT_EMAIL,ve.APP_CONNECT_DEVICE,ve.APP_CONNECT_OTP,ve.APP_CONNECT_SOCIAL,ve.APP_GET_SOCIAL_REDIRECT_URI].map(s).includes(o)&&(t=setTimeout(()=>{var c;(c=this.onTimeout)==null||c.call(this,"iframe_request_timeout"),this.abortController.abort()},12e4)),new Promise((c,l)=>{var f,p,g;const u=Math.random().toString(36).substring(7);(g=(f=this.w3mLogger)==null?void 0:(p=f.logger).info)==null||g.call(p,{event:e,id:u},"Sending app event"),this.w3mFrame.events.postAppEvent({...e,id:u});const h=new AbortController;if(o==="RPC_REQUEST"){const m=e;this.openRpcRequests=[...this.openRpcRequests,{...m.payload,abortController:h}]}h.signal.addEventListener("abort",()=>{o==="RPC_REQUEST"?l(new Error("Request was aborted")):o!=="GET_FARCASTER_URI"&&l(new Error("Something went wrong"))});function d(m,w){var v,A,T;m.id===u&&((A=w==null?void 0:(v=w.logger).info)==null||A.call(v,{framEvent:m,id:u},"Received frame response"),m.type===`@w3m-frame/${o}_SUCCESS`?(t&&clearTimeout(t),r&&clearTimeout(r),"payload"in m&&c(m.payload),c(void 0)):m.type===`@w3m-frame/${o}_ERROR`&&(t&&clearTimeout(t),r&&clearTimeout(r),"payload"in m&&l(new Error(((T=m.payload)==null?void 0:T.message)||"An error occurred")),l(new Error("An error occurred"))))}this.w3mFrame.events.registerFrameEventHandler(u,m=>d(m,this.w3mLogger),this.abortController.signal)})}setNewLastEmailLoginTime(){Fn.set(ve.LAST_EMAIL_LOGIN_TIME,Date.now().toString())}setSocialLoginSuccess(e){Fn.set(ve.SOCIAL_USERNAME,e)}setLoginSuccess(e){e&&Fn.set(ve.EMAIL,e),Fn.set(ve.EMAIL_LOGIN_USED_KEY,"true"),Fn.delete(ve.LAST_EMAIL_LOGIN_TIME)}deleteAuthLoginCache(){Fn.delete(ve.EMAIL_LOGIN_USED_KEY),Fn.delete(ve.EMAIL),Fn.delete(ve.LAST_USED_CHAIN_KEY),Fn.delete(ve.SOCIAL_USERNAME)}setLastUsedChainId(e){e&&Fn.set(ve.LAST_USED_CHAIN_KEY,String(e))}getLastUsedChainId(){const e=Fn.get(ve.LAST_USED_CHAIN_KEY)??void 0,t=Number(e);return isNaN(t)?e:t}persistSmartAccountEnabledNetworks(e){Fn.set(ve.SMART_ACCOUNT_ENABLED_NETWORKS,e.join(","))}getRpcUrl(e){var i,o;let t=e===void 0?void 0:"eip155";typeof e=="string"&&(e.includes(":")?t=(i=Tr.parseCaipNetworkId(e))==null?void 0:i.chainNamespace:Number.isInteger(Number(e))?t="eip155":t="solana");const r=this.getCaipNetworks(t),s=e?r.find(a=>String(a.id)===String(e)||a.caipNetworkId===e):r[0];return(o=s==null?void 0:s.rpcUrls.default.http)==null?void 0:o[0]}}class tg{constructor(){}static getInstance({projectId:e,chainId:t,enableLogger:r,onTimeout:s,abortController:i,getActiveCaipNetwork:o,getCaipNetworks:a}){var c;return tg.instance||(tg.instance=new yce({projectId:e,chainId:t,enableLogger:r,onTimeout:s,abortController:i,getActiveCaipNetwork:o,getCaipNetworks:a,enableCloudAuthAccount:!!((c=z.state.remoteFeatures)!=null&&c.emailCapture)})),tg.instance}}var Mx={};const wce={ACCOUNT_TABS:[{label:"Tokens"},{label:"NFTs"},{label:"Activity"}],SECURE_SITE_ORIGIN:(typeof process<"u"&&typeof Mx<"u"?Mx.NEXT_PUBLIC_SECURE_SITE_ORIGIN:void 0)||"https://secure.walletconnect.org",VIEW_DIRECTION:{Next:"next",Prev:"prev"},DEFAULT_CONNECT_METHOD_ORDER:["email","social","wallet"],ANIMATION_DURATIONS:{HeaderText:120,ModalHeight:150,ViewTransition:150}},vC={filterOutDuplicatesByRDNS(n){const e=z.state.enableEIP6963?se.state.connectors:[],t=Q.getRecentWallets(),r=e.map(a=>{var c;return(c=a.info)==null?void 0:c.rdns}).filter(Boolean),s=t.map(a=>a.rdns).filter(Boolean),i=r.concat(s);if(i.includes("io.metamask.mobile")&&ye.isMobile()){const a=i.indexOf("io.metamask.mobile");i[a]="io.metamask"}return n.filter(a=>!(a!=null&&a.rdns&&i.includes(String(a.rdns))||!(a!=null&&a.rdns)&&e.some(l=>l.name===a.name)))},filterOutDuplicatesByIds(n){const e=se.state.connectors.filter(a=>a.type==="ANNOUNCED"||a.type==="INJECTED"),t=Q.getRecentWallets(),r=e.map(a=>a.explorerId),s=t.map(a=>a.id),i=r.concat(s);return n.filter(a=>!i.includes(a==null?void 0:a.id))},filterOutDuplicateWallets(n){const e=this.filterOutDuplicatesByRDNS(n);return this.filterOutDuplicatesByIds(e)},markWalletsAsInstalled(n){const{connectors:e}=se.state,{featuredWalletIds:t}=z.state,r=e.filter(o=>o.type==="ANNOUNCED").reduce((o,a)=>{var c;return(c=a.info)!=null&&c.rdns&&(o[a.info.rdns]=!0),o},{});return n.map(o=>({...o,installed:!!o.rdns&&!!r[o.rdns??""]})).sort((o,a)=>{const c=Number(a.installed)-Number(o.installed);if(c!==0)return c;if(t!=null&&t.length){const l=t.indexOf(o.id),u=t.indexOf(a.id);if(l!==-1&&u!==-1)return l-u;if(l!==-1)return-1;if(u!==-1)return 1}return 0})},getConnectOrderMethod(n,e){var c;const t=(n==null?void 0:n.connectMethodsOrder)||((c=z.state.features)==null?void 0:c.connectMethodsOrder),r=e||se.state.connectors;if(t)return t;const{injected:s,announced:i}=n0.getConnectorsByType(r,Se.state.recommended,Se.state.featured),o=s.filter(n0.showConnector),a=i.filter(n0.showConnector);return o.length||a.length?["wallet","email","social"]:wce.DEFAULT_CONNECT_METHOD_ORDER},isExcluded(n){const e=!!n.rdns&&Se.state.excludedWallets.some(r=>r.rdns===n.rdns),t=!!n.name&&Se.state.excludedWallets.some(r=>zn.isLowerCaseMatch(r.name,n.name));return e||t},markWalletsWithDisplayIndex(n){return n.map((e,t)=>({...e,display_index:t}))}},n0={getConnectorsByType(n,e,t){const{customWallets:r}=z.state,s=Q.getRecentWallets(),i=vC.filterOutDuplicateWallets(e),o=vC.filterOutDuplicateWallets(t),a=n.filter(h=>h.type==="MULTI_CHAIN"),c=n.filter(h=>h.type==="ANNOUNCED"),l=n.filter(h=>h.type==="INJECTED"),u=n.filter(h=>h.type==="EXTERNAL");return{custom:r,recent:s,external:u,multiChain:a,announced:c,injected:l,recommended:i,featured:o}},showConnector(n){var s;const e=(s=n.info)==null?void 0:s.rdns,t=!!e&&Se.state.excludedWallets.some(i=>!!i.rdns&&i.rdns===e),r=!!n.name&&Se.state.excludedWallets.some(i=>zn.isLowerCaseMatch(i.name,n.name));return!(n.type==="INJECTED"&&(n.name==="Browser Wallet"&&(!ye.isMobile()||ye.isMobile()&&!e&&!ie.checkInstalled())||t||r)||(n.type==="ANNOUNCED"||n.type==="EXTERNAL")&&(t||r))},getIsConnectedWithWC(){return Array.from(I.state.chains.values()).some(t=>se.getConnectorId(t.namespace)===H.CONNECTOR_ID.WALLET_CONNECT)},getConnectorTypeOrder({recommended:n,featured:e,custom:t,recent:r,announced:s,injected:i,multiChain:o,external:a,overriddenConnectors:c=(l=>(l=z.state.features)==null?void 0:l.connectorTypeOrder)()??[]}){const d=[{type:"walletConnect",isEnabled:z.state.enableWalletConnect},{type:"recent",isEnabled:r.length>0},{type:"injected",isEnabled:[...i,...s,...o].length>0},{type:"featured",isEnabled:e.length>0},{type:"custom",isEnabled:t&&t.length>0},{type:"external",isEnabled:a.length>0},{type:"recommended",isEnabled:n.length>0}].filter(m=>m.isEnabled),f=new Set(d.map(m=>m.type)),p=c.filter(m=>f.has(m)).map(m=>({type:m,isEnabled:!0})),g=d.filter(({type:m})=>!p.some(({type:v})=>v===m));return Array.from(new Set([...p,...g].map(({type:m})=>m)))},getAuthName({email:n,socialUsername:e,socialProvider:t}){return e?t&&t==="discord"&&e.endsWith("0")?e.slice(0,-1):e:n.length>30?`${n.slice(0,-3)}...`:n},async fetchProviderData(n){var e,t;try{if(n.name==="Browser Wallet"&&!ye.isMobile())return{accounts:[],chainId:void 0};if(n.id===H.CONNECTOR_ID.AUTH)return{accounts:[],chainId:void 0};const[r,s]=await Promise.all([(e=n.provider)==null?void 0:e.request({method:"eth_accounts"}),(t=n.provider)==null?void 0:t.request({method:"eth_chainId"}).then(i=>Number(i))]);return{accounts:r,chainId:s}}catch(r){return console.warn(`Failed to fetch provider data for ${n.name}`,r),{accounts:[],chainId:void 0}}}};/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const r0=globalThis,B_=r0.ShadowRoot&&(r0.ShadyCSS===void 0||r0.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,F_=Symbol(),Lx=new WeakMap;let EM=class{constructor(e,t,r){if(this._$cssResult$=!0,r!==F_)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=e,this.t=t}get styleSheet(){let e=this.o;const t=this.t;if(B_&&e===void 0){const r=t!==void 0&&t.length===1;r&&(e=Lx.get(t)),e===void 0&&((this.o=e=new CSSStyleSheet).replaceSync(this.cssText),r&&Lx.set(t,e))}return e}toString(){return this.cssText}};const Bs=n=>new EM(typeof n=="string"?n:n+"",void 0,F_),sc=(n,...e)=>{const t=n.length===1?n[0]:e.reduce((r,s,i)=>r+(o=>{if(o._$cssResult$===!0)return o.cssText;if(typeof o=="number")return o;throw Error("Value passed to 'css' function must be a 'css' function result: "+o+". Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.")})(s)+n[i+1],n[0]);return new EM(t,n,F_)},bce=(n,e)=>{if(B_)n.adoptedStyleSheets=e.map(t=>t instanceof CSSStyleSheet?t:t.styleSheet);else for(const t of e){const r=document.createElement("style"),s=r0.litNonce;s!==void 0&&r.setAttribute("nonce",s),r.textContent=t.cssText,n.appendChild(r)}},Bx=B_?n=>n:n=>n instanceof CSSStyleSheet?(e=>{let t="";for(const r of e.cssRules)t+=r.cssText;return Bs(t)})(n):n;/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const{is:Ece,defineProperty:vce,getOwnPropertyDescriptor:Ace,getOwnPropertyNames:Cce,getOwnPropertySymbols:Ice,getPrototypeOf:_ce}=Object,Tc=globalThis,Fx=Tc.trustedTypes,Sce=Fx?Fx.emptyScript:"",m1=Tc.reactiveElementPolyfillSupport,ng=(n,e)=>n,AC={toAttribute(n,e){switch(e){case Boolean:n=n?Sce:null;break;case Object:case Array:n=n==null?n:JSON.stringify(n)}return n},fromAttribute(n,e){let t=n;switch(e){case Boolean:t=n!==null;break;case Number:t=n===null?null:Number(n);break;case Object:case Array:try{t=JSON.parse(n)}catch{t=null}}return t}},vM=(n,e)=>!Ece(n,e),jx={attribute:!0,type:String,converter:AC,reflect:!1,useDefault:!1,hasChanged:vM};Symbol.metadata??(Symbol.metadata=Symbol("metadata")),Tc.litPropertyMetadata??(Tc.litPropertyMetadata=new WeakMap);let Oh=class extends HTMLElement{static addInitializer(e){this._$Ei(),(this.l??(this.l=[])).push(e)}static get observedAttributes(){return this.finalize(),this._$Eh&&[...this._$Eh.keys()]}static createProperty(e,t=jx){if(t.state&&(t.attribute=!1),this._$Ei(),this.prototype.hasOwnProperty(e)&&((t=Object.create(t)).wrapped=!0),this.elementProperties.set(e,t),!t.noAccessor){const r=Symbol(),s=this.getPropertyDescriptor(e,r,t);s!==void 0&&vce(this.prototype,e,s)}}static getPropertyDescriptor(e,t,r){const{get:s,set:i}=Ace(this.prototype,e)??{get(){return this[t]},set(o){this[t]=o}};return{get:s,set(o){const a=s==null?void 0:s.call(this);i==null||i.call(this,o),this.requestUpdate(e,a,r)},configurable:!0,enumerable:!0}}static getPropertyOptions(e){return this.elementProperties.get(e)??jx}static _$Ei(){if(this.hasOwnProperty(ng("elementProperties")))return;const e=_ce(this);e.finalize(),e.l!==void 0&&(this.l=[...e.l]),this.elementProperties=new Map(e.elementProperties)}static finalize(){if(this.hasOwnProperty(ng("finalized")))return;if(this.finalized=!0,this._$Ei(),this.hasOwnProperty(ng("properties"))){const t=this.properties,r=[...Cce(t),...Ice(t)];for(const s of r)this.createProperty(s,t[s])}const e=this[Symbol.metadata];if(e!==null){const t=litPropertyMetadata.get(e);if(t!==void 0)for(const[r,s]of t)this.elementProperties.set(r,s)}this._$Eh=new Map;for(const[t,r]of this.elementProperties){const s=this._$Eu(t,r);s!==void 0&&this._$Eh.set(s,t)}this.elementStyles=this.finalizeStyles(this.styles)}static finalizeStyles(e){const t=[];if(Array.isArray(e)){const r=new Set(e.flat(1/0).reverse());for(const s of r)t.unshift(Bx(s))}else e!==void 0&&t.push(Bx(e));return t}static _$Eu(e,t){const r=t.attribute;return r===!1?void 0:typeof r=="string"?r:typeof e=="string"?e.toLowerCase():void 0}constructor(){super(),this._$Ep=void 0,this.isUpdatePending=!1,this.hasUpdated=!1,this._$Em=null,this._$Ev()}_$Ev(){var e;this._$ES=new Promise(t=>this.enableUpdating=t),this._$AL=new Map,this._$E_(),this.requestUpdate(),(e=this.constructor.l)==null||e.forEach(t=>t(this))}addController(e){var t;(this._$EO??(this._$EO=new Set)).add(e),this.renderRoot!==void 0&&this.isConnected&&((t=e.hostConnected)==null||t.call(e))}removeController(e){var t;(t=this._$EO)==null||t.delete(e)}_$E_(){const e=new Map,t=this.constructor.elementProperties;for(const r of t.keys())this.hasOwnProperty(r)&&(e.set(r,this[r]),delete this[r]);e.size>0&&(this._$Ep=e)}createRenderRoot(){const e=this.shadowRoot??this.attachShadow(this.constructor.shadowRootOptions);return bce(e,this.constructor.elementStyles),e}connectedCallback(){var e;this.renderRoot??(this.renderRoot=this.createRenderRoot()),this.enableUpdating(!0),(e=this._$EO)==null||e.forEach(t=>{var r;return(r=t.hostConnected)==null?void 0:r.call(t)})}enableUpdating(e){}disconnectedCallback(){var e;(e=this._$EO)==null||e.forEach(t=>{var r;return(r=t.hostDisconnected)==null?void 0:r.call(t)})}attributeChangedCallback(e,t,r){this._$AK(e,r)}_$ET(e,t){var i;const r=this.constructor.elementProperties.get(e),s=this.constructor._$Eu(e,r);if(s!==void 0&&r.reflect===!0){const o=(((i=r.converter)==null?void 0:i.toAttribute)!==void 0?r.converter:AC).toAttribute(t,r.type);this._$Em=e,o==null?this.removeAttribute(s):this.setAttribute(s,o),this._$Em=null}}_$AK(e,t){var i,o;const r=this.constructor,s=r._$Eh.get(e);if(s!==void 0&&this._$Em!==s){const a=r.getPropertyOptions(s),c=typeof a.converter=="function"?{fromAttribute:a.converter}:((i=a.converter)==null?void 0:i.fromAttribute)!==void 0?a.converter:AC;this._$Em=s;const l=c.fromAttribute(t,a.type);this[s]=l??((o=this._$Ej)==null?void 0:o.get(s))??l,this._$Em=null}}requestUpdate(e,t,r){var s;if(e!==void 0){const i=this.constructor,o=this[e];if(r??(r=i.getPropertyOptions(e)),!((r.hasChanged??vM)(o,t)||r.useDefault&&r.reflect&&o===((s=this._$Ej)==null?void 0:s.get(e))&&!this.hasAttribute(i._$Eu(e,r))))return;this.C(e,t,r)}this.isUpdatePending===!1&&(this._$ES=this._$EP())}C(e,t,{useDefault:r,reflect:s,wrapped:i},o){r&&!(this._$Ej??(this._$Ej=new Map)).has(e)&&(this._$Ej.set(e,o??t??this[e]),i!==!0||o!==void 0)||(this._$AL.has(e)||(this.hasUpdated||r||(t=void 0),this._$AL.set(e,t)),s===!0&&this._$Em!==e&&(this._$Eq??(this._$Eq=new Set)).add(e))}async _$EP(){this.isUpdatePending=!0;try{await this._$ES}catch(t){Promise.reject(t)}const e=this.scheduleUpdate();return e!=null&&await e,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){var r;if(!this.isUpdatePending)return;if(!this.hasUpdated){if(this.renderRoot??(this.renderRoot=this.createRenderRoot()),this._$Ep){for(const[i,o]of this._$Ep)this[i]=o;this._$Ep=void 0}const s=this.constructor.elementProperties;if(s.size>0)for(const[i,o]of s){const{wrapped:a}=o,c=this[i];a!==!0||this._$AL.has(i)||c===void 0||this.C(i,void 0,o,c)}}let e=!1;const t=this._$AL;try{e=this.shouldUpdate(t),e?(this.willUpdate(t),(r=this._$EO)==null||r.forEach(s=>{var i;return(i=s.hostUpdate)==null?void 0:i.call(s)}),this.update(t)):this._$EM()}catch(s){throw e=!1,this._$EM(),s}e&&this._$AE(t)}willUpdate(e){}_$AE(e){var t;(t=this._$EO)==null||t.forEach(r=>{var s;return(s=r.hostUpdated)==null?void 0:s.call(r)}),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(e)),this.updated(e)}_$EM(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$ES}shouldUpdate(e){return!0}update(e){this._$Eq&&(this._$Eq=this._$Eq.forEach(t=>this._$ET(t,this[t]))),this._$EM()}updated(e){}firstUpdated(e){}};Oh.elementStyles=[],Oh.shadowRootOptions={mode:"open"},Oh[ng("elementProperties")]=new Map,Oh[ng("finalized")]=new Map,m1==null||m1({ReactiveElement:Oh}),(Tc.reactiveElementVersions??(Tc.reactiveElementVersions=[])).push("2.1.1");/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const rg=globalThis,X0=rg.trustedTypes,Hx=X0?X0.createPolicy("lit-html",{createHTML:n=>n}):void 0,AM="$lit$",ic=`lit$${Math.random().toFixed(9).slice(2)}$`,CM="?"+ic,Tce=`<${CM}>`,vu=document,im=()=>vu.createComment(""),om=n=>n===null||typeof n!="object"&&typeof n!="function",j_=Array.isArray,Nce=n=>j_(n)||typeof(n==null?void 0:n[Symbol.iterator])=="function",y1=`[ 	
\f\r]`,bp=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,Vx=/-->/g,qx=/>/g,ol=RegExp(`>|${y1}(?:([^\\s"'>=/]+)(${y1}*=${y1}*(?:[^ 	
\f\r"'\`<>=]|("|')|))|$)`,"g"),zx=/'/g,Wx=/"/g,IM=/^(?:script|style|textarea|title)$/i,_M=n=>(e,...t)=>({_$litType$:n,strings:e,values:t}),Mve=_M(1),Lve=_M(2),lf=Symbol.for("lit-noChange"),xn=Symbol.for("lit-nothing"),Gx=new WeakMap,Sl=vu.createTreeWalker(vu,129);function SM(n,e){if(!j_(n)||!n.hasOwnProperty("raw"))throw Error("invalid template strings array");return Hx!==void 0?Hx.createHTML(e):e}const Oce=(n,e)=>{const t=n.length-1,r=[];let s,i=e===2?"<svg>":e===3?"<math>":"",o=bp;for(let a=0;a<t;a++){const c=n[a];let l,u,h=-1,d=0;for(;d<c.length&&(o.lastIndex=d,u=o.exec(c),u!==null);)d=o.lastIndex,o===bp?u[1]==="!--"?o=Vx:u[1]!==void 0?o=qx:u[2]!==void 0?(IM.test(u[2])&&(s=RegExp("</"+u[2],"g")),o=ol):u[3]!==void 0&&(o=ol):o===ol?u[0]===">"?(o=s??bp,h=-1):u[1]===void 0?h=-2:(h=o.lastIndex-u[2].length,l=u[1],o=u[3]===void 0?ol:u[3]==='"'?Wx:zx):o===Wx||o===zx?o=ol:o===Vx||o===qx?o=bp:(o=ol,s=void 0);const f=o===ol&&n[a+1].startsWith("/>")?" ":"";i+=o===bp?c+Tce:h>=0?(r.push(l),c.slice(0,h)+AM+c.slice(h)+ic+f):c+ic+(h===-2?a:f)}return[SM(n,i+(n[t]||"<?>")+(e===2?"</svg>":e===3?"</math>":"")),r]};let CC=class TM{constructor({strings:e,_$litType$:t},r){let s;this.parts=[];let i=0,o=0;const a=e.length-1,c=this.parts,[l,u]=Oce(e,t);if(this.el=TM.createElement(l,r),Sl.currentNode=this.el.content,t===2||t===3){const h=this.el.content.firstChild;h.replaceWith(...h.childNodes)}for(;(s=Sl.nextNode())!==null&&c.length<a;){if(s.nodeType===1){if(s.hasAttributes())for(const h of s.getAttributeNames())if(h.endsWith(AM)){const d=u[o++],f=s.getAttribute(h).split(ic),p=/([.?@])?(.*)/.exec(d);c.push({type:1,index:i,name:p[2],strings:f,ctor:p[1]==="."?Rce:p[1]==="?"?Pce:p[1]==="@"?kce:dE}),s.removeAttribute(h)}else h.startsWith(ic)&&(c.push({type:6,index:i}),s.removeAttribute(h));if(IM.test(s.tagName)){const h=s.textContent.split(ic),d=h.length-1;if(d>0){s.textContent=X0?X0.emptyScript:"";for(let f=0;f<d;f++)s.append(h[f],im()),Sl.nextNode(),c.push({type:2,index:++i});s.append(h[d],im())}}}else if(s.nodeType===8)if(s.data===CM)c.push({type:2,index:i});else{let h=-1;for(;(h=s.data.indexOf(ic,h+1))!==-1;)c.push({type:7,index:i}),h+=ic.length-1}i++}}static createElement(e,t){const r=vu.createElement("template");return r.innerHTML=e,r}};function uf(n,e,t=n,r){var o,a;if(e===lf)return e;let s=r!==void 0?(o=t._$Co)==null?void 0:o[r]:t._$Cl;const i=om(e)?void 0:e._$litDirective$;return(s==null?void 0:s.constructor)!==i&&((a=s==null?void 0:s._$AO)==null||a.call(s,!1),i===void 0?s=void 0:(s=new i(n),s._$AT(n,t,r)),r!==void 0?(t._$Co??(t._$Co=[]))[r]=s:t._$Cl=s),s!==void 0&&(e=uf(n,s._$AS(n,e.values),s,r)),e}let xce=class{constructor(e,t){this._$AV=[],this._$AN=void 0,this._$AD=e,this._$AM=t}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(e){const{el:{content:t},parts:r}=this._$AD,s=((e==null?void 0:e.creationScope)??vu).importNode(t,!0);Sl.currentNode=s;let i=Sl.nextNode(),o=0,a=0,c=r[0];for(;c!==void 0;){if(o===c.index){let l;c.type===2?l=new H_(i,i.nextSibling,this,e):c.type===1?l=new c.ctor(i,c.name,c.strings,this,e):c.type===6&&(l=new Dce(i,this,e)),this._$AV.push(l),c=r[++a]}o!==(c==null?void 0:c.index)&&(i=Sl.nextNode(),o++)}return Sl.currentNode=vu,s}p(e){let t=0;for(const r of this._$AV)r!==void 0&&(r.strings!==void 0?(r._$AI(e,r,t),t+=r.strings.length-2):r._$AI(e[t])),t++}},H_=class NM{get _$AU(){var e;return((e=this._$AM)==null?void 0:e._$AU)??this._$Cv}constructor(e,t,r,s){this.type=2,this._$AH=xn,this._$AN=void 0,this._$AA=e,this._$AB=t,this._$AM=r,this.options=s,this._$Cv=(s==null?void 0:s.isConnected)??!0}get parentNode(){let e=this._$AA.parentNode;const t=this._$AM;return t!==void 0&&(e==null?void 0:e.nodeType)===11&&(e=t.parentNode),e}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(e,t=this){e=uf(this,e,t),om(e)?e===xn||e==null||e===""?(this._$AH!==xn&&this._$AR(),this._$AH=xn):e!==this._$AH&&e!==lf&&this._(e):e._$litType$!==void 0?this.$(e):e.nodeType!==void 0?this.T(e):Nce(e)?this.k(e):this._(e)}O(e){return this._$AA.parentNode.insertBefore(e,this._$AB)}T(e){this._$AH!==e&&(this._$AR(),this._$AH=this.O(e))}_(e){this._$AH!==xn&&om(this._$AH)?this._$AA.nextSibling.data=e:this.T(vu.createTextNode(e)),this._$AH=e}$(e){var i;const{values:t,_$litType$:r}=e,s=typeof r=="number"?this._$AC(e):(r.el===void 0&&(r.el=CC.createElement(SM(r.h,r.h[0]),this.options)),r);if(((i=this._$AH)==null?void 0:i._$AD)===s)this._$AH.p(t);else{const o=new xce(s,this),a=o.u(this.options);o.p(t),this.T(a),this._$AH=o}}_$AC(e){let t=Gx.get(e.strings);return t===void 0&&Gx.set(e.strings,t=new CC(e)),t}k(e){j_(this._$AH)||(this._$AH=[],this._$AR());const t=this._$AH;let r,s=0;for(const i of e)s===t.length?t.push(r=new NM(this.O(im()),this.O(im()),this,this.options)):r=t[s],r._$AI(i),s++;s<t.length&&(this._$AR(r&&r._$AB.nextSibling,s),t.length=s)}_$AR(e=this._$AA.nextSibling,t){var r;for((r=this._$AP)==null?void 0:r.call(this,!1,!0,t);e!==this._$AB;){const s=e.nextSibling;e.remove(),e=s}}setConnected(e){var t;this._$AM===void 0&&(this._$Cv=e,(t=this._$AP)==null||t.call(this,e))}},dE=class{get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}constructor(e,t,r,s,i){this.type=1,this._$AH=xn,this._$AN=void 0,this.element=e,this.name=t,this._$AM=s,this.options=i,r.length>2||r[0]!==""||r[1]!==""?(this._$AH=Array(r.length-1).fill(new String),this.strings=r):this._$AH=xn}_$AI(e,t=this,r,s){const i=this.strings;let o=!1;if(i===void 0)e=uf(this,e,t,0),o=!om(e)||e!==this._$AH&&e!==lf,o&&(this._$AH=e);else{const a=e;let c,l;for(e=i[0],c=0;c<i.length-1;c++)l=uf(this,a[r+c],t,c),l===lf&&(l=this._$AH[c]),o||(o=!om(l)||l!==this._$AH[c]),l===xn?e=xn:e!==xn&&(e+=(l??"")+i[c+1]),this._$AH[c]=l}o&&!s&&this.j(e)}j(e){e===xn?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,e??"")}},Rce=class extends dE{constructor(){super(...arguments),this.type=3}j(e){this.element[this.name]=e===xn?void 0:e}},Pce=class extends dE{constructor(){super(...arguments),this.type=4}j(e){this.element.toggleAttribute(this.name,!!e&&e!==xn)}},kce=class extends dE{constructor(e,t,r,s,i){super(e,t,r,s,i),this.type=5}_$AI(e,t=this){if((e=uf(this,e,t,0)??xn)===lf)return;const r=this._$AH,s=e===xn&&r!==xn||e.capture!==r.capture||e.once!==r.once||e.passive!==r.passive,i=e!==xn&&(r===xn||s);s&&this.element.removeEventListener(this.name,this,r),i&&this.element.addEventListener(this.name,this,e),this._$AH=e}handleEvent(e){var t;typeof this._$AH=="function"?this._$AH.call(((t=this.options)==null?void 0:t.host)??this.element,e):this._$AH.handleEvent(e)}},Dce=class{constructor(e,t,r){this.element=e,this.type=6,this._$AN=void 0,this._$AM=t,this.options=r}get _$AU(){return this._$AM._$AU}_$AI(e){uf(this,e)}};const w1=rg.litHtmlPolyfillSupport;w1==null||w1(CC,H_),(rg.litHtmlVersions??(rg.litHtmlVersions=[])).push("3.3.1");const Uce=(n,e,t)=>{const r=(t==null?void 0:t.renderBefore)??e;let s=r._$litPart$;if(s===void 0){const i=(t==null?void 0:t.renderBefore)??null;r._$litPart$=s=new H_(e.insertBefore(im(),i),i,void 0,t??{})}return s._$AI(n),s};/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const cu=globalThis;class s0 extends Oh{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){var t;const e=super.createRenderRoot();return(t=this.renderOptions).renderBefore??(t.renderBefore=e.firstChild),e}update(e){const t=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(e),this._$Do=Uce(t,this.renderRoot,this.renderOptions)}connectedCallback(){var e;super.connectedCallback(),(e=this._$Do)==null||e.setConnected(!0)}disconnectedCallback(){var e;super.disconnectedCallback(),(e=this._$Do)==null||e.setConnected(!1)}render(){return lf}}var Tk;s0._$litElement$=!0,s0.finalized=!0,(Tk=cu.litElementHydrateSupport)==null||Tk.call(cu,{LitElement:s0});const b1=cu.litElementPolyfillSupport;b1==null||b1({LitElement:s0});(cu.litElementVersions??(cu.litElementVersions=[])).push("4.2.1");let sg,Nc,Oc;function zve(n,e){sg=document.createElement("style"),Nc=document.createElement("style"),Oc=document.createElement("style"),sg.textContent=Zh(n).core.cssText,Nc.textContent=Zh(n).dark.cssText,Oc.textContent=Zh(n).light.cssText,document.head.appendChild(sg),document.head.appendChild(Nc),document.head.appendChild(Oc),OM(e)}function OM(n){Nc&&Oc&&(n==="light"?(Nc.removeAttribute("media"),Oc.media="enabled"):(Oc.removeAttribute("media"),Nc.media="enabled"))}function $ce(n){sg&&Nc&&Oc&&(sg.textContent=Zh(n).core.cssText,Nc.textContent=Zh(n).dark.cssText,Oc.textContent=Zh(n).light.cssText)}function Zh(n){return{core:sc`
      ${n!=null&&n["--w3m-font-family"]?sc``:sc`
            @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
          `}
      @keyframes w3m-shake {
        0% {
          transform: scale(1) rotate(0deg);
        }
        20% {
          transform: scale(1) rotate(-1deg);
        }
        40% {
          transform: scale(1) rotate(1.5deg);
        }
        60% {
          transform: scale(1) rotate(-1.5deg);
        }
        80% {
          transform: scale(1) rotate(1deg);
        }
        100% {
          transform: scale(1) rotate(0deg);
        }
      }
      @keyframes w3m-iframe-fade-out {
        0% {
          opacity: 1;
        }
        100% {
          opacity: 0;
        }
      }
      @keyframes w3m-iframe-zoom-in {
        0% {
          transform: translateY(50px);
          opacity: 0;
        }
        100% {
          transform: translateY(0px);
          opacity: 1;
        }
      }
      @keyframes w3m-iframe-zoom-in-mobile {
        0% {
          transform: scale(0.95);
          opacity: 0;
        }
        100% {
          transform: scale(1);
          opacity: 1;
        }
      }
      :root {
        --w3m-modal-width: 360px;
        --w3m-color-mix-strength: ${Bs(n!=null&&n["--w3m-color-mix-strength"]?`${n["--w3m-color-mix-strength"]}%`:"0%")};
        --w3m-font-family: ${Bs((n==null?void 0:n["--w3m-font-family"])||"Inter, Segoe UI, Roboto, Oxygen, Ubuntu, Cantarell, Fira Sans, Droid Sans, Helvetica Neue, sans-serif;")};
        --w3m-font-size-master: ${Bs((n==null?void 0:n["--w3m-font-size-master"])||"10px")};
        --w3m-border-radius-master: ${Bs((n==null?void 0:n["--w3m-border-radius-master"])||"4px")};
        --w3m-z-index: ${Bs((n==null?void 0:n["--w3m-z-index"])||999)};

        --wui-font-family: var(--w3m-font-family);

        --wui-font-size-mini: calc(var(--w3m-font-size-master) * 0.8);
        --wui-font-size-micro: var(--w3m-font-size-master);
        --wui-font-size-tiny: calc(var(--w3m-font-size-master) * 1.2);
        --wui-font-size-small: calc(var(--w3m-font-size-master) * 1.4);
        --wui-font-size-paragraph: calc(var(--w3m-font-size-master) * 1.6);
        --wui-font-size-medium: calc(var(--w3m-font-size-master) * 1.8);
        --wui-font-size-large: calc(var(--w3m-font-size-master) * 2);
        --wui-font-size-title-6: calc(var(--w3m-font-size-master) * 2.2);
        --wui-font-size-medium-title: calc(var(--w3m-font-size-master) * 2.4);
        --wui-font-size-2xl: calc(var(--w3m-font-size-master) * 4);

        --wui-border-radius-5xs: var(--w3m-border-radius-master);
        --wui-border-radius-4xs: calc(var(--w3m-border-radius-master) * 1.5);
        --wui-border-radius-3xs: calc(var(--w3m-border-radius-master) * 2);
        --wui-border-radius-xxs: calc(var(--w3m-border-radius-master) * 3);
        --wui-border-radius-xs: calc(var(--w3m-border-radius-master) * 4);
        --wui-border-radius-s: calc(var(--w3m-border-radius-master) * 5);
        --wui-border-radius-m: calc(var(--w3m-border-radius-master) * 7);
        --wui-border-radius-l: calc(var(--w3m-border-radius-master) * 9);
        --wui-border-radius-3xl: calc(var(--w3m-border-radius-master) * 20);

        --wui-font-weight-light: 400;
        --wui-font-weight-regular: 500;
        --wui-font-weight-medium: 600;
        --wui-font-weight-bold: 700;

        --wui-letter-spacing-2xl: -1.6px;
        --wui-letter-spacing-medium-title: -0.96px;
        --wui-letter-spacing-title-6: -0.88px;
        --wui-letter-spacing-large: -0.8px;
        --wui-letter-spacing-medium: -0.72px;
        --wui-letter-spacing-paragraph: -0.64px;
        --wui-letter-spacing-small: -0.56px;
        --wui-letter-spacing-tiny: -0.48px;
        --wui-letter-spacing-micro: -0.2px;
        --wui-letter-spacing-mini: -0.16px;

        --wui-spacing-0: 0px;
        --wui-spacing-4xs: 2px;
        --wui-spacing-3xs: 4px;
        --wui-spacing-xxs: 6px;
        --wui-spacing-2xs: 7px;
        --wui-spacing-xs: 8px;
        --wui-spacing-1xs: 10px;
        --wui-spacing-s: 12px;
        --wui-spacing-m: 14px;
        --wui-spacing-l: 16px;
        --wui-spacing-2l: 18px;
        --wui-spacing-xl: 20px;
        --wui-spacing-xxl: 24px;
        --wui-spacing-2xl: 32px;
        --wui-spacing-3xl: 40px;
        --wui-spacing-4xl: 90px;
        --wui-spacing-5xl: 95px;

        --wui-icon-box-size-xxs: 14px;
        --wui-icon-box-size-xs: 20px;
        --wui-icon-box-size-sm: 24px;
        --wui-icon-box-size-md: 32px;
        --wui-icon-box-size-mdl: 36px;
        --wui-icon-box-size-lg: 40px;
        --wui-icon-box-size-2lg: 48px;
        --wui-icon-box-size-xl: 64px;

        --wui-icon-size-inherit: inherit;
        --wui-icon-size-xxs: 10px;
        --wui-icon-size-xs: 12px;
        --wui-icon-size-sm: 14px;
        --wui-icon-size-md: 16px;
        --wui-icon-size-mdl: 18px;
        --wui-icon-size-lg: 20px;
        --wui-icon-size-xl: 24px;
        --wui-icon-size-xxl: 28px;

        --wui-wallet-image-size-inherit: inherit;
        --wui-wallet-image-size-sm: 40px;
        --wui-wallet-image-size-md: 56px;
        --wui-wallet-image-size-lg: 80px;

        --wui-visual-size-size-inherit: inherit;
        --wui-visual-size-sm: 40px;
        --wui-visual-size-md: 55px;
        --wui-visual-size-lg: 80px;

        --wui-box-size-md: 100px;
        --wui-box-size-lg: 120px;

        --wui-ease-out-power-2: cubic-bezier(0, 0, 0.22, 1);
        --wui-ease-out-power-1: cubic-bezier(0, 0, 0.55, 1);

        --wui-ease-in-power-3: cubic-bezier(0.66, 0, 1, 1);
        --wui-ease-in-power-2: cubic-bezier(0.45, 0, 1, 1);
        --wui-ease-in-power-1: cubic-bezier(0.3, 0, 1, 1);

        --wui-ease-inout-power-1: cubic-bezier(0.45, 0, 0.55, 1);

        --wui-duration-lg: 200ms;
        --wui-duration-md: 125ms;
        --wui-duration-sm: 75ms;

        --wui-path-network-sm: path(
          'M15.4 2.1a5.21 5.21 0 0 1 5.2 0l11.61 6.7a5.21 5.21 0 0 1 2.61 4.52v13.4c0 1.87-1 3.59-2.6 4.52l-11.61 6.7c-1.62.93-3.6.93-5.22 0l-11.6-6.7a5.21 5.21 0 0 1-2.61-4.51v-13.4c0-1.87 1-3.6 2.6-4.52L15.4 2.1Z'
        );

        --wui-path-network-md: path(
          'M43.4605 10.7248L28.0485 1.61089C25.5438 0.129705 22.4562 0.129705 19.9515 1.61088L4.53951 10.7248C2.03626 12.2051 0.5 14.9365 0.5 17.886V36.1139C0.5 39.0635 2.03626 41.7949 4.53951 43.2752L19.9515 52.3891C22.4562 53.8703 25.5438 53.8703 28.0485 52.3891L43.4605 43.2752C45.9637 41.7949 47.5 39.0635 47.5 36.114V17.8861C47.5 14.9365 45.9637 12.2051 43.4605 10.7248Z'
        );

        --wui-path-network-lg: path(
          'M78.3244 18.926L50.1808 2.45078C45.7376 -0.150261 40.2624 -0.150262 35.8192 2.45078L7.6756 18.926C3.23322 21.5266 0.5 26.3301 0.5 31.5248V64.4752C0.5 69.6699 3.23322 74.4734 7.6756 77.074L35.8192 93.5492C40.2624 96.1503 45.7376 96.1503 50.1808 93.5492L78.3244 77.074C82.7668 74.4734 85.5 69.6699 85.5 64.4752V31.5248C85.5 26.3301 82.7668 21.5266 78.3244 18.926Z'
        );

        --wui-width-network-sm: 36px;
        --wui-width-network-md: 48px;
        --wui-width-network-lg: 86px;

        --wui-height-network-sm: 40px;
        --wui-height-network-md: 54px;
        --wui-height-network-lg: 96px;

        --wui-icon-size-network-xs: 12px;
        --wui-icon-size-network-sm: 16px;
        --wui-icon-size-network-md: 24px;
        --wui-icon-size-network-lg: 42px;

        --wui-color-inherit: inherit;

        --wui-color-inverse-100: #fff;
        --wui-color-inverse-000: #000;

        --wui-cover: rgba(20, 20, 20, 0.8);

        --wui-color-modal-bg: var(--wui-color-modal-bg-base);

        --wui-color-accent-100: var(--wui-color-accent-base-100);
        --wui-color-accent-090: var(--wui-color-accent-base-090);
        --wui-color-accent-080: var(--wui-color-accent-base-080);

        --wui-color-success-100: var(--wui-color-success-base-100);
        --wui-color-success-125: var(--wui-color-success-base-125);

        --wui-color-warning-100: var(--wui-color-warning-base-100);

        --wui-color-error-100: var(--wui-color-error-base-100);
        --wui-color-error-125: var(--wui-color-error-base-125);

        --wui-color-blue-100: var(--wui-color-blue-base-100);
        --wui-color-blue-90: var(--wui-color-blue-base-90);

        --wui-icon-box-bg-error-100: var(--wui-icon-box-bg-error-base-100);
        --wui-icon-box-bg-blue-100: var(--wui-icon-box-bg-blue-base-100);
        --wui-icon-box-bg-success-100: var(--wui-icon-box-bg-success-base-100);
        --wui-icon-box-bg-inverse-100: var(--wui-icon-box-bg-inverse-base-100);

        --wui-all-wallets-bg-100: var(--wui-all-wallets-bg-100);

        --wui-avatar-border: var(--wui-avatar-border-base);

        --wui-thumbnail-border: var(--wui-thumbnail-border-base);

        --wui-wallet-button-bg: var(--wui-wallet-button-bg-base);

        --wui-box-shadow-blue: var(--wui-color-accent-glass-020);
      }

      @supports (background: color-mix(in srgb, white 50%, black)) {
        :root {
          --wui-color-modal-bg: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-modal-bg-base)
          );

          --wui-box-shadow-blue: color-mix(in srgb, var(--wui-color-accent-100) 20%, transparent);

          --wui-color-accent-100: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 100%,
            transparent
          );
          --wui-color-accent-090: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 90%,
            transparent
          );
          --wui-color-accent-080: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 80%,
            transparent
          );
          --wui-color-accent-glass-090: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 90%,
            transparent
          );
          --wui-color-accent-glass-080: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 80%,
            transparent
          );
          --wui-color-accent-glass-020: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 20%,
            transparent
          );
          --wui-color-accent-glass-015: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 15%,
            transparent
          );
          --wui-color-accent-glass-010: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 10%,
            transparent
          );
          --wui-color-accent-glass-005: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 5%,
            transparent
          );
          --wui-color-accent-002: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 2%,
            transparent
          );

          --wui-color-fg-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-100)
          );
          --wui-color-fg-125: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-125)
          );
          --wui-color-fg-150: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-150)
          );
          --wui-color-fg-175: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-175)
          );
          --wui-color-fg-200: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-200)
          );
          --wui-color-fg-225: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-225)
          );
          --wui-color-fg-250: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-250)
          );
          --wui-color-fg-275: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-275)
          );
          --wui-color-fg-300: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-300)
          );
          --wui-color-fg-325: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-325)
          );
          --wui-color-fg-350: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-350)
          );

          --wui-color-bg-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-100)
          );
          --wui-color-bg-125: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-125)
          );
          --wui-color-bg-150: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-150)
          );
          --wui-color-bg-175: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-175)
          );
          --wui-color-bg-200: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-200)
          );
          --wui-color-bg-225: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-225)
          );
          --wui-color-bg-250: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-250)
          );
          --wui-color-bg-275: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-275)
          );
          --wui-color-bg-300: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-300)
          );
          --wui-color-bg-325: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-325)
          );
          --wui-color-bg-350: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-350)
          );

          --wui-color-success-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-success-base-100)
          );
          --wui-color-success-125: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-success-base-125)
          );

          --wui-color-warning-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-warning-base-100)
          );

          --wui-color-error-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-error-base-100)
          );
          --wui-color-blue-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-blue-base-100)
          );
          --wui-color-blue-90: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-blue-base-90)
          );
          --wui-color-error-125: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-error-base-125)
          );

          --wui-icon-box-bg-error-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-icon-box-bg-error-base-100)
          );
          --wui-icon-box-bg-accent-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-icon-box-bg-blue-base-100)
          );
          --wui-icon-box-bg-success-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-icon-box-bg-success-base-100)
          );
          --wui-icon-box-bg-inverse-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-icon-box-bg-inverse-base-100)
          );

          --wui-all-wallets-bg-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-all-wallets-bg-100)
          );

          --wui-avatar-border: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-avatar-border-base)
          );

          --wui-thumbnail-border: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-thumbnail-border-base)
          );

          --wui-wallet-button-bg: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-wallet-button-bg-base)
          );
        }
      }
    `,light:sc`
      :root {
        --w3m-color-mix: ${Bs((n==null?void 0:n["--w3m-color-mix"])||"#fff")};
        --w3m-accent: ${Bs(ia(n,"dark")["--w3m-accent"])};
        --w3m-default: #fff;

        --wui-color-modal-bg-base: ${Bs(ia(n,"dark")["--w3m-background"])};
        --wui-color-accent-base-100: var(--w3m-accent);

        --wui-color-blueberry-100: hsla(230, 100%, 67%, 1);
        --wui-color-blueberry-090: hsla(231, 76%, 61%, 1);
        --wui-color-blueberry-080: hsla(230, 59%, 55%, 1);
        --wui-color-blueberry-050: hsla(231, 100%, 70%, 0.1);

        --wui-color-fg-100: #e4e7e7;
        --wui-color-fg-125: #d0d5d5;
        --wui-color-fg-150: #a8b1b1;
        --wui-color-fg-175: #a8b0b0;
        --wui-color-fg-200: #949e9e;
        --wui-color-fg-225: #868f8f;
        --wui-color-fg-250: #788080;
        --wui-color-fg-275: #788181;
        --wui-color-fg-300: #6e7777;
        --wui-color-fg-325: #9a9a9a;
        --wui-color-fg-350: #363636;

        --wui-color-bg-100: #141414;
        --wui-color-bg-125: #191a1a;
        --wui-color-bg-150: #1e1f1f;
        --wui-color-bg-175: #222525;
        --wui-color-bg-200: #272a2a;
        --wui-color-bg-225: #2c3030;
        --wui-color-bg-250: #313535;
        --wui-color-bg-275: #363b3b;
        --wui-color-bg-300: #3b4040;
        --wui-color-bg-325: #252525;
        --wui-color-bg-350: #ffffff;

        --wui-color-success-base-100: #26d962;
        --wui-color-success-base-125: #30a46b;

        --wui-color-warning-base-100: #f3a13f;

        --wui-color-error-base-100: #f25a67;
        --wui-color-error-base-125: #df4a34;

        --wui-color-blue-base-100: rgba(102, 125, 255, 1);
        --wui-color-blue-base-90: rgba(102, 125, 255, 0.9);

        --wui-color-success-glass-001: rgba(38, 217, 98, 0.01);
        --wui-color-success-glass-002: rgba(38, 217, 98, 0.02);
        --wui-color-success-glass-005: rgba(38, 217, 98, 0.05);
        --wui-color-success-glass-010: rgba(38, 217, 98, 0.1);
        --wui-color-success-glass-015: rgba(38, 217, 98, 0.15);
        --wui-color-success-glass-020: rgba(38, 217, 98, 0.2);
        --wui-color-success-glass-025: rgba(38, 217, 98, 0.25);
        --wui-color-success-glass-030: rgba(38, 217, 98, 0.3);
        --wui-color-success-glass-060: rgba(38, 217, 98, 0.6);
        --wui-color-success-glass-080: rgba(38, 217, 98, 0.8);

        --wui-color-success-glass-reown-020: rgba(48, 164, 107, 0.2);

        --wui-color-warning-glass-reown-020: rgba(243, 161, 63, 0.2);

        --wui-color-error-glass-001: rgba(242, 90, 103, 0.01);
        --wui-color-error-glass-002: rgba(242, 90, 103, 0.02);
        --wui-color-error-glass-005: rgba(242, 90, 103, 0.05);
        --wui-color-error-glass-010: rgba(242, 90, 103, 0.1);
        --wui-color-error-glass-015: rgba(242, 90, 103, 0.15);
        --wui-color-error-glass-020: rgba(242, 90, 103, 0.2);
        --wui-color-error-glass-025: rgba(242, 90, 103, 0.25);
        --wui-color-error-glass-030: rgba(242, 90, 103, 0.3);
        --wui-color-error-glass-060: rgba(242, 90, 103, 0.6);
        --wui-color-error-glass-080: rgba(242, 90, 103, 0.8);

        --wui-color-error-glass-reown-020: rgba(223, 74, 52, 0.2);

        --wui-color-gray-glass-001: rgba(255, 255, 255, 0.01);
        --wui-color-gray-glass-002: rgba(255, 255, 255, 0.02);
        --wui-color-gray-glass-005: rgba(255, 255, 255, 0.05);
        --wui-color-gray-glass-010: rgba(255, 255, 255, 0.1);
        --wui-color-gray-glass-015: rgba(255, 255, 255, 0.15);
        --wui-color-gray-glass-020: rgba(255, 255, 255, 0.2);
        --wui-color-gray-glass-025: rgba(255, 255, 255, 0.25);
        --wui-color-gray-glass-030: rgba(255, 255, 255, 0.3);
        --wui-color-gray-glass-060: rgba(255, 255, 255, 0.6);
        --wui-color-gray-glass-080: rgba(255, 255, 255, 0.8);
        --wui-color-gray-glass-090: rgba(255, 255, 255, 0.9);

        --wui-color-dark-glass-100: rgba(42, 42, 42, 1);

        --wui-icon-box-bg-error-base-100: #3c2426;
        --wui-icon-box-bg-blue-base-100: #20303f;
        --wui-icon-box-bg-success-base-100: #1f3a28;
        --wui-icon-box-bg-inverse-base-100: #243240;

        --wui-all-wallets-bg-100: #222b35;

        --wui-avatar-border-base: #252525;

        --wui-thumbnail-border-base: #252525;

        --wui-wallet-button-bg-base: var(--wui-color-bg-125);

        --w3m-card-embedded-shadow-color: rgb(17 17 18 / 25%);
      }
    `,dark:sc`
      :root {
        --w3m-color-mix: ${Bs((n==null?void 0:n["--w3m-color-mix"])||"#000")};
        --w3m-accent: ${Bs(ia(n,"light")["--w3m-accent"])};
        --w3m-default: #000;

        --wui-color-modal-bg-base: ${Bs(ia(n,"light")["--w3m-background"])};
        --wui-color-accent-base-100: var(--w3m-accent);

        --wui-color-blueberry-100: hsla(231, 100%, 70%, 1);
        --wui-color-blueberry-090: hsla(231, 97%, 72%, 1);
        --wui-color-blueberry-080: hsla(231, 92%, 74%, 1);

        --wui-color-fg-100: #141414;
        --wui-color-fg-125: #2d3131;
        --wui-color-fg-150: #474d4d;
        --wui-color-fg-175: #636d6d;
        --wui-color-fg-200: #798686;
        --wui-color-fg-225: #828f8f;
        --wui-color-fg-250: #8b9797;
        --wui-color-fg-275: #95a0a0;
        --wui-color-fg-300: #9ea9a9;
        --wui-color-fg-325: #9a9a9a;
        --wui-color-fg-350: #d0d0d0;

        --wui-color-bg-100: #ffffff;
        --wui-color-bg-125: #f5fafa;
        --wui-color-bg-150: #f3f8f8;
        --wui-color-bg-175: #eef4f4;
        --wui-color-bg-200: #eaf1f1;
        --wui-color-bg-225: #e5eded;
        --wui-color-bg-250: #e1e9e9;
        --wui-color-bg-275: #dce7e7;
        --wui-color-bg-300: #d8e3e3;
        --wui-color-bg-325: #f3f3f3;
        --wui-color-bg-350: #202020;

        --wui-color-success-base-100: #26b562;
        --wui-color-success-base-125: #30a46b;

        --wui-color-warning-base-100: #f3a13f;

        --wui-color-error-base-100: #f05142;
        --wui-color-error-base-125: #df4a34;

        --wui-color-blue-base-100: rgba(102, 125, 255, 1);
        --wui-color-blue-base-90: rgba(102, 125, 255, 0.9);

        --wui-color-success-glass-001: rgba(38, 181, 98, 0.01);
        --wui-color-success-glass-002: rgba(38, 181, 98, 0.02);
        --wui-color-success-glass-005: rgba(38, 181, 98, 0.05);
        --wui-color-success-glass-010: rgba(38, 181, 98, 0.1);
        --wui-color-success-glass-015: rgba(38, 181, 98, 0.15);
        --wui-color-success-glass-020: rgba(38, 181, 98, 0.2);
        --wui-color-success-glass-025: rgba(38, 181, 98, 0.25);
        --wui-color-success-glass-030: rgba(38, 181, 98, 0.3);
        --wui-color-success-glass-060: rgba(38, 181, 98, 0.6);
        --wui-color-success-glass-080: rgba(38, 181, 98, 0.8);

        --wui-color-success-glass-reown-020: rgba(48, 164, 107, 0.2);

        --wui-color-warning-glass-reown-020: rgba(243, 161, 63, 0.2);

        --wui-color-error-glass-001: rgba(240, 81, 66, 0.01);
        --wui-color-error-glass-002: rgba(240, 81, 66, 0.02);
        --wui-color-error-glass-005: rgba(240, 81, 66, 0.05);
        --wui-color-error-glass-010: rgba(240, 81, 66, 0.1);
        --wui-color-error-glass-015: rgba(240, 81, 66, 0.15);
        --wui-color-error-glass-020: rgba(240, 81, 66, 0.2);
        --wui-color-error-glass-025: rgba(240, 81, 66, 0.25);
        --wui-color-error-glass-030: rgba(240, 81, 66, 0.3);
        --wui-color-error-glass-060: rgba(240, 81, 66, 0.6);
        --wui-color-error-glass-080: rgba(240, 81, 66, 0.8);

        --wui-color-error-glass-reown-020: rgba(223, 74, 52, 0.2);

        --wui-icon-box-bg-error-base-100: #f4dfdd;
        --wui-icon-box-bg-blue-base-100: #d9ecfb;
        --wui-icon-box-bg-success-base-100: #daf0e4;
        --wui-icon-box-bg-inverse-base-100: #dcecfc;

        --wui-all-wallets-bg-100: #e8f1fa;

        --wui-avatar-border-base: #f3f4f4;

        --wui-thumbnail-border-base: #eaefef;

        --wui-wallet-button-bg-base: var(--wui-color-bg-125);

        --wui-color-gray-glass-001: rgba(0, 0, 0, 0.01);
        --wui-color-gray-glass-002: rgba(0, 0, 0, 0.02);
        --wui-color-gray-glass-005: rgba(0, 0, 0, 0.05);
        --wui-color-gray-glass-010: rgba(0, 0, 0, 0.1);
        --wui-color-gray-glass-015: rgba(0, 0, 0, 0.15);
        --wui-color-gray-glass-020: rgba(0, 0, 0, 0.2);
        --wui-color-gray-glass-025: rgba(0, 0, 0, 0.25);
        --wui-color-gray-glass-030: rgba(0, 0, 0, 0.3);
        --wui-color-gray-glass-060: rgba(0, 0, 0, 0.6);
        --wui-color-gray-glass-080: rgba(0, 0, 0, 0.8);
        --wui-color-gray-glass-090: rgba(0, 0, 0, 0.9);

        --wui-color-dark-glass-100: rgba(233, 233, 233, 1);

        --w3m-card-embedded-shadow-color: rgb(224 225 233 / 25%);
      }
    `}}const Wve=sc`
  *,
  *::after,
  *::before,
  :host {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    font-style: normal;
    text-rendering: optimizeSpeed;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    -webkit-tap-highlight-color: transparent;
    font-family: var(--wui-font-family);
    backface-visibility: hidden;
  }
`,Gve=sc`
  button,
  a {
    cursor: pointer;
    display: flex;
    justify-content: center;
    align-items: center;
    position: relative;
    transition:
      color var(--wui-duration-lg) var(--wui-ease-out-power-1),
      background-color var(--wui-duration-lg) var(--wui-ease-out-power-1),
      border var(--wui-duration-lg) var(--wui-ease-out-power-1),
      border-radius var(--wui-duration-lg) var(--wui-ease-out-power-1),
      box-shadow var(--wui-duration-lg) var(--wui-ease-out-power-1);
    will-change: background-color, color, border, box-shadow, border-radius;
    outline: none;
    border: none;
    column-gap: var(--wui-spacing-3xs);
    background-color: transparent;
    text-decoration: none;
  }

  wui-flex {
    transition: border-radius var(--wui-duration-lg) var(--wui-ease-out-power-1);
    will-change: border-radius;
  }

  button:disabled > wui-wallet-image,
  button:disabled > wui-all-wallets-image,
  button:disabled > wui-network-image,
  button:disabled > wui-image,
  button:disabled > wui-transaction-visual,
  button:disabled > wui-logo {
    filter: grayscale(1);
  }

  @media (hover: hover) and (pointer: fine) {
    button:hover:enabled {
      background-color: var(--wui-color-gray-glass-005);
    }

    button:active:enabled {
      background-color: var(--wui-color-gray-glass-010);
    }
  }

  button:disabled > wui-icon-box {
    opacity: 0.5;
  }

  input {
    border: none;
    outline: none;
    appearance: none;
  }
`,Kve=sc`
  .wui-color-inherit {
    color: var(--wui-color-inherit);
  }

  .wui-color-accent-100 {
    color: var(--wui-color-accent-100);
  }

  .wui-color-error-100 {
    color: var(--wui-color-error-100);
  }

  .wui-color-blue-100 {
    color: var(--wui-color-blue-100);
  }

  .wui-color-blue-90 {
    color: var(--wui-color-blue-90);
  }

  .wui-color-error-125 {
    color: var(--wui-color-error-125);
  }

  .wui-color-success-100 {
    color: var(--wui-color-success-100);
  }

  .wui-color-success-125 {
    color: var(--wui-color-success-125);
  }

  .wui-color-inverse-100 {
    color: var(--wui-color-inverse-100);
  }

  .wui-color-inverse-000 {
    color: var(--wui-color-inverse-000);
  }

  .wui-color-fg-100 {
    color: var(--wui-color-fg-100);
  }

  .wui-color-fg-200 {
    color: var(--wui-color-fg-200);
  }

  .wui-color-fg-300 {
    color: var(--wui-color-fg-300);
  }

  .wui-color-fg-325 {
    color: var(--wui-color-fg-325);
  }

  .wui-color-fg-350 {
    color: var(--wui-color-fg-350);
  }

  .wui-bg-color-inherit {
    background-color: var(--wui-color-inherit);
  }

  .wui-bg-color-blue-100 {
    background-color: var(--wui-color-accent-100);
  }

  .wui-bg-color-error-100 {
    background-color: var(--wui-color-error-100);
  }

  .wui-bg-color-error-125 {
    background-color: var(--wui-color-error-125);
  }

  .wui-bg-color-success-100 {
    background-color: var(--wui-color-success-100);
  }

  .wui-bg-color-success-125 {
    background-color: var(--wui-color-success-100);
  }

  .wui-bg-color-inverse-100 {
    background-color: var(--wui-color-inverse-100);
  }

  .wui-bg-color-inverse-000 {
    background-color: var(--wui-color-inverse-000);
  }

  .wui-bg-color-fg-100 {
    background-color: var(--wui-color-fg-100);
  }

  .wui-bg-color-fg-200 {
    background-color: var(--wui-color-fg-200);
  }

  .wui-bg-color-fg-300 {
    background-color: var(--wui-color-fg-300);
  }

  .wui-color-fg-325 {
    background-color: var(--wui-color-fg-325);
  }

  .wui-color-fg-350 {
    background-color: var(--wui-color-fg-350);
  }
`,Jh={hexStringToNumber(n){const e=n.startsWith("0x")?n.slice(2):n;return parseInt(e,16)},numberToHexString(n){return`0x${n.toString(16)}`},async getUserInfo(n){const[e,t]=await Promise.all([Jh.getAddresses(n),Jh.getChainId(n)]);return{chainId:t,addresses:e}},async getChainId(n){const e=await n.request({method:"eth_chainId"});return Number(e)},async getAddress(n){const[e]=await n.request({method:"eth_accounts"});return e},async getAddresses(n){return await n.request({method:"eth_accounts"})},async addEthereumChain(n,e){var r,s;const t=((r=e.rpcUrls.chainDefault)==null?void 0:r.http)||[];await n.request({method:"wallet_addEthereumChain",params:[{chainId:Jh.numberToHexString(e.id),rpcUrls:[...t],chainName:e.name,nativeCurrency:{name:e.nativeCurrency.name,decimals:e.nativeCurrency.decimals,symbol:e.nativeCurrency.symbol},blockExplorerUrls:[(s=e.blockExplorers)==null?void 0:s.default.url],iconUrls:[oo.NetworkImageIds[e.id]]}]})}},bh={ACCOUNT_INDEXES:{PAYMENT:0,ORDINAL:1}},xM=n3({id:1,name:"Ethereum",nativeCurrency:{name:"Ether",symbol:"ETH",decimals:18},blockTime:12e3,rpcUrls:{default:{http:["https://eth.merkle.io"]}},blockExplorers:{default:{name:"Etherscan",url:"https://etherscan.io",apiUrl:"https://api.etherscan.io/api"}},contracts:{ensUniversalResolver:{address:"0xeeeeeeee14d718c2b47d9923deab1335e144eeee",blockCreated:23085558},multicall3:{address:"0xca11bde05977b3631167028862be2a173976ca11",blockCreated:14353601}}}),Mce=n3({id:11155111,name:"Sepolia",nativeCurrency:{name:"Sepolia Ether",symbol:"ETH",decimals:18},rpcUrls:{default:{http:["https://sepolia.drpc.org"]}},blockExplorers:{default:{name:"Etherscan",url:"https://sepolia.etherscan.io",apiUrl:"https://api-sepolia.etherscan.io/api"}},contracts:{multicall3:{address:"0xca11bde05977b3631167028862be2a173976ca11",blockCreated:751532},ensUniversalResolver:{address:"0xeeeeeeee14d718c2b47d9923deab1335e144eeee",blockCreated:8928790}},testnet:!0});function wy(n){return{formatters:void 0,fees:void 0,serializers:void 0,...n}}const Kx=wy({id:"5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp",name:"Solana",network:"solana-mainnet",nativeCurrency:{name:"Solana",symbol:"SOL",decimals:9},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}},blockExplorers:{default:{name:"Solscan",url:"https://solscan.io"}},testnet:!1,chainNamespace:"solana",caipNetworkId:"solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp",deprecatedCaipNetworkId:"solana:4sGjMW1sUnHzSxGspuhpqLDx6wiyjNtZ"}),Yx=wy({id:"EtWTRABZaYq6iMfeYKouRu166VU2xqa1",name:"Solana Devnet",network:"solana-devnet",nativeCurrency:{name:"Solana",symbol:"SOL",decimals:9},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}},blockExplorers:{default:{name:"Solscan",url:"https://solscan.io"}},testnet:!0,chainNamespace:"solana",caipNetworkId:"solana:EtWTRABZaYq6iMfeYKouRu166VU2xqa1",deprecatedCaipNetworkId:"solana:8E9rvCKLFQia2Y35HXjjpWzj8weVo44K"});wy({id:"4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z",name:"Solana Testnet",network:"solana-testnet",nativeCurrency:{name:"Solana",symbol:"SOL",decimals:9},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}},blockExplorers:{default:{name:"Solscan",url:"https://solscan.io"}},testnet:!0,chainNamespace:"solana",caipNetworkId:"solana:4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z"});wy({id:"000000000019d6689c085ae165831e93",caipNetworkId:"bip122:000000000019d6689c085ae165831e93",chainNamespace:"bip122",name:"Bitcoin",nativeCurrency:{name:"Bitcoin",symbol:"BTC",decimals:8},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}}});wy({id:"000000000933ea01ad0ee984209779ba",caipNetworkId:"bip122:000000000933ea01ad0ee984209779ba",chainNamespace:"bip122",name:"Bitcoin Testnet",nativeCurrency:{name:"Bitcoin",symbol:"BTC",decimals:8},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}},testnet:!0});const Lce={solana:["solana_signMessage","solana_signTransaction","solana_requestAccounts","solana_getAccounts","solana_signAllTransactions","solana_signAndSendTransaction"],eip155:["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode","wallet_getCallsStatus","wallet_showCallsStatus","wallet_sendCalls","wallet_getCapabilities","wallet_grantPermissions","wallet_revokePermissions","wallet_getAssets"],bip122:["sendTransfer","signMessage","signPsbt","getAccountAddresses"]},da={getMethodsByChainNamespace(n){return Lce[n]||[]},createDefaultNamespace(n){return{methods:this.getMethodsByChainNamespace(n),events:["accountsChanged","chainChanged"],chains:[],rpcMap:{}}},applyNamespaceOverrides(n,e){if(!e)return{...n};const t={...n},r=new Set;if(e.methods&&Object.keys(e.methods).forEach(s=>r.add(s)),e.chains&&Object.keys(e.chains).forEach(s=>r.add(s)),e.events&&Object.keys(e.events).forEach(s=>r.add(s)),e.rpcMap&&Object.keys(e.rpcMap).forEach(s=>{const[i]=s.split(":");i&&r.add(i)}),r.forEach(s=>{t[s]||(t[s]=this.createDefaultNamespace(s))}),e.methods&&Object.entries(e.methods).forEach(([s,i])=>{t[s]&&(t[s].methods=i)}),e.chains&&Object.entries(e.chains).forEach(([s,i])=>{t[s]&&(t[s].chains=i)}),e.events&&Object.entries(e.events).forEach(([s,i])=>{t[s]&&(t[s].events=i)}),e.rpcMap){const s=new Set;Object.entries(e.rpcMap).forEach(([i,o])=>{const[a,c]=i.split(":");!a||!c||!t[a]||(t[a].rpcMap||(t[a].rpcMap={}),s.has(a)||(t[a].rpcMap={},s.add(a)),t[a].rpcMap[c]=o)})}return t},createNamespaces(n,e){const t=n.reduce((r,s)=>{const{id:i,chainNamespace:o,rpcUrls:a}=s,c=a.default.http[0];r[o]||(r[o]=this.createDefaultNamespace(o));const l=`${o}:${i}`,u=r[o];switch(u.chains.push(l),l){case Kx.caipNetworkId:u.chains.push(Kx.deprecatedCaipNetworkId);break;case Yx.caipNetworkId:u.chains.push(Yx.deprecatedCaipNetworkId);break}return u!=null&&u.rpcMap&&c&&(u.rpcMap[i]=c),r},{});return this.applyNamespaceOverrides(t,e)},resolveReownName:async n=>{var r;const e=await zp.resolveName(n);return((r=(Object.values(e==null?void 0:e.addresses)||[])[0])==null?void 0:r.address)||!1},getChainsFromNamespaces(n={}){return Object.values(n).flatMap(e=>{const t=e.chains||[],r=e.accounts.map(s=>{const[i,o]=s.split(":");return`${i}:${o}`});return Array.from(new Set([...t,...r]))})},isSessionEventData(n){return typeof n=="object"&&n!==null&&"id"in n&&"topic"in n&&"params"in n&&typeof n.params=="object"&&n.params!==null&&"chainId"in n.params&&"event"in n.params&&typeof n.params.event=="object"&&n.params.event!==null},isOriginAllowed(n,e,t){for(const r of[...e,...t])if(r.includes("*")){const i=`^${r.replace(/[.*+?^${}()|[\]\\]/gu,"\\$&").replace(/\\\*/gu,".*")}$`;if(new RegExp(i,"u").test(n))return!0}else try{if(new URL(r).origin===n)return!0}catch{if(r===n)return!0}return!1},listenWcProvider({universalProvider:n,namespace:e,onConnect:t,onDisconnect:r,onAccountsChanged:s,onChainChanged:i,onDisplayUri:o}){t&&n.on("connect",()=>{const a=da.getWalletConnectAccounts(n,e);t(a)}),r&&n.on("disconnect",()=>{r()}),s&&n.on("accountsChanged",a=>{var c,l,u,h,d;try{const f=((u=(l=(c=n.session)==null?void 0:c.namespaces)==null?void 0:l[e])==null?void 0:u.accounts)||[],p=(d=(h=n.rpcProviders)==null?void 0:h[e])==null?void 0:d.getDefaultChain(),g=a.map(m=>{const w=f.find(T=>T.includes(`${e}:${p}:${m}`));if(!w)return;const{chainId:v,chainNamespace:A}=Tr.parseCaipAddress(w);return{address:m,chainId:v,chainNamespace:A}}).filter(m=>m!==void 0);g.length>0&&s(g)}catch(f){console.warn("Failed to parse accounts for namespace on accountsChanged event",e,a,f)}}),i&&n.on("chainChanged",a=>{i(a)}),o&&n.on("display_uri",a=>{o(a)})},getWalletConnectAccounts(n,e){var s,i,o,a;const t=new Set,r=(a=(o=(i=(s=n==null?void 0:n.session)==null?void 0:s.namespaces)==null?void 0:i[e])==null?void 0:o.accounts)==null?void 0:a.map(c=>Tr.parseCaipAddress(c)).filter(({address:c})=>t.has(c.toLowerCase())?!1:(t.add(c.toLowerCase()),!0));return r&&r.length>0?r:[]}};class Bce{constructor(e){this.namespace=e.namespace}async syncConnections(e){switch(this.namespace){case H.CHAIN.EVM:await this.syncEVMConnections(e);break;case H.CHAIN.SOLANA:await this.syncSolanaConnections(e);break;case H.CHAIN.BITCOIN:await this.syncBitcoinConnections(e);break;default:throw new Error(`Unsupported chain namespace: ${this.namespace}`)}}async syncEVMConnections({connectors:e,caipNetworks:t,universalProvider:r,getConnectionStatusInfo:s,onConnection:i,onListenProvider:o}){await Promise.all(e.filter(a=>{const{hasDisconnected:c,hasConnected:l}=s(a.id);return!c&&l}).map(async a=>{if(a.id===H.CONNECTOR_ID.WALLET_CONNECT){const c=da.getWalletConnectAccounts(r,this.namespace),l=t.find(u=>{var h,d;return u.chainNamespace===this.namespace&&u.id.toString()===((d=(h=c[0])==null?void 0:h.chainId)==null?void 0:d.toString())});c.length>0&&i({connectorId:a.id,accounts:c.map(u=>({address:u.address})),caipNetwork:l})}else{const{accounts:c,chainId:l}=await n0.fetchProviderData(a);if(c.length>0&&l){const u=t.find(h=>h.chainNamespace===this.namespace&&h.id.toString()===l.toString());i({connectorId:a.id,accounts:c.map(h=>({address:h})),caipNetwork:u}),a.provider&&a.id!==H.CONNECTOR_ID.AUTH&&a.id!==H.CONNECTOR_ID.WALLET_CONNECT&&o(a.id,a.provider)}}}))}async syncSolanaConnections({connectors:e,caipNetwork:t,universalProvider:r,getConnectionStatusInfo:s,onConnection:i,onListenProvider:o}){await Promise.all(e.filter(a=>{const{hasDisconnected:c,hasConnected:l}=s(a.id);return!c&&l}).map(async a=>{if(a.id===H.CONNECTOR_ID.WALLET_CONNECT){const c=da.getWalletConnectAccounts(r,this.namespace);c.length>0&&i({connectorId:a.id,accounts:c.map(l=>({address:l.address})),caipNetwork:t})}else{const c=await a.connect({chainId:t==null?void 0:t.id});c&&(i({connectorId:a.id,accounts:[{address:c}],caipNetwork:t}),o(a.id,a.provider))}}))}async syncBitcoinConnections({connectors:e,caipNetwork:t,universalProvider:r,getConnectionStatusInfo:s,onConnection:i,onListenProvider:o}){await Promise.all(e.filter(a=>{const{hasDisconnected:c,hasConnected:l}=s(a.id);return!c&&l}).map(async a=>{var d,f,p,g,m,w;if(a.id===H.CONNECTOR_ID.WALLET_CONNECT){const v=da.getWalletConnectAccounts(r,this.namespace);v.length>0&&i({connectorId:a.id,accounts:v.map(A=>({address:A.address})),caipNetwork:t});return}const c=await a.connect(),l=await a.getAccountAddresses();let u=l==null?void 0:l.map(v=>ye.createAccount(H.CHAIN.BITCOIN,v.address,v.purpose||"payment",v.publicKey,v.path));if(u&&u.length>1&&(u=[{namespace:H.CHAIN.BITCOIN,publicKey:((d=u[bh.ACCOUNT_INDEXES.PAYMENT])==null?void 0:d.publicKey)??"",path:((f=u[bh.ACCOUNT_INDEXES.PAYMENT])==null?void 0:f.path)??"",address:((p=u[bh.ACCOUNT_INDEXES.PAYMENT])==null?void 0:p.address)??"",type:"payment"},{namespace:H.CHAIN.BITCOIN,publicKey:((g=u[bh.ACCOUNT_INDEXES.ORDINAL])==null?void 0:g.publicKey)??"",path:((m=u[bh.ACCOUNT_INDEXES.ORDINAL])==null?void 0:m.path)??"",address:((w=u[bh.ACCOUNT_INDEXES.ORDINAL])==null?void 0:w.address)??"",type:"ordinal"}]),!(a.chains.find(v=>v.id===(t==null?void 0:t.id))||a.chains[0]))throw new Error("The connector does not support any of the requested chains");c&&(o(a.id,a.provider),i({connectorId:a.id,accounts:u.map(v=>({address:v.address,type:v.type})),caipNetwork:t}))}))}getConnection({address:e,connectorId:t,connections:r,connectors:s}){if(t){const o=r.find(l=>zn.isLowerCaseMatch(l.connectorId,t));if(!o)return null;const a=s.find(l=>zn.isLowerCaseMatch(l.id,o.connectorId)),c=e?o.accounts.find(l=>zn.isLowerCaseMatch(l.address,e)):o.accounts[0];return{...o,account:c,connector:a}}const i=r.find(o=>o.accounts.length>0&&s.some(a=>zn.isLowerCaseMatch(a.id,o.connectorId)));if(i){const[o]=i.accounts,a=s.find(c=>zn.isLowerCaseMatch(c.id,i.connectorId));return{...i,account:o,connector:a}}return null}}const oa={ERROR_CODE_UNRECOGNIZED_CHAIN_ID:4902,ERROR_CODE_DEFAULT:5e3,ERROR_INVALID_CHAIN_ID:32603,DEFAULT_ALLOWED_ANCESTORS:["http://localhost:*","https://localhost:*","http://127.0.0.1:*","https://127.0.0.1:*","https://*.pages.dev","https://*.vercel.app","https://*.ngrok-free.app","https://secure-mobile.walletconnect.com","https://secure-mobile.walletconnect.org"]};class V_{constructor({provider:e,namespace:t}){this.id=H.CONNECTOR_ID.WALLET_CONNECT,this.name=oo.ConnectorNamesMap[H.CONNECTOR_ID.WALLET_CONNECT],this.type="WALLET_CONNECT",this.imageId=oo.ConnectorImageIds[H.CONNECTOR_ID.WALLET_CONNECT],this.getCaipNetworks=I.getCaipNetworks.bind(I),this.caipNetworks=this.getCaipNetworks(),this.provider=e,this.chain=t}get chains(){return this.getCaipNetworks()}async connectWalletConnect(){if(!await this.authenticate()){const t=this.getCaipNetworks(),r=z.state.universalProviderConfigOverride,s=da.createNamespaces(t,r);await this.provider.connect({optionalNamespaces:s})}return{clientId:await this.provider.client.core.crypto.getClientId(),session:this.provider.session}}async disconnect(){await this.provider.disconnect()}async authenticate(){const e=this.chains.map(t=>t.caipNetworkId);return Cs.universalProviderAuthenticate({universalProvider:this.provider,chains:e,methods:Fce})}}const Fce=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode","wallet_getCallsStatus","wallet_sendCalls","wallet_getCapabilities","wallet_grantPermissions","wallet_revokePermissions","wallet_getAssets"],jce=[H.CONNECTOR_ID.AUTH,H.CONNECTOR_ID.WALLET_CONNECT];class RM{constructor(e){this.availableConnectors=[],this.availableConnections=[],this.providerHandlers={},this.eventListeners=new Map,this.getCaipNetworks=t=>I.getCaipNetworks(t),this.getConnectorId=t=>se.getConnectorId(t),e&&this.construct(e),e!=null&&e.namespace&&(this.connectionManager=new Bce({namespace:e.namespace}))}construct(e){this.projectId=e.projectId,this.namespace=e.namespace,this.adapterType=e.adapterType}get connectors(){return this.availableConnectors}get connections(){return this.availableConnections}get networks(){return this.getCaipNetworks(this.namespace)}onAuthConnected({accounts:e,chainId:t}){const r=this.getCaipNetworks().filter(s=>s.chainNamespace===this.namespace).find(s=>s.id.toString()===(t==null?void 0:t.toString()));e&&r&&this.addConnection({connectorId:H.CONNECTOR_ID.AUTH,accounts:e,caipNetwork:r})}setAuthProvider(e){e.onConnect(this.onAuthConnected.bind(this)),e.onSocialConnected(this.onAuthConnected.bind(this)),this.addConnector({id:H.CONNECTOR_ID.AUTH,type:"AUTH",name:H.CONNECTOR_NAMES.AUTH,provider:e,imageId:oo.ConnectorImageIds[H.CONNECTOR_ID.AUTH],chain:this.namespace,chains:[]})}addConnector(...e){const t=new Set;this.availableConnectors=[...e,...this.availableConnectors].filter(r=>t.has(r.id)?!1:(t.add(r.id),!0)),this.emit("connectors",this.availableConnectors)}addConnection(...e){const t=new Set;this.availableConnections=[...e,...this.availableConnections].filter(r=>t.has(r.connectorId.toLowerCase())?!1:(t.add(r.connectorId.toLowerCase()),!0)),this.emit("connections",this.availableConnections)}deleteConnection(e){this.availableConnections=this.availableConnections.filter(t=>!zn.isLowerCaseMatch(t.connectorId,e)),this.emit("connections",this.availableConnections)}clearConnections(e=!1){this.availableConnections=[],e&&this.emit("connections",this.availableConnections)}setStatus(e,t){ge.setStatus(e,t)}on(e,t){var r;this.eventListeners.has(e)||this.eventListeners.set(e,new Set),(r=this.eventListeners.get(e))==null||r.add(t)}off(e,t){const r=this.eventListeners.get(e);r&&r.delete(t)}removeAllEventListeners(){this.eventListeners.forEach(e=>{e.clear()})}emit(e,t){const r=this.eventListeners.get(e);r&&r.forEach(s=>s(t))}async connectWalletConnect(e){return{clientId:(await this.getWalletConnectConnector().connectWalletConnect()).clientId}}async switchNetwork(e){const{caipNetwork:t,providerType:r}=e;if(!e.provider)return;const s="provider"in e.provider?e.provider.provider:e.provider;if(r==="WALLET_CONNECT"){s.setDefaultChain(t.caipNetworkId);return}if(s&&r==="AUTH"){const i=s,o=Ns(t.chainNamespace);await i.switchNetwork({chainId:t.caipNetworkId});const a=await i.getUser({chainId:t.caipNetworkId,preferredAccountType:o});this.emit("switchNetwork",a)}}getWalletConnectConnector(){const e=this.connectors.find(t=>t instanceof V_);if(!e)throw new Error("WalletConnectConnector not found");return e}onConnect(e,t){if(e.length>0){const{address:r,chainId:s}=ye.getAccount(e[0]),i=this.getCaipNetworks().filter(a=>a.chainNamespace===this.namespace).find(a=>a.id.toString()===(s==null?void 0:s.toString())),o=this.connectors.find(a=>a.id===t);r&&(this.emit("accountChanged",{address:r,chainId:s,connector:o}),this.addConnection({connectorId:t,accounts:e.map(a=>{const{address:c}=ye.getAccount(a);return{address:c}}),caipNetwork:i}))}}onAccountsChanged(e,t,r=!0){var s,i;if(e.length>0){const{address:o}=ye.getAccount(e[0]),a=(s=this.connectionManager)==null?void 0:s.getConnection({connectorId:t,connections:this.connections,connectors:this.connectors});o&&zn.isLowerCaseMatch(this.getConnectorId(H.CHAIN.EVM),t)&&this.emit("accountChanged",{address:o,chainId:(i=a==null?void 0:a.caipNetwork)==null?void 0:i.id,connector:a==null?void 0:a.connector}),this.addConnection({connectorId:t,accounts:e.map(c=>{const{address:l}=ye.getAccount(c);return{address:l}}),caipNetwork:a==null?void 0:a.caipNetwork})}else r&&this.onDisconnect(t)}onDisconnect(e){this.removeProviderListeners(e),this.deleteConnection(e),zn.isLowerCaseMatch(this.getConnectorId(H.CHAIN.EVM),e)&&this.emitFirstAvailableConnection(),this.connections.length===0&&this.emit("disconnect")}onChainChanged(e,t){var o;const r=typeof e=="string"&&e.startsWith("0x")?Jh.hexStringToNumber(e).toString():e.toString(),s=(o=this.connectionManager)==null?void 0:o.getConnection({connectorId:t,connections:this.connections,connectors:this.connectors}),i=this.getCaipNetworks().filter(a=>a.chainNamespace===this.namespace).find(a=>a.id.toString()===r);s&&this.addConnection({connectorId:t,accounts:s.accounts,caipNetwork:i}),zn.isLowerCaseMatch(this.getConnectorId(H.CHAIN.EVM),t)&&this.emit("switchNetwork",{chainId:r})}listenProviderEvents(e,t){if(jce.includes(e))return;const r=o=>this.onAccountsChanged(o,e),s=o=>this.onChainChanged(o,e),i=()=>this.onDisconnect(e);this.providerHandlers[e]||(t.on("disconnect",i),t.on("accountsChanged",r),t.on("chainChanged",s),this.providerHandlers[e]={provider:t,disconnect:i,accountsChanged:r,chainChanged:s})}removeProviderListeners(e){if(this.providerHandlers[e]){const{provider:t,disconnect:r,accountsChanged:s,chainChanged:i}=this.providerHandlers[e];t.removeListener("disconnect",r),t.removeListener("accountsChanged",s),t.removeListener("chainChanged",i),this.providerHandlers[e]=null}}emitFirstAvailableConnection(){var t,r;const e=(t=this.connectionManager)==null?void 0:t.getConnection({connections:this.connections,connectors:this.connectors});if(e){const[s]=e.accounts;this.emit("accountChanged",{address:s==null?void 0:s.address,chainId:(r=e.caipNetwork)==null?void 0:r.id,connector:e.connector})}}}class Hce extends RM{async setUniversalProvider(e){if(!this.namespace)throw new Error("UniversalAdapter:setUniversalProvider - namespace is required");return this.addConnector(new V_({provider:e,caipNetworks:this.getCaipNetworks(),namespace:this.namespace})),Promise.resolve()}async connect(e){return Promise.resolve({id:"WALLET_CONNECT",type:"WALLET_CONNECT",chainId:Number(e.chainId),provider:this.provider,address:""})}async disconnect(){try{await this.getWalletConnectConnector().disconnect(),this.emit("disconnect")}catch(e){console.warn("UniversalAdapter:disconnect - error",e)}return{connections:[]}}syncConnections(){return Promise.resolve()}async getAccounts({namespace:e}){var s,i,o,a;const t=this.provider,r=((a=(o=(i=(s=t==null?void 0:t.session)==null?void 0:s.namespaces)==null?void 0:i[e])==null?void 0:o.accounts)==null?void 0:a.map(c=>{const[,,l]=c.split(":");return l}).filter((c,l,u)=>u.indexOf(c)===l))||[];return Promise.resolve({accounts:r.map(c=>ye.createAccount(e,c,e==="bip122"?"payment":"eoa"))})}async syncConnectors(){return Promise.resolve()}async getBalance(e){var i,o,a,c,l;if(!(e.caipNetwork&&st.BALANCE_SUPPORTED_CHAINS.includes((i=e.caipNetwork)==null?void 0:i.chainNamespace))||(o=e.caipNetwork)!=null&&o.testnet)return{balance:"0.00",symbol:((a=e.caipNetwork)==null?void 0:a.nativeCurrency.symbol)||""};if(ge.state.balanceLoading&&e.chainId===((c=I.state.activeCaipNetwork)==null?void 0:c.id))return{balance:ge.state.balance||"0.00",symbol:ge.state.balanceSymbol||""};const s=(await ge.fetchTokenBalance()).find(u=>{var h,d;return u.chainId===`${(h=e.caipNetwork)==null?void 0:h.chainNamespace}:${e.chainId}`&&u.symbol===((d=e.caipNetwork)==null?void 0:d.nativeCurrency.symbol)});return{balance:(s==null?void 0:s.quantity.numeric)||"0.00",symbol:(s==null?void 0:s.symbol)||((l=e.caipNetwork)==null?void 0:l.nativeCurrency.symbol)||""}}async signMessage(e){var o,a,c;const{provider:t,message:r,address:s}=e;if(!t)throw new Error("UniversalAdapter:signMessage - provider is undefined");let i="";return((o=I.state.activeCaipNetwork)==null?void 0:o.chainNamespace)===H.CHAIN.SOLANA?i=(await t.request({method:"solana_signMessage",params:{message:$f.encode(new TextEncoder().encode(r)),pubkey:s}},(a=I.state.activeCaipNetwork)==null?void 0:a.caipNetworkId)).signature:i=await t.request({method:"personal_sign",params:[r,s]},(c=I.state.activeCaipNetwork)==null?void 0:c.caipNetworkId),{signature:i}}async estimateGas(){return Promise.resolve({gas:BigInt(0)})}async sendTransaction(){return Promise.resolve({hash:""})}walletGetAssets(e){return Promise.resolve({})}async writeContract(){return Promise.resolve({hash:""})}emitFirstAvailableConnection(){}parseUnits(){return 0n}formatUnits(){return"0"}async getCapabilities(){return Promise.resolve({})}async grantPermissions(){return Promise.resolve({})}async revokePermissions(){return Promise.resolve("0x")}async syncConnection(){return Promise.resolve({id:"WALLET_CONNECT",type:"WALLET_CONNECT",chainId:1,provider:this.provider,address:""})}async switchNetwork(e){var s,i,o,a,c,l;const{caipNetwork:t}=e,r=this.getWalletConnectConnector();if(t.chainNamespace===H.CHAIN.EVM)try{await((s=r.provider)==null?void 0:s.request({method:"wallet_switchEthereumChain",params:[{chainId:EN(t.id)}]}))}catch(u){if(u.code===oa.ERROR_CODE_UNRECOGNIZED_CHAIN_ID||u.code===oa.ERROR_INVALID_CHAIN_ID||u.code===oa.ERROR_CODE_DEFAULT||((o=(i=u==null?void 0:u.data)==null?void 0:i.originalError)==null?void 0:o.code)===oa.ERROR_CODE_UNRECOGNIZED_CHAIN_ID)try{await((l=r.provider)==null?void 0:l.request({method:"wallet_addEthereumChain",params:[{chainId:EN(t.id),rpcUrls:[(a=t==null?void 0:t.rpcUrls.chainDefault)==null?void 0:a.http],chainName:t.name,nativeCurrency:t.nativeCurrency,blockExplorerUrls:[(c=t.blockExplorers)==null?void 0:c.default.url]}]}))}catch{throw new Error("Chain is not supported")}}r.provider.setDefaultChain(t.caipNetworkId)}getWalletConnectProvider(){const e=this.connectors.find(r=>r.type==="WALLET_CONNECT");return e==null?void 0:e.provider}}const Vce=["email","socials","swaps","onramp","activity","reownBranding","multiWallet","emailCapture","payWithExchange","payments","reownAuthentication"],Iw={email:{apiFeatureName:"social_login",localFeatureName:"email",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:n=>{if(!(n!=null&&n.config))return!1;const e=n.config;return!!n.isEnabled&&e.includes("email")},processFallback:n=>n===void 0?st.DEFAULT_REMOTE_FEATURES.email:!!n},socials:{apiFeatureName:"social_login",localFeatureName:"socials",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:n=>{if(!(n!=null&&n.config))return!1;const e=n.config;return n.isEnabled&&e.length>0?e.filter(t=>t!=="email"):!1},processFallback:n=>n===void 0?st.DEFAULT_REMOTE_FEATURES.socials:typeof n=="boolean"?n?st.DEFAULT_REMOTE_FEATURES.socials:!1:n},swaps:{apiFeatureName:"swap",localFeatureName:"swaps",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:n=>{if(!(n!=null&&n.config))return!1;const e=n.config;return n.isEnabled&&e.length>0?e:!1},processFallback:n=>n===void 0?st.DEFAULT_REMOTE_FEATURES.swaps:typeof n=="boolean"?n?st.DEFAULT_REMOTE_FEATURES.swaps:!1:n},onramp:{apiFeatureName:"onramp",localFeatureName:"onramp",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:n=>{if(!(n!=null&&n.config))return!1;const e=n.config;return n.isEnabled&&e.length>0?e:!1},processFallback:n=>n===void 0?st.DEFAULT_REMOTE_FEATURES.onramp:typeof n=="boolean"?n?st.DEFAULT_REMOTE_FEATURES.onramp:!1:n},activity:{apiFeatureName:"activity",localFeatureName:"history",returnType:!1,isLegacy:!0,isAvailableOnBasic:!1,processApi:n=>!!n.isEnabled,processFallback:n=>n===void 0?st.DEFAULT_REMOTE_FEATURES.activity:!!n},reownBranding:{apiFeatureName:"reown_branding",localFeatureName:"reownBranding",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:n=>!!n.isEnabled,processFallback:n=>n===void 0?st.DEFAULT_REMOTE_FEATURES.reownBranding:!!n},emailCapture:{apiFeatureName:"email_capture",localFeatureName:"emailCapture",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:n=>n.isEnabled&&(n.config??[]),processFallback:n=>!1},multiWallet:{apiFeatureName:"multi_wallet",localFeatureName:"multiWallet",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:n=>!!n.isEnabled,processFallback:()=>st.DEFAULT_REMOTE_FEATURES.multiWallet},payWithExchange:{apiFeatureName:"fund_from_exchange",localFeatureName:"payWithExchange",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:n=>!!n.isEnabled,processFallback:()=>st.DEFAULT_REMOTE_FEATURES.payWithExchange},payments:{apiFeatureName:"payments",localFeatureName:"payments",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:n=>!!n.isEnabled,processFallback:()=>st.DEFAULT_REMOTE_FEATURES.payments},reownAuthentication:{apiFeatureName:"reown_authentication",localFeatureName:"reownAuthentication",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:n=>!!n.isEnabled,processFallback:n=>typeof n>"u"?st.DEFAULT_REMOTE_FEATURES.reownAuthentication:!!n}},qce={localSettingsOverridden:new Set,getApiConfig(n,e){return e==null?void 0:e.find(t=>t.id===n)},addWarning(n,e){if(n!==void 0){const t=Iw[e],r=t.isLegacy?`"features.${t.localFeatureName}" (now "${e}")`:`"features.${e}"`;this.localSettingsOverridden.add(r)}},processFeature(n,e,t,r,s){const i=Iw[n],o=e[i.localFeatureName];if(s&&!i.isAvailableOnBasic)return!1;if(r){const a=this.getApiConfig(i.apiFeatureName,t);return(a==null?void 0:a.config)===null?this.processFallbackFeature(n,o):a!=null&&a.config?(o!==void 0&&this.addWarning(o,n),this.processApiFeature(n,a)):!1}return this.processFallbackFeature(n,o)},processApiFeature(n,e){return Iw[n].processApi(e)},processFallbackFeature(n,e){return Iw[n].processFallback(e)},async fetchRemoteFeatures(n){const e=n.basic??!1,t=n.features||{};this.localSettingsOverridden.clear();let r=null,s=!1;try{r=await Se.fetchProjectConfig(),s=r!=null}catch(o){console.warn("[Reown Config] Failed to fetch remote project configuration. Using local/default values.",o)}const i=s&&!e?st.DEFAULT_REMOTE_FEATURES:st.DEFAULT_REMOTE_FEATURES_DISABLED;try{for(const o of Vce){const a=this.processFeature(o,t,r,s,e);Object.assign(i,{[o]:a})}}catch(o){return console.warn("[Reown Config] Failed to process the configuration from Cloud. Using default values.",o),st.DEFAULT_REMOTE_FEATURES}if(s&&this.localSettingsOverridden.size>0){const o=`Your local configuration for ${Array.from(this.localSettingsOverridden).join(", ")} was ignored because a remote configuration was successfully fetched. Please manage these features via your project dashboard on dashboard.reown.com.`;wn.open({debugMessage:lr.ALERT_WARNINGS.LOCAL_CONFIGURATION_IGNORED.debugMessage(o)},"warning")}return i}};class zce{constructor(e){this.chainNamespaces=[],this.remoteFeatures={},this.reportedAlertErrors={},this.getCaipNetwork=(t,r)=>{var s,i,o;if(t){const a=(s=I.getCaipNetworks(t))==null?void 0:s.find(u=>u.id===r);if(a)return a;const c=(i=I.getNetworkData(t))==null?void 0:i.caipNetwork;return c||((o=I.getRequestedCaipNetworks(t).filter(u=>u.chainNamespace===t))==null?void 0:o[0])}return I.state.activeCaipNetwork||this.defaultCaipNetwork},this.getCaipNetworkId=()=>{const t=this.getCaipNetwork();if(t)return t.id},this.getCaipNetworks=t=>I.getCaipNetworks(t),this.getActiveChainNamespace=()=>I.state.activeChain,this.setRequestedCaipNetworks=(t,r)=>{I.setRequestedCaipNetworks(t,r)},this.getApprovedCaipNetworkIds=()=>I.getAllApprovedCaipNetworkIds(),this.getCaipAddress=t=>{var r,s;return I.state.activeChain===t||!t?I.state.activeCaipAddress:(s=(r=I.state.chains.get(t))==null?void 0:r.accountState)==null?void 0:s.caipAddress},this.setClientId=t=>{xe.setClientId(t)},this.getProvider=t=>mt.getProvider(t),this.getProviderType=t=>mt.getProviderId(t),this.getPreferredAccountType=t=>Ns(t),this.setCaipAddress=(t,r)=>{ge.setCaipAddress(t,r)},this.setBalance=(t,r,s)=>{ge.setBalance(t,r,s)},this.setProfileName=(t,r)=>{ge.setProfileName(t,r)},this.setProfileImage=(t,r)=>{ge.setProfileImage(t,r)},this.setUser=(t,r)=>{ge.setUser(t,r)},this.resetAccount=t=>{ge.resetAccount(t)},this.setCaipNetwork=t=>{I.setActiveCaipNetwork(t)},this.setCaipNetworkOfNamespace=(t,r)=>{I.setChainNetworkData(r,{caipNetwork:t})},this.setStatus=(t,r)=>{ge.setStatus(t,r),se.isConnected()?Q.setConnectionStatus("connected"):Q.setConnectionStatus("disconnected")},this.getAddressByChainNamespace=t=>{var r,s;return(s=(r=I.state.chains.get(t))==null?void 0:r.accountState)==null?void 0:s.address},this.setConnectors=t=>{const r=[...se.state.allConnectors,...t];se.setConnectors(r)},this.setConnections=(t,r)=>{Q.setConnections(t,r),ie.setConnections(t,r)},this.fetchIdentity=t=>xe.fetchIdentity(t),this.getReownName=t=>zp.getNamesForAddress(t),this.getConnectors=()=>se.getConnectors(),this.getConnectorImage=t=>$D.getConnectorImage(t),this.getConnections=t=>this.remoteFeatures.multiWallet?I0.getConnectionsData(t).connections:(wn.open(H.REMOTE_FEATURES_ALERTS.MULTI_WALLET_NOT_ENABLED.DEFAULT,"info"),[]),this.getRecentConnections=t=>this.remoteFeatures.multiWallet?I0.getConnectionsData(t).recentConnections:(wn.open(H.REMOTE_FEATURES_ALERTS.MULTI_WALLET_NOT_ENABLED.DEFAULT,"info"),[]),this.switchConnection=async t=>{if(!this.remoteFeatures.multiWallet){wn.open(H.REMOTE_FEATURES_ALERTS.MULTI_WALLET_NOT_ENABLED.DEFAULT,"info");return}await ie.switchConnection(t)},this.deleteConnection=t=>{if(!this.remoteFeatures.multiWallet){wn.open(H.REMOTE_FEATURES_ALERTS.MULTI_WALLET_NOT_ENABLED.DEFAULT,"info");return}Q.deleteAddressFromConnection(t),ie.syncStorageConnections()},this.setConnectedWalletInfo=(t,r)=>{const s=mt.getProviderId(r),i=t?{...t,type:s}:void 0;ge.setConnectedWalletInfo(i,r)},this.getIsConnectedState=()=>!!I.state.activeCaipAddress,this.addAddressLabel=(t,r,s)=>{ge.addAddressLabel(t,r,s)},this.removeAddressLabel=(t,r)=>{ge.removeAddressLabel(t,r)},this.getAddress=t=>{var r,s;return I.state.activeChain===t||!t?ge.state.address:(s=(r=I.state.chains.get(t))==null?void 0:r.accountState)==null?void 0:s.address},this.setApprovedCaipNetworksData=t=>I.setApprovedCaipNetworksData(t),this.resetNetwork=t=>{I.resetNetwork(t)},this.addConnector=t=>{se.addConnector(t)},this.resetWcConnection=()=>{ie.resetWcConnection()},this.setAddressExplorerUrl=(t,r)=>{ge.setAddressExplorerUrl(t,r)},this.setSmartAccountDeployed=(t,r)=>{ge.setSmartAccountDeployed(t,r)},this.setPreferredAccountType=(t,r)=>{I.setAccountProp("preferredAccountType",t,r)},this.setEIP6963Enabled=t=>{z.setEIP6963Enabled(t)},this.handleUnsafeRPCRequest=()=>{if(this.isOpen()){if(this.isTransactionStackEmpty())return;this.redirect("ApproveTransaction")}else this.open({view:"ApproveTransaction"})},this.options=e,this.version=e.sdkVersion,this.caipNetworks=this.extendCaipNetworks(e),this.chainNamespaces=this.getChainNamespacesSet(e.adapters,this.caipNetworks),this.defaultCaipNetwork=this.extendDefaultCaipNetwork(e),this.chainAdapters=this.createAdapters(e.adapters),this.readyPromise=this.initialize(e)}getChainNamespacesSet(e,t){const r=e==null?void 0:e.map(i=>i.namespace).filter(i=>!!i);if(r!=null&&r.length)return[...new Set(r)];const s=t==null?void 0:t.map(i=>i.chainNamespace);return[...new Set(s)]}async initialize(e){var t,r,s,i,o;if(this.initializeProjectSettings(e),this.initControllers(e),await this.initChainAdapters(),this.sendInitializeEvent(e),z.state.enableReconnect?(await this.syncExistingConnection(),await this.syncAdapterConnections()):await this.unSyncExistingConnection(),this.remoteFeatures=await qce.fetchRemoteFeatures(e),z.setRemoteFeatures(this.remoteFeatures),this.remoteFeatures.onramp&&bA.setOnrampProviders(this.remoteFeatures.onramp),((t=z.state.remoteFeatures)!=null&&t.email||Array.isArray((r=z.state.remoteFeatures)==null?void 0:r.socials)&&((s=z.state.remoteFeatures)==null?void 0:s.socials.length)>0)&&await this.checkAllowedOrigins(),(i=z.state.features)!=null&&i.reownAuthentication||(o=z.state.remoteFeatures)!=null&&o.reownAuthentication){const{ReownAuthentication:a}=await Sn(()=>import("./D4WHiZ3d.js"),__vite__mapDeps([4,1,2,3]),import.meta.url),c=z.state.siwx;c instanceof a||(c&&console.warn("ReownAuthentication option is enabled, SIWX configuration will be overridden."),z.setSIWX(new a))}}async checkAllowedOrigins(){try{const e=await Se.fetchAllowedOrigins();if(!e||!ye.isClient()){wn.open(lr.ALERT_ERRORS.PROJECT_ID_NOT_CONFIGURED,"error");return}const t=window.location.origin;da.isOriginAllowed(t,e,oa.DEFAULT_ALLOWED_ANCESTORS)||wn.open(lr.ALERT_ERRORS.ORIGIN_NOT_ALLOWED,"error")}catch(e){if(!(e instanceof Error)){wn.open(lr.ALERT_ERRORS.PROJECT_ID_NOT_CONFIGURED,"error");return}switch(e.message){case"RATE_LIMITED":wn.open(lr.ALERT_ERRORS.RATE_LIMITED_APP_CONFIGURATION,"error");break;case"SERVER_ERROR":{const t=e.cause instanceof Error?e.cause:e;wn.open({displayMessage:lr.ALERT_ERRORS.SERVER_ERROR_APP_CONFIGURATION.displayMessage,debugMessage:lr.ALERT_ERRORS.SERVER_ERROR_APP_CONFIGURATION.debugMessage(t.message)},"error");break}default:wn.open(lr.ALERT_ERRORS.PROJECT_ID_NOT_CONFIGURED,"error")}}}sendInitializeEvent(e){var r;const{...t}=e;delete t.adapters,delete t.universalProvider,ut.sendEvent({type:"track",event:"INITIALIZE",properties:{...t,networks:e.networks.map(s=>s.id),siweConfig:{options:((r=e.siweConfig)==null?void 0:r.options)||{}}}})}initControllers(e){this.initializeOptionsController(e),this.initializeChainController(e),this.initializeThemeController(e),this.initializeConnectionController(e),this.initializeConnectorController()}initializeThemeController(e){e.themeMode&&Jr.setThemeMode(e.themeMode),e.themeVariables&&Jr.setThemeVariables(e.themeVariables)}initializeChainController(e){if(!this.connectionControllerClient||!this.networkControllerClient)throw new Error("ConnectionControllerClient and NetworkControllerClient must be set");I.initialize(e.adapters??[],this.caipNetworks,{connectionControllerClient:this.connectionControllerClient,networkControllerClient:this.networkControllerClient});const t=this.getDefaultNetwork();t&&I.setActiveCaipNetwork(t)}initializeConnectionController(e){ie.initialize(e.adapters??[]),ie.setWcBasic(e.basic??!1)}initializeConnectorController(){se.initialize(this.chainNamespaces)}initializeProjectSettings(e){z.setProjectId(e.projectId),z.setSdkVersion(e.sdkVersion)}initializeOptionsController(e){var s;z.setDebug(e.debug!==!1),z.setEnableWalletConnect(e.enableWalletConnect!==!1),z.setEnableWalletGuide(e.enableWalletGuide!==!1),z.setEnableWallets(e.enableWallets!==!1),z.setEIP6963Enabled(e.enableEIP6963!==!1),z.setEnableNetworkSwitch(e.enableNetworkSwitch!==!1),z.setEnableReconnect(e.enableReconnect!==!1),z.setEnableAuthLogger(e.enableAuthLogger!==!1),z.setCustomRpcUrls(e.customRpcUrls),z.setEnableEmbedded(e.enableEmbedded),z.setAllWallets(e.allWallets),z.setIncludeWalletIds(e.includeWalletIds),z.setExcludeWalletIds(e.excludeWalletIds),z.setFeaturedWalletIds(e.featuredWalletIds),z.setTokens(e.tokens),z.setTermsConditionsUrl(e.termsConditionsUrl),z.setPrivacyPolicyUrl(e.privacyPolicyUrl),z.setCustomWallets(e.customWallets),z.setFeatures(e.features),z.setAllowUnsupportedChain(e.allowUnsupportedChain),z.setUniversalProviderConfigOverride(e.universalProviderConfigOverride),z.setPreferUniversalLinks(e.experimental_preferUniversalLinks),z.setDefaultAccountTypes(e.defaultAccountTypes);const t=this.getDefaultMetaData();if(!e.metadata&&t&&(e.metadata=t),z.setMetadata(e.metadata),z.setDisableAppend(e.disableAppend),z.setEnableEmbedded(e.enableEmbedded),z.setSIWX(e.siwx),!e.projectId){wn.open(lr.ALERT_ERRORS.PROJECT_ID_NOT_CONFIGURED,"error");return}if(((s=e.adapters)==null?void 0:s.find(i=>i.namespace===H.CHAIN.EVM))&&e.siweConfig){if(e.siwx)throw new Error("Cannot set both `siweConfig` and `siwx` options");z.setSIWX(e.siweConfig.mapToSIWX())}}getDefaultMetaData(){var e,t,r,s;return ye.isClient()?{name:((t=(e=document.getElementsByTagName("title"))==null?void 0:e[0])==null?void 0:t.textContent)||"",description:((r=document.querySelector('meta[property="og:description"]'))==null?void 0:r.content)||"",url:window.location.origin,icons:[((s=document.querySelector('link[rel~="icon"]'))==null?void 0:s.href)||""]}:null}setUnsupportedNetwork(e){const t=this.getActiveChainNamespace();if(t){const r=Th.getUnsupportedNetwork(`${t}:${e}`);I.setActiveCaipNetwork(r)}}getDefaultNetwork(){return Th.getCaipNetworkFromStorage(this.defaultCaipNetwork)}extendCaipNetwork(e,t){return Th.extendCaipNetwork(e,{customNetworkImageUrls:t.chainImages,projectId:t.projectId})}extendCaipNetworks(e){return Th.extendCaipNetworks(e.networks,{customNetworkImageUrls:e.chainImages,customRpcUrls:e.customRpcUrls,projectId:e.projectId})}extendDefaultCaipNetwork(e){const t=e.networks.find(s=>{var i;return s.id===((i=e.defaultNetwork)==null?void 0:i.id)});return t?Th.extendCaipNetwork(t,{customNetworkImageUrls:e.chainImages,customRpcUrls:e.customRpcUrls,projectId:e.projectId}):void 0}async disconnectNamespace(e,t){var r,s;try{this.setLoading(!0,e);let i={connections:[]};const o=this.getAdapter(e);return(((s=(r=I.state.chains.get(e))==null?void 0:r.accountState)==null?void 0:s.caipAddress)||!z.state.enableReconnect)&&(o!=null&&o.disconnect)&&(i=await o.disconnect({id:t})),this.setLoading(!1,e),i}catch(i){throw this.setLoading(!1,e),new Error(`Failed to disconnect chains: ${i.message}`)}}createClients(){this.connectionControllerClient={connectWalletConnect:async()=>{var l;const e=I.state.activeChain,t=this.getAdapter(e),r=(l=this.getCaipNetwork(e))==null?void 0:l.id,s=ie.getConnections(e),i=this.remoteFeatures.multiWallet,o=s.length>0;if(!t)throw new Error("Adapter not found");const a=await t.connectWalletConnect(r);(!o||!i)&&this.close(),this.setClientId((a==null?void 0:a.clientId)||null),Q.setConnectedNamespaces([...I.state.chains.keys()]),await this.syncWalletConnectAccount(),await Cs.initializeIfEnabled()},connectExternal:async({id:e,address:t,info:r,type:s,provider:i,chain:o,caipNetwork:a,socialUri:c})=>{var p,g,m,w,v,A;const l=I.state.activeChain,u=o||l,h=this.getAdapter(u);if(o&&o!==l&&!a){const T=this.getCaipNetworks().find(N=>N.chainNamespace===o);T&&this.setCaipNetwork(T)}if(!u)throw new Error("connectExternal: namespace not found");if(!h)throw new Error("connectExternal: adapter not found");const d=this.getCaipNetwork(u),f=await h.connect({id:e,address:t,info:r,type:s,provider:i,socialUri:c,chainId:(a==null?void 0:a.id)||(d==null?void 0:d.id),rpcUrl:((m=(g=(p=a==null?void 0:a.rpcUrls)==null?void 0:p.default)==null?void 0:g.http)==null?void 0:m[0])||((A=(v=(w=d==null?void 0:d.rpcUrls)==null?void 0:w.default)==null?void 0:v.http)==null?void 0:A[0])});if(f)return Q.addConnectedNamespace(u),this.syncProvider({...f,chainNamespace:u}),this.setStatus("connected",u),this.syncConnectedWalletInfo(u),Q.removeDisconnectedConnectorId(e,u),{address:f.address}},reconnectExternal:async({id:e,info:t,type:r,provider:s})=>{var a;const i=I.state.activeChain,o=this.getAdapter(i);if(!i)throw new Error("reconnectExternal: namespace not found");if(!o)throw new Error("reconnectExternal: adapter not found");o!=null&&o.reconnect&&(await(o==null?void 0:o.reconnect({id:e,info:t,type:r,provider:s,chainId:(a=this.getCaipNetwork())==null?void 0:a.id})),Q.addConnectedNamespace(i),this.syncConnectedWalletInfo(i))},disconnect:async e=>{var l;const{id:t,chainNamespace:r,initialDisconnect:s}=e||{},i=r||I.state.activeChain,o=se.getConnectorId(i),a=t===H.CONNECTOR_ID.AUTH||o===H.CONNECTOR_ID.AUTH,c=t===H.CONNECTOR_ID.WALLET_CONNECT||o===H.CONNECTOR_ID.WALLET_CONNECT;try{const u=Array.from(I.state.chains.keys());let h=r?[r]:u;(c||a)&&(h=u);const d=h.map(async g=>{const m=se.getConnectorId(g),w=await this.disconnectNamespace(g,t||m);w&&(a&&Q.deleteConnectedSocialProvider(),w.connections.forEach(v=>{Q.addDisconnectedConnectorId(v.connectorId,g)})),s&&this.onDisconnectNamespace({chainNamespace:g,closeModal:!1})}),f=await Promise.allSettled(d);Et.resetSend(),ie.resetWcConnection(),(l=Cs.getSIWX())!=null&&l.signOutOnDisconnect&&await Cs.clearSessions(),se.setFilterByNamespace(void 0),ie.syncStorageConnections();const p=f.filter(g=>g.status==="rejected");if(p.length>0)throw new Error(p.map(g=>g.reason.message).join(", "));ut.sendEvent({type:"track",event:"DISCONNECT_SUCCESS",properties:{namespace:r||"all"}})}catch(u){throw new Error(`Failed to disconnect chains: ${u.message}`)}},checkInstalled:e=>e?e.some(t=>{var r;return!!((r=window.ethereum)!=null&&r[String(t)])}):!!window.ethereum,signMessage:async e=>{const t=I.state.activeChain,r=this.getAdapter(I.state.activeChain);if(!t)throw new Error("signMessage: namespace not found");if(!r)throw new Error("signMessage: adapter not found");const s=await(r==null?void 0:r.signMessage({message:e,address:ge.state.address,provider:mt.getProvider(t)}));return(s==null?void 0:s.signature)||""},sendTransaction:async e=>{const t=e.chainNamespace;if(!t)throw new Error("sendTransaction: namespace not found");if(st.SEND_SUPPORTED_NAMESPACES.includes(t)){const r=this.getAdapter(t);if(!r)throw new Error("sendTransaction: adapter not found");const s=mt.getProvider(t),i=await(r==null?void 0:r.sendTransaction({...e,caipNetwork:this.getCaipNetwork(),provider:s}));return(i==null?void 0:i.hash)||""}return""},estimateGas:async e=>{const t=e.chainNamespace;if(t===H.CHAIN.EVM){const r=this.getAdapter(t);if(!r)throw new Error("estimateGas: adapter is required but got undefined");const s=mt.getProvider(t),i=this.getCaipNetwork();if(!i)throw new Error("estimateGas: caipNetwork is required but got undefined");const o=await(r==null?void 0:r.estimateGas({...e,provider:s,caipNetwork:i}));return(o==null?void 0:o.gas)||0n}return 0n},getEnsAvatar:async()=>{var t;const e=I.state.activeChain;if(!e)throw new Error("getEnsAvatar: namespace is required but got undefined");return await this.syncIdentity({address:ge.state.address,chainId:Number((t=this.getCaipNetwork())==null?void 0:t.id),chainNamespace:e}),ge.state.profileImage||!1},getEnsAddress:async e=>await da.resolveReownName(e),writeContract:async e=>{const t=I.state.activeChain,r=this.getAdapter(t);if(!t)throw new Error("writeContract: namespace is required but got undefined");if(!r)throw new Error("writeContract: adapter is required but got undefined");const s=this.getCaipNetwork(),i=this.getCaipAddress(),o=mt.getProvider(t);if(!s||!i)throw new Error("writeContract: caipNetwork or caipAddress is required but got undefined");const a=await(r==null?void 0:r.writeContract({...e,caipNetwork:s,provider:o,caipAddress:i}));return a==null?void 0:a.hash},parseUnits:(e,t)=>{const r=this.getAdapter(I.state.activeChain);if(!r)throw new Error("parseUnits: adapter is required but got undefined");return(r==null?void 0:r.parseUnits({value:e,decimals:t}))??0n},formatUnits:(e,t)=>{const r=this.getAdapter(I.state.activeChain);if(!r)throw new Error("formatUnits: adapter is required but got undefined");return(r==null?void 0:r.formatUnits({value:e,decimals:t}))??"0"},getCapabilities:async e=>{const t=this.getAdapter(I.state.activeChain);if(!t)throw new Error("getCapabilities: adapter is required but got undefined");return await(t==null?void 0:t.getCapabilities(e))},grantPermissions:async e=>{const t=this.getAdapter(I.state.activeChain);if(!t)throw new Error("grantPermissions: adapter is required but got undefined");return await(t==null?void 0:t.grantPermissions(e))},revokePermissions:async e=>{const t=this.getAdapter(I.state.activeChain);if(!t)throw new Error("revokePermissions: adapter is required but got undefined");return t!=null&&t.revokePermissions?await t.revokePermissions(e):"0x"},walletGetAssets:async e=>{const t=this.getAdapter(I.state.activeChain);if(!t)throw new Error("walletGetAssets: adapter is required but got undefined");return await(t==null?void 0:t.walletGetAssets(e))??{}},updateBalance:e=>{const t=this.getCaipNetwork(e);!t||!ge.state.address||this.updateNativeBalance(ge.state.address,t==null?void 0:t.id,e)}},this.networkControllerClient={switchCaipNetwork:async e=>await this.switchCaipNetwork(e),getApprovedCaipNetworksData:async()=>this.getApprovedCaipNetworksData()},ie.setClient(this.connectionControllerClient)}getApprovedCaipNetworksData(){var t,r,s,i,o;if(mt.getProviderId(I.state.activeChain)===lt.CONNECTOR_TYPE_WALLET_CONNECT){const a=(r=(t=this.universalProvider)==null?void 0:t.session)==null?void 0:r.namespaces;return{supportsAllNetworks:((o=(i=(s=this.universalProvider)==null?void 0:s.session)==null?void 0:i.peer)==null?void 0:o.metadata.name)==="MetaMask Wallet",approvedCaipNetworkIds:this.getChainsFromNamespaces(a)}}return{supportsAllNetworks:!0,approvedCaipNetworkIds:[]}}async switchCaipNetwork(e){if(!e)return;const t=e.chainNamespace;if(this.getAddressByChainNamespace(e.chainNamespace)){const s=mt.getProvider(t),i=mt.getProviderId(t);if(e.chainNamespace===I.state.activeChain){const o=this.getAdapter(t);await(o==null?void 0:o.switchNetwork({caipNetwork:e,provider:s,providerType:i}))}else if(this.setCaipNetwork(e),i===lt.CONNECTOR_TYPE_WALLET_CONNECT)this.syncWalletConnectAccount();else{const o=this.getAddressByChainNamespace(t);o&&this.syncAccount({address:o,chainId:e.id,chainNamespace:t})}}else this.setCaipNetwork(e)}getChainsFromNamespaces(e={}){return Object.values(e).flatMap(t=>{const r=t.chains||[],s=t.accounts.map(i=>{const{chainId:o,chainNamespace:a}=Tr.parseCaipAddress(i);return`${a}:${o}`});return Array.from(new Set([...r,...s]))})}createAdapters(e){return this.createClients(),this.chainNamespaces.reduce((t,r)=>{var i;const s=e==null?void 0:e.find(o=>o.namespace===r);return s?(s.construct({namespace:r,projectId:(i=this.options)==null?void 0:i.projectId,networks:this.getCaipNetworks()}),t[r]=s):t[r]=new Hce({namespace:r,networks:this.getCaipNetworks()}),t},{})}async initChainAdapter(e){var t;this.onConnectors(e),this.listenAdapter(e),await((t=this.chainAdapters)==null?void 0:t[e].syncConnectors(this.options,this)),await this.createUniversalProviderForAdapter(e)}async initChainAdapters(){await Promise.all(this.chainNamespaces.map(async e=>{await this.initChainAdapter(e)}))}onConnectors(e){const t=this.getAdapter(e);t==null||t.on("connectors",this.setConnectors.bind(this))}listenAdapter(e){const t=this.getAdapter(e);if(!t)return;const r=Q.getConnectionStatus();z.state.enableReconnect===!1?this.setStatus("disconnected",e):r==="connected"?this.setStatus("connecting",e):r==="disconnected"?(Q.clearAddressCache(),this.setStatus(r,e)):this.setStatus(r,e),t.on("switchNetwork",({address:s,chainId:i})=>{var l,u;const o=this.getCaipNetworks().find(h=>h.id.toString()===i.toString()||h.caipNetworkId.toString()===i.toString()),a=I.state.activeChain===e,c=(u=(l=I.state.chains.get(e))==null?void 0:l.accountState)==null?void 0:u.address;if(o){const h=a&&s?s:c;h&&this.syncAccount({address:h,chainId:o.id,chainNamespace:e})}else this.setUnsupportedNetwork(i)}),t.on("disconnect",()=>{const s=this.remoteFeatures.multiWallet,i=Array.from(ie.state.connections.values()).flat();this.onDisconnectNamespace({chainNamespace:e,closeModal:!s||i.length===0})}),t.on("connections",s=>{this.setConnections(s,e)}),t.on("pendingTransactions",()=>{const s=ge.state.address,i=I.state.activeCaipNetwork;!s||!(i!=null&&i.id)||this.updateNativeBalance(s,i.id,i.chainNamespace)}),t.on("accountChanged",({address:s,chainId:i,connector:o})=>{var c,l;const a=I.state.activeChain===e;o!=null&&o.provider&&(this.syncProvider({id:o.id,type:o.type,provider:o.provider,chainNamespace:e}),this.syncConnectedWalletInfo(e)),a&&i?this.syncAccount({address:s,chainId:i,chainNamespace:e}):a&&((c=I.state.activeCaipNetwork)!=null&&c.id)?this.syncAccount({address:s,chainId:(l=I.state.activeCaipNetwork)==null?void 0:l.id,chainNamespace:e}):this.syncAccountInfo(s,i,e),Q.addConnectedNamespace(e)})}async createUniversalProviderForAdapter(e){var t,r,s;await this.getUniversalProvider(),this.universalProvider&&await((s=(r=(t=this.chainAdapters)==null?void 0:t[e])==null?void 0:r.setUniversalProvider)==null?void 0:s.call(r,this.universalProvider))}async syncExistingConnection(){await Promise.allSettled(this.chainNamespaces.map(e=>this.syncNamespaceConnection(e)))}async unSyncExistingConnection(){try{await Promise.allSettled(this.chainNamespaces.map(e=>ie.disconnect({namespace:e,initialDisconnect:!0})))}catch(e){console.error("Error disconnecting existing connections:",e)}}async reconnectWalletConnect(){var t,r,s,i;await this.syncWalletConnectAccount();const e=this.getAddress();ut.sendEvent({type:"track",event:"CONNECT_SUCCESS",address:e,properties:{method:ye.isMobile()?"mobile":"qrcode",name:((i=(s=(r=(t=this.universalProvider)==null?void 0:t.session)==null?void 0:r.peer)==null?void 0:s.metadata)==null?void 0:i.name)||"Unknown",reconnect:!0}})}async syncNamespaceConnection(e){try{e===H.CHAIN.EVM&&ye.isSafeApp()&&se.setConnectorId(H.CONNECTOR_ID.SAFE,e);const t=se.getConnectorId(e);switch(this.setStatus("connecting",e),t){case H.CONNECTOR_ID.WALLET_CONNECT:await this.reconnectWalletConnect();break;case H.CONNECTOR_ID.AUTH:break;default:await this.syncAdapterConnection(e)}}catch(t){console.warn("AppKit couldn't sync existing connection",t),this.setStatus("disconnected",e)}}onDisconnectNamespace(e){const{chainNamespace:t,closeModal:r}=e||{};I.resetAccount(t),I.resetNetwork(t),Q.removeConnectedNamespace(t);const s=Array.from(I.state.chains.keys());(t?[t]:s).forEach(o=>Q.addDisconnectedConnectorId(se.getConnectorId(o)||"",o)),se.removeConnectorId(t),mt.resetChain(t),this.setUser(void 0,t),this.setStatus("disconnected",t),this.setConnectedWalletInfo(void 0,t),r!==!1&&tt.close()}async syncAdapterConnections(){await Promise.allSettled(this.chainNamespaces.map(e=>{var s;const t=this.getCaipAddress(e),r=this.getCaipNetwork(e);return(s=this.chainAdapters)==null?void 0:s[e].syncConnections({connectToFirstConnector:!t,caipNetwork:r,getConnectorStorageInfo(i){const a=Q.getConnections()[e]??[];return{hasDisconnected:Q.isConnectorDisconnected(i,e),hasConnected:a.some(c=>zn.isLowerCaseMatch(c.connectorId,i))}}})}))}async syncAdapterConnection(e){var a,c,l,u;const t=this.getAdapter(e),r=se.getConnectorId(e),s=this.getCaipNetwork(e),o=se.getConnectors(e).find(h=>h.id===r);try{if(!t||!o)throw new Error(`Adapter or connector not found for namespace ${e}`);if(!(s!=null&&s.id))throw new Error("CaipNetwork not found");const h=await(t==null?void 0:t.syncConnection({namespace:e,id:o.id,chainId:s.id,rpcUrl:(l=(c=(a=s==null?void 0:s.rpcUrls)==null?void 0:a.default)==null?void 0:c.http)==null?void 0:l[0]}));h?(this.syncProvider({...h,chainNamespace:e}),await this.syncAccount({...h,chainNamespace:e}),this.setStatus("connected",e),ut.sendEvent({type:"track",event:"CONNECT_SUCCESS",address:h.address,properties:{method:"browser",name:((u=o.info)==null?void 0:u.name)||o.name||"Unknown",reconnect:!0}})):this.setStatus("disconnected",e)}catch{this.onDisconnectNamespace({chainNamespace:e,closeModal:!1})}}async syncWalletConnectAccount(){var r,s;const e=Object.keys(((s=(r=this.universalProvider)==null?void 0:r.session)==null?void 0:s.namespaces)||{}),t=this.chainNamespaces.map(async i=>{var u,h,d,f,p;const o=this.getAdapter(i);if(!o)return;const a=((f=(d=(h=(u=this.universalProvider)==null?void 0:u.session)==null?void 0:h.namespaces)==null?void 0:d[i])==null?void 0:f.accounts)||[],c=(p=I.state.activeCaipNetwork)==null?void 0:p.id,l=a.find(g=>{const{chainId:m}=Tr.parseCaipAddress(g);return m===(c==null?void 0:c.toString())})||a[0];if(l){const g=Tr.validateCaipAddress(l),{chainId:m,address:w}=Tr.parseCaipAddress(g);if(mt.setProviderId(i,lt.CONNECTOR_TYPE_WALLET_CONNECT),this.caipNetworks&&I.state.activeCaipNetwork&&o.namespace!==H.CHAIN.EVM){const v=o.getWalletConnectProvider({caipNetworks:this.getCaipNetworks(),provider:this.universalProvider,activeCaipNetwork:I.state.activeCaipNetwork});mt.setProvider(i,v)}else mt.setProvider(i,this.universalProvider);se.setConnectorId(H.CONNECTOR_ID.WALLET_CONNECT,i),Q.addConnectedNamespace(i),await this.syncAccount({address:w,chainId:m,chainNamespace:i})}else e.includes(i)&&this.setStatus("disconnected",i);this.syncConnectedWalletInfo(i),await I.setApprovedCaipNetworksData(i)});await Promise.all(t)}syncProvider({type:e,provider:t,id:r,chainNamespace:s}){mt.setProviderId(s,e),mt.setProvider(s,t),se.setConnectorId(r,s)}async syncAccount(e){var h,d;const t=e.chainNamespace===I.state.activeChain,r=I.getCaipNetworkByNamespace(e.chainNamespace,e.chainId),{address:s,chainId:i,chainNamespace:o}=e,{chainId:a}=Q.getActiveNetworkProps(),c=i||a,l=((h=I.state.activeCaipNetwork)==null?void 0:h.name)===H.UNSUPPORTED_NETWORK_NAME,u=I.getNetworkProp("supportsAllNetworks",o);if(this.setStatus("connected",o),!(l&&!u)&&c){let f=this.getCaipNetworks().find(m=>m.id.toString()===c.toString()),p=this.getCaipNetworks().find(m=>m.chainNamespace===o);if(!u&&!f&&!p){const m=this.getApprovedCaipNetworkIds()||[],w=m.find(A=>{var T;return((T=Tr.parseCaipNetworkId(A))==null?void 0:T.chainId)===c.toString()}),v=m.find(A=>{var T;return((T=Tr.parseCaipNetworkId(A))==null?void 0:T.chainNamespace)===o});f=this.getCaipNetworks().find(A=>A.caipNetworkId===w),p=this.getCaipNetworks().find(A=>A.caipNetworkId===v||"deprecatedCaipNetworkId"in A&&A.deprecatedCaipNetworkId===v)}const g=f||p;(g==null?void 0:g.chainNamespace)===I.state.activeChain?z.state.enableNetworkSwitch&&!z.state.allowUnsupportedChain&&((d=I.state.activeCaipNetwork)==null?void 0:d.name)===H.UNSUPPORTED_NETWORK_NAME?I.showUnsupportedChainUI():this.setCaipNetwork(g):t||r&&this.setCaipNetworkOfNamespace(r,o),this.syncConnectedWalletInfo(o),zn.isLowerCaseMatch(s,ge.state.address)||this.syncAccountInfo(s,g==null?void 0:g.id,o),t?await this.syncBalance({address:s,chainId:g==null?void 0:g.id,chainNamespace:o}):await this.syncBalance({address:s,chainId:r==null?void 0:r.id,chainNamespace:o}),this.syncIdentity({address:s,chainId:i,chainNamespace:o})}}async syncAccountInfo(e,t,r){const s=this.getCaipAddress(r),i=t||(s==null?void 0:s.split(":")[1]);if(!i)return;const o=`${r}:${i}:${e}`;this.setCaipAddress(o,r),await this.syncIdentity({address:e,chainId:i,chainNamespace:r})}async syncReownName(e,t){try{const r=await this.getReownName(e);if(r[0]){const s=r[0];this.setProfileName(s.name,t)}else this.setProfileName(null,t)}catch{this.setProfileName(null,t)}}syncConnectedWalletInfo(e){var s;const t=se.getConnectorId(e),r=mt.getProviderId(e);if(r===lt.CONNECTOR_TYPE_ANNOUNCED||r===lt.CONNECTOR_TYPE_INJECTED){if(t){const o=this.getConnectors().find(a=>{var h,d;const c=a.id===t,l=((h=a.info)==null?void 0:h.rdns)===t,u=(d=a.connectors)==null?void 0:d.some(f=>{var p;return f.id===t||((p=f.info)==null?void 0:p.rdns)===t});return c||l||!!u});if(o){const{info:a,name:c,imageUrl:l}=o,u=l||this.getConnectorImage(o);this.setConnectedWalletInfo({name:c,icon:u,...a},e)}}}else if(r===lt.CONNECTOR_TYPE_WALLET_CONNECT){const i=mt.getProvider(e);i!=null&&i.session&&this.setConnectedWalletInfo({...i.session.peer.metadata,name:i.session.peer.metadata.name,icon:(s=i.session.peer.metadata.icons)==null?void 0:s[0]},e)}else if(t&&(t===H.CONNECTOR_ID.COINBASE_SDK||t===H.CONNECTOR_ID.COINBASE)){const i=this.getConnectors().find(l=>l.id===t),o=(i==null?void 0:i.name)||"Coinbase Wallet",a=(i==null?void 0:i.imageUrl)||this.getConnectorImage(i),c=i==null?void 0:i.info;this.setConnectedWalletInfo({...c,name:o,icon:a},e)}}async syncBalance(e){!RD.getNetworksByNamespace(this.getCaipNetworks(),e.chainNamespace).find(r=>{var s;return r.id.toString()===((s=e.chainId)==null?void 0:s.toString())})||!e.chainId||await this.updateNativeBalance(e.address,e.chainId,e.chainNamespace)}async ready(){await this.readyPromise}async updateNativeBalance(e,t,r){const s=this.getAdapter(r),i=I.getCaipNetworkByNamespace(r,t);if(s){const o=await s.getBalance({address:e,chainId:t,caipNetwork:i,tokens:this.options.tokens});return this.setBalance(o.balance,o.symbol,r),o}}async initializeUniversalAdapter(){var r,s,i,o,a,c,l,u,h,d;const e=Bie.createLogger((f,...p)=>{f&&this.handleAlertError(f),console.error(...p)}),t={projectId:(r=this.options)==null?void 0:r.projectId,metadata:{name:(s=this.options)!=null&&s.metadata?(i=this.options)==null?void 0:i.metadata.name:"",description:(o=this.options)!=null&&o.metadata?(a=this.options)==null?void 0:a.metadata.description:"",url:(c=this.options)!=null&&c.metadata?(l=this.options)==null?void 0:l.metadata.url:"",icons:(u=this.options)!=null&&u.metadata?(h=this.options)==null?void 0:h.metadata.icons:[""]},logger:e};z.setManualWCControl(!!((d=this.options)!=null&&d.manualWCControl)),this.universalProvider=this.options.universalProvider??await Mie.init(t),z.state.enableReconnect===!1&&this.universalProvider.session&&await this.universalProvider.disconnect(),this.listenWalletConnect()}listenWalletConnect(){this.universalProvider&&this.chainNamespaces.forEach(e=>{da.listenWcProvider({universalProvider:this.universalProvider,namespace:e,onDisplayUri:t=>{ie.setUri(t)},onConnect:t=>{const{address:r}=ye.getAccount(t[0]);ie.finalizeWcConnection(r)},onDisconnect:()=>{I.state.noAdapters&&this.resetAccount(e),ie.resetWcConnection()},onChainChanged:t=>{const r=I.state.activeChain,s=r&&se.state.activeConnectorIds[r]===H.CONNECTOR_ID.WALLET_CONNECT;if(r===e&&(I.state.noAdapters||s)){const i=this.getCaipNetworks().find(a=>a.id.toString()===t.toString()||a.caipNetworkId.toString()===t.toString()),o=this.getCaipNetwork();if(!i){this.setUnsupportedNetwork(t);return}(o==null?void 0:o.id.toString())!==(i==null?void 0:i.id.toString())&&(o==null?void 0:o.chainNamespace)===(i==null?void 0:i.chainNamespace)&&this.setCaipNetwork(i)}},onAccountsChanged:t=>{const r=I.state.activeChain,s=r&&se.state.activeConnectorIds[r]===H.CONNECTOR_ID.WALLET_CONNECT;if(r===e&&(I.state.noAdapters||s)){const i=t==null?void 0:t[0];i&&this.syncAccount({address:i.address,chainId:i.chainId,chainNamespace:i.chainNamespace})}}})})}createUniversalProvider(){var e;return!this.universalProviderInitPromise&&ye.isClient()&&((e=this.options)!=null&&e.projectId)&&(this.universalProviderInitPromise=this.initializeUniversalAdapter()),this.universalProviderInitPromise}async getUniversalProvider(){if(!this.universalProvider)try{await this.createUniversalProvider()}catch(e){ut.sendEvent({type:"error",event:"INTERNAL_SDK_ERROR",properties:{errorType:"UniversalProviderInitError",errorMessage:e instanceof Error?e.message:"Unknown",uncaught:!1}}),console.error("AppKit:getUniversalProvider - Cannot create provider",e)}return this.universalProvider}handleAlertError(e){const t=Object.entries(lr.UniversalProviderErrors).find(([,{message:a}])=>e.message.includes(a)),[r,s]=t??[],{message:i,alertErrorKey:o}=s??{};if(r&&i&&!this.reportedAlertErrors[r]){const a=lr.ALERT_ERRORS[o];a&&(wn.open(a,"error"),this.reportedAlertErrors[r]=!0)}}getAdapter(e){var t;if(e)return(t=this.chainAdapters)==null?void 0:t[e]}createAdapter(e){var s;if(!e)return;const t=e.namespace;if(!t)return;this.createClients();const r=e;r.namespace=t,r.construct({namespace:t,projectId:(s=this.options)==null?void 0:s.projectId,networks:this.getCaipNetworks()}),this.chainNamespaces.includes(t)||this.chainNamespaces.push(t),this.chainAdapters&&(this.chainAdapters[t]=r)}async open(e){if(await this.injectModalUi(),e!=null&&e.uri&&ie.setUri(e.uri),e!=null&&e.arguments)switch(e==null?void 0:e.view){case"Swap":return tt.open({...e,data:{swap:e.arguments}})}return tt.open(e)}async close(){await this.injectModalUi(),tt.close()}setLoading(e,t){tt.setLoading(e,t)}async disconnect(e){await ie.disconnect({namespace:e})}getSIWX(){return z.state.siwx}getError(){return""}getChainId(){var e;return(e=I.state.activeCaipNetwork)==null?void 0:e.id}async switchNetwork(e){const t=this.getCaipNetworks().find(r=>r.id===e.id);if(!t){wn.open(lr.ALERT_ERRORS.SWITCH_NETWORK_NOT_FOUND,"error");return}await I.switchActiveNetwork(t)}getWalletProvider(){return I.state.activeChain?mt.state.providers[I.state.activeChain]:null}getWalletProviderType(){return mt.getProviderId(I.state.activeChain)}subscribeProviders(e){return mt.subscribeProviders(e)}getThemeMode(){return Jr.state.themeMode}getThemeVariables(){return Jr.state.themeVariables}setThemeMode(e){Jr.setThemeMode(e),OM(Jr.state.themeMode)}setTermsConditionsUrl(e){z.setTermsConditionsUrl(e)}setPrivacyPolicyUrl(e){z.setPrivacyPolicyUrl(e)}setThemeVariables(e){Jr.setThemeVariables(e),$ce(Jr.state.themeVariables)}subscribeTheme(e){return Jr.subscribe(e)}subscribeConnections(e){return this.remoteFeatures.multiWallet?ie.subscribe(e):(wn.open(H.REMOTE_FEATURES_ALERTS.MULTI_WALLET_NOT_ENABLED.DEFAULT,"info"),()=>{})}getWalletInfo(e){var t,r;return e?(r=(t=I.state.chains.get(e))==null?void 0:t.accountState)==null?void 0:r.connectedWalletInfo:ge.state.connectedWalletInfo}getAccount(e){const t=e||I.state.activeChain,r=se.getAuthConnector(t),s=I.getAccountData(t),i=Q.getConnectedConnectorId(I.state.activeChain),o=ie.getConnections(t);if(!t)throw new Error("AppKit:getAccount - namespace is required");const a=o.flatMap(c=>c.accounts.map(({address:l,type:u,publicKey:h})=>ye.createAccount(t,l,u||"eoa",h)));if(s)return{allAccounts:a,caipAddress:s.caipAddress,address:ye.getPlainAddress(s.caipAddress),isConnected:!!s.caipAddress,status:s.status,embeddedWalletInfo:r&&i===H.CONNECTOR_ID.AUTH?{user:s.user?{...s.user,username:Q.getConnectedSocialUsername()}:void 0,authProvider:s.socialProvider||"email",accountType:Ns(t),isSmartAccountDeployed:!!s.smartAccountDeployed}:void 0}}subscribeAccount(e,t){const r=()=>{const s=this.getAccount(t);s&&e(s)};t?I.subscribeChainProp("accountState",r,t):I.subscribe(r),se.subscribe(r)}subscribeNetwork(e){return I.subscribe(({activeCaipNetwork:t})=>{e({caipNetwork:t,chainId:t==null?void 0:t.id,caipNetworkId:t==null?void 0:t.caipNetworkId})})}subscribeWalletInfo(e,t){return t?ge.subscribeKey("connectedWalletInfo",e,t):ge.subscribeKey("connectedWalletInfo",e)}subscribeShouldUpdateToAddress(e){ge.subscribeKey("shouldUpdateToAddress",e)}subscribeCaipNetworkChange(e){I.subscribeKey("activeCaipNetwork",e)}getState(){return Si.state}getRemoteFeatures(){return z.state.remoteFeatures}subscribeState(e){return Si.subscribe(e)}subscribeRemoteFeatures(e){return z.subscribeKey("remoteFeatures",e)}showErrorMessage(e){uo.showError(e)}showSuccessMessage(e){uo.showSuccess(e)}getEvent(){return{...ut.state}}subscribeEvents(e){return ut.subscribe(e)}replace(e){Pe.replace(e)}redirect(e){Pe.push(e)}popTransactionStack(e){Pe.popTransactionStack(e)}isOpen(){return tt.state.open}isTransactionStackEmpty(){return Pe.state.transactionStack.length===0}static getInstance(){return this.instance}updateFeatures(e){z.setFeatures(e)}updateRemoteFeatures(e){z.setRemoteFeatures(e)}updateOptions(e){const r={...z.state||{},...e};z.setOptions(r)}setConnectMethodsOrder(e){z.setConnectMethodsOrder(e)}setWalletFeaturesOrder(e){z.setWalletFeaturesOrder(e)}setCollapseWallets(e){z.setCollapseWallets(e)}setSocialsOrder(e){z.setSocialsOrder(e)}getConnectMethodsOrder(){return vC.getConnectOrderMethod(z.state.features,se.getConnectors())}addNetwork(e,t){if(this.chainAdapters&&!this.chainAdapters[e])throw new Error(`Adapter for namespace ${e} doesn't exist`);const r=this.extendCaipNetwork(t,this.options);this.getCaipNetworks().find(s=>s.id===r.id)||I.addNetwork(r)}removeNetwork(e,t){if(this.chainAdapters&&!this.chainAdapters[e])throw new Error(`Adapter for namespace ${e} doesn't exist`);this.getCaipNetworks().find(s=>s.id===t)&&I.removeNetwork(e,t)}}let Qx=!1;class Wce extends zce{async onAuthProviderConnected(e){e.message&&e.signature&&e.siwxMessage&&await Cs.addEmbeddedWalletSession({chainId:e.siwxMessage.chainId,accountAddress:e.address,notBefore:e.siwxMessage.notBefore,statement:e.siwxMessage.statement,resources:e.siwxMessage.resources,requestId:e.siwxMessage.requestId,issuedAt:e.siwxMessage.issuedAt,domain:e.siwxMessage.domain,uri:e.siwxMessage.uri,version:e.siwxMessage.version,nonce:e.siwxMessage.nonce},e.message,e.signature);const t=I.state.activeChain;if(!t)throw new Error("AppKit:onAuthProviderConnected - namespace is required");const r=t===H.CHAIN.EVM?`eip155:${e.chainId}:${e.address}`:`${e.chainId}:${e.address}`,s=z.state.defaultAccountTypes[t],i=Ns(t),o=e.preferredAccountType||i||s;this.setCaipAddress(r,t);const{signature:a,siwxMessage:c,message:l,...u}=e;this.setUser({...ge.state.user||{},...u},t),this.setSmartAccountDeployed(!!e.smartAccountDeployed,t),this.setPreferredAccountType(o,t),this.setLoading(!1,t)}setupAuthConnectorListeners(e){e.onRpcRequest(t=>{Is.checkIfRequestExists(t)?Is.checkIfRequestIsSafe(t)||this.handleUnsafeRPCRequest():(this.open(),console.error(vn.RPC_METHOD_NOT_ALLOWED_MESSAGE,{method:t.method}),setTimeout(()=>{this.showErrorMessage(vn.RPC_METHOD_NOT_ALLOWED_UI_MESSAGE)},300),e.rejectRpcRequests())}),e.onRpcError(()=>{this.isOpen()&&(this.isTransactionStackEmpty()?this.close():this.popTransactionStack("error"))}),e.onRpcSuccess((t,r)=>{const s=Is.checkIfRequestIsSafe(r),i=ge.state.address,o=I.state.activeCaipNetwork;s||(i&&(o!=null&&o.id)&&this.updateNativeBalance(i,o.id,o.chainNamespace),this.isTransactionStackEmpty()?this.close():this.popTransactionStack("success"))}),e.onNotConnected(()=>{const t=I.state.activeChain;if(!t)throw new Error("AppKit:onNotConnected - namespace is required");se.getConnectorId(t)===H.CONNECTOR_ID.AUTH&&(this.setCaipAddress(void 0,t),this.setLoading(!1,t))}),e.onConnect(this.onAuthProviderConnected.bind(this)),e.onSocialConnected(this.onAuthProviderConnected.bind(this)),e.onSetPreferredAccount(({address:t,type:r})=>{const s=I.state.activeChain;if(!s)throw new Error("AppKit:onSetPreferredAccount - namespace is required");t&&this.setPreferredAccountType(r,s)})}async syncAuthConnectorTheme(e){if(!e)return;const t=Jr.getSnapshot(),r=z.getSnapshot();await Promise.all([e.syncDappData({metadata:r.metadata,sdkVersion:r.sdkVersion,projectId:r.projectId,sdkType:r.sdkType}),e.syncTheme({themeMode:t.themeMode,themeVariables:t.themeVariables,w3mThemeVariables:ia(t.themeVariables,t.themeMode)})])}async syncAuthConnector(e,t){var l,u,h,d,f,p,g,m;const r=H.AUTH_CONNECTOR_SUPPORTED_CHAINS.includes(t),s=t===I.state.activeChain;if(!r)return;this.setLoading(!0,t);const i=e.getLoginEmailUsed();this.setLoading(i,t),i&&this.setStatus("connecting",t);const o=e.getEmail(),a=e.getUsername();this.setUser({...((l=ge.state)==null?void 0:l.user)||{},username:a,email:o},t),this.setupAuthConnectorListeners(e);const{isConnected:c}=await e.isConnected();if(await this.syncAuthConnectorTheme(e),t&&r&&s){const w=await e.getSmartAccountEnabledNetworks();if(I.setSmartAccountEnabledNetworks((w==null?void 0:w.smartAccountEnabledNetworks)||[],t),c&&((u=this.connectionControllerClient)!=null&&u.connectExternal)){await((d=this.connectionControllerClient)==null?void 0:d.connectExternal({id:H.CONNECTOR_ID.AUTH,info:{name:H.CONNECTOR_ID.AUTH},type:lt.CONNECTOR_TYPE_AUTH,provider:e,chainId:(h=I.state.activeCaipNetwork)==null?void 0:h.id,chain:t})),this.setStatus("connected",t);const v=Q.getConnectedSocialProvider();v?ut.sendEvent({type:"track",event:"SOCIAL_LOGIN_SUCCESS",address:ge.state.address,properties:{provider:v,reconnect:!0}}):ut.sendEvent({type:"track",event:"CONNECT_SUCCESS",address:ge.state.address,properties:{method:"email",name:((m=(g=(p=(f=this.universalProvider)==null?void 0:f.session)==null?void 0:p.peer)==null?void 0:g.metadata)==null?void 0:m.name)||"Unknown",reconnect:!0}})}else se.getConnectorId(t)===H.CONNECTOR_ID.AUTH&&(this.setStatus("disconnected",t),Q.removeConnectedNamespace(t))}this.setLoading(!1,t)}async checkExistingTelegramSocialConnection(e){var t;try{if(!ye.isTelegram())return;const r=Q.getTelegramSocialProvider();if(!r||!ye.isClient())return;const i=new URL(window.location.href).searchParams.get("result_uri");if(!i)return;ge.setSocialProvider(r,e),await((t=this.authProvider)==null?void 0:t.init());const o=se.getAuthConnector();r&&o&&(this.setLoading(!0,e),await ie.connectExternal({id:o.id,type:o.type,socialUri:i},o.chain),Q.setConnectedSocialProvider(r),Q.removeTelegramSocialProvider(),ut.sendEvent({type:"track",event:"SOCIAL_LOGIN_SUCCESS",properties:{provider:r}}))}catch(r){this.setLoading(!1,e),console.error("checkExistingSTelegramocialConnection error",r)}try{const r=new URL(window.location.href);r.searchParams.delete("result_uri"),window.history.replaceState({},document.title,r.toString())}catch(r){console.error("tma social login failed",r)}}createAuthProvider(e){var l,u,h,d;if(!H.AUTH_CONNECTOR_SUPPORTED_CHAINS.includes(e))return;const r=(l=this.remoteFeatures)==null?void 0:l.email,s=Array.isArray((u=this.remoteFeatures)==null?void 0:u.socials)&&this.remoteFeatures.socials.length>0,i=r||s,a=zn.getActiveNamespaceConnectedToAuth()||e;!this.authProvider&&((h=this.options)!=null&&h.projectId)&&i&&(this.authProvider=tg.getInstance({projectId:this.options.projectId,enableLogger:this.options.enableAuthLogger,chainId:(d=this.getCaipNetwork(a))==null?void 0:d.caipNetworkId,abortController:lr.EmbeddedWalletAbortController,onTimeout:f=>{f==="iframe_load_failed"?wn.open(lr.ALERT_ERRORS.IFRAME_LOAD_FAILED,"error"):f==="iframe_request_timeout"?wn.open(lr.ALERT_ERRORS.IFRAME_REQUEST_TIMEOUT,"error"):f==="unverified_domain"&&wn.open(lr.ALERT_ERRORS.UNVERIFIED_DOMAIN,"error")},getActiveCaipNetwork:f=>Tp(f),getCaipNetworks:f=>I.getCaipNetworks(f)}),Si.subscribeOpen(f=>{var p;!f&&this.isTransactionStackEmpty()&&((p=this.authProvider)==null||p.rejectRpcRequests())}));const c=e===I.state.activeChain&&z.state.enableReconnect;z.state.enableReconnect===!1?this.syncAuthConnectorTheme(this.authProvider):this.authProvider&&c&&(this.syncAuthConnector(this.authProvider,e),this.checkExistingTelegramSocialConnection(e))}createAuthProviderForAdapter(e){var t,r,s;this.createAuthProvider(e),this.authProvider&&((s=(r=(t=this.chainAdapters)==null?void 0:t[e])==null?void 0:r.setAuthProvider)==null||s.call(r,this.authProvider))}initControllers(e){super.initControllers(e),this.options.excludeWalletIds&&Se.initializeExcludedWallets({ids:this.options.excludeWalletIds})}async switchCaipNetwork(e){var o,a;if(!e)return;const t=I.state.activeChain,r=e.chainNamespace,s=this.getAddressByChainNamespace(r);if(r===t&&s){const c=this.getAdapter(r),l=mt.getProvider(r),u=mt.getProviderId(r);await(c==null?void 0:c.switchNetwork({caipNetwork:e,provider:l,providerType:u})),this.setCaipNetwork(e)}else{const l=mt.getProviderId(t)===lt.CONNECTOR_TYPE_AUTH,u=mt.getProviderId(r),h=u===lt.CONNECTOR_TYPE_AUTH,d=H.AUTH_CONNECTOR_SUPPORTED_CHAINS.includes(r);if(!r)throw new Error("AppKit:switchCaipNetwork - networkNamespace is required");if((l&&u===void 0||h)&&d)try{if(I.state.activeChain=e.chainNamespace,s){const f=this.getAdapter(r);await(f==null?void 0:f.switchNetwork({caipNetwork:e,provider:this.authProvider,providerType:u}))}else await((a=(o=this.connectionControllerClient)==null?void 0:o.connectExternal)==null?void 0:a.call(o,{id:H.CONNECTOR_ID.AUTH,provider:this.authProvider,chain:r,chainId:e.id,type:lt.CONNECTOR_TYPE_AUTH,caipNetwork:e}));this.setCaipNetwork(e)}catch{const p=this.getAdapter(r);await(p==null?void 0:p.switchNetwork({caipNetwork:e,provider:this.authProvider,providerType:u}))}else if(u===lt.CONNECTOR_TYPE_WALLET_CONNECT){if(!I.state.noAdapters){const f=this.getAdapter(r),p=mt.getProvider(r),g=mt.getProviderId(r);await(f==null?void 0:f.switchNetwork({caipNetwork:e,provider:p,providerType:g}))}this.setCaipNetwork(e),this.syncWalletConnectAccount()}else this.setCaipNetwork(e),s&&this.syncAccount({address:s,chainId:e.id,chainNamespace:r})}}async initialize(e){var t;await super.initialize(e),(t=this.chainNamespaces)==null||t.forEach(r=>{this.createAuthProviderForAdapter(r)}),await this.injectModalUi(),Si.set({initialized:!0})}async syncIdentity({address:e,chainId:t,chainNamespace:r}){var a;const s=`${r}:${t}`,i=(a=this.caipNetworks)==null?void 0:a.find(c=>c.caipNetworkId===s);if(i!=null&&i.testnet){this.setProfileName(null,r),this.setProfileImage(null,r);return}const o=se.getConnectorId(r)===H.CONNECTOR_ID.AUTH;try{const{name:c,avatar:l}=await this.fetchIdentity({address:e});!c&&o?await this.syncReownName(e,r):(this.setProfileName(c,r),this.setProfileImage(l,r))}catch{t!==1&&this.setProfileImage(null,r)}}syncConnectedWalletInfo(e){const t=mt.getProviderId(e);if(t===lt.CONNECTOR_TYPE_AUTH){const r=this.authProvider;if(r){const s=Q.getConnectedSocialProvider()??"email",i=r.getEmail()??r.getUsername();this.setConnectedWalletInfo({name:t,identifier:i,social:s},e)}}else super.syncConnectedWalletInfo(e)}async injectModalUi(){if(ye.isClient()&&!Qx)try{const e={...st.DEFAULT_FEATURES,...this.options.features},t=this.remoteFeatures;if(await this.loadModalComponents(e,t),ye.isClient()&&!document.querySelector("w3m-modal")){const s=document.createElement("w3m-modal");!z.state.disableAppend&&!z.state.enableEmbedded&&document.body.insertAdjacentElement("beforeend",s)}Qx=!0}catch(e){console.error("Error injecting modal UI:",e)}}async loadModalComponents(e,t){if(!ye.isClient())return;const r=[];(t.email||t.socials&&t.socials.length>0)&&r.push(Sn(()=>import("./C6UJIyST.js"),__vite__mapDeps([5,6,7,8,9,1,2,10,11,12,13,14,15,16,17,18,19,20,3]),import.meta.url)),t.email&&r.push(Sn(()=>import("./CbthURU1.js"),__vite__mapDeps([21,7,22,6,20,12,13,23,19,9,1,2,11,18,24,14,15,3]),import.meta.url)),t.socials&&r.push(Sn(()=>import("./BYPxFd3C.js"),__vite__mapDeps([25,6,26,7,27,12,15,9,1,2,28,29,19,30,18,13,20,31,10,32,3]),import.meta.url)),t.swaps&&t.swaps.length>0&&r.push(Sn(()=>import("./DfM8Jnjg.js"),__vite__mapDeps([33,6,7,18,13,9,1,2,34,35,36,32,37,10,19,14,12,15,23,3]),import.meta.url)),e.send&&r.push(Sn(()=>import("./Bf9iuFdd.js"),__vite__mapDeps([38,6,7,18,13,19,9,1,2,11,15,28,20,12,37,10,32,36,14,39,40,26,3]),import.meta.url)),e.receive&&r.push(Sn(()=>import("./C44XKz1d.js"),__vite__mapDeps([41,6,26,7,42,9,1,2,10,31,3]),import.meta.url)),t.onramp&&t.onramp.length>0&&r.push(Sn(()=>import("./CUiKheE-.js"),__vite__mapDeps([43,6,26,7,44,12,9,1,2,10,13,19,27,15,28,45,20,18,30,14,3]),import.meta.url)),t.payWithExchange&&r.push(Sn(()=>import("./DCciz4xf.js"),__vite__mapDeps([46,6,7,18,13,16,9,1,2,10,44,12,19,32,3]),import.meta.url)),t.activity&&r.push(Sn(()=>import("./K1QTFBCJ.js"),__vite__mapDeps([47,6,7,48,1,2,19,9,20,12,10,32,3]),import.meta.url)),(e.pay||t.payments)&&r.push(Sn(()=>import("./CPYRf6CO.js"),__vite__mapDeps([49,7,18,13,9,1,2,50,10,19,16,44,12,40,30,3]),import.meta.url)),t.emailCapture&&r.push(Sn(()=>import("./D3qyTeKh.js"),__vite__mapDeps([51,6,7,22,20,12,13,23,4,1,2,3]),import.meta.url)),await Promise.all([...r,Sn(()=>import("./D1m4Z2XG.js"),__vite__mapDeps([52,6,26,7,12,10,13,39,9,1,2,19,53,35,16,44,18,23,17,50,8,48,20,32,34,11,40,15,14,24,27,28,29,30,42,31,45,3]),import.meta.url),Sn(()=>import("./Cy1GOJZA.js"),__vite__mapDeps([54,6,26,7,9,1,2,16,10,19,17,13,35,53,36,3]),import.meta.url)])}}const Gce="1.7.20";let E1;function Kce(n){return E1||(E1=new Wce({...n,sdkVersion:ye.generateSdkVersion(n.adapters??[],"html",Gce)})),E1}const Yce="6.12.1";function Qce(n,e,t){const r=e.split("|").map(i=>i.trim());for(let i=0;i<r.length;i++)switch(e){case"any":return;case"bigint":case"boolean":case"number":case"string":if(typeof n===e)return}const s=new Error(`invalid value for type ${e}`);throw s.code="INVALID_ARGUMENT",s.argument=`value.${t}`,s.value=n,s}async function Sr(n){const e=Object.keys(n);return(await Promise.all(e.map(r=>Promise.resolve(n[r])))).reduce((r,s,i)=>(r[e[i]]=s,r),{})}function Re(n,e,t){for(let r in e){let s=e[r];const i=t?t[r]:null;i&&Qce(s,i,r),Object.defineProperty(n,r,{enumerable:!0,value:s,writable:!1})}}function Fh(n){if(n==null)return"null";if(Array.isArray(n))return"[ "+n.map(Fh).join(", ")+" ]";if(n instanceof Uint8Array){const e="0123456789abcdef";let t="0x";for(let r=0;r<n.length;r++)t+=e[n[r]>>4],t+=e[n[r]&15];return t}if(typeof n=="object"&&typeof n.toJSON=="function")return Fh(n.toJSON());switch(typeof n){case"boolean":case"symbol":return n.toString();case"bigint":return BigInt(n).toString();case"number":return n.toString();case"string":return JSON.stringify(n);case"object":{const e=Object.keys(n);return e.sort(),"{ "+e.map(t=>`${Fh(t)}: ${Fh(n[t])}`).join(", ")+" }"}}return"[ COULD NOT SERIALIZE ]"}function pr(n,e){return n&&n.code===e}function q_(n){return pr(n,"CALL_EXCEPTION")}function un(n,e,t){let r=n;{const i=[];if(t){if("message"in t||"code"in t||"name"in t)throw new Error(`value will overwrite populated values: ${Fh(t)}`);for(const o in t){if(o==="shortMessage")continue;const a=t[o];i.push(o+"="+Fh(a))}}i.push(`code=${e}`),i.push(`version=${Yce}`),i.length&&(n+=" ("+i.join(", ")+")")}let s;switch(e){case"INVALID_ARGUMENT":s=new TypeError(n);break;case"NUMERIC_FAULT":case"BUFFER_OVERRUN":s=new RangeError(n);break;default:s=new Error(n)}return Re(s,{code:e}),t&&Object.assign(s,t),s.shortMessage==null&&Re(s,{shortMessage:r}),s}function K(n,e,t,r){if(!n)throw un(e,t,r)}function x(n,e,t,r){K(n,e,"INVALID_ARGUMENT",{argument:t,value:r})}function PM(n,e,t){t==null&&(t=""),t&&(t=": "+t),K(n>=e,"missing arguemnt"+t,"MISSING_ARGUMENT",{count:n,expectedCount:e}),K(n<=e,"too many arguments"+t,"UNEXPECTED_ARGUMENT",{count:n,expectedCount:e})}["NFD","NFC","NFKD","NFKC"].reduce((n,e)=>{try{if("test".normalize(e)!=="test")throw new Error("bad");if(e==="NFD"&&"é".normalize("NFD")!=="é")throw new Error("broken");n.push(e)}catch{}return n},[]);function by(n,e,t){if(t==null&&(t=""),n!==e){let r=t,s="new";t&&(r+=".",s+=" "+t),K(!1,`private constructor; use ${r}from* methods`,"UNSUPPORTED_OPERATION",{operation:s})}}function kM(n,e,t){if(n instanceof Uint8Array)return t?new Uint8Array(n):n;if(typeof n=="string"&&n.match(/^0x([0-9a-f][0-9a-f])*$/i)){const r=new Uint8Array((n.length-2)/2);let s=2;for(let i=0;i<r.length;i++)r[i]=parseInt(n.substring(s,s+2),16),s+=2;return r}x(!1,"invalid BytesLike value",e||"value",n)}function ot(n,e){return kM(n,e,!1)}function Nr(n,e){return kM(n,e,!0)}function Ut(n,e){return!(typeof n!="string"||!n.match(/^0x[0-9A-Fa-f]*$/)||typeof e=="number"&&n.length!==2+2*e||e===!0&&n.length%2!==0)}function z_(n){return Ut(n,!0)||n instanceof Uint8Array}const Zx="0123456789abcdef";function Ee(n){const e=ot(n);let t="0x";for(let r=0;r<e.length;r++){const s=e[r];t+=Zx[(s&240)>>4]+Zx[s&15]}return t}function on(n){return"0x"+n.map(e=>Ee(e).substring(2)).join("")}function Xh(n){return Ut(n,!0)?(n.length-2)/2:ot(n).length}function Zt(n,e,t){const r=ot(n);return t!=null&&t>r.length&&K(!1,"cannot slice beyond data bounds","BUFFER_OVERRUN",{buffer:r,length:r.length,offset:t}),Ee(r.slice(e??0,t??r.length))}function DM(n,e,t){const r=ot(n);K(e>=r.length,"padding exceeds data length","BUFFER_OVERRUN",{buffer:new Uint8Array(r),length:e,offset:e+1});const s=new Uint8Array(e);return s.fill(0),t?s.set(r,e-r.length):s.set(r,0),Ee(s)}function Au(n,e){return DM(n,e,!0)}function Zce(n,e){return DM(n,e,!1)}const fE=BigInt(0),Ii=BigInt(1),jh=9007199254740991;function eb(n,e){const t=pE(n,"value"),r=BigInt(We(e,"width"));if(K(t>>r===fE,"overflow","NUMERIC_FAULT",{operation:"fromTwos",fault:"overflow",value:n}),t>>r-Ii){const s=(Ii<<r)-Ii;return-((~t&s)+Ii)}return t}function UM(n,e){let t=Ae(n,"value");const r=BigInt(We(e,"width")),s=Ii<<r-Ii;if(t<fE){t=-t,K(t<=s,"too low","NUMERIC_FAULT",{operation:"toTwos",fault:"overflow",value:n});const i=(Ii<<r)-Ii;return(~t&i)+Ii}else K(t<s,"too high","NUMERIC_FAULT",{operation:"toTwos",fault:"overflow",value:n});return t}function Tl(n,e){const t=pE(n,"value"),r=BigInt(We(e,"bits"));return t&(Ii<<r)-Ii}function Ae(n,e){switch(typeof n){case"bigint":return n;case"number":return x(Number.isInteger(n),"underflow",e||"value",n),x(n>=-jh&&n<=jh,"overflow",e||"value",n),BigInt(n);case"string":try{if(n==="")throw new Error("empty string");return n[0]==="-"&&n[1]!=="-"?-BigInt(n.substring(1)):BigInt(n)}catch(t){x(!1,`invalid BigNumberish string: ${t.message}`,e||"value",n)}}x(!1,"invalid BigNumberish value",e||"value",n)}function pE(n,e){const t=Ae(n,e);return K(t>=fE,"unsigned value cannot be negative","NUMERIC_FAULT",{fault:"overflow",operation:"getUint",value:n}),t}const Jx="0123456789abcdef";function gE(n){if(n instanceof Uint8Array){let e="0x0";for(const t of n)e+=Jx[t>>4],e+=Jx[t&15];return BigInt(e)}return Ae(n)}function We(n,e){switch(typeof n){case"bigint":return x(n>=-jh&&n<=jh,"overflow",e||"value",n),Number(n);case"number":return x(Number.isInteger(n),"underflow",e||"value",n),x(n>=-jh&&n<=jh,"overflow",e||"value",n),n;case"string":try{if(n==="")throw new Error("empty string");return We(BigInt(n),e)}catch(t){x(!1,`invalid numeric string: ${t.message}`,e||"value",n)}}x(!1,"invalid numeric value",e||"value",n)}function Jce(n){return We(gE(n))}function Fc(n,e){let r=pE(n,"value").toString(16);if(e==null)r.length%2&&(r="0"+r);else{const s=We(e,"width");for(K(s*2>=r.length,`value exceeds width (${s} bytes)`,"NUMERIC_FAULT",{operation:"toBeHex",fault:"overflow",value:n});r.length<s*2;)r="0"+r}return"0x"+r}function xr(n){const e=pE(n,"value");if(e===fE)return new Uint8Array([]);let t=e.toString(16);t.length%2&&(t="0"+t);const r=new Uint8Array(t.length/2);for(let s=0;s<r.length;s++){const i=s*2;r[s]=parseInt(t.substring(i,i+2),16)}return r}function Hh(n){let e=Ee(z_(n)?n:xr(n)).substring(2);for(;e.startsWith("0");)e=e.substring(1);return e===""&&(e="0"),"0x"+e}const Xx="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";BigInt(0);const eR=BigInt(58);function Xce(n){const e=ot(n);let t=gE(e),r="";for(;t;)r=Xx[Number(t%eR)]+r,t/=eR;for(let s=0;s<e.length&&!e[s];s++)r=Xx[0]+r;return r}function ele(n){n=atob(n);const e=new Uint8Array(n.length);for(let t=0;t<n.length;t++)e[t]=n.charCodeAt(t);return ot(e)}function tle(n){const e=ot(n);let t="";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return btoa(t)}var ld;class $M{constructor(e,t,r){B(this,"filter");B(this,"emitter");F(this,ld,void 0);_(this,ld,t),Re(this,{emitter:e,filter:r})}async removeListener(){y(this,ld)!=null&&await this.emitter.off(this.filter,y(this,ld))}}ld=new WeakMap;function nle(n,e,t,r,s){x(!1,`invalid codepoint at offset ${e}; ${n}`,"bytes",t)}function MM(n,e,t,r,s){if(n==="BAD_PREFIX"||n==="UNEXPECTED_CONTINUE"){let i=0;for(let o=e+1;o<t.length&&t[o]>>6===2;o++)i++;return i}return n==="OVERRUN"?t.length-e-1:0}function rle(n,e,t,r,s){return n==="OVERLONG"?(x(typeof s=="number","invalid bad code point for replacement","badCodepoint",s),r.push(s),0):(r.push(65533),MM(n,e,t))}const sle=Object.freeze({error:nle,ignore:MM,replace:rle});function ile(n,e){e==null&&(e=sle.error);const t=ot(n,"bytes"),r=[];let s=0;for(;s<t.length;){const i=t[s++];if(!(i>>7)){r.push(i);continue}let o=null,a=null;if((i&224)===192)o=1,a=127;else if((i&240)===224)o=2,a=2047;else if((i&248)===240)o=3,a=65535;else{(i&192)===128?s+=e("UNEXPECTED_CONTINUE",s-1,t,r):s+=e("BAD_PREFIX",s-1,t,r);continue}if(s-1+o>=t.length){s+=e("OVERRUN",s-1,t,r);continue}let c=i&(1<<8-o-1)-1;for(let l=0;l<o;l++){let u=t[s];if((u&192)!=128){s+=e("MISSING_CONTINUE",s,t,r),c=null;break}c=c<<6|u&63,s++}if(c!==null){if(c>1114111){s+=e("OUT_OF_RANGE",s-1-o,t,r,c);continue}if(c>=55296&&c<=57343){s+=e("UTF16_SURROGATE",s-1-o,t,r,c);continue}if(c<=a){s+=e("OVERLONG",s-1-o,t,r,c);continue}r.push(c)}}return r}function Eo(n,e){x(typeof n=="string","invalid string value","str",n);let t=[];for(let r=0;r<n.length;r++){const s=n.charCodeAt(r);if(s<128)t.push(s);else if(s<2048)t.push(s>>6|192),t.push(s&63|128);else if((s&64512)==55296){r++;const i=n.charCodeAt(r);x(r<n.length&&(i&64512)===56320,"invalid surrogate pair","str",n);const o=65536+((s&1023)<<10)+(i&1023);t.push(o>>18|240),t.push(o>>12&63|128),t.push(o>>6&63|128),t.push(o&63|128)}else t.push(s>>12|224),t.push(s>>6&63|128),t.push(s&63|128)}return new Uint8Array(t)}function ole(n){return n.map(e=>e<=65535?String.fromCharCode(e):(e-=65536,String.fromCharCode((e>>10&1023)+55296,(e&1023)+56320))).join("")}function tb(n,e){return ole(ile(n,e))}function LM(n){async function e(t,r){const s=t.url.split(":")[0].toLowerCase();K(s==="http"||s==="https",`unsupported protocol ${s}`,"UNSUPPORTED_OPERATION",{info:{protocol:s},operation:"request"}),K(s==="https"||!t.credentials||t.allowInsecureAuthentication,"insecure authorized connections unsupported","UNSUPPORTED_OPERATION",{operation:"request"});let i;if(r){const h=new AbortController;i=h.signal,r.addListener(()=>{h.abort()})}const o={method:t.method,headers:new Headers(Array.from(t)),body:t.body||void 0,signal:i},a=await fetch(t.url,o),c={};a.headers.forEach((h,d)=>{c[d.toLowerCase()]=h});const l=await a.arrayBuffer(),u=l==null?null:new Uint8Array(l);return{statusCode:a.status,statusMessage:a.statusText,headers:c,body:u}}return e}const ale=12,cle=250;let tR=LM();const lle=new RegExp("^data:([^;:]*)?(;base64)?,(.*)$","i"),ule=new RegExp("^ipfs://(ipfs/)?(.*)$","i");let v1=!1;async function BM(n,e){try{const t=n.match(lle);if(!t)throw new Error("invalid data");return new xc(200,"OK",{"content-type":t[1]||"text/plain"},t[2]?ele(t[3]):dle(t[3]))}catch{return new xc(599,"BAD REQUEST (invalid data: URI)",{},null,new ba(n))}}function FM(n){async function e(t,r){try{const s=t.match(ule);if(!s)throw new Error("invalid link");return new ba(`${n}${s[2]}`)}catch{return new xc(599,"BAD REQUEST (invalid IPFS URI)",{},null,new ba(t))}}return e}const _w={data:BM,ipfs:FM("https://gateway.ipfs.io/ipfs/")},jM=new WeakMap;var Ul,oc;class hle{constructor(e){F(this,Ul,void 0);F(this,oc,void 0);_(this,Ul,[]),_(this,oc,!1),jM.set(e,()=>{if(!y(this,oc)){_(this,oc,!0);for(const t of y(this,Ul))setTimeout(()=>{t()},0);_(this,Ul,[])}})}addListener(e){K(!y(this,oc),"singal already cancelled","UNSUPPORTED_OPERATION",{operation:"fetchCancelSignal.addCancelListener"}),y(this,Ul).push(e)}get cancelled(){return y(this,oc)}checkSignal(){K(!this.cancelled,"cancelled","CANCELLED",{})}}Ul=new WeakMap,oc=new WeakMap;function Sw(n){if(n==null)throw new Error("missing signal; should not happen");return n.checkSignal(),n}var ud,hd,yi,zo,dd,fd,_n,ws,Wo,$l,Ml,Ll,Qi,wi,ac,Bl,Pp;const Rb=class Rb{constructor(e){F(this,Bl);F(this,ud,void 0);F(this,hd,void 0);F(this,yi,void 0);F(this,zo,void 0);F(this,dd,void 0);F(this,fd,void 0);F(this,_n,void 0);F(this,ws,void 0);F(this,Wo,void 0);F(this,$l,void 0);F(this,Ml,void 0);F(this,Ll,void 0);F(this,Qi,void 0);F(this,wi,void 0);F(this,ac,void 0);_(this,fd,String(e)),_(this,ud,!1),_(this,hd,!0),_(this,yi,{}),_(this,zo,""),_(this,dd,3e5),_(this,wi,{slotInterval:cle,maxAttempts:ale}),_(this,ac,null)}get url(){return y(this,fd)}set url(e){_(this,fd,String(e))}get body(){return y(this,_n)==null?null:new Uint8Array(y(this,_n))}set body(e){if(e==null)_(this,_n,void 0),_(this,ws,void 0);else if(typeof e=="string")_(this,_n,Eo(e)),_(this,ws,"text/plain");else if(e instanceof Uint8Array)_(this,_n,e),_(this,ws,"application/octet-stream");else if(typeof e=="object")_(this,_n,Eo(JSON.stringify(e))),_(this,ws,"application/json");else throw new Error("invalid body")}hasBody(){return y(this,_n)!=null}get method(){return y(this,zo)?y(this,zo):this.hasBody()?"POST":"GET"}set method(e){e==null&&(e=""),_(this,zo,String(e).toUpperCase())}get headers(){const e=Object.assign({},y(this,yi));return y(this,Wo)&&(e.authorization=`Basic ${tle(Eo(y(this,Wo)))}`),this.allowGzip&&(e["accept-encoding"]="gzip"),e["content-type"]==null&&y(this,ws)&&(e["content-type"]=y(this,ws)),this.body&&(e["content-length"]=String(this.body.length)),e}getHeader(e){return this.headers[e.toLowerCase()]}setHeader(e,t){y(this,yi)[String(e).toLowerCase()]=String(t)}clearHeaders(){_(this,yi,{})}[Symbol.iterator](){const e=this.headers,t=Object.keys(e);let r=0;return{next:()=>{if(r<t.length){const s=t[r++];return{value:[s,e[s]],done:!1}}return{value:void 0,done:!0}}}}get credentials(){return y(this,Wo)||null}setCredentials(e,t){x(!e.match(/:/),"invalid basic authentication username","username","[REDACTED]"),_(this,Wo,`${e}:${t}`)}get allowGzip(){return y(this,hd)}set allowGzip(e){_(this,hd,!!e)}get allowInsecureAuthentication(){return!!y(this,ud)}set allowInsecureAuthentication(e){_(this,ud,!!e)}get timeout(){return y(this,dd)}set timeout(e){x(e>=0,"timeout must be non-zero","timeout",e),_(this,dd,e)}get preflightFunc(){return y(this,$l)||null}set preflightFunc(e){_(this,$l,e)}get processFunc(){return y(this,Ml)||null}set processFunc(e){_(this,Ml,e)}get retryFunc(){return y(this,Ll)||null}set retryFunc(e){_(this,Ll,e)}get getUrlFunc(){return y(this,ac)||tR}set getUrlFunc(e){_(this,ac,e)}toString(){return`<FetchRequest method=${JSON.stringify(this.method)} url=${JSON.stringify(this.url)} headers=${JSON.stringify(this.headers)} body=${y(this,_n)?Ee(y(this,_n)):"null"}>`}setThrottleParams(e){e.slotInterval!=null&&(y(this,wi).slotInterval=e.slotInterval),e.maxAttempts!=null&&(y(this,wi).maxAttempts=e.maxAttempts)}send(){return K(y(this,Qi)==null,"request already sent","UNSUPPORTED_OPERATION",{operation:"fetchRequest.send"}),_(this,Qi,new hle(this)),Z(this,Bl,Pp).call(this,0,nR()+this.timeout,0,this,new xc(0,"",{},null,this))}cancel(){K(y(this,Qi)!=null,"request has not been sent","UNSUPPORTED_OPERATION",{operation:"fetchRequest.cancel"});const e=jM.get(this);if(!e)throw new Error("missing signal; should not happen");e()}redirect(e){const t=this.url.split(":")[0].toLowerCase(),r=e.split(":")[0].toLowerCase();K(this.method==="GET"&&(t!=="https"||r!=="http")&&e.match(/^https?:/),"unsupported redirect","UNSUPPORTED_OPERATION",{operation:`redirect(${this.method} ${JSON.stringify(this.url)} => ${JSON.stringify(e)})`});const s=new Rb(e);return s.method="GET",s.allowGzip=this.allowGzip,s.timeout=this.timeout,_(s,yi,Object.assign({},y(this,yi))),y(this,_n)&&_(s,_n,new Uint8Array(y(this,_n))),_(s,ws,y(this,ws)),s}clone(){const e=new Rb(this.url);return _(e,zo,y(this,zo)),y(this,_n)&&_(e,_n,y(this,_n)),_(e,ws,y(this,ws)),_(e,yi,Object.assign({},y(this,yi))),_(e,Wo,y(this,Wo)),this.allowGzip&&(e.allowGzip=!0),e.timeout=this.timeout,this.allowInsecureAuthentication&&(e.allowInsecureAuthentication=!0),_(e,$l,y(this,$l)),_(e,Ml,y(this,Ml)),_(e,Ll,y(this,Ll)),_(e,wi,Object.assign({},y(this,wi))),_(e,ac,y(this,ac)),e}static lockConfig(){v1=!0}static getGateway(e){return _w[e.toLowerCase()]||null}static registerGateway(e,t){if(e=e.toLowerCase(),e==="http"||e==="https")throw new Error(`cannot intercept ${e}; use registerGetUrl`);if(v1)throw new Error("gateways locked");_w[e]=t}static registerGetUrl(e){if(v1)throw new Error("gateways locked");tR=e}static createGetUrlFunc(e){return LM()}static createDataGateway(){return BM}static createIpfsGatewayFunc(e){return FM(e)}};ud=new WeakMap,hd=new WeakMap,yi=new WeakMap,zo=new WeakMap,dd=new WeakMap,fd=new WeakMap,_n=new WeakMap,ws=new WeakMap,Wo=new WeakMap,$l=new WeakMap,Ml=new WeakMap,Ll=new WeakMap,Qi=new WeakMap,wi=new WeakMap,ac=new WeakMap,Bl=new WeakSet,Pp=async function(e,t,r,s,i){var u,h,d;if(e>=y(this,wi).maxAttempts)return i.makeServerError("exceeded maximum retry limit");K(nR()<=t,"timeout","TIMEOUT",{operation:"request.send",reason:"timeout",request:s}),r>0&&await fle(r);let o=this.clone();const a=(o.url.split(":")[0]||"").toLowerCase();if(a in _w){const f=await _w[a](o.url,Sw(y(s,Qi)));if(f instanceof xc){let p=f;if(this.processFunc){Sw(y(s,Qi));try{p=await this.processFunc(o,p)}catch(g){(g.throttle==null||typeof g.stall!="number")&&p.makeServerError("error in post-processing function",g).assertOk()}}return p}o=f}this.preflightFunc&&(o=await this.preflightFunc(o));const c=await this.getUrlFunc(o,Sw(y(s,Qi)));let l=new xc(c.statusCode,c.statusMessage,c.headers,c.body,s);if(l.statusCode===301||l.statusCode===302){try{const f=l.headers.location||"";return Z(u=o.redirect(f),Bl,Pp).call(u,e+1,t,0,s,l)}catch{}return l}else if(l.statusCode===429&&(this.retryFunc==null||await this.retryFunc(o,l,e))){const f=l.headers["retry-after"];let p=y(this,wi).slotInterval*Math.trunc(Math.random()*Math.pow(2,e));return typeof f=="string"&&f.match(/^[1-9][0-9]*$/)&&(p=parseInt(f)),Z(h=o.clone(),Bl,Pp).call(h,e+1,t,p,s,l)}if(this.processFunc){Sw(y(s,Qi));try{l=await this.processFunc(o,l)}catch(f){(f.throttle==null||typeof f.stall!="number")&&l.makeServerError("error in post-processing function",f).assertOk();let p=y(this,wi).slotInterval*Math.trunc(Math.random()*Math.pow(2,e));return f.stall>=0&&(p=f.stall),Z(d=o.clone(),Bl,Pp).call(d,e+1,t,p,s,l)}}return l};let ba=Rb;var Pm,km,Dm,bs,pd,Fl;const _T=class _T{constructor(e,t,r,s,i){F(this,Pm,void 0);F(this,km,void 0);F(this,Dm,void 0);F(this,bs,void 0);F(this,pd,void 0);F(this,Fl,void 0);_(this,Pm,e),_(this,km,t),_(this,Dm,Object.keys(r).reduce((o,a)=>(o[a.toLowerCase()]=String(r[a]),o),{})),_(this,bs,s==null?null:new Uint8Array(s)),_(this,pd,i||null),_(this,Fl,{message:""})}toString(){return`<FetchResponse status=${this.statusCode} body=${y(this,bs)?Ee(y(this,bs)):"null"}>`}get statusCode(){return y(this,Pm)}get statusMessage(){return y(this,km)}get headers(){return Object.assign({},y(this,Dm))}get body(){return y(this,bs)==null?null:new Uint8Array(y(this,bs))}get bodyText(){try{return y(this,bs)==null?"":tb(y(this,bs))}catch{K(!1,"response body is not valid UTF-8 data","UNSUPPORTED_OPERATION",{operation:"bodyText",info:{response:this}})}}get bodyJson(){try{return JSON.parse(this.bodyText)}catch{K(!1,"response body is not valid JSON","UNSUPPORTED_OPERATION",{operation:"bodyJson",info:{response:this}})}}[Symbol.iterator](){const e=this.headers,t=Object.keys(e);let r=0;return{next:()=>{if(r<t.length){const s=t[r++];return{value:[s,e[s]],done:!1}}return{value:void 0,done:!0}}}}makeServerError(e,t){let r;e?r=`CLIENT ESCALATED SERVER ERROR (${this.statusCode} ${this.statusMessage}; ${e})`:(e=`${this.statusCode} ${this.statusMessage}`,r=`CLIENT ESCALATED SERVER ERROR (${e})`);const s=new _T(599,r,this.headers,this.body,y(this,pd)||void 0);return _(s,Fl,{message:e,error:t}),s}throwThrottleError(e,t){t==null?t=-1:x(Number.isInteger(t)&&t>=0,"invalid stall timeout","stall",t);const r=new Error(e||"throttling requests");throw Re(r,{stall:t,throttle:!0}),r}getHeader(e){return this.headers[e.toLowerCase()]}hasBody(){return y(this,bs)!=null}get request(){return y(this,pd)}ok(){return y(this,Fl).message===""&&this.statusCode>=200&&this.statusCode<300}assertOk(){if(this.ok())return;let{message:e,error:t}=y(this,Fl);e===""&&(e=`server response ${this.statusCode} ${this.statusMessage}`);let r=null;this.request&&(r=this.request.url);let s=null;try{y(this,bs)&&(s=tb(y(this,bs)))}catch{}K(!1,e,"SERVER_ERROR",{request:this.request||"unknown request",response:this,error:t,info:{requestUrl:r,responseBody:s,responseStatus:`${this.statusCode} ${this.statusMessage}`}})}};Pm=new WeakMap,km=new WeakMap,Dm=new WeakMap,bs=new WeakMap,pd=new WeakMap,Fl=new WeakMap;let xc=_T;function nR(){return new Date().getTime()}function dle(n){return Eo(n.replace(/%([0-9a-f][0-9a-f])/gi,(e,t)=>String.fromCharCode(parseInt(t,16))))}function fle(n){return new Promise(e=>setTimeout(e,n))}const ple=BigInt(-1),pi=BigInt(0),Vh=BigInt(1),gle=BigInt(5),Eh={};let ed="0000";for(;ed.length<80;)ed+=ed;function al(n){let e=ed;for(;e.length<n;)e+=e;return BigInt("1"+e.substring(0,n))}function Ep(n,e,t){const r=BigInt(e.width);if(e.signed){const s=Vh<<r-Vh;K(t==null||n>=-s&&n<s,"overflow","NUMERIC_FAULT",{operation:t,fault:"overflow",value:n}),n>pi?n=eb(Tl(n,r),r):n=-eb(Tl(-n,r),r)}else{const s=Vh<<r;K(t==null||n>=0&&n<s,"overflow","NUMERIC_FAULT",{operation:t,fault:"overflow",value:n}),n=(n%s+s)%s&s-Vh}return n}function A1(n){typeof n=="number"&&(n=`fixed128x${n}`);let e=!0,t=128,r=18;if(typeof n=="string"){if(n!=="fixed")if(n==="ufixed")e=!1;else{const i=n.match(/^(u?)fixed([0-9]+)x([0-9]+)$/);x(i,"invalid fixed format","format",n),e=i[1]!=="u",t=parseInt(i[2]),r=parseInt(i[3])}}else if(n){const i=n,o=(a,c,l)=>i[a]==null?l:(x(typeof i[a]===c,"invalid fixed format ("+a+" not "+c+")","format."+a,i[a]),i[a]);e=o("signed","boolean",e),t=o("width","number",t),r=o("decimals","number",r)}x(t%8===0,"invalid FixedNumber width (not byte aligned)","format.width",t),x(r<=80,"invalid FixedNumber decimals (too large)","format.decimals",r);const s=(e?"":"u")+"fixed"+String(t)+"x"+String(r);return{signed:e,width:t,decimals:r,name:s}}function mle(n,e){let t="";n<pi&&(t="-",n*=ple);let r=n.toString();if(e===0)return t+r;for(;r.length<=e;)r=ed+r;const s=r.length-e;for(r=r.substring(0,s)+"."+r.substring(s);r[0]==="0"&&r[1]!==".";)r=r.substring(1);for(;r[r.length-1]==="0"&&r[r.length-2]!==".";)r=r.substring(0,r.length-1);return t+r}var bi,Rt,Ar,Go,ul,Ei,Bo,Um,IC,$m,_C,Mm,SC,Lm,TC;const ec=class ec{constructor(e,t,r){F(this,Go);F(this,Ei);F(this,Um);F(this,$m);F(this,Mm);F(this,Lm);B(this,"format");F(this,bi,void 0);F(this,Rt,void 0);F(this,Ar,void 0);B(this,"_value");by(e,Eh,"FixedNumber"),_(this,Rt,t),_(this,bi,r);const s=mle(t,r.decimals);Re(this,{format:r.name,_value:s}),_(this,Ar,al(r.decimals))}get signed(){return y(this,bi).signed}get width(){return y(this,bi).width}get decimals(){return y(this,bi).decimals}get value(){return y(this,Rt)}addUnsafe(e){return Z(this,Um,IC).call(this,e)}add(e){return Z(this,Um,IC).call(this,e,"add")}subUnsafe(e){return Z(this,$m,_C).call(this,e)}sub(e){return Z(this,$m,_C).call(this,e,"sub")}mulUnsafe(e){return Z(this,Mm,SC).call(this,e)}mul(e){return Z(this,Mm,SC).call(this,e,"mul")}mulSignal(e){Z(this,Go,ul).call(this,e);const t=y(this,Rt)*y(e,Rt);return K(t%y(this,Ar)===pi,"precision lost during signalling mul","NUMERIC_FAULT",{operation:"mulSignal",fault:"underflow",value:this}),Z(this,Ei,Bo).call(this,t/y(this,Ar),"mulSignal")}divUnsafe(e){return Z(this,Lm,TC).call(this,e)}div(e){return Z(this,Lm,TC).call(this,e,"div")}divSignal(e){K(y(e,Rt)!==pi,"division by zero","NUMERIC_FAULT",{operation:"div",fault:"divide-by-zero",value:this}),Z(this,Go,ul).call(this,e);const t=y(this,Rt)*y(this,Ar);return K(t%y(e,Rt)===pi,"precision lost during signalling div","NUMERIC_FAULT",{operation:"divSignal",fault:"underflow",value:this}),Z(this,Ei,Bo).call(this,t/y(e,Rt),"divSignal")}cmp(e){let t=this.value,r=e.value;const s=this.decimals-e.decimals;return s>0?r*=al(s):s<0&&(t*=al(-s)),t<r?-1:t>r?1:0}eq(e){return this.cmp(e)===0}lt(e){return this.cmp(e)<0}lte(e){return this.cmp(e)<=0}gt(e){return this.cmp(e)>0}gte(e){return this.cmp(e)>=0}floor(){let e=y(this,Rt);return y(this,Rt)<pi&&(e-=y(this,Ar)-Vh),e=y(this,Rt)/y(this,Ar)*y(this,Ar),Z(this,Ei,Bo).call(this,e,"floor")}ceiling(){let e=y(this,Rt);return y(this,Rt)>pi&&(e+=y(this,Ar)-Vh),e=y(this,Rt)/y(this,Ar)*y(this,Ar),Z(this,Ei,Bo).call(this,e,"ceiling")}round(e){if(e==null&&(e=0),e>=this.decimals)return this;const t=this.decimals-e,r=gle*al(t-1);let s=this.value+r;const i=al(t);return s=s/i*i,Ep(s,y(this,bi),"round"),new ec(Eh,s,y(this,bi))}isZero(){return y(this,Rt)===pi}isNegative(){return y(this,Rt)<pi}toString(){return this._value}toUnsafeFloat(){return parseFloat(this.toString())}toFormat(e){return ec.fromString(this.toString(),e)}static fromValue(e,t,r){const s=t==null?0:We(t),i=A1(r);let o=Ae(e,"value");const a=s-i.decimals;if(a>0){const c=al(a);K(o%c===pi,"value loses precision for format","NUMERIC_FAULT",{operation:"fromValue",fault:"underflow",value:e}),o/=c}else a<0&&(o*=al(-a));return Ep(o,i,"fromValue"),new ec(Eh,o,i)}static fromString(e,t){const r=e.match(/^(-?)([0-9]*)\.?([0-9]*)$/);x(r&&r[2].length+r[3].length>0,"invalid FixedNumber string value","value",e);const s=A1(t);let i=r[2]||"0",o=r[3]||"";for(;o.length<s.decimals;)o+=ed;K(o.substring(s.decimals).match(/^0*$/),"too many decimals for format","NUMERIC_FAULT",{operation:"fromString",fault:"underflow",value:e}),o=o.substring(0,s.decimals);const a=BigInt(r[1]+i+o);return Ep(a,s,"fromString"),new ec(Eh,a,s)}static fromBytes(e,t){let r=gE(ot(e,"value"));const s=A1(t);return s.signed&&(r=eb(r,s.width)),Ep(r,s,"fromBytes"),new ec(Eh,r,s)}};bi=new WeakMap,Rt=new WeakMap,Ar=new WeakMap,Go=new WeakSet,ul=function(e){x(this.format===e.format,"incompatible format; use fixedNumber.toFormat","other",e)},Ei=new WeakSet,Bo=function(e,t){return e=Ep(e,y(this,bi),t),new ec(Eh,e,y(this,bi))},Um=new WeakSet,IC=function(e,t){return Z(this,Go,ul).call(this,e),Z(this,Ei,Bo).call(this,y(this,Rt)+y(e,Rt),t)},$m=new WeakSet,_C=function(e,t){return Z(this,Go,ul).call(this,e),Z(this,Ei,Bo).call(this,y(this,Rt)-y(e,Rt),t)},Mm=new WeakSet,SC=function(e,t){return Z(this,Go,ul).call(this,e),Z(this,Ei,Bo).call(this,y(this,Rt)*y(e,Rt)/y(this,Ar),t)},Lm=new WeakSet,TC=function(e,t){return K(y(e,Rt)!==pi,"division by zero","NUMERIC_FAULT",{operation:"div",fault:"divide-by-zero",value:this}),Z(this,Go,ul).call(this,e),Z(this,Ei,Bo).call(this,y(this,Rt)*y(this,Ar)/y(e,Rt),t)};let nb=ec;function yle(n){let e=n.toString(16);for(;e.length<2;)e="0"+e;return"0x"+e}function rR(n,e,t){let r=0;for(let s=0;s<t;s++)r=r*256+n[e+s];return r}function sR(n,e,t,r){const s=[];for(;t<e+1+r;){const i=HM(n,t);s.push(i.result),t+=i.consumed,K(t<=e+1+r,"child data too short","BUFFER_OVERRUN",{buffer:n,length:r,offset:e})}return{consumed:1+r,result:s}}function HM(n,e){K(n.length!==0,"data too short","BUFFER_OVERRUN",{buffer:n,length:0,offset:1});const t=r=>{K(r<=n.length,"data short segment too short","BUFFER_OVERRUN",{buffer:n,length:n.length,offset:r})};if(n[e]>=248){const r=n[e]-247;t(e+1+r);const s=rR(n,e+1,r);return t(e+1+r+s),sR(n,e,e+1+r,r+s)}else if(n[e]>=192){const r=n[e]-192;return t(e+1+r),sR(n,e,e+1,r)}else if(n[e]>=184){const r=n[e]-183;t(e+1+r);const s=rR(n,e+1,r);t(e+1+r+s);const i=Ee(n.slice(e+1+r,e+1+r+s));return{consumed:1+r+s,result:i}}else if(n[e]>=128){const r=n[e]-128;t(e+1+r);const s=Ee(n.slice(e+1,e+1+r));return{consumed:1+r,result:s}}return{consumed:1,result:yle(n[e])}}function mE(n){const e=ot(n,"data"),t=HM(e,0);return x(t.consumed===e.length,"unexpected junk after rlp payload","data",n),t.result}function iR(n){const e=[];for(;n;)e.unshift(n&255),n>>=8;return e}function VM(n){if(Array.isArray(n)){let r=[];if(n.forEach(function(i){r=r.concat(VM(i))}),r.length<=55)return r.unshift(192+r.length),r;const s=iR(r.length);return s.unshift(247+s.length),s.concat(r)}const e=Array.prototype.slice.call(ot(n,"object"));if(e.length===1&&e[0]<=127)return e;if(e.length<=55)return e.unshift(128+e.length),e;const t=iR(e.length);return t.unshift(183+t.length),t.concat(e)}const oR="0123456789abcdef";function Cu(n){let e="0x";for(const t of VM(n))e+=oR[t>>4],e+=oR[t&15];return e}const qM=["wei","kwei","mwei","gwei","szabo","finney","ether"];function zM(n,e){let t=18;if(typeof e=="string"){const r=qM.indexOf(e);x(r>=0,"invalid unit","unit",e),t=3*r}else e!=null&&(t=We(e,"unit"));return nb.fromValue(n,t,{decimals:t,width:512}).toString()}function WM(n,e){x(typeof n=="string","value must be a string","value",n);let t=18;if(typeof e=="string"){const r=qM.indexOf(e);x(r>=0,"invalid unit","unit",e),t=3*r}else e!=null&&(t=We(e,"unit"));return nb.fromString(n,{decimals:t,width:512}).value}function wle(n){return zM(n,18)}function Yve(n){return WM(n,18)}const Rr=32,NC=new Uint8Array(Rr),ble=["then"],Tw={};function vp(n,e){const t=new Error(`deferred error during ABI decoding triggered accessing ${n}`);throw t.error=e,t}var cc;const yl=class yl extends Array{constructor(...t){const r=t[0];let s=t[1],i=(t[2]||[]).slice(),o=!0;r!==Tw&&(s=t,i=[],o=!1);super(s.length);F(this,cc,void 0);s.forEach((c,l)=>{this[l]=c});const a=i.reduce((c,l)=>(typeof l=="string"&&c.set(l,(c.get(l)||0)+1),c),new Map);if(_(this,cc,Object.freeze(s.map((c,l)=>{const u=i[l];return u!=null&&a.get(u)===1?u:null}))),!!o)return Object.freeze(this),new Proxy(this,{get:(c,l,u)=>{if(typeof l=="string"){if(l.match(/^[0-9]+$/)){const d=We(l,"%index");if(d<0||d>=this.length)throw new RangeError("out of result range");const f=c[d];return f instanceof Error&&vp(`index ${d}`,f),f}if(ble.indexOf(l)>=0)return Reflect.get(c,l,u);const h=c[l];if(h instanceof Function)return function(...d){return h.apply(this===u?c:this,d)};if(!(l in c))return c.getValue.apply(this===u?c:this,[l])}return Reflect.get(c,l,u)}})}toArray(t){const r=[];return this.forEach((s,i)=>{s instanceof Error&&vp(`index ${i}`,s),t&&s instanceof yl&&(s=s.toArray(t)),r.push(s)}),r}toObject(t){return y(this,cc).reduce((r,s,i)=>{if(K(s!=null,"value at index ${ index } unnamed","UNSUPPORTED_OPERATION",{operation:"toObject()"}),!(s in r)){let o=this.getValue(s);t&&o instanceof yl&&(o=o.toObject(t)),r[s]=o}return r},{})}slice(t,r){t==null&&(t=0),t<0&&(t+=this.length,t<0&&(t=0)),r==null&&(r=this.length),r<0&&(r+=this.length,r<0&&(r=0)),r>this.length&&(r=this.length);const s=[],i=[];for(let o=t;o<r;o++)s.push(this[o]),i.push(y(this,cc)[o]);return new yl(Tw,s,i)}filter(t,r){const s=[],i=[];for(let o=0;o<this.length;o++){const a=this[o];a instanceof Error&&vp(`index ${o}`,a),t.call(r,a,o,this)&&(s.push(a),i.push(y(this,cc)[o]))}return new yl(Tw,s,i)}map(t,r){const s=[];for(let i=0;i<this.length;i++){const o=this[i];o instanceof Error&&vp(`index ${i}`,o),s.push(t.call(r,o,i,this))}return s}getValue(t){const r=y(this,cc).indexOf(t);if(r===-1)return;const s=this[r];return s instanceof Error&&vp(`property ${JSON.stringify(t)}`,s.error),s}static fromItems(t,r){return new yl(Tw,t,r)}};cc=new WeakMap;let rb=yl;function aR(n){let e=xr(n);return K(e.length<=Rr,"value out-of-bounds","BUFFER_OVERRUN",{buffer:e,length:Rr,offset:e.length}),e.length!==Rr&&(e=Nr(on([NC.slice(e.length%Rr),e]))),e}class Sa{constructor(e,t,r,s){B(this,"name");B(this,"type");B(this,"localName");B(this,"dynamic");Re(this,{name:e,type:t,localName:r,dynamic:s},{name:"string",type:"string",localName:"string",dynamic:"boolean"})}_throwError(e,t){x(!1,e,this.localName,t)}}var Ko,jl,gd,i0;class OC{constructor(){F(this,gd);F(this,Ko,void 0);F(this,jl,void 0);_(this,Ko,[]),_(this,jl,0)}get data(){return on(y(this,Ko))}get length(){return y(this,jl)}appendWriter(e){return Z(this,gd,i0).call(this,Nr(e.data))}writeBytes(e){let t=Nr(e);const r=t.length%Rr;return r&&(t=Nr(on([t,NC.slice(r)]))),Z(this,gd,i0).call(this,t)}writeValue(e){return Z(this,gd,i0).call(this,aR(e))}writeUpdatableValue(){const e=y(this,Ko).length;return y(this,Ko).push(NC),_(this,jl,y(this,jl)+Rr),t=>{y(this,Ko)[e]=aR(t)}}}Ko=new WeakMap,jl=new WeakMap,gd=new WeakSet,i0=function(e){return y(this,Ko).push(e),_(this,jl,y(this,jl)+e.length),e.length};var Qr,Es,Hl,Vl,lc,Bm,RC,Pb,GM;const ST=class ST{constructor(e,t,r){F(this,Bm);F(this,Pb);B(this,"allowLoose");F(this,Qr,void 0);F(this,Es,void 0);F(this,Hl,void 0);F(this,Vl,void 0);F(this,lc,void 0);Re(this,{allowLoose:!!t}),_(this,Qr,Nr(e)),_(this,Hl,0),_(this,Vl,null),_(this,lc,r??1024),_(this,Es,0)}get data(){return Ee(y(this,Qr))}get dataLength(){return y(this,Qr).length}get consumed(){return y(this,Es)}get bytes(){return new Uint8Array(y(this,Qr))}subReader(e){const t=new ST(y(this,Qr).slice(y(this,Es)+e),this.allowLoose,y(this,lc));return _(t,Vl,this),t}readBytes(e,t){let r=Z(this,Pb,GM).call(this,0,e,!!t);return Z(this,Bm,RC).call(this,e),_(this,Es,y(this,Es)+r.length),r.slice(0,e)}readValue(){return gE(this.readBytes(Rr))}readIndex(){return Jce(this.readBytes(Rr))}};Qr=new WeakMap,Es=new WeakMap,Hl=new WeakMap,Vl=new WeakMap,lc=new WeakMap,Bm=new WeakSet,RC=function(e){var t;if(y(this,Vl))return Z(t=y(this,Vl),Bm,RC).call(t,e);_(this,Hl,y(this,Hl)+e),K(y(this,lc)<1||y(this,Hl)<=y(this,lc)*this.dataLength,`compressed ABI data exceeds inflation ratio of ${y(this,lc)} ( see: https://github.com/ethers-io/ethers.js/issues/4537 )`,"BUFFER_OVERRUN",{buffer:Nr(y(this,Qr)),offset:y(this,Es),length:e,info:{bytesRead:y(this,Hl),dataLength:this.dataLength}})},Pb=new WeakSet,GM=function(e,t,r){let s=Math.ceil(t/Rr)*Rr;return y(this,Es)+s>y(this,Qr).length&&(this.allowLoose&&r&&y(this,Es)+t<=y(this,Qr).length?s=t:K(!1,"data out-of-bounds","BUFFER_OVERRUN",{buffer:Nr(y(this,Qr)),length:y(this,Qr).length,offset:y(this,Es)+s})),y(this,Qr).slice(y(this,Es),y(this,Es)+s)};let xC=ST;function sb(n){if(!Number.isSafeInteger(n)||n<0)throw new Error(`Wrong positive integer: ${n}`)}function W_(n,...e){if(!(n instanceof Uint8Array))throw new Error("Expected Uint8Array");if(e.length>0&&!e.includes(n.length))throw new Error(`Expected Uint8Array of length ${e}, not of length=${n.length}`)}function Ele(n){if(typeof n!="function"||typeof n.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");sb(n.outputLen),sb(n.blockLen)}function hf(n,e=!0){if(n.destroyed)throw new Error("Hash instance has been destroyed");if(e&&n.finished)throw new Error("Hash#digest() has already been called")}function KM(n,e){W_(n);const t=e.outputLen;if(n.length<t)throw new Error(`digestInto() expects output buffer of length at least ${t}`)}const C1=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const YM=n=>n instanceof Uint8Array,vle=n=>new Uint32Array(n.buffer,n.byteOffset,Math.floor(n.byteLength/4)),I1=n=>new DataView(n.buffer,n.byteOffset,n.byteLength),Wi=(n,e)=>n<<32-e|n>>>e,Ale=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!Ale)throw new Error("Non little-endian hardware is not supported");function Cle(n){if(typeof n!="string")throw new Error(`utf8ToBytes expected string, got ${typeof n}`);return new Uint8Array(new TextEncoder().encode(n))}function yE(n){if(typeof n=="string"&&(n=Cle(n)),!YM(n))throw new Error(`expected Uint8Array, got ${typeof n}`);return n}function Ile(...n){const e=new Uint8Array(n.reduce((r,s)=>r+s.length,0));let t=0;return n.forEach(r=>{if(!YM(r))throw new Error("Uint8Array expected");e.set(r,t),t+=r.length}),e}class G_{clone(){return this._cloneInto()}}function K_(n){const e=r=>n().update(yE(r)).digest(),t=n();return e.outputLen=t.outputLen,e.blockLen=t.blockLen,e.create=()=>n(),e}function _le(n=32){if(C1&&typeof C1.getRandomValues=="function")return C1.getRandomValues(new Uint8Array(n));throw new Error("crypto.getRandomValues must be defined")}class QM extends G_{constructor(e,t){super(),this.finished=!1,this.destroyed=!1,Ele(e);const r=yE(t);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const s=this.blockLen,i=new Uint8Array(s);i.set(r.length>s?e.create().update(r).digest():r);for(let o=0;o<i.length;o++)i[o]^=54;this.iHash.update(i),this.oHash=e.create();for(let o=0;o<i.length;o++)i[o]^=106;this.oHash.update(i),i.fill(0)}update(e){return hf(this),this.iHash.update(e),this}digestInto(e){hf(this),W_(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:t,iHash:r,finished:s,destroyed:i,blockLen:o,outputLen:a}=this;return e=e,e.finished=s,e.destroyed=i,e.blockLen=o,e.outputLen=a,e.oHash=t._cloneInto(e.oHash),e.iHash=r._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const ZM=(n,e,t)=>new QM(n,e).update(t).digest();ZM.create=(n,e)=>new QM(n,e);function Sle(n,e,t,r){if(typeof n.setBigUint64=="function")return n.setBigUint64(e,t,r);const s=BigInt(32),i=BigInt(4294967295),o=Number(t>>s&i),a=Number(t&i),c=r?4:0,l=r?0:4;n.setUint32(e+c,o,r),n.setUint32(e+l,a,r)}class JM extends G_{constructor(e,t,r,s){super(),this.blockLen=e,this.outputLen=t,this.padOffset=r,this.isLE=s,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=I1(this.buffer)}update(e){hf(this);const{view:t,buffer:r,blockLen:s}=this;e=yE(e);const i=e.length;for(let o=0;o<i;){const a=Math.min(s-this.pos,i-o);if(a===s){const c=I1(e);for(;s<=i-o;o+=s)this.process(c,o);continue}r.set(e.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===s&&(this.process(t,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){hf(this),KM(e,this),this.finished=!0;const{buffer:t,view:r,blockLen:s,isLE:i}=this;let{pos:o}=this;t[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>s-o&&(this.process(r,0),o=0);for(let h=o;h<s;h++)t[h]=0;Sle(r,s-8,BigInt(this.length*8),i),this.process(r,0);const a=I1(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const l=c/4,u=this.get();if(l>u.length)throw new Error("_sha2: outputLen bigger than state");for(let h=0;h<l;h++)a.setUint32(4*h,u[h],i)}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const r=e.slice(0,t);return this.destroy(),r}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:t,buffer:r,length:s,finished:i,destroyed:o,pos:a}=this;return e.length=s,e.pos=a,e.finished=i,e.destroyed=o,s%t&&e.buffer.set(r),e}}const Tle=(n,e,t)=>n&e^~n&t,Nle=(n,e,t)=>n&e^n&t^e&t,Ole=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),qa=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),za=new Uint32Array(64);class xle extends JM{constructor(){super(64,32,8,!1),this.A=qa[0]|0,this.B=qa[1]|0,this.C=qa[2]|0,this.D=qa[3]|0,this.E=qa[4]|0,this.F=qa[5]|0,this.G=qa[6]|0,this.H=qa[7]|0}get(){const{A:e,B:t,C:r,D:s,E:i,F:o,G:a,H:c}=this;return[e,t,r,s,i,o,a,c]}set(e,t,r,s,i,o,a,c){this.A=e|0,this.B=t|0,this.C=r|0,this.D=s|0,this.E=i|0,this.F=o|0,this.G=a|0,this.H=c|0}process(e,t){for(let h=0;h<16;h++,t+=4)za[h]=e.getUint32(t,!1);for(let h=16;h<64;h++){const d=za[h-15],f=za[h-2],p=Wi(d,7)^Wi(d,18)^d>>>3,g=Wi(f,17)^Wi(f,19)^f>>>10;za[h]=g+za[h-7]+p+za[h-16]|0}let{A:r,B:s,C:i,D:o,E:a,F:c,G:l,H:u}=this;for(let h=0;h<64;h++){const d=Wi(a,6)^Wi(a,11)^Wi(a,25),f=u+d+Tle(a,c,l)+Ole[h]+za[h]|0,g=(Wi(r,2)^Wi(r,13)^Wi(r,22))+Nle(r,s,i)|0;u=l,l=c,c=a,a=o+f|0,o=i,i=s,s=r,r=f+g|0}r=r+this.A|0,s=s+this.B|0,i=i+this.C|0,o=o+this.D|0,a=a+this.E|0,c=c+this.F|0,l=l+this.G|0,u=u+this.H|0,this.set(r,s,i,o,a,c,l,u)}roundClean(){za.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}const XM=K_(()=>new xle),Nw=BigInt(2**32-1),PC=BigInt(32);function eL(n,e=!1){return e?{h:Number(n&Nw),l:Number(n>>PC&Nw)}:{h:Number(n>>PC&Nw)|0,l:Number(n&Nw)|0}}function tL(n,e=!1){let t=new Uint32Array(n.length),r=new Uint32Array(n.length);for(let s=0;s<n.length;s++){const{h:i,l:o}=eL(n[s],e);[t[s],r[s]]=[i,o]}return[t,r]}const Rle=(n,e)=>BigInt(n>>>0)<<PC|BigInt(e>>>0),Ple=(n,e,t)=>n>>>t,kle=(n,e,t)=>n<<32-t|e>>>t,Dle=(n,e,t)=>n>>>t|e<<32-t,Ule=(n,e,t)=>n<<32-t|e>>>t,$le=(n,e,t)=>n<<64-t|e>>>t-32,Mle=(n,e,t)=>n>>>t-32|e<<64-t,Lle=(n,e)=>e,Ble=(n,e)=>n,nL=(n,e,t)=>n<<t|e>>>32-t,rL=(n,e,t)=>e<<t|n>>>32-t,sL=(n,e,t)=>e<<t-32|n>>>64-t,iL=(n,e,t)=>n<<t-32|e>>>64-t;function Fle(n,e,t,r){const s=(e>>>0)+(r>>>0);return{h:n+t+(s/2**32|0)|0,l:s|0}}const jle=(n,e,t)=>(n>>>0)+(e>>>0)+(t>>>0),Hle=(n,e,t,r)=>e+t+r+(n/2**32|0)|0,Vle=(n,e,t,r)=>(n>>>0)+(e>>>0)+(t>>>0)+(r>>>0),qle=(n,e,t,r,s)=>e+t+r+s+(n/2**32|0)|0,zle=(n,e,t,r,s)=>(n>>>0)+(e>>>0)+(t>>>0)+(r>>>0)+(s>>>0),Wle=(n,e,t,r,s,i)=>e+t+r+s+i+(n/2**32|0)|0,Ke={fromBig:eL,split:tL,toBig:Rle,shrSH:Ple,shrSL:kle,rotrSH:Dle,rotrSL:Ule,rotrBH:$le,rotrBL:Mle,rotr32H:Lle,rotr32L:Ble,rotlSH:nL,rotlSL:rL,rotlBH:sL,rotlBL:iL,add:Fle,add3L:jle,add3H:Hle,add4L:Vle,add4H:qle,add5H:Wle,add5L:zle},[Gle,Kle]=Ke.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(n=>BigInt(n))),Wa=new Uint32Array(80),Ga=new Uint32Array(80);class Yle extends JM{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:e,Al:t,Bh:r,Bl:s,Ch:i,Cl:o,Dh:a,Dl:c,Eh:l,El:u,Fh:h,Fl:d,Gh:f,Gl:p,Hh:g,Hl:m}=this;return[e,t,r,s,i,o,a,c,l,u,h,d,f,p,g,m]}set(e,t,r,s,i,o,a,c,l,u,h,d,f,p,g,m){this.Ah=e|0,this.Al=t|0,this.Bh=r|0,this.Bl=s|0,this.Ch=i|0,this.Cl=o|0,this.Dh=a|0,this.Dl=c|0,this.Eh=l|0,this.El=u|0,this.Fh=h|0,this.Fl=d|0,this.Gh=f|0,this.Gl=p|0,this.Hh=g|0,this.Hl=m|0}process(e,t){for(let A=0;A<16;A++,t+=4)Wa[A]=e.getUint32(t),Ga[A]=e.getUint32(t+=4);for(let A=16;A<80;A++){const T=Wa[A-15]|0,N=Ga[A-15]|0,R=Ke.rotrSH(T,N,1)^Ke.rotrSH(T,N,8)^Ke.shrSH(T,N,7),M=Ke.rotrSL(T,N,1)^Ke.rotrSL(T,N,8)^Ke.shrSL(T,N,7),D=Wa[A-2]|0,S=Ga[A-2]|0,$=Ke.rotrSH(D,S,19)^Ke.rotrBH(D,S,61)^Ke.shrSH(D,S,6),P=Ke.rotrSL(D,S,19)^Ke.rotrBL(D,S,61)^Ke.shrSL(D,S,6),L=Ke.add4L(M,P,Ga[A-7],Ga[A-16]),V=Ke.add4H(L,R,$,Wa[A-7],Wa[A-16]);Wa[A]=V|0,Ga[A]=L|0}let{Ah:r,Al:s,Bh:i,Bl:o,Ch:a,Cl:c,Dh:l,Dl:u,Eh:h,El:d,Fh:f,Fl:p,Gh:g,Gl:m,Hh:w,Hl:v}=this;for(let A=0;A<80;A++){const T=Ke.rotrSH(h,d,14)^Ke.rotrSH(h,d,18)^Ke.rotrBH(h,d,41),N=Ke.rotrSL(h,d,14)^Ke.rotrSL(h,d,18)^Ke.rotrBL(h,d,41),R=h&f^~h&g,M=d&p^~d&m,D=Ke.add5L(v,N,M,Kle[A],Ga[A]),S=Ke.add5H(D,w,T,R,Gle[A],Wa[A]),$=D|0,P=Ke.rotrSH(r,s,28)^Ke.rotrBH(r,s,34)^Ke.rotrBH(r,s,39),L=Ke.rotrSL(r,s,28)^Ke.rotrBL(r,s,34)^Ke.rotrBL(r,s,39),V=r&i^r&a^i&a,G=s&o^s&c^o&c;w=g|0,v=m|0,g=f|0,m=p|0,f=h|0,p=d|0,{h,l:d}=Ke.add(l|0,u|0,S|0,$|0),l=a|0,u=c|0,a=i|0,c=o|0,i=r|0,o=s|0;const E=Ke.add3L($,L,G);r=Ke.add3H(E,S,P,V),s=E|0}({h:r,l:s}=Ke.add(this.Ah|0,this.Al|0,r|0,s|0)),{h:i,l:o}=Ke.add(this.Bh|0,this.Bl|0,i|0,o|0),{h:a,l:c}=Ke.add(this.Ch|0,this.Cl|0,a|0,c|0),{h:l,l:u}=Ke.add(this.Dh|0,this.Dl|0,l|0,u|0),{h,l:d}=Ke.add(this.Eh|0,this.El|0,h|0,d|0),{h:f,l:p}=Ke.add(this.Fh|0,this.Fl|0,f|0,p|0),{h:g,l:m}=Ke.add(this.Gh|0,this.Gl|0,g|0,m|0),{h:w,l:v}=Ke.add(this.Hh|0,this.Hl|0,w|0,v|0),this.set(r,s,i,o,a,c,l,u,h,d,f,p,g,m,w,v)}roundClean(){Wa.fill(0),Ga.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const Qle=K_(()=>new Yle);function Zle(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")}const cR=Zle();cR.crypto||cR.msCrypto;function Jle(n){switch(n){case"sha256":return XM.create();case"sha512":return Qle.create()}x(!1,"invalid hashing algorithm name","algorithm",n)}const[oL,aL,cL]=[[],[],[]],Xle=BigInt(0),Ap=BigInt(1),eue=BigInt(2),tue=BigInt(7),nue=BigInt(256),rue=BigInt(113);for(let n=0,e=Ap,t=1,r=0;n<24;n++){[t,r]=[r,(2*t+3*r)%5],oL.push(2*(5*r+t)),aL.push((n+1)*(n+2)/2%64);let s=Xle;for(let i=0;i<7;i++)e=(e<<Ap^(e>>tue)*rue)%nue,e&eue&&(s^=Ap<<(Ap<<BigInt(i))-Ap);cL.push(s)}const[sue,iue]=tL(cL,!0),lR=(n,e,t)=>t>32?sL(n,e,t):nL(n,e,t),uR=(n,e,t)=>t>32?iL(n,e,t):rL(n,e,t);function oue(n,e=24){const t=new Uint32Array(10);for(let r=24-e;r<24;r++){for(let o=0;o<10;o++)t[o]=n[o]^n[o+10]^n[o+20]^n[o+30]^n[o+40];for(let o=0;o<10;o+=2){const a=(o+8)%10,c=(o+2)%10,l=t[c],u=t[c+1],h=lR(l,u,1)^t[a],d=uR(l,u,1)^t[a+1];for(let f=0;f<50;f+=10)n[o+f]^=h,n[o+f+1]^=d}let s=n[2],i=n[3];for(let o=0;o<24;o++){const a=aL[o],c=lR(s,i,a),l=uR(s,i,a),u=oL[o];s=n[u],i=n[u+1],n[u]=c,n[u+1]=l}for(let o=0;o<50;o+=10){for(let a=0;a<10;a++)t[a]=n[o+a];for(let a=0;a<10;a++)n[o+a]^=~t[(a+2)%10]&t[(a+4)%10]}n[0]^=sue[r],n[1]^=iue[r]}t.fill(0)}class Y_ extends G_{constructor(e,t,r,s=!1,i=24){if(super(),this.blockLen=e,this.suffix=t,this.outputLen=r,this.enableXOF=s,this.rounds=i,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,sb(r),0>=this.blockLen||this.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=vle(this.state)}keccak(){oue(this.state32,this.rounds),this.posOut=0,this.pos=0}update(e){hf(this);const{blockLen:t,state:r}=this;e=yE(e);const s=e.length;for(let i=0;i<s;){const o=Math.min(t-this.pos,s-i);for(let a=0;a<o;a++)r[this.pos++]^=e[i++];this.pos===t&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:t,pos:r,blockLen:s}=this;e[r]^=t,t&128&&r===s-1&&this.keccak(),e[s-1]^=128,this.keccak()}writeInto(e){hf(this,!1),W_(e),this.finish();const t=this.state,{blockLen:r}=this;for(let s=0,i=e.length;s<i;){this.posOut>=r&&this.keccak();const o=Math.min(r-this.posOut,i-s);e.set(t.subarray(this.posOut,this.posOut+o),s),this.posOut+=o,s+=o}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return sb(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(KM(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(e){const{blockLen:t,suffix:r,outputLen:s,rounds:i,enableXOF:o}=this;return e||(e=new Y_(t,r,s,o,i)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=i,e.suffix=r,e.outputLen=s,e.enableXOF=o,e.destroyed=this.destroyed,e}}const aue=(n,e,t)=>K_(()=>new Y_(e,n,t)),cue=aue(1,136,256/8);let lL=!1;const uL=function(n){return cue(n)};let hL=uL;function pn(n){const e=ot(n,"data");return Ee(hL(e))}pn._=uL;pn.lock=function(){lL=!0};pn.register=function(n){if(lL)throw new TypeError("keccak256 is locked");hL=n};Object.freeze(pn);const dL=function(n){return Jle("sha256").update(n).digest()};let fL=dL,pL=!1;function jf(n){const e=ot(n,"data");return Ee(fL(e))}jf._=dL;jf.lock=function(){pL=!0};jf.register=function(n){if(pL)throw new Error("sha256 is locked");fL=n};Object.freeze(jf);Object.freeze(jf);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const gL=BigInt(0),wE=BigInt(1),lue=BigInt(2),bE=n=>n instanceof Uint8Array,uue=Array.from({length:256},(n,e)=>e.toString(16).padStart(2,"0"));function df(n){if(!bE(n))throw new Error("Uint8Array expected");let e="";for(let t=0;t<n.length;t++)e+=uue[n[t]];return e}function mL(n){const e=n.toString(16);return e.length&1?`0${e}`:e}function Q_(n){if(typeof n!="string")throw new Error("hex string expected, got "+typeof n);return BigInt(n===""?"0":`0x${n}`)}function ff(n){if(typeof n!="string")throw new Error("hex string expected, got "+typeof n);const e=n.length;if(e%2)throw new Error("padded hex string expected, got unpadded hex of length "+e);const t=new Uint8Array(e/2);for(let r=0;r<t.length;r++){const s=r*2,i=n.slice(s,s+2),o=Number.parseInt(i,16);if(Number.isNaN(o)||o<0)throw new Error("Invalid byte sequence");t[r]=o}return t}function lu(n){return Q_(df(n))}function Z_(n){if(!bE(n))throw new Error("Uint8Array expected");return Q_(df(Uint8Array.from(n).reverse()))}function pf(n,e){return ff(n.toString(16).padStart(e*2,"0"))}function J_(n,e){return pf(n,e).reverse()}function hue(n){return ff(mL(n))}function mi(n,e,t){let r;if(typeof e=="string")try{r=ff(e)}catch(i){throw new Error(`${n} must be valid hex string, got "${e}". Cause: ${i}`)}else if(bE(e))r=Uint8Array.from(e);else throw new Error(`${n} must be hex string or Uint8Array`);const s=r.length;if(typeof t=="number"&&s!==t)throw new Error(`${n} expected ${t} bytes, got ${s}`);return r}function am(...n){const e=new Uint8Array(n.reduce((r,s)=>r+s.length,0));let t=0;return n.forEach(r=>{if(!bE(r))throw new Error("Uint8Array expected");e.set(r,t),t+=r.length}),e}function due(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;t++)if(n[t]!==e[t])return!1;return!0}function fue(n){if(typeof n!="string")throw new Error(`utf8ToBytes expected string, got ${typeof n}`);return new Uint8Array(new TextEncoder().encode(n))}function pue(n){let e;for(e=0;n>gL;n>>=wE,e+=1);return e}function gue(n,e){return n>>BigInt(e)&wE}const mue=(n,e,t)=>n|(t?wE:gL)<<BigInt(e),X_=n=>(lue<<BigInt(n-1))-wE,_1=n=>new Uint8Array(n),hR=n=>Uint8Array.from(n);function yL(n,e,t){if(typeof n!="number"||n<2)throw new Error("hashLen must be a number");if(typeof e!="number"||e<2)throw new Error("qByteLen must be a number");if(typeof t!="function")throw new Error("hmacFn must be a function");let r=_1(n),s=_1(n),i=0;const o=()=>{r.fill(1),s.fill(0),i=0},a=(...h)=>t(s,r,...h),c=(h=_1())=>{s=a(hR([0]),h),r=a(),h.length!==0&&(s=a(hR([1]),h),r=a())},l=()=>{if(i++>=1e3)throw new Error("drbg: tried 1000 values");let h=0;const d=[];for(;h<e;){r=a();const f=r.slice();d.push(f),h+=r.length}return am(...d)};return(h,d)=>{o(),c(h);let f;for(;!(f=d(l()));)c();return o(),f}}const yue={bigint:n=>typeof n=="bigint",function:n=>typeof n=="function",boolean:n=>typeof n=="boolean",string:n=>typeof n=="string",stringOrUint8Array:n=>typeof n=="string"||n instanceof Uint8Array,isSafeInteger:n=>Number.isSafeInteger(n),array:n=>Array.isArray(n),field:(n,e)=>e.Fp.isValid(n),hash:n=>typeof n=="function"&&Number.isSafeInteger(n.outputLen)};function Ey(n,e,t={}){const r=(s,i,o)=>{const a=yue[i];if(typeof a!="function")throw new Error(`Invalid validator "${i}", expected function`);const c=n[s];if(!(o&&c===void 0)&&!a(c,n))throw new Error(`Invalid param ${String(s)}=${c} (${typeof c}), expected ${i}`)};for(const[s,i]of Object.entries(e))r(s,i,!1);for(const[s,i]of Object.entries(t))r(s,i,!0);return n}const wue=Object.freeze(Object.defineProperty({__proto__:null,bitGet:gue,bitLen:pue,bitMask:X_,bitSet:mue,bytesToHex:df,bytesToNumberBE:lu,bytesToNumberLE:Z_,concatBytes:am,createHmacDrbg:yL,ensureBytes:mi,equalBytes:due,hexToBytes:ff,hexToNumber:Q_,numberToBytesBE:pf,numberToBytesLE:J_,numberToHexUnpadded:mL,numberToVarBytesBE:hue,utf8ToBytes:fue,validateObject:Ey},Symbol.toStringTag,{value:"Module"}));/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Pn=BigInt(0),rn=BigInt(1),ml=BigInt(2),bue=BigInt(3),kC=BigInt(4),dR=BigInt(5),fR=BigInt(8);BigInt(9);BigInt(16);function ns(n,e){const t=n%e;return t>=Pn?t:e+t}function Eue(n,e,t){if(t<=Pn||e<Pn)throw new Error("Expected power/modulo > 0");if(t===rn)return Pn;let r=rn;for(;e>Pn;)e&rn&&(r=r*n%t),n=n*n%t,e>>=rn;return r}function Ls(n,e,t){let r=n;for(;e-- >Pn;)r*=r,r%=t;return r}function DC(n,e){if(n===Pn||e<=Pn)throw new Error(`invert: expected positive integers, got n=${n} mod=${e}`);let t=ns(n,e),r=e,s=Pn,i=rn;for(;t!==Pn;){const a=r/t,c=r%t,l=s-i*a;r=t,t=c,s=i,i=l}if(r!==rn)throw new Error("invert: does not exist");return ns(s,e)}function vue(n){const e=(n-rn)/ml;let t,r,s;for(t=n-rn,r=0;t%ml===Pn;t/=ml,r++);for(s=ml;s<n&&Eue(s,e,n)!==n-rn;s++);if(r===1){const o=(n+rn)/kC;return function(c,l){const u=c.pow(l,o);if(!c.eql(c.sqr(u),l))throw new Error("Cannot find square root");return u}}const i=(t+rn)/ml;return function(a,c){if(a.pow(c,e)===a.neg(a.ONE))throw new Error("Cannot find square root");let l=r,u=a.pow(a.mul(a.ONE,s),t),h=a.pow(c,i),d=a.pow(c,t);for(;!a.eql(d,a.ONE);){if(a.eql(d,a.ZERO))return a.ZERO;let f=1;for(let g=a.sqr(d);f<l&&!a.eql(g,a.ONE);f++)g=a.sqr(g);const p=a.pow(u,rn<<BigInt(l-f-1));u=a.sqr(p),h=a.mul(h,p),d=a.mul(d,u),l=f}return h}}function Aue(n){if(n%kC===bue){const e=(n+rn)/kC;return function(r,s){const i=r.pow(s,e);if(!r.eql(r.sqr(i),s))throw new Error("Cannot find square root");return i}}if(n%fR===dR){const e=(n-dR)/fR;return function(r,s){const i=r.mul(s,ml),o=r.pow(i,e),a=r.mul(s,o),c=r.mul(r.mul(a,ml),o),l=r.mul(a,r.sub(c,r.ONE));if(!r.eql(r.sqr(l),s))throw new Error("Cannot find square root");return l}}return vue(n)}const Cue=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function Iue(n){const e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},t=Cue.reduce((r,s)=>(r[s]="function",r),e);return Ey(n,t)}function _ue(n,e,t){if(t<Pn)throw new Error("Expected power > 0");if(t===Pn)return n.ONE;if(t===rn)return e;let r=n.ONE,s=e;for(;t>Pn;)t&rn&&(r=n.mul(r,s)),s=n.sqr(s),t>>=rn;return r}function Sue(n,e){const t=new Array(e.length),r=e.reduce((i,o,a)=>n.is0(o)?i:(t[a]=i,n.mul(i,o)),n.ONE),s=n.inv(r);return e.reduceRight((i,o,a)=>n.is0(o)?i:(t[a]=n.mul(i,t[a]),n.mul(i,o)),s),t}function wL(n,e){const t=e!==void 0?e:n.toString(2).length,r=Math.ceil(t/8);return{nBitLength:t,nByteLength:r}}function Tue(n,e,t=!1,r={}){if(n<=Pn)throw new Error(`Expected Field ORDER > 0, got ${n}`);const{nBitLength:s,nByteLength:i}=wL(n,e);if(i>2048)throw new Error("Field lengths over 2048 bytes are not supported");const o=Aue(n),a=Object.freeze({ORDER:n,BITS:s,BYTES:i,MASK:X_(s),ZERO:Pn,ONE:rn,create:c=>ns(c,n),isValid:c=>{if(typeof c!="bigint")throw new Error(`Invalid field element: expected bigint, got ${typeof c}`);return Pn<=c&&c<n},is0:c=>c===Pn,isOdd:c=>(c&rn)===rn,neg:c=>ns(-c,n),eql:(c,l)=>c===l,sqr:c=>ns(c*c,n),add:(c,l)=>ns(c+l,n),sub:(c,l)=>ns(c-l,n),mul:(c,l)=>ns(c*l,n),pow:(c,l)=>_ue(a,c,l),div:(c,l)=>ns(c*DC(l,n),n),sqrN:c=>c*c,addN:(c,l)=>c+l,subN:(c,l)=>c-l,mulN:(c,l)=>c*l,inv:c=>DC(c,n),sqrt:r.sqrt||(c=>o(a,c)),invertBatch:c=>Sue(a,c),cmov:(c,l,u)=>u?l:c,toBytes:c=>t?J_(c,i):pf(c,i),fromBytes:c=>{if(c.length!==i)throw new Error(`Fp.fromBytes: expected ${i}, got ${c.length}`);return t?Z_(c):lu(c)}});return Object.freeze(a)}function bL(n){if(typeof n!="bigint")throw new Error("field order must be bigint");const e=n.toString(2).length;return Math.ceil(e/8)}function EL(n){const e=bL(n);return e+Math.ceil(e/2)}function Nue(n,e,t=!1){const r=n.length,s=bL(e),i=EL(e);if(r<16||r<i||r>1024)throw new Error(`expected ${i}-1024 bytes of input, got ${r}`);const o=t?lu(n):Z_(n),a=ns(o,e-rn)+rn;return t?J_(a,s):pf(a,s)}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Oue=BigInt(0),S1=BigInt(1);function xue(n,e){const t=(s,i)=>{const o=i.negate();return s?o:i},r=s=>{const i=Math.ceil(e/s)+1,o=2**(s-1);return{windows:i,windowSize:o}};return{constTimeNegate:t,unsafeLadder(s,i){let o=n.ZERO,a=s;for(;i>Oue;)i&S1&&(o=o.add(a)),a=a.double(),i>>=S1;return o},precomputeWindow(s,i){const{windows:o,windowSize:a}=r(i),c=[];let l=s,u=l;for(let h=0;h<o;h++){u=l,c.push(u);for(let d=1;d<a;d++)u=u.add(l),c.push(u);l=u.double()}return c},wNAF(s,i,o){const{windows:a,windowSize:c}=r(s);let l=n.ZERO,u=n.BASE;const h=BigInt(2**s-1),d=2**s,f=BigInt(s);for(let p=0;p<a;p++){const g=p*c;let m=Number(o&h);o>>=f,m>c&&(m-=d,o+=S1);const w=g,v=g+Math.abs(m)-1,A=p%2!==0,T=m<0;m===0?u=u.add(t(A,i[w])):l=l.add(t(T,i[v]))}return{p:l,f:u}},wNAFCached(s,i,o,a){const c=s._WINDOW_SIZE||1;let l=i.get(s);return l||(l=this.precomputeWindow(s,c),c!==1&&i.set(s,a(l))),this.wNAF(c,l,o)}}}function vL(n){return Iue(n.Fp),Ey(n,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...wL(n.n,n.nBitLength),...n,p:n.Fp.ORDER})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function Rue(n){const e=vL(n);Ey(e,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});const{endo:t,Fp:r,a:s}=e;if(t){if(!r.eql(s,r.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if(typeof t!="object"||typeof t.beta!="bigint"||typeof t.splitScalar!="function")throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...e})}const{bytesToNumberBE:Pue,hexToBytes:kue}=wue,Nl={Err:class extends Error{constructor(e=""){super(e)}},_parseInt(n){const{Err:e}=Nl;if(n.length<2||n[0]!==2)throw new e("Invalid signature integer tag");const t=n[1],r=n.subarray(2,t+2);if(!t||r.length!==t)throw new e("Invalid signature integer: wrong length");if(r[0]&128)throw new e("Invalid signature integer: negative");if(r[0]===0&&!(r[1]&128))throw new e("Invalid signature integer: unnecessary leading zero");return{d:Pue(r),l:n.subarray(t+2)}},toSig(n){const{Err:e}=Nl,t=typeof n=="string"?kue(n):n;if(!(t instanceof Uint8Array))throw new Error("ui8a expected");let r=t.length;if(r<2||t[0]!=48)throw new e("Invalid signature tag");if(t[1]!==r-2)throw new e("Invalid signature: incorrect length");const{d:s,l:i}=Nl._parseInt(t.subarray(2)),{d:o,l:a}=Nl._parseInt(i);if(a.length)throw new e("Invalid signature: left bytes after parsing");return{r:s,s:o}},hexFromSig(n){const e=l=>Number.parseInt(l[0],16)&8?"00"+l:l,t=l=>{const u=l.toString(16);return u.length&1?`0${u}`:u},r=e(t(n.s)),s=e(t(n.r)),i=r.length/2,o=s.length/2,a=t(i),c=t(o);return`30${t(o+i+4)}02${c}${s}02${a}${r}`}},sa=BigInt(0),Ys=BigInt(1);BigInt(2);const pR=BigInt(3);BigInt(4);function Due(n){const e=Rue(n),{Fp:t}=e,r=e.toBytes||((p,g,m)=>{const w=g.toAffine();return am(Uint8Array.from([4]),t.toBytes(w.x),t.toBytes(w.y))}),s=e.fromBytes||(p=>{const g=p.subarray(1),m=t.fromBytes(g.subarray(0,t.BYTES)),w=t.fromBytes(g.subarray(t.BYTES,2*t.BYTES));return{x:m,y:w}});function i(p){const{a:g,b:m}=e,w=t.sqr(p),v=t.mul(w,p);return t.add(t.add(v,t.mul(p,g)),m)}if(!t.eql(t.sqr(e.Gy),i(e.Gx)))throw new Error("bad generator point: equation left != right");function o(p){return typeof p=="bigint"&&sa<p&&p<e.n}function a(p){if(!o(p))throw new Error("Expected valid bigint: 0 < bigint < curve.n")}function c(p){const{allowedPrivateKeyLengths:g,nByteLength:m,wrapPrivateKey:w,n:v}=e;if(g&&typeof p!="bigint"){if(p instanceof Uint8Array&&(p=df(p)),typeof p!="string"||!g.includes(p.length))throw new Error("Invalid key");p=p.padStart(m*2,"0")}let A;try{A=typeof p=="bigint"?p:lu(mi("private key",p,m))}catch{throw new Error(`private key must be ${m} bytes, hex or bigint, not ${typeof p}`)}return w&&(A=ns(A,v)),a(A),A}const l=new Map;function u(p){if(!(p instanceof h))throw new Error("ProjectivePoint expected")}class h{constructor(g,m,w){if(this.px=g,this.py=m,this.pz=w,g==null||!t.isValid(g))throw new Error("x required");if(m==null||!t.isValid(m))throw new Error("y required");if(w==null||!t.isValid(w))throw new Error("z required")}static fromAffine(g){const{x:m,y:w}=g||{};if(!g||!t.isValid(m)||!t.isValid(w))throw new Error("invalid affine point");if(g instanceof h)throw new Error("projective point not allowed");const v=A=>t.eql(A,t.ZERO);return v(m)&&v(w)?h.ZERO:new h(m,w,t.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(g){const m=t.invertBatch(g.map(w=>w.pz));return g.map((w,v)=>w.toAffine(m[v])).map(h.fromAffine)}static fromHex(g){const m=h.fromAffine(s(mi("pointHex",g)));return m.assertValidity(),m}static fromPrivateKey(g){return h.BASE.multiply(c(g))}_setWindowSize(g){this._WINDOW_SIZE=g,l.delete(this)}assertValidity(){if(this.is0()){if(e.allowInfinityPoint&&!t.is0(this.py))return;throw new Error("bad point: ZERO")}const{x:g,y:m}=this.toAffine();if(!t.isValid(g)||!t.isValid(m))throw new Error("bad point: x or y not FE");const w=t.sqr(m),v=i(g);if(!t.eql(w,v))throw new Error("bad point: equation left != right");if(!this.isTorsionFree())throw new Error("bad point: not in prime-order subgroup")}hasEvenY(){const{y:g}=this.toAffine();if(t.isOdd)return!t.isOdd(g);throw new Error("Field doesn't support isOdd")}equals(g){u(g);const{px:m,py:w,pz:v}=this,{px:A,py:T,pz:N}=g,R=t.eql(t.mul(m,N),t.mul(A,v)),M=t.eql(t.mul(w,N),t.mul(T,v));return R&&M}negate(){return new h(this.px,t.neg(this.py),this.pz)}double(){const{a:g,b:m}=e,w=t.mul(m,pR),{px:v,py:A,pz:T}=this;let N=t.ZERO,R=t.ZERO,M=t.ZERO,D=t.mul(v,v),S=t.mul(A,A),$=t.mul(T,T),P=t.mul(v,A);return P=t.add(P,P),M=t.mul(v,T),M=t.add(M,M),N=t.mul(g,M),R=t.mul(w,$),R=t.add(N,R),N=t.sub(S,R),R=t.add(S,R),R=t.mul(N,R),N=t.mul(P,N),M=t.mul(w,M),$=t.mul(g,$),P=t.sub(D,$),P=t.mul(g,P),P=t.add(P,M),M=t.add(D,D),D=t.add(M,D),D=t.add(D,$),D=t.mul(D,P),R=t.add(R,D),$=t.mul(A,T),$=t.add($,$),D=t.mul($,P),N=t.sub(N,D),M=t.mul($,S),M=t.add(M,M),M=t.add(M,M),new h(N,R,M)}add(g){u(g);const{px:m,py:w,pz:v}=this,{px:A,py:T,pz:N}=g;let R=t.ZERO,M=t.ZERO,D=t.ZERO;const S=e.a,$=t.mul(e.b,pR);let P=t.mul(m,A),L=t.mul(w,T),V=t.mul(v,N),G=t.add(m,w),E=t.add(A,T);G=t.mul(G,E),E=t.add(P,L),G=t.sub(G,E),E=t.add(m,v);let C=t.add(A,N);return E=t.mul(E,C),C=t.add(P,V),E=t.sub(E,C),C=t.add(w,v),R=t.add(T,N),C=t.mul(C,R),R=t.add(L,V),C=t.sub(C,R),D=t.mul(S,E),R=t.mul($,V),D=t.add(R,D),R=t.sub(L,D),D=t.add(L,D),M=t.mul(R,D),L=t.add(P,P),L=t.add(L,P),V=t.mul(S,V),E=t.mul($,E),L=t.add(L,V),V=t.sub(P,V),V=t.mul(S,V),E=t.add(E,V),P=t.mul(L,E),M=t.add(M,P),P=t.mul(C,E),R=t.mul(G,R),R=t.sub(R,P),P=t.mul(G,L),D=t.mul(C,D),D=t.add(D,P),new h(R,M,D)}subtract(g){return this.add(g.negate())}is0(){return this.equals(h.ZERO)}wNAF(g){return f.wNAFCached(this,l,g,m=>{const w=t.invertBatch(m.map(v=>v.pz));return m.map((v,A)=>v.toAffine(w[A])).map(h.fromAffine)})}multiplyUnsafe(g){const m=h.ZERO;if(g===sa)return m;if(a(g),g===Ys)return this;const{endo:w}=e;if(!w)return f.unsafeLadder(this,g);let{k1neg:v,k1:A,k2neg:T,k2:N}=w.splitScalar(g),R=m,M=m,D=this;for(;A>sa||N>sa;)A&Ys&&(R=R.add(D)),N&Ys&&(M=M.add(D)),D=D.double(),A>>=Ys,N>>=Ys;return v&&(R=R.negate()),T&&(M=M.negate()),M=new h(t.mul(M.px,w.beta),M.py,M.pz),R.add(M)}multiply(g){a(g);let m=g,w,v;const{endo:A}=e;if(A){const{k1neg:T,k1:N,k2neg:R,k2:M}=A.splitScalar(m);let{p:D,f:S}=this.wNAF(N),{p:$,f:P}=this.wNAF(M);D=f.constTimeNegate(T,D),$=f.constTimeNegate(R,$),$=new h(t.mul($.px,A.beta),$.py,$.pz),w=D.add($),v=S.add(P)}else{const{p:T,f:N}=this.wNAF(m);w=T,v=N}return h.normalizeZ([w,v])[0]}multiplyAndAddUnsafe(g,m,w){const v=h.BASE,A=(N,R)=>R===sa||R===Ys||!N.equals(v)?N.multiplyUnsafe(R):N.multiply(R),T=A(this,m).add(A(g,w));return T.is0()?void 0:T}toAffine(g){const{px:m,py:w,pz:v}=this,A=this.is0();g==null&&(g=A?t.ONE:t.inv(v));const T=t.mul(m,g),N=t.mul(w,g),R=t.mul(v,g);if(A)return{x:t.ZERO,y:t.ZERO};if(!t.eql(R,t.ONE))throw new Error("invZ was invalid");return{x:T,y:N}}isTorsionFree(){const{h:g,isTorsionFree:m}=e;if(g===Ys)return!0;if(m)return m(h,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:g,clearCofactor:m}=e;return g===Ys?this:m?m(h,this):this.multiplyUnsafe(e.h)}toRawBytes(g=!0){return this.assertValidity(),r(h,this,g)}toHex(g=!0){return df(this.toRawBytes(g))}}h.BASE=new h(e.Gx,e.Gy,t.ONE),h.ZERO=new h(t.ZERO,t.ONE,t.ZERO);const d=e.nBitLength,f=xue(h,e.endo?Math.ceil(d/2):d);return{CURVE:e,ProjectivePoint:h,normPrivateKeyToScalar:c,weierstrassEquation:i,isWithinCurveOrder:o}}function Uue(n){const e=vL(n);return Ey(e,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...e})}function $ue(n){const e=Uue(n),{Fp:t,n:r}=e,s=t.BYTES+1,i=2*t.BYTES+1;function o(E){return sa<E&&E<t.ORDER}function a(E){return ns(E,r)}function c(E){return DC(E,r)}const{ProjectivePoint:l,normPrivateKeyToScalar:u,weierstrassEquation:h,isWithinCurveOrder:d}=Due({...e,toBytes(E,C,O){const U=C.toAffine(),k=t.toBytes(U.x),j=am;return O?j(Uint8Array.from([C.hasEvenY()?2:3]),k):j(Uint8Array.from([4]),k,t.toBytes(U.y))},fromBytes(E){const C=E.length,O=E[0],U=E.subarray(1);if(C===s&&(O===2||O===3)){const k=lu(U);if(!o(k))throw new Error("Point is not on curve");const j=h(k);let q=t.sqrt(j);const X=(q&Ys)===Ys;return(O&1)===1!==X&&(q=t.neg(q)),{x:k,y:q}}else if(C===i&&O===4){const k=t.fromBytes(U.subarray(0,t.BYTES)),j=t.fromBytes(U.subarray(t.BYTES,2*t.BYTES));return{x:k,y:j}}else throw new Error(`Point of length ${C} was invalid. Expected ${s} compressed bytes or ${i} uncompressed bytes`)}}),f=E=>df(pf(E,e.nByteLength));function p(E){const C=r>>Ys;return E>C}function g(E){return p(E)?a(-E):E}const m=(E,C,O)=>lu(E.slice(C,O));class w{constructor(C,O,U){this.r=C,this.s=O,this.recovery=U,this.assertValidity()}static fromCompact(C){const O=e.nByteLength;return C=mi("compactSignature",C,O*2),new w(m(C,0,O),m(C,O,2*O))}static fromDER(C){const{r:O,s:U}=Nl.toSig(mi("DER",C));return new w(O,U)}assertValidity(){if(!d(this.r))throw new Error("r must be 0 < r < CURVE.n");if(!d(this.s))throw new Error("s must be 0 < s < CURVE.n")}addRecoveryBit(C){return new w(this.r,this.s,C)}recoverPublicKey(C){const{r:O,s:U,recovery:k}=this,j=M(mi("msgHash",C));if(k==null||![0,1,2,3].includes(k))throw new Error("recovery id invalid");const q=k===2||k===3?O+e.n:O;if(q>=t.ORDER)throw new Error("recovery id 2 or 3 invalid");const X=k&1?"03":"02",ce=l.fromHex(X+f(q)),te=c(q),de=a(-j*te),De=a(U*te),Qe=l.BASE.multiplyAndAddUnsafe(ce,de,De);if(!Qe)throw new Error("point at infinify");return Qe.assertValidity(),Qe}hasHighS(){return p(this.s)}normalizeS(){return this.hasHighS()?new w(this.r,a(-this.s),this.recovery):this}toDERRawBytes(){return ff(this.toDERHex())}toDERHex(){return Nl.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return ff(this.toCompactHex())}toCompactHex(){return f(this.r)+f(this.s)}}const v={isValidPrivateKey(E){try{return u(E),!0}catch{return!1}},normPrivateKeyToScalar:u,randomPrivateKey:()=>{const E=EL(e.n);return Nue(e.randomBytes(E),e.n)},precompute(E=8,C=l.BASE){return C._setWindowSize(E),C.multiply(BigInt(3)),C}};function A(E,C=!0){return l.fromPrivateKey(E).toRawBytes(C)}function T(E){const C=E instanceof Uint8Array,O=typeof E=="string",U=(C||O)&&E.length;return C?U===s||U===i:O?U===2*s||U===2*i:E instanceof l}function N(E,C,O=!0){if(T(E))throw new Error("first arg must be private key");if(!T(C))throw new Error("second arg must be public key");return l.fromHex(C).multiply(u(E)).toRawBytes(O)}const R=e.bits2int||function(E){const C=lu(E),O=E.length*8-e.nBitLength;return O>0?C>>BigInt(O):C},M=e.bits2int_modN||function(E){return a(R(E))},D=X_(e.nBitLength);function S(E){if(typeof E!="bigint")throw new Error("bigint expected");if(!(sa<=E&&E<D))throw new Error(`bigint expected < 2^${e.nBitLength}`);return pf(E,e.nByteLength)}function $(E,C,O=P){if(["recovered","canonical"].some(Me=>Me in O))throw new Error("sign() legacy options not supported");const{hash:U,randomBytes:k}=e;let{lowS:j,prehash:q,extraEntropy:X}=O;j==null&&(j=!0),E=mi("msgHash",E),q&&(E=mi("prehashed msgHash",U(E)));const ce=M(E),te=u(C),de=[S(te),S(ce)];if(X!=null){const Me=X===!0?k(t.BYTES):X;de.push(mi("extraEntropy",Me))}const De=am(...de),Qe=ce;function Je(Me){const Ot=R(Me);if(!d(Ot))return;const an=c(Ot),jr=l.BASE.multiply(Ot).toAffine(),Zn=a(jr.x);if(Zn===sa)return;const ds=a(an*a(Qe+Zn*te));if(ds===sa)return;let Ku=(jr.x===Zn?0:2)|Number(jr.y&Ys),jy=ds;return j&&p(ds)&&(jy=g(ds),Ku^=1),new w(Zn,jy,Ku)}return{seed:De,k2sig:Je}}const P={lowS:e.lowS,prehash:!1},L={lowS:e.lowS,prehash:!1};function V(E,C,O=P){const{seed:U,k2sig:k}=$(E,C,O),j=e;return yL(j.hash.outputLen,j.nByteLength,j.hmac)(U,k)}l.BASE._setWindowSize(8);function G(E,C,O,U=L){var jr;const k=E;if(C=mi("msgHash",C),O=mi("publicKey",O),"strict"in U)throw new Error("options.strict was renamed to lowS");const{lowS:j,prehash:q}=U;let X,ce;try{if(typeof k=="string"||k instanceof Uint8Array)try{X=w.fromDER(k)}catch(Zn){if(!(Zn instanceof Nl.Err))throw Zn;X=w.fromCompact(k)}else if(typeof k=="object"&&typeof k.r=="bigint"&&typeof k.s=="bigint"){const{r:Zn,s:ds}=k;X=new w(Zn,ds)}else throw new Error("PARSE");ce=l.fromHex(O)}catch(Zn){if(Zn.message==="PARSE")throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(j&&X.hasHighS())return!1;q&&(C=e.hash(C));const{r:te,s:de}=X,De=M(C),Qe=c(de),Je=a(De*Qe),Me=a(te*Qe),Ot=(jr=l.BASE.multiplyAndAddUnsafe(ce,Je,Me))==null?void 0:jr.toAffine();return Ot?a(Ot.x)===te:!1}return{CURVE:e,getPublicKey:A,getSharedSecret:N,sign:V,verify:G,ProjectivePoint:l,Signature:w,utils:v}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function Mue(n){return{hash:n,hmac:(e,...t)=>ZM(n,e,Ile(...t)),randomBytes:_le}}function Lue(n,e){const t=r=>$ue({...n,...Mue(r)});return Object.freeze({...t(e),create:t})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const AL=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),gR=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),Bue=BigInt(1),UC=BigInt(2),mR=(n,e)=>(n+e/UC)/e;function Fue(n){const e=AL,t=BigInt(3),r=BigInt(6),s=BigInt(11),i=BigInt(22),o=BigInt(23),a=BigInt(44),c=BigInt(88),l=n*n*n%e,u=l*l*n%e,h=Ls(u,t,e)*u%e,d=Ls(h,t,e)*u%e,f=Ls(d,UC,e)*l%e,p=Ls(f,s,e)*f%e,g=Ls(p,i,e)*p%e,m=Ls(g,a,e)*g%e,w=Ls(m,c,e)*m%e,v=Ls(w,a,e)*g%e,A=Ls(v,t,e)*u%e,T=Ls(A,o,e)*p%e,N=Ls(T,r,e)*l%e,R=Ls(N,UC,e);if(!$C.eql($C.sqr(R),n))throw new Error("Cannot find square root");return R}const $C=Tue(AL,void 0,void 0,{sqrt:Fue}),Ka=Lue({a:BigInt(0),b:BigInt(7),Fp:$C,n:gR,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:n=>{const e=gR,t=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),r=-Bue*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),s=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),i=t,o=BigInt("0x100000000000000000000000000000000"),a=mR(i*n,e),c=mR(-r*n,e);let l=ns(n-a*t-c*s,e),u=ns(-a*r-c*i,e);const h=l>o,d=u>o;if(h&&(l=e-l),d&&(u=e-u),l>o||u>o)throw new Error("splitScalar: Endomorphism failed, k="+n);return{k1neg:h,k1:l,k2neg:d,k2:u}}}},XM);BigInt(0);Ka.ProjectivePoint;const cm="0x0000000000000000000000000000000000000000",yR="0x0000000000000000000000000000000000000000000000000000000000000000",wR=BigInt(0),bR=BigInt(1),ER=BigInt(2),vR=BigInt(27),AR=BigInt(28),Ow=BigInt(35),vh={};function CR(n){return Au(xr(n),32)}var md,yd,wd,ql;const gi=class gi{constructor(e,t,r,s){F(this,md,void 0);F(this,yd,void 0);F(this,wd,void 0);F(this,ql,void 0);by(e,vh,"Signature"),_(this,md,t),_(this,yd,r),_(this,wd,s),_(this,ql,null)}get r(){return y(this,md)}set r(e){x(Xh(e)===32,"invalid r","value",e),_(this,md,Ee(e))}get s(){return y(this,yd)}set s(e){x(Xh(e)===32,"invalid s","value",e);const t=Ee(e);x(parseInt(t.substring(0,3))<8,"non-canonical s","value",t),_(this,yd,t)}get v(){return y(this,wd)}set v(e){const t=We(e,"value");x(t===27||t===28,"invalid v","v",e),_(this,wd,t)}get networkV(){return y(this,ql)}get legacyChainId(){const e=this.networkV;return e==null?null:gi.getChainId(e)}get yParity(){return this.v===27?0:1}get yParityAndS(){const e=ot(this.s);return this.yParity&&(e[0]|=128),Ee(e)}get compactSerialized(){return on([this.r,this.yParityAndS])}get serialized(){return on([this.r,this.s,this.yParity?"0x1c":"0x1b"])}[Symbol.for("nodejs.util.inspect.custom")](){return`Signature { r: "${this.r}", s: "${this.s}", yParity: ${this.yParity}, networkV: ${this.networkV} }`}clone(){const e=new gi(vh,this.r,this.s,this.v);return this.networkV&&_(e,ql,this.networkV),e}toJSON(){const e=this.networkV;return{_type:"signature",networkV:e!=null?e.toString():null,r:this.r,s:this.s,v:this.v}}static getChainId(e){const t=Ae(e,"v");return t==vR||t==AR?wR:(x(t>=Ow,"invalid EIP-155 v","v",e),(t-Ow)/ER)}static getChainIdV(e,t){return Ae(e)*ER+BigInt(35+t-27)}static getNormalizedV(e){const t=Ae(e);return t===wR||t===vR?27:t===bR||t===AR?28:(x(t>=Ow,"invalid v","v",e),t&bR?27:28)}static from(e){function t(l,u){x(l,u,"signature",e)}if(e==null)return new gi(vh,yR,yR,27);if(typeof e=="string"){const l=ot(e,"signature");if(l.length===64){const u=Ee(l.slice(0,32)),h=l.slice(32,64),d=h[0]&128?28:27;return h[0]&=127,new gi(vh,u,Ee(h),d)}if(l.length===65){const u=Ee(l.slice(0,32)),h=l.slice(32,64);t((h[0]&128)===0,"non-canonical s");const d=gi.getNormalizedV(l[64]);return new gi(vh,u,Ee(h),d)}t(!1,"invalid raw signature length")}if(e instanceof gi)return e.clone();const r=e.r;t(r!=null,"missing r");const s=CR(r),i=function(l,u){if(l!=null)return CR(l);if(u!=null){t(Ut(u,32),"invalid yParityAndS");const h=ot(u);return h[0]&=127,Ee(h)}t(!1,"missing s")}(e.s,e.yParityAndS);t((ot(i)[0]&128)==0,"non-canonical s");const{networkV:o,v:a}=function(l,u,h){if(l!=null){const d=Ae(l);return{networkV:d>=Ow?d:void 0,v:gi.getNormalizedV(d)}}if(u!=null)return t(Ut(u,32),"invalid yParityAndS"),{v:ot(u)[0]&128?28:27};if(h!=null){switch(We(h,"sig.yParity")){case 0:return{v:27};case 1:return{v:28}}t(!1,"invalid yParity")}t(!1,"missing v")}(e.v,e.yParityAndS,e.yParity),c=new gi(vh,s,i,a);return o&&_(c,ql,o),t(e.yParity==null||We(e.yParity,"sig.yParity")===c.yParity,"yParity mismatch"),t(e.yParityAndS==null||e.yParityAndS===c.yParityAndS,"yParityAndS mismatch"),c}};md=new WeakMap,yd=new WeakMap,wd=new WeakMap,ql=new WeakMap;let Di=gi;var Yo;const wl=class wl{constructor(e){F(this,Yo,void 0);x(Xh(e)===32,"invalid private key","privateKey","[REDACTED]"),_(this,Yo,Ee(e))}get privateKey(){return y(this,Yo)}get publicKey(){return wl.computePublicKey(y(this,Yo))}get compressedPublicKey(){return wl.computePublicKey(y(this,Yo),!0)}sign(e){x(Xh(e)===32,"invalid digest length","digest",e);const t=Ka.sign(Nr(e),Nr(y(this,Yo)),{lowS:!0});return Di.from({r:Fc(t.r,32),s:Fc(t.s,32),v:t.recovery?28:27})}computeSharedSecret(e){const t=wl.computePublicKey(e);return Ee(Ka.getSharedSecret(Nr(y(this,Yo)),ot(t),!1))}static computePublicKey(e,t){let r=ot(e,"key");if(r.length===32){const i=Ka.getPublicKey(r,!!t);return Ee(i)}if(r.length===64){const i=new Uint8Array(65);i[0]=4,i.set(r,1),r=i}const s=Ka.ProjectivePoint.fromHex(r);return Ee(s.toRawBytes(t))}static recoverPublicKey(e,t){x(Xh(e)===32,"invalid digest length","digest",e);const r=Di.from(t);let s=Ka.Signature.fromCompact(Nr(on([r.r,r.s])));s=s.addRecoveryBit(r.yParity);const i=s.recoverPublicKey(Nr(e));return x(i!=null,"invalid signautre for digest","signature",t),"0x"+i.toHex(!1)}static addPoints(e,t,r){const s=Ka.ProjectivePoint.fromHex(wl.computePublicKey(e).substring(2)),i=Ka.ProjectivePoint.fromHex(wl.computePublicKey(t).substring(2));return"0x"+s.add(i).toHex(!!r)}};Yo=new WeakMap;let lm=wl;const jue=BigInt(0),Hue=BigInt(36);function IR(n){n=n.toLowerCase();const e=n.substring(2).split(""),t=new Uint8Array(40);for(let s=0;s<40;s++)t[s]=e[s].charCodeAt(0);const r=ot(pn(t));for(let s=0;s<40;s+=2)r[s>>1]>>4>=8&&(e[s]=e[s].toUpperCase()),(r[s>>1]&15)>=8&&(e[s+1]=e[s+1].toUpperCase());return"0x"+e.join("")}const eS={};for(let n=0;n<10;n++)eS[String(n)]=String(n);for(let n=0;n<26;n++)eS[String.fromCharCode(65+n)]=String(10+n);const _R=15;function Vue(n){n=n.toUpperCase(),n=n.substring(4)+n.substring(0,2)+"00";let e=n.split("").map(r=>eS[r]).join("");for(;e.length>=_R;){let r=e.substring(0,_R);e=parseInt(r,10)%97+e.substring(r.length)}let t=String(98-parseInt(e,10)%97);for(;t.length<2;)t="0"+t;return t}const que=function(){const n={};for(let e=0;e<36;e++){const t="0123456789abcdefghijklmnopqrstuvwxyz"[e];n[t]=BigInt(e)}return n}();function zue(n){n=n.toLowerCase();let e=jue;for(let t=0;t<n.length;t++)e=e*Hue+que[n[t]];return e}function Tt(n){if(x(typeof n=="string","invalid address","address",n),n.match(/^(0x)?[0-9a-fA-F]{40}$/)){n.startsWith("0x")||(n="0x"+n);const e=IR(n);return x(!n.match(/([A-F].*[a-f])|([a-f].*[A-F])/)||e===n,"bad address checksum","address",n),e}if(n.match(/^XE[0-9]{2}[0-9A-Za-z]{30,31}$/)){x(n.substring(2,4)===Vue(n),"bad icap checksum","address",n);let e=zue(n.substring(4)).toString(16);for(;e.length<40;)e="0"+e;return IR("0x"+e)}x(!1,"invalid address","address",n)}function Wue(n){const e=Tt(n.from);let r=Ae(n.nonce,"tx.nonce").toString(16);return r==="0"?r="0x":r.length%2?r="0x0"+r:r="0x"+r,Tt(Zt(pn(Cu([e,r])),12))}function CL(n){return n&&typeof n.getAddress=="function"}async function T1(n,e){const t=await e;return(t==null||t==="0x0000000000000000000000000000000000000000")&&(K(typeof n!="string","unconfigured name","UNCONFIGURED_NAME",{value:n}),x(!1,"invalid AddressLike value; did not resolve to a value address","target",n)),Tt(t)}function Pr(n,e){if(typeof n=="string")return n.match(/^0x[0-9a-f]{40}$/i)?Tt(n):(K(e!=null,"ENS resolution requires a provider","UNSUPPORTED_OPERATION",{operation:"resolveName"}),T1(n,e.resolveName(n)));if(CL(n))return T1(n,n.getAddress());if(n&&typeof n.then=="function")return T1(n,n);x(!1,"unsupported addressable value","target",n)}const Fo={};function be(n,e){let t=!1;return e<0&&(t=!0,e*=-1),new gr(Fo,`${t?"":"u"}int${e}`,n,{signed:t,width:e})}function pt(n,e){return new gr(Fo,`bytes${e||""}`,n,{size:e})}const SR=Symbol.for("_ethers_typed");var zl;const jo=class jo{constructor(e,t,r,s){B(this,"type");B(this,"value");F(this,zl,void 0);B(this,"_typedSymbol");s==null&&(s=null),by(Fo,e,"Typed"),Re(this,{_typedSymbol:SR,type:t,value:r}),_(this,zl,s),this.format()}format(){if(this.type==="array")throw new Error("");if(this.type==="dynamicArray")throw new Error("");return this.type==="tuple"?`tuple(${this.value.map(e=>e.format()).join(",")})`:this.type}defaultValue(){return 0}minValue(){return 0}maxValue(){return 0}isBigInt(){return!!this.type.match(/^u?int[0-9]+$/)}isData(){return this.type.startsWith("bytes")}isString(){return this.type==="string"}get tupleName(){if(this.type!=="tuple")throw TypeError("not a tuple");return y(this,zl)}get arrayLength(){if(this.type!=="array")throw TypeError("not an array");return y(this,zl)===!0?-1:y(this,zl)===!1?this.value.length:null}static from(e,t){return new jo(Fo,e,t)}static uint8(e){return be(e,8)}static uint16(e){return be(e,16)}static uint24(e){return be(e,24)}static uint32(e){return be(e,32)}static uint40(e){return be(e,40)}static uint48(e){return be(e,48)}static uint56(e){return be(e,56)}static uint64(e){return be(e,64)}static uint72(e){return be(e,72)}static uint80(e){return be(e,80)}static uint88(e){return be(e,88)}static uint96(e){return be(e,96)}static uint104(e){return be(e,104)}static uint112(e){return be(e,112)}static uint120(e){return be(e,120)}static uint128(e){return be(e,128)}static uint136(e){return be(e,136)}static uint144(e){return be(e,144)}static uint152(e){return be(e,152)}static uint160(e){return be(e,160)}static uint168(e){return be(e,168)}static uint176(e){return be(e,176)}static uint184(e){return be(e,184)}static uint192(e){return be(e,192)}static uint200(e){return be(e,200)}static uint208(e){return be(e,208)}static uint216(e){return be(e,216)}static uint224(e){return be(e,224)}static uint232(e){return be(e,232)}static uint240(e){return be(e,240)}static uint248(e){return be(e,248)}static uint256(e){return be(e,256)}static uint(e){return be(e,256)}static int8(e){return be(e,-8)}static int16(e){return be(e,-16)}static int24(e){return be(e,-24)}static int32(e){return be(e,-32)}static int40(e){return be(e,-40)}static int48(e){return be(e,-48)}static int56(e){return be(e,-56)}static int64(e){return be(e,-64)}static int72(e){return be(e,-72)}static int80(e){return be(e,-80)}static int88(e){return be(e,-88)}static int96(e){return be(e,-96)}static int104(e){return be(e,-104)}static int112(e){return be(e,-112)}static int120(e){return be(e,-120)}static int128(e){return be(e,-128)}static int136(e){return be(e,-136)}static int144(e){return be(e,-144)}static int152(e){return be(e,-152)}static int160(e){return be(e,-160)}static int168(e){return be(e,-168)}static int176(e){return be(e,-176)}static int184(e){return be(e,-184)}static int192(e){return be(e,-192)}static int200(e){return be(e,-200)}static int208(e){return be(e,-208)}static int216(e){return be(e,-216)}static int224(e){return be(e,-224)}static int232(e){return be(e,-232)}static int240(e){return be(e,-240)}static int248(e){return be(e,-248)}static int256(e){return be(e,-256)}static int(e){return be(e,-256)}static bytes1(e){return pt(e,1)}static bytes2(e){return pt(e,2)}static bytes3(e){return pt(e,3)}static bytes4(e){return pt(e,4)}static bytes5(e){return pt(e,5)}static bytes6(e){return pt(e,6)}static bytes7(e){return pt(e,7)}static bytes8(e){return pt(e,8)}static bytes9(e){return pt(e,9)}static bytes10(e){return pt(e,10)}static bytes11(e){return pt(e,11)}static bytes12(e){return pt(e,12)}static bytes13(e){return pt(e,13)}static bytes14(e){return pt(e,14)}static bytes15(e){return pt(e,15)}static bytes16(e){return pt(e,16)}static bytes17(e){return pt(e,17)}static bytes18(e){return pt(e,18)}static bytes19(e){return pt(e,19)}static bytes20(e){return pt(e,20)}static bytes21(e){return pt(e,21)}static bytes22(e){return pt(e,22)}static bytes23(e){return pt(e,23)}static bytes24(e){return pt(e,24)}static bytes25(e){return pt(e,25)}static bytes26(e){return pt(e,26)}static bytes27(e){return pt(e,27)}static bytes28(e){return pt(e,28)}static bytes29(e){return pt(e,29)}static bytes30(e){return pt(e,30)}static bytes31(e){return pt(e,31)}static bytes32(e){return pt(e,32)}static address(e){return new jo(Fo,"address",e)}static bool(e){return new jo(Fo,"bool",!!e)}static bytes(e){return new jo(Fo,"bytes",e)}static string(e){return new jo(Fo,"string",e)}static array(e,t){throw new Error("not implemented yet")}static tuple(e,t){throw new Error("not implemented yet")}static overrides(e){return new jo(Fo,"overrides",Object.assign({},e))}static isTyped(e){return e&&typeof e=="object"&&"_typedSymbol"in e&&e._typedSymbol===SR}static dereference(e,t){if(jo.isTyped(e)){if(e.type!==t)throw new Error(`invalid type: expecetd ${t}, got ${e.type}`);return e.value}return e}};zl=new WeakMap;let gr=jo;class Gue extends Sa{constructor(e){super("address","address",e,!1)}defaultValue(){return"0x0000000000000000000000000000000000000000"}encode(e,t){let r=gr.dereference(t,"string");try{r=Tt(r)}catch(s){return this._throwError(s.message,t)}return e.writeValue(r)}decode(e){return Tt(Fc(e.readValue(),20))}}class Kue extends Sa{constructor(t){super(t.name,t.type,"_",t.dynamic);B(this,"coder");this.coder=t}defaultValue(){return this.coder.defaultValue()}encode(t,r){return this.coder.encode(t,r)}decode(t){return this.coder.decode(t)}}function IL(n,e,t){let r=[];if(Array.isArray(t))r=t;else if(t&&typeof t=="object"){let c={};r=e.map(l=>{const u=l.localName;return K(u,"cannot encode object for signature with missing names","INVALID_ARGUMENT",{argument:"values",info:{coder:l},value:t}),K(!c[u],"cannot encode object for signature with duplicate names","INVALID_ARGUMENT",{argument:"values",info:{coder:l},value:t}),c[u]=!0,t[u]})}else x(!1,"invalid tuple value","tuple",t);x(e.length===r.length,"types/value length mismatch","tuple",t);let s=new OC,i=new OC,o=[];e.forEach((c,l)=>{let u=r[l];if(c.dynamic){let h=i.length;c.encode(i,u);let d=s.writeUpdatableValue();o.push(f=>{d(f+h)})}else c.encode(s,u)}),o.forEach(c=>{c(s.length)});let a=n.appendWriter(s);return a+=n.appendWriter(i),a}function _L(n,e){let t=[],r=[],s=n.subReader(0);return e.forEach(i=>{let o=null;if(i.dynamic){let a=n.readIndex(),c=s.subReader(a);try{o=i.decode(c)}catch(l){if(pr(l,"BUFFER_OVERRUN"))throw l;o=l,o.baseType=i.name,o.name=i.localName,o.type=i.type}}else try{o=i.decode(n)}catch(a){if(pr(a,"BUFFER_OVERRUN"))throw a;o=a,o.baseType=i.name,o.name=i.localName,o.type=i.type}if(o==null)throw new Error("investigate");t.push(o),r.push(i.localName||null)}),rb.fromItems(t,r)}class Yue extends Sa{constructor(t,r,s){const i=t.type+"["+(r>=0?r:"")+"]",o=r===-1||t.dynamic;super("array",i,s,o);B(this,"coder");B(this,"length");Re(this,{coder:t,length:r})}defaultValue(){const t=this.coder.defaultValue(),r=[];for(let s=0;s<this.length;s++)r.push(t);return r}encode(t,r){const s=gr.dereference(r,"array");Array.isArray(s)||this._throwError("expected array value",s);let i=this.length;i===-1&&(i=s.length,t.writeValue(s.length)),PM(s.length,i,"coder array"+(this.localName?" "+this.localName:""));let o=[];for(let a=0;a<s.length;a++)o.push(this.coder);return IL(t,o,s)}decode(t){let r=this.length;r===-1&&(r=t.readIndex(),K(r*Rr<=t.dataLength,"insufficient data length","BUFFER_OVERRUN",{buffer:t.bytes,offset:r*Rr,length:t.dataLength}));let s=[];for(let i=0;i<r;i++)s.push(new Kue(this.coder));return _L(t,s)}}class Que extends Sa{constructor(e){super("bool","bool",e,!1)}defaultValue(){return!1}encode(e,t){const r=gr.dereference(t,"bool");return e.writeValue(r?1:0)}decode(e){return!!e.readValue()}}class SL extends Sa{constructor(e,t){super(e,e,t,!0)}defaultValue(){return"0x"}encode(e,t){t=Nr(t);let r=e.writeValue(t.length);return r+=e.writeBytes(t),r}decode(e){return e.readBytes(e.readIndex(),!0)}}class Zue extends SL{constructor(e){super("bytes",e)}decode(e){return Ee(super.decode(e))}}class Jue extends Sa{constructor(t,r){let s="bytes"+String(t);super(s,s,r,!1);B(this,"size");Re(this,{size:t},{size:"number"})}defaultValue(){return"0x0000000000000000000000000000000000000000000000000000000000000000".substring(0,2+this.size*2)}encode(t,r){let s=Nr(gr.dereference(r,this.type));return s.length!==this.size&&this._throwError("incorrect data length",r),t.writeBytes(s)}decode(t){return Ee(t.readBytes(this.size))}}const Xue=new Uint8Array([]);class ehe extends Sa{constructor(e){super("null","",e,!1)}defaultValue(){return null}encode(e,t){return t!=null&&this._throwError("not null",t),e.writeBytes(Xue)}decode(e){return e.readBytes(0),null}}const the=BigInt(0),nhe=BigInt(1),rhe=BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");class she extends Sa{constructor(t,r,s){const i=(r?"int":"uint")+t*8;super(i,i,s,!1);B(this,"size");B(this,"signed");Re(this,{size:t,signed:r},{size:"number",signed:"boolean"})}defaultValue(){return 0}encode(t,r){let s=Ae(gr.dereference(r,this.type)),i=Tl(rhe,Rr*8);if(this.signed){let o=Tl(i,this.size*8-1);(s>o||s<-(o+nhe))&&this._throwError("value out-of-bounds",r),s=UM(s,8*Rr)}else(s<the||s>Tl(i,this.size*8))&&this._throwError("value out-of-bounds",r);return t.writeValue(s)}decode(t){let r=Tl(t.readValue(),this.size*8);return this.signed&&(r=eb(r,this.size*8)),r}}class ihe extends SL{constructor(e){super("string",e)}defaultValue(){return""}encode(e,t){return super.encode(e,Eo(gr.dereference(t,"string")))}decode(e){return tb(super.decode(e))}}class xw extends Sa{constructor(t,r){let s=!1;const i=[];t.forEach(a=>{a.dynamic&&(s=!0),i.push(a.type)});const o="tuple("+i.join(",")+")";super("tuple",o,r,s);B(this,"coders");Re(this,{coders:Object.freeze(t.slice())})}defaultValue(){const t=[];this.coders.forEach(s=>{t.push(s.defaultValue())});const r=this.coders.reduce((s,i)=>{const o=i.localName;return o&&(s[o]||(s[o]=0),s[o]++),s},{});return this.coders.forEach((s,i)=>{let o=s.localName;!o||r[o]!==1||(o==="length"&&(o="_length"),t[o]==null&&(t[o]=t[i]))}),Object.freeze(t)}encode(t,r){const s=gr.dereference(r,"tuple");return IL(t,this.coders,s)}decode(t){return _L(t,this.coders)}}function Iu(n){return pn(Eo(n))}var ohe="AEEUdwmgDS8BxQKKAP4BOgDjATAAngDUAIMAoABoAOAAagCOAEQAhABMAHIAOwA9ACsANgAmAGIAHgAuACgAJwAXAC0AGgAjAB8ALwAUACkAEgAeAAkAGwARABkAFgA5ACgALQArADcAFQApABAAHgAiABAAGgAeABMAGAUhBe8BFxREN8sF2wC5AK5HAW8ArQkDzQCuhzc3NzcBP68NEfMABQdHBuw5BV8FYAA9MzkI9r4ZBg7QyQAWA9CeOwLNCjcCjqkChuA/lm+RAsXTAoP6ASfnEQDytQFJAjWVCkeXAOsA6godAB/cwdAUE0WlBCN/AQUCQRjFD/MRBjHxDQSJbw0jBzUAswBxme+tnIcAYwabAysG8QAjAEMMmxcDqgPKQyDXCMMxA7kUQwD3NXOrAKmFIAAfBC0D3x4BJQDBGdUFAhEgVD8JnwmQJiNWYUzrg0oAGwAUAB0AFnNcACkAFgBP9h3gPfsDOWDKneY2ChglX1UDYD30ABsAFAAdABZzIGRAnwDD8wAjAEEMzRbDqgMB2sAFYwXqAtCnAsS4AwpUJKRtFHsadUz9AMMVbwLpABM1NJEX0ZkCgYMBEyMAxRVvAukAEzUBUFAtmUwSAy4DBTER33EftQHfSwB5MxJ/AjkWKQLzL8E/cwBB6QH9LQDPDtO9ASNriQC5DQANAwCK21EFI91zHwCoL9kBqQcHBwcHKzUDowBvAQohPvU3fAQgHwCyAc8CKQMA5zMSezr7ULgFmDp/LzVQBgEGAi8FYQVgt8AFcTtlQhpCWEmfe5tmZ6IAExsDzQ8t+X8rBKtTAltbAn0jsy8Bl6utPWMDTR8Ei2kRANkDBrNHNysDBzECQWUAcwFpJ3kAiyUhAJ0BUb8AL3EfAbfNAz81KUsFWwF3YQZtAm0A+VEfAzEJDQBRSQCzAQBlAHsAM70GD/v3IZWHBwARKQAxALsjTwHZAeMPEzmXgIHwABIAGQA8AEUAQDt3gdvIEGcQZAkGTRFMdEIVEwK0D64L7REdDNkq09PgADSxB/MDWwfzA1sDWwfzB/MDWwfzA1sDWwNbA1scEvAi28gQZw9QBHUFlgWTBN4IiyZREYkHMAjaVBV0JhxPA00BBCMtSSQ7mzMTJUpMFE0LCAQ2SmyvfUADTzGzVP2QqgPTMlc5dAkGHnkSqAAyD3skNb1OhnpPcagKU0+2tYdJak5vAsY6sEAACikJm2/Dd1YGRRAfJ6kQ+ww3AbkBPw3xS9wE9QY/BM0fgRkdD9GVoAipLeEM8SbnLqWAXiP5KocF8Uv4POELUVFsD10LaQnnOmeBUgMlAREijwrhDT0IcRD3Cs1vDekRSQc9A9lJngCpBwULFR05FbkmFGKwCw05ewb/GvoLkyazEy17AAXXGiUGUQEtGwMA0y7rhbRaNVwgT2MGBwspI8sUrFAkDSlAu3hMGh8HGSWtApVDdEqLUToelyH6PEENai4XUYAH+TwJGVMLhTyiRq9FEhHWPpE9TCJNTDAEOYMsMyePCdMPiQy9fHYBXQklCbUMdRM1ERs3yQg9Bx0xlygnGQglRplgngT7owP3E9UDDwVDCUUHFwO5HDETMhUtBRGBKNsC9zbZLrcCk1aEARsFzw8pH+MQVEfkDu0InwJpA4cl7wAxFSUAGyKfCEdnAGOP3FMJLs8Iy2pwI3gDaxTrZRF3B5UOWwerHDcVwxzlcMxeD4YMKKezCV8BeQmdAWME5wgNNV+MpCBFZ1eLXBifIGVBQ14AAjUMaRWjRMGHfAKPD28SHwE5AXcHPQ0FAnsR8RFvEJkI74YINbkz/DopBFMhhyAVCisDU2zSCysm/Qz8bQGnEmYDEDRBd/Jnr2C6KBgBBx0yyUFkIfULlk/RDKAaxRhGVDIZ6AfDA/ca9yfuQVsGAwOnBxc6UTPyBMELbQiPCUMATQ6nGwfbGG4KdYzUATWPAbudA1uVhwJzkwY7Bw8Aaw+LBX3pACECqwinAAkA0wNbAD0CsQehAB0AiUUBQQMrMwEl6QKTA5cINc8BmTMB9y0EH8cMGQD7O25OAsO1AoBuZqYF4VwCkgJNOQFRKQQJUktVA7N15QDfAE8GF+NLARmvTs8e50cB43MvAMsA/wAJOQcJRQHRAfdxALsBYws1Caa3uQFR7S0AhwAZbwHbAo0A4QA5AIP1AVcAUQVd/QXXAlNNARU1HC9bZQG/AyMBNwERAH0Gz5GpzQsjBHEH1wIQHxXlAu8yB7kFAyLjE9FCyQK94lkAMhoKPAqrCqpgX2Q3CjV2PVQAEh+sPss/UgVVO1c7XDtXO1w7VztcO1c7XDtXO1wDm8Pmw+YKcF9JYe8Mqg3YRMw6TRPfYFVgNhPMLbsUxRXSJVoZQRrAJwkl6FUNDwgt12Y0CDA0eRfAAEMpbINFY4oeNApPHOtTlVT8LR8AtUumM7MNsBsZREQFS3XxYi4WEgomAmSFAmJGX1GzAV83JAKh+wJonAJmDQKfiDgfDwJmPwJmKgRyBIMDfxcDfpY5Cjl7GzmGOicnAmwhAjI6OA4CbcsCbbLzjgM3a0kvAWsA4gDlAE4JB5wMkQECD8YAEbkCdzMCdqZDAnlPRwJ4viFg30WyRvcCfEMCeswCfQ0CfPRIBEiBZygALxlJXEpfGRtK0ALRBQLQ0EsrA4hTA4fqRMmRNgLypV0HAwOyS9JMMSkH001QTbMCi0MCitzFHwshR2sJuwKOOwKOYESbhQKO3QKOYHxRuFM5AQ5S2FSJApP/ApMQAO0AIFUiVbNV1AosHymZijLleGpFPz0Cl6MC77ZYJawAXSkClpMCloCgAK1ZsFoNhVEAPwKWuQKWUlxIXNUCmc8CmWhczl0LHQKcnznGOqECnBoCn58CnryOACETNS4TAp31Ap6WALlBYThh8wKe1wKgcgGtAp6jIwKeUqljzGQrKS8CJ7MCJoICoP8CoFDbAqYzAqXSAqgDAIECp/ZogGi1AAdNaiBq1QKs5wKssgKtawKtBgJXIQJV4AKx5dsDH1JsmwKywRECsuwbbORtZ21MYwMl0QK2YD9DbpQDKUkCuGICuUsZArkue3A6cOUCvR0DLbYDMhUCvoxyBgMzdQK+HnMmc1MCw88CwwhzhnRPOUl05AM8qwEDPJ4DPcMCxYACxksCxhSNAshtVQLISALJUwLJMgJkoQLd1nh9ZXiyeSlL1AMYp2cGAmH4GfeVKHsPXpZevxUCz28Cz3AzT1fW9xejAMqxAs93AS3uA04Wfk8JAtwrAtuOAtJTA1JgA1NjAQUDVZCAjUMEzxrxZEl5A4LSg5EC2ssC2eKEFIRNp0ADhqkAMwNkEoZ1Xf0AWQLfaQLevHd7AuIz7RgB8zQrAfSfAfLWiwLr9wLpdH0DAur9AuroAP1LAb0C7o0C66CWrpcHAu5DA4XkmH1w5HGlAvMHAG0DjhqZlwL3FwORcgOSiwL3nAL53QL4apogmq+/O5siA52HAv7+AR8APZ8gAZ+3AwWRA6ZuA6bdANXJAwZuoYyiCQ0DDE0BEwEjB3EGZb1rCQC/BG/DFY8etxEAG3k9ACcDNxJRA42DAWcrJQCM8wAlAOanC6OVCLsGI6fJBgCvBRnDBvElRUYFFoAFcD9GSDNCKUK8X3kZX8QAls0FOgCQVCGbwTsuYDoZutcONxjOGJHJ/gVfBWAFXwVgBWsFYAVfBWAFXwVgBV8FYAVfBWBOHQjfjW8KCgoKbF7xMwTRA7kGN8PDAMMEr8MA70gxFroFTj5xPnhCR0K+X30/X/AAWBkzswCNBsxzzASm70aCRS4rDDMeLz49fnXfcsH5GcoscQFz13Y4HwVnBXLJycnACNdRYwgICAqEXoWTxgA7P4kACxbZBu21Kw0AjMsTAwkVAOVtJUUsJ1JCuULESUArXy9gPi9AKwnJRQYKTD9LPoA+iT54PnkCkULEUUpDX9NWV3JVEjQAc1w3A3IBE3YnX+g7QiMJb6MKaiszRCUuQrNCxDPMCcwEX9EWJzYREBEEBwIHKn6l33JCNVIfybPJtAltydPUCmhBZw/tEKsZAJOVJU1CLRuxbUHOQAo7P0s+eEJHHA8SJVRPdGM0NVrpvBoKhfUlM0JHHGUQUhEWO1xLSj8MO0ucNAqJIzVCRxv9EFsqKyA4OQgNj2nwZgp5ZNFgE2A1K3YHS2AhQQojJmC7DgpzGG1WYFUZCQYHZO9gHWCdYIVgu2BTYJlwFh8GvRbcXbG8YgtDHrMBwzPVyQonHQgkCyYBgQJ0Ajc4nVqIAwGSCsBPIgDsK3SWEtIVBa5N8gGjAo+kVwVIZwD/AEUSCDweX4ITrRQsJ8K3TwBXFDwEAB0TvzVcAtoTS20RIwDgVgZ9BBImYgA5AL4Coi8LFnezOkCnIQFjAY4KBAPh9RcGsgZSBsEAJctdsWIRu2kTkQstRw7DAcMBKgpPBGIGMDAwKCYnKTQaLg4AKRSVAFwCdl+YUZ0JdicFD3lPAdt1F9ZZKCGxuE3yBxkFVGcA/wBFEgiCBwAOLHQSjxOtQDg1z7deFRMAZ8QTAGtKb1ApIiPHADkAvgKiLy1DFtYCmBiDAlDDWNB0eo7fpaMO/aEVRRv0ATEQZBIODyMEAc8JQhCbDRgzFD4TAEMAu9YBCgCsAOkAm5I3ABwAYxvONnR+MhXJAxgKQyxL2+kkJhMbhQKDBMkSsvF0AD9BNQ6uQC7WqSQHwxEAEEIu1hkhAH2z4iQPwyJPHNWpdyYBRSpnJALzoBAEVPPsH20MxA0CCEQKRgAFyAtFAlMNwwjEDUQJRArELtapMg7DDZgJIw+TGukEIwvDFkMAqAtDEMMMBhioe+QAO3MMRAACrgnEBSPY9Q0FDnbSBoMAB8MSYxkSxAEJAPIJAAB8FWMOFtMc/HcXwxhDAC7DAvOowwAewwJdKDKHAAHDAALrFUQVwwAbwyvzpWMWv8wA/ABpAy++bcYDUKPD0KhDCwKmJ1MAAmMA5+UZwxAagwipBRL/eADfw6fDGOMCGsOjk3l6BwOpo4sAEsMOGxMAA5sAbcMOAAvDp0MJGkMDwgipnNIPAwfIqUMGAOGDAAPzABXDAAcDAAnDAGmTABrDAA7DChjDjnEWAwABYwAOcwAuUyYABsMAF8MIKQANUgC6wy4AA8MADqMq8wCyYgAcIwAB8wqpAAXOCx0V4wAHowBCwwEKAGnDAAuDAB3DAAjDCakABdIAbqcZ3QCZCCkABdIAAAFDAAfjAB2jCCkABqIACYMAGzMAbSMA5sOIAAhjAAhDABTDBAkpAAbSAOOTAAlDC6kOzPtnAAdDAG6kQFAATwAKwwwAA0MACbUDPwAHIwAZgwACE6cDAAojAApDAAoDp/MGwwAJIwADEwAQQwgAFEMAEXMAD5MADfMADcMAGRMOFiMAFUMAbqMWuwHDAMIAE0MLAGkzEgDhUwACQwAEWgAXgwUjAAbYABjDBSYBgzBaAEFNALcQBxUMegAwMngBrA0IZgJ0KxQHBREPd1N0ZzKRJwaIHAZqNT4DqQq8BwngAB4DAwt2AX56T1ocKQNXAh1GATQGC3tOxYNagkgAMQA5CQADAQEAWxLjAIOYNAEzAH7tFRk6TglSAF8NAAlYAQ+S1ACAQwQorQBiAN4dAJ1wPyeTANVzuQDX3AIeEMp9eyMgXiUAEdkBkJizKltbVVAaRMqRAAEAhyQ/SDEz6BmfVwB6ATEsOClKIRcDOF0E/832AFNt5AByAnkCRxGCOs94NjXdAwINGBonDBwPALW2AwICAgAAAAAAAAYDBQMDARrUAwAtAAAAAgEGBgYGBgYFBQUFBQUEBQYHCAkEBQUFBQQAAAICAAAAIgCNAJAAlT0A6gC7ANwApEQAwgCyAK0AqADuAKYA2gCjAOcBCAEDAMcAgQBiANIA1AEDAN4A8gCQAKkBMQDqAN8A3AsBCQ8yO9ra2tq8xuLT1tRJOB0BUgFcNU0BWgFpAWgBWwFMUUlLbhMBUxsNEAs6PhMOACcUKy0vMj5AQENDQ0RFFEYGJFdXV1dZWVhZL1pbXVxcI2NnZ2ZoZypsbnZ1eHh4eHh4enp6enp6enp6enp8fH18e2IARPIASQCaAHgAMgBm+ACOAFcAVwA3AnbvAIsABfj4AGQAk/IAnwBPAGIAZP//sACFAIUAaQBWALEAJAC2AIMCQAJDAPwA5wD+AP4A6AD/AOkA6QDoAOYALwJ7AVEBQAE+AVQBPgE+AT4BOQE4ATgBOAEcAVgXADEQCAEAUx8SHgsdHhYAjgCWAKYAUQBqIAIxAHYAbwCXAxUDJzIDIUlGTzEAkQJPAMcCVwKkAMAClgKWApYClgKWApYCiwKWApYClgKWApYClgKVApUCmAKgApcClgKWApQClAKUApQCkgKVAnUB1AKXAp8ClgKWApUeAIETBQD+DQOfAmECOh8BVBg9AuIZEjMbAU4/G1WZAXusRAFpYQEFA0FPAQYAmTEeIJdyADFoAHEANgCRA5zMk/C2jGINwjMWygIZCaXdfDILBCs5dAE7YnQBugDlhoiHhoiGiYqKhouOjIaNkI6Ij4qQipGGkoaThpSSlYaWhpeKmIaZhpqGm4aci52QnoqfhuIC4XTpAt90AIp0LHSoAIsAdHQEQwRABEIERQRDBEkERgRBBEcESQRIBEQERgRJAJ5udACrA490ALxuAQ10ANFZdHQA13QCFHQA/mJ0AP4BIQD+APwA/AD9APwDhGZ03ASMK23HAP4A/AD8AP0A/CR0dACRYnQA/gCRASEA/gCRAvQA/gCRA4RmdNwEjCttxyR0AP9idAEhAP4A/gD8APwA/QD8AP8A/AD8AP0A/AOEZnTcBIwrbcckdHQAkWJ0ASEA/gCRAP4AkQL0AP4AkQOEZnTcBIwrbcckdAJLAT50AlIBQXQCU8l0dAJfdHQDpgL0A6YDpgOnA6cDpwOnA4RmdNwEjCttxyR0dACRYnQBIQOmAJEDpgCRAvQDpgCRA4RmdNwEjCttxyR0BDh0AJEEOQCRDpU5dSgCADR03gV2CwArdAEFAM5iCnR0AF1iAAYcOgp0dACRCnQAXAEIwWZ0CnRmdHQAkWZ0CnRmdEXgAFF03gp0dEY0tlT2u3SOAQTwscwhjZZKrhYcBSfFp9XNbKiVDOD2b+cpe4/Z17mQnbtzzhaeQtE2GGj0IDNTjRUSyTxxw/RPHW/+vS7d1NfRt9z9QPZg4X7QFfhCnkvgNPIItOsC2eV6hPannZNHlZ9xrwZXIMOlu3jSoQSq78WEjwLjw1ELSlF1aBvfzwk5ZX7AUvQzjPQKbDuQ+sm4wNOp4A6AdVuRS0t1y/DZpg4R6m7FNjM9HgvW7Bi88zaMjOo6lM8wtBBdj8LP4ylv3zCXPhebMKJc066o9sF71oFW/8JXu86HJbwDID5lzw5GWLR/LhT0Qqnp2JQxNZNfcbLIzPy+YypqRm/lBmGmex+82+PisxUumSeJkALIT6rJezxMH+CTJmQtt5uwTVbL3ptmjDUQzlSIvWi8Tl7ng1NpuRn1Ng4n14Qc+3Iil7OwkvNWogLSPkn3pihIFytyIGmMhOe3n1tWsuMy9BdKyqF4Z3v2SgggTL9KVvMXPnCbRe+oOuFFP3HejBG/w9gvmfNYvg6JuWia2lcSSN1uIjBktzoIazOHPJZ7kKHPz8mRWVdW3lA8WGF9dQF6Bm673boov3BUWDU2JNcahR23GtfHKLOz/viZ+rYnZFaIznXO67CYEJ1fXuTRpZhYZkKe54xeoagkNGLs+NTZHE0rX45/XvQ2RGADX6vcAvdxIUBV27wxGm2zjZo4X3ILgAlrOFheuZ6wtsvaIj4yLY7qqawlliaIcrz2G+c3vscAnCkCuMzMmZvMfu9lLwTvfX+3cVSyPdN9ZwgDZhfjRgNJcLiJ67b9xx8JHswprbiE3v9UphotAPIgnXVIN5KmMc0piXhc6cChPnN+MRhG9adtdttQTTwSIpl8I4/j//d3sz1326qTBTpPRM/Hgh3kzqEXs8ZAk4ErQhNO8hzrQ0DLkWMA/N+91tn2MdOJnWC2FCZehkQrwzwbKOjhvZsbM95QoeL9skYyMf4srVPVJSgg7pOLUtr/n9eT99oe9nLtFRpjA9okV2Kj8h9k5HaC0oivRD8VyXkJ81tcd4fHNXPCfloIQasxsuO18/46dR2jgul/UIet2G0kRvnyONMKhHs6J26FEoqSqd+rfYjeEGwHWVDpX1fh1jBBcKGMqRepju9Y00mDVHC+Xdij/j44rKfvfjGinNs1jO/0F3jB83XCDINN/HB84axlP+3E/klktRo+vl3U/aiyMJbIodE1XSsDn6UAzIoMtUObY2+k/4gY/l+AkZJ5Sj2vQrkyLm3FoxjhDX+31UXBFf9XrAH31fFqoBmDEZvhvvpnZ87N+oZEu7U9O/nnk+QWj3x8uyoRbEnf+O5UMr9i0nHP38IF5AvzrBW8YWBUR0mIAzIvndQq9N3v/Jto3aPjPXUPl8ASdPPyAp7jENf8bk7VMM9ol9XGmlBmeDMuGqt+WzuL6CXAxXjIhCPM5vACchgMJ/8XBGLO/D1isVvGhwwHHr1DLaI5mn2Jr/b1pUD90uciDaS8cXNDzCWvNmT/PhQe5e8nTnnnkt8Ds/SIjibcum/fqDhKopxAY8AkSrPn+IGDEKOO+U3XOP6djFs2H5N9+orhOahiQk5KnEUWa+CzkVzhp8bMHRbg81qhjjXuIKbHjSLSIBKWqockGtKinY+z4/RdBUF6pcc3JmnlxVcNgrI4SEzKUZSwcD2QCyxzKve+gAmg6ZuSRkpPFa6mfThu7LJNu3H5K42uCpNvPAsoedolKV/LHe/eJ+BbaG5MG0NaSGVPRUmNFMFFSSpXEcXwbVh7UETOZZtoVNRGOIbbkig3McEtR68cG0RZAoJevWYo7Dg/lZ1CQzblWeUvVHmr8fY4Nqd9JJiH/zEX24mJviH60fAyFr0A3c4bC1j3yZU60VgJxXn8JgJXLUIsiBnmKmMYz+7yBQFBvqb2eYnuW59joZBf56/wXvWIR4R8wTmV80i1mZy+S4+BUES+hzjk0uXpC///z/IlqHZ1monzlXp8aCfhGKMti73FI1KbL1q6IKO4fuBuZ59gagjn5xU79muMpHXg6S+e+gDM/U9BKLHbl9l6o8czQKl4RUkJJiqftQG2i3BMg/TQlUYFkJDYBOOvAugYuzYSDnZbDDd/aSd9x0Oe6F+bJcHfl9+gp6L5/TgA+BdFFovbfCrQ40s5vMPw8866pNX8zyFGeFWdxIpPVp9Rg1UPOVFbFZrvaFq/YAzHQgqMWpahMYfqHpmwXfHL1/kpYmGuHFwT55mQu0dylfNuq2Oq0hTMCPwqfxnuBIPLXfci4Y1ANy+1CUipQxld/izVh16WyG2Q0CQQ9NqtAnx1HCHwDj7sYxOSB0wopZSnOzxQOcExmxrVTF2BkOthVpGfuhaGECfCJpJKpjnihY+xOT2QJxN61+9K6QSqtv2Shr82I3jgJrqBg0wELFZPjvHpvzTtaJnLK6Vb97Yn933koO/saN7fsjwNKzp4l2lJVx2orjCGzC/4ZL4zCver6aQYtC5sdoychuFE6ufOiog+VWi5UDkbmvmtah/3aArEBIi39s5ILUnlFLgilcGuz9CQshEY7fw2ouoILAYPVT/gyAIq3TFAIwVsl+ktkRz/qGfnCDGrm5gsl/l9QdvCWGsjPz3dU7XuqKfdUrr/6XIgjp4rey6AJBmCmUJMjITHVdFb5m1p+dLMCL8t55zD42cmftmLEJC0Da04YiRCVUBLLa8D071/N5UBNBXDh0LFsmhV/5B5ExOB4j3WVG/S3lfK5o+V6ELHvy6RR9n4ac+VsK4VE4yphPvV+kG9FegTBH4ZRXL2HytUHCduJazB/KykjfetYxOXTLws267aGOd+I+JhKP//+VnXmS90OD/jvLcVu0asyqcuYN1mSb6XTlCkqv1vigZPIYwNF/zpWcT1GR/6aEIRjkh0yhg4LXJfaGobYJTY4JI58KiAKgmmgAKWdl5nYCeLqavRJGQNuYuZtZFGx+IkI4w4NS2xwbetNMunOjBu/hmKCI/w7tfiiyUd//4rbTeWt4izBY8YvGIN6vyKYmP/8X8wHKCeN+WRcKM70+tXKNGyevU9H2Dg5BsljnTf8YbsJ1TmMs74Ce2XlHisleguhyeg44rQOHZuw/6HTkhnnurK2d62q6yS7210SsAIaR+jXMQA+svkrLpsUY+F30Uw89uOdGAR6vo4FIME0EfVVeHTu6eKicfhSqOeXJhbftcd08sWEnNUL1C9fnprTgd83IMut8onVUF0hvqzZfHduPjbjwEXIcoYmy+P6tcJZHmeOv6VrvEdkHDJecjHuHeWANe79VG662qTjA/HCvumVv3qL+LrOcpqGps2ZGwQdFJ7PU4iuyRlBrwfO+xnPyr47s2cXVbWzAyznDiBGjCM3ksxjjqM62GE9C8f5U38kB3VjtabKp/nRdvMESPGDG90bWRLAt1Qk5DyLuazRR1YzdC1c+hZXvAWV8xA72S4A8B67vjVhbba3MMop293FeEXpe7zItMWrJG/LOH9ByOXmYnNJfjmfuX9KbrpgLOba4nZ+fl8Gbdv/ihv+6wFGKHCYrVwmhFC0J3V2bn2tIB1wCc1CST3d3X2OyxhguXcs4sm679UngzofuSeBewMFJboIQHbUh/m2JhW2hG9DIvG2t7yZIzKBTz9wBtnNC+2pCRYhSIuQ1j8xsz5VvqnyUIthvuoyyu7fNIrg/KQUVmGQaqkqZk/Vx5b33/gsEs8yX7SC1J+NV4icz6bvIE7C5G6McBaI8rVg56q5QBJWxn/87Q1sPK4+sQa8fLU5gXo4paaq4cOcQ4wR0VBHPGjKh+UlPCbA1nLXyEUX45qZ8J7/Ln4FPJE2TdzD0Z8MLSNQiykMMmSyOCiFfy84Rq60emYB2vD09KjYwsoIpeDcBDTElBbXxND72yhd9pC/1CMid/5HUMvAL27OtcIJDzNKpRPNqPOpyt2aPGz9QWIs9hQ9LiX5s8m9hjTUu/f7MyIatjjd+tSfQ3ufZxPpmJhTaBtZtKLUcfOCUqADuO+QoH8B9v6U+P0HV1GLQmtoNFTb3s74ivZgjES0qfK+8RdGgBbcCMSy8eBvh98+et1KIFqSe1KQPyXULBMTsIYnysIwiZBJYdI20vseV+wuJkcqGemehKjaAb9L57xZm3g2zX0bZ2xk/fU+bCo7TlnbW7JuF1YdURo/2Gw7VclDG1W7LOtas2LX4upifZ/23rzpsnY/ALfRgrcWP5hYmV9VxVOQA1fZvp9F2UNU+7d7xRyVm5wiLp3/0dlV7vdw1PMiZrbDAYzIVqEjRY2YU03sJhPnlwIPcZUG5ltL6S8XCxU1eYS5cjr34veBmXAvy7yN4ZjArIG0dfD/5UpBNlX1ZPoxJOwyqRi3wQWtOzd4oNKh0LkoTm8cwqgIfKhqqGOhwo71I+zXnMemTv2B2AUzABWyFztGgGULjDDzWYwJUVBTjKCn5K2QGMK1CQT7SzziOjo+BhAmqBjzuc3xYym2eedGeOIRJVyTwDw37iCMe4g5Vbnsb5ZBdxOAnMT7HU4DHpxWGuQ7GeiY30Cpbvzss55+5Km1YsbD5ea3NI9QNYIXol5apgSu9dZ8f8xS5dtHpido5BclDuLWY4lhik0tbJa07yJhH0BOyEut/GRbYTS6RfiTYWGMCkNpfSHi7HvdiTglEVHKZXaVhezH4kkXiIvKopYAlPusftpE4a5IZwvw1x/eLvoDIh/zpo9FiQInsTb2SAkKHV42XYBjpJDg4374XiVb3ws4qM0s9eSQ5HzsMU4OZJKuopFjBM+dAZEl8RUMx5uU2N486Kr141tVsGQfGjORYMCJAMsxELeNT4RmWjRcpdTGBwcx6XN9drWqPmJzcrGrH4+DRc7+n1w3kPZwu0BkNr6hQrqgo7JTB9A5kdJ/H7P4cWBMwsmuixAzJB3yrQpnGIq90lxAXLzDCdn1LPibsRt7rHNjgQBklRgPZ8vTbjXdgXrTWQsK5MdrXXQVPp0Rinq3frzZKJ0qD6Qhc40VzAraUXlob1gvkhK3vpmHgI6FRlQZNx6eRqkp0zy4AQlX813fAPtL3jMRaitGFFjo0zmErloC+h+YYdVQ6k4F/epxAoF0BmqEoKNTt6j4vQZNQ2BoqF9Vj53TOIoNmDiu9Xp15RkIgQIGcoLpfoIbenzpGUAtqFJp5W+LLnx38jHeECTJ/navKY1NWfN0sY1T8/pB8kIH3DU3DX+u6W3YwpypBMYOhbSxGjq84RZ84fWJow8pyHqn4S/9J15EcCMsXqrfwyd9mhiu3+rEo9pPpoJkdZqHjra4NvzFwuThNKy6hao/SlLw3ZADUcUp3w3SRVfW2rhl80zOgTYnKE0Hs2qp1J6H3xqPqIkvUDRMFDYyRbsFI3M9MEyovPk8rlw7/0a81cDVLmBsR2ze2pBuKb23fbeZC0uXoIvDppfTwIDxk1Oq2dGesGc+oJXWJLGkOha3CX+DUnzgAp9HGH9RsPZN63Hn4RMA5eSVhPHO+9RcRb/IOgtW31V1Q5IPGtoxPjC+MEJbVlIMYADd9aHYWUIQKopuPOHmoqSkubnAKnzgKHqgIOfW5RdAgotN6BN+O2ZYHkuemLnvQ8U9THVrS1RtLmKbcC7PeeDsYznvqzeg6VCNwmr0Yyx1wnLjyT84BZz3EJyCptD3yeueAyDWIs0L2qs/VQ3HUyqfrja0V1LdDzqAikeWuV4sc7RLIB69jEIBjCkyZedoUHqCrOvShVzyd73OdrJW0hPOuQv2qOoHDc9xVb6Yu6uq3Xqp2ZaH46A7lzevbxQEmfrzvAYSJuZ4WDk1Hz3QX1LVdiUK0EvlAGAYlG3Md30r7dcPN63yqBCIj25prpvZP0nI4+EgWoFG95V596CurXpKRBGRjQlHCvy5Ib/iW8nZJWwrET3mgd6mEhfP4KCuaLjopWs7h+MdXFdIv8dHQJgg1xi1eYqB0uDYjxwVmri0Sv5XKut/onqapC+FQiC2C1lvYJ9MVco6yDYsS3AANUfMtvtbYI2hfwZatiSsnoUeMZd34GVjkMMKA+XnjJpXgRW2SHTZplVowPmJsvXy6w3cfO1AK2dvtZEKTkC/TY9LFiKHCG0DnrMQdGm2lzlBHM9iEYynH2UcVMhUEjsc0oDBTgo2ZSQ1gzkAHeWeBXYFjYLuuf8yzTCy7/RFR81WDjXMbq2BOH5dURnxo6oivmxL3cKzKInlZkD31nvpHB9Kk7GfcfE1t+1V64b9LtgeJGlpRFxQCAqWJ5DoY77ski8gsOEOr2uywZaoO/NGa0X0y1pNQHBi3b2SUGNpcZxDT7rLbBf1FSnQ8guxGW3W+36BW0gBje4DOz6Ba6SVk0xiKgt+q2JOFyr4SYfnu+Ic1QZYIuwHBrgzr6UvOcSCzPTOo7D6IC4ISeS7zkl4h+2VoeHpnG/uWR3+ysNgPcOIXQbv0n4mr3BwQcdKJxgPSeyuP/z1Jjg4e9nUvoXegqQVIE30EHx5GHv+FAVUNTowYDJgyFhf5IvlYmEqRif6+WN1MkEJmDcQITx9FX23a4mxy1AQRsOHO/+eImX9l8EMJI3oPWzVXxSOeHU1dUWYr2uAA7AMb+vAEZSbU3qob9ibCyXeypEMpZ6863o6QPqlqGHZkuWABSTVNd4cOh9hv3qEpSx2Zy/DJMP6cItEmiBJ5PFqQnDEIt3NrA3COlOSgz43D7gpNFNJ5MBh4oFzhDPiglC2ypsNU4ISywY2erkyb1NC3Qh/IfWj0eDgZI4/ln8WPfBsT3meTjq1Uqt1E7Zl/qftqkx6aM9KueMCekSnMrcHj1CqTWWzEzPsZGcDe3Ue4Ws+XFYVxNbOFF8ezkvQGR6ZOtOLU2lQEnMBStx47vE6Pb7AYMBRj2OOfZXfisjJnpTfSNjo6sZ6qSvNxZNmDeS7Gk3yYyCk1HtKN2UnhMIjOXUzAqDv90lx9O/q/AT1ZMnit5XQe9wmQxnE/WSH0CqZ9/2Hy+Sfmpeg8RwsHI5Z8kC8H293m/LHVVM/BA7HaTJYg5Enk7M/xWpq0192ACfBai2LA/qrCjCr6Dh1BIMzMXINBmX96MJ5Hn2nxln/RXPFhwHxUmSV0EV2V0jm86/dxxuYSU1W7sVkEbN9EzkG0QFwPhyHKyb3t+Fj5WoUUTErcazE/N6EW6Lvp0d//SDPj7EV9UdJN+Amnf3Wwk3A0SlJ9Z00yvXZ7n3z70G47Hfsow8Wq1JXcfwnA+Yxa5mFsgV464KKP4T31wqIgzFPd3eCe3j5ory5fBF2hgCFyVFrLzI9eetNXvM7oQqyFgDo4CTp/hDV9NMX9JDHQ/nyHTLvZLNLF6ftn2OxjGm8+PqOwhxnPHWipkE/8wbtyri80Sr7pMNkQGMfo4ZYK9OcCC4ESVFFbLMIvlxSoRqWie0wxqnLfcLSXMSpMMQEJYDVObYsXIQNv4TGNwjq1kvT1UOkicTrG3IaBZ3XdScS3u8sgeZPVpOLkbiF940FjbCeNRINNvDbd01EPBrTCPpm12m43ze1bBB59Ia6Ovhnur/Nvx3IxwSWol+3H2qfCJR8df6aQf4v6WiONxkK+IqT4pKQrZK/LplgDI/PJZbOep8dtbV7oCr6CgfpWa8NczOkPx81iSHbsNhVSJBOtrLIMrL31LK9TqHqAbAHe0RLmmV806kRLDLNEhUEJfm9u0sxpkL93Zgd6rw+tqBfTMi59xqXHLXSHwSbSBl0EK0+loECOPtrl+/nsaFe197di4yUgoe4jKoAJDXc6DGDjrQOoFDWZJ9HXwt8xDrQP+7aRwWKWI1GF8s8O4KzxWBBcwnl3vnl1Oez3oh6Ea1vjR7/z7DDTrFtqU2W/KAEzAuXDNZ7MY73MF216dzdSbWmUp4lcm7keJfWaMHgut9x5C9mj66Z0lJ+yhsjVvyiWrfk1lzPOTdhG15Y7gQlXtacvI7qv/XNSscDwqkgwHT/gUsD5yB7LdRRvJxQGYINn9hTpodKFVSTPrtGvyQw+HlRFXIkodErAGu9Iy1YpfSPc3jkFh5CX3lPxv7aqjE/JAfTIpEjGb/H7MO0e2vsViSW1qa/Lmi4/n4DEI3g7lYrcanspDfEpKkdV1OjSLOy0BCUqVoECaB55vs06rXl4jqmLsPsFM/7vYJ0vrBhDCm/00A/H81l1uekJ/6Lml3Hb9+NKiLqATJmDpyzfYZFHumEjC662L0Bwkxi7E9U4cQA0XMVDuMYAIeLMPgQaMVOd8fmt5SflFIfuBoszeAw7ow5gXPE2Y/yBc/7jExARUf/BxIHQBF5Sn3i61w4z5xJdCyO1F1X3+3ax+JSvMeZ7S6QSKp1Fp/sjYz6Z+VgCZzibGeEoujryfMulH7Rai5kAft9ebcW50DyJr2uo2z97mTWIu45YsSnNSMrrNUuG1XsYBtD9TDYzQffKB87vWbkM4EbPAFgoBV4GQS+vtFDUqOFAoi1nTtmIOvg38N4hT2Sn8r8clmBCXspBlMBYTnrqFJGBT3wZOzAyJDre9dHH7+x7qaaKDOB4UQALD5ecS0DE4obubQEiuJZ0EpBVpLuYcce8Aa4PYd/V4DLDAJBYKQPCWTcrEaZ5HYbJi11Gd6hjGom1ii18VHYnG28NKpkz2UKVPxlhYSp8uZr367iOmoy7zsxehW9wzcy2zG0a80PBMCRQMb32hnaHeOR8fnNDzZhaNYhkOdDsBUZ3loDMa1YP0uS0cjUP3b/6DBlqmZOeNABDsLl5BI5QJups8uxAuWJdkUB/pO6Zax6tsg7fN5mjjDgMGngO+DPcKqiHIDbFIGudxtPTIyDi9SFMKBDcfdGQRv41q1AqmxgkVfJMnP8w/Bc7N9/TR6C7mGObFqFkIEom8sKi2xYqJLTCHK7cxzaZvqODo22c3wisBCP4HeAgcRbNPAsBkNRhSmD48dHupdBRw4mIvtS5oeF6zeT1KMCyhMnmhpkFAGWnGscoNkwvQ8ZM5lE/vgTHFYL99OuNxdFBxTEDd5v2qLR8y9WkXsWgG6kZNndFG+pO/UAkOCipqIhL3hq7cRSdrCq7YhUsTocEcnaFa6nVkhnSeRYUA1YO0z5itF9Sly3VlxYDw239TJJH6f3EUfYO5lb7bcFcz8Bp7Oo8QmnsUHOz/fagVUBtKEw1iT88j+aKkv8cscKNkMxjYr8344D1kFoZ7/td1W6LCNYN594301tUGRmFjAzeRg5vyoM1F6+bJZ/Q54jN/k8SFd3DxPTYaAUsivsBfgTn7Mx8H2SpPt4GOdYRnEJOH6jHM2p6SgB0gzIRq6fHxGMmSmqaPCmlfwxiuloaVIitLGN8wie2CDWhkzLoCJcODh7KIOAqbHEvXdUxaS4TTTs07Clzj/6GmVs9kiZDerMxEnhUB6QQPlcfqkG9882RqHoLiHGBoHfQuXIsAG8GTAtao2KVwRnvvam8jo1e312GQAKWEa4sUVEAMG4G6ckcONDwRcg1e2D3+ohXgY4UAWF8wHKQMrSnzCgfFpsxh+aHXMGtPQroQasRY4U6UdG0rz1Vjbka0MekOGRZQEvqQFlxseFor8zWFgHek3v29+WqN6gaK5gZOTOMZzpQIC1201LkMCXild3vWXSc5UX9xcFYfbRPzGFa1FDcPfPB/jUEq/FeGt419CI3YmBlVoHsa4KdcwQP5ZSwHHhFJ7/Ph/Rap/4vmG91eDwPP0lDfCDRCLszTqfzM71xpmiKi2HwS4WlqvGNwtvwF5Dqpn6KTq8ax00UMPkxDcZrEEEsIvHiUXXEphdb4GB4FymlPwBz4Gperqq5pW7TQ6/yNRhW8VT5NhuP0udlxo4gILq5ZxAZk8ZGh3g4CqxJlPKY7AQxupfUcVpWT5VItp1+30UqoyP4wWsRo3olRRgkWZZ2ZN6VC3OZFeXB8NbnUrSdikNptD1QiGuKkr8EmSR/AK9Rw+FF3s5uwuPbvHGiPeFOViltMK7AUaOsq9+x9cndk3iJEE5LKZRlWJbKOZweROzmPNVPkjE3K/TyA57Rs68TkZ3MR8akKpm7cFjnjPd/DdkWjgYoKHSr5Wu5ssoBYU4acRs5g2DHxUmdq8VXOXRbunD8QN0LhgkssgahcdoYsNvuXGUK/KXD/7oFb+VGdhqIn02veuM5bLudJOc2Ky0GMaG4W/xWBxIJcL7yliJOXOpx0AkBqUgzlDczmLT4iILXDxxtRR1oZa2JWFgiAb43obrJnG/TZC2KSK2wqOzRZTXavZZFMb1f3bXvVaNaK828w9TO610gk8JNf3gMfETzXXsbcvRGCG9JWQZ6+cDPqc4466Yo2RcKH+PILeKOqtnlbInR3MmBeGG3FH10yzkybuqEC2HSQwpA0An7d9+73BkDUTm30bZmoP/RGbgFN+GrCOfADgqr0WbI1a1okpFms8iHYw9hm0zUvlEMivBRxModrbJJ+9/p3jUdQQ9BCtQdxnOGrT5dzRUmw0593/mbRSdBg0nRvRZM5/E16m7ZHmDEtWhwvfdZCZ8J8M12W0yRMszXamWfQTwIZ4ayYktrnscQuWr8idp3PjT2eF/jmtdhIfcpMnb+IfZY2FebW6UY/AK3jP4u3Tu4zE4qlnQgLFbM19EBIsNf7KhjdbqQ/D6yiDb+NlEi2SKD+ivXVUK8ib0oBo366gXkR8ZxGjpJIDcEgZPa9TcYe0TIbiPl/rPUQDu3XBJ9X/GNq3FAUsKsll57DzaGMrjcT+gctp+9MLYXCq+sqP81eVQ0r9lt+gcQfZbACRbEjvlMskztZG8gbC8Qn9tt26Q7y7nDrbZq/LEz7kR6Jc6pg3N9rVX8Y5MJrGlML9p9lU4jbTkKqCveeZUJjHB03m2KRKR2TytoFkTXOLg7keU1s1lrPMQJpoOKLuAAC+y1HlJucU6ysB5hsXhvSPPLq5J7JtnqHKZ4vYjC4Vy8153QY+6780xDuGARsGbOs1WqzH0QS765rnSKEbbKlkO8oI/VDwUd0is13tKpqILu1mDJFNy/iJAWcvDgjxvusIT+PGz3ST/J9r9Mtfd0jpaGeiLYIqXc7DiHSS8TcjFVksi66PEkxW1z6ujbLLUGNNYnzOWpH8BZGK4bCK7iR+MbIv8ncDAz1u4StN3vTTzewr9IQjk9wxFxn+6N1ddKs0vffJiS08N3a4G1SVrlZ97Q/M+8G9fe5AP6d9/Qq4WRnORVhofPIKEdCr3llspUfE0oKIIYoByBRPh+bX1HLS3JWGJRhIvE1aW4NTd8ePi4Z+kXb+Z8snYfSNcqijhAgVsx4RCM54cXUiYkjeBmmC4ajOHrChoELscJJC7+9jjMjw5BagZKlgRMiSNYz7h7vvZIoQqbtQmspc0cUk1G/73iXtSpROl5wtLgQi0mW2Ex8i3WULhcggx6E1LMVHUsdc9GHI1PH3U2Ko0PyGdn9KdVOLm7FPBui0i9a0HpA60MsewVE4z8CAt5d401Gv6zXlIT5Ybit1VIA0FCs7wtvYreru1fUyW3oLAZ/+aTnZrOcYRNVA8spoRtlRoWflsRClFcgzkqiHOrf0/SVw+EpVaFlJ0g4Kxq1MMOmiQdpMNpte8lMMQqm6cIFXlnGbfJllysKDi+0JJMotkqgIxOSQgU9dn/lWkeVf8nUm3iwX2Nl3WDw9i6AUK3vBAbZZrcJpDQ/N64AVwjT07Jef30GSSmtNu2WlW7YoyW2FlWfZFQUwk867EdLYKk9VG6JgEnBiBxkY7LMo4YLQJJlAo9l/oTvJkSARDF/XtyAzM8O2t3eT/iXa6wDN3WewNmQHdPfsxChU/KtLG2Mn8i4ZqKdSlIaBZadxJmRzVS/o4yA65RTSViq60oa395Lqw0pzY4SipwE0SXXsKV+GZraGSkr/RW08wPRvqvSUkYBMA9lPx4m24az+IHmCbXA+0faxTRE9wuGeO06DIXa6QlKJ3puIyiuAVfPr736vzo2pBirS+Vxel3TMm3JKhz9o2ZoRvaFVpIkykb0Hcm4oHFBMcNSNj7/4GJt43ogonY2Vg4nsDQIWxAcorpXACzgBqQPjYsE/VUpXpwNManEru4NwMCFPkXvMoqvoeLN3qyu/N1eWEHttMD65v19l/0kH2mR35iv/FI+yjoHJ9gPMz67af3Mq/BoWXqu3rphiWMXVkmnPSEkpGpUI2h1MThideGFEOK6YZHPwYzMBvpNC7+ZHxPb7epfefGyIB4JzO9DTNEYnDLVVHdQyvOEVefrk6Uv5kTQYVYWWdqrdcIl7yljwwIWdfQ/y+2QB3eR/qxYObuYyB4gTbo2in4PzarU1sO9nETkmj9/AoxDA+JM3GMqQtJR4jtduHtnoCLxd1gQUscHRB/MoRYIEsP2pDZ9KvHgtlk1iTbWWbHhohwFEYX7y51fUV2nuUmnoUcqnWIQAAgl9LTVX+Bc0QGNEhChxHR4YjfE51PUdGfsSFE6ck7BL3/hTf9jLq4G1IafINxOLKeAtO7quulYvH5YOBc+zX7CrMgWnW47/jfRsWnJjYYoE7xMfWV2HN2iyIqLI";const TR=new Map([[8217,"apostrophe"],[8260,"fraction slash"],[12539,"middle dot"]]),NR=4;function ahe(n){let e=0;function t(){return n[e++]<<8|n[e++]}let r=t(),s=1,i=[0,1];for(let N=1;N<r;N++)i.push(s+=t());let o=t(),a=e;e+=o;let c=0,l=0;function u(){return c==0&&(l=l<<8|n[e++],c=8),l>>--c&1}const h=31,d=2**h,f=d>>>1,p=f>>1,g=d-1;let m=0;for(let N=0;N<h;N++)m=m<<1|u();let w=[],v=0,A=d;for(;;){let N=Math.floor(((m-v+1)*s-1)/A),R=0,M=r;for(;M-R>1;){let $=R+M>>>1;N<i[$]?M=$:R=$}if(R==0)break;w.push(R);let D=v+Math.floor(A*i[R]/s),S=v+Math.floor(A*i[R+1]/s)-1;for(;!((D^S)&f);)m=m<<1&g|u(),D=D<<1&g,S=S<<1&g|1;for(;D&~S&p;)m=m&f|m<<1&g>>>1|u(),D=D<<1^f,S=(S^f)<<1|f|1;v=D,A=1+S-D}let T=r-4;return w.map(N=>{switch(N-T){case 3:return T+65792+(n[a++]<<16|n[a++]<<8|n[a++]);case 2:return T+256+(n[a++]<<8|n[a++]);case 1:return T+n[a++];default:return N-1}})}function che(n){let e=0;return()=>n[e++]}function TL(n){return che(ahe(lhe(n)))}function lhe(n){let e=[];[..."ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"].forEach((s,i)=>e[s.charCodeAt(0)]=i);let t=n.length,r=new Uint8Array(6*t>>3);for(let s=0,i=0,o=0,a=0;s<t;s++)a=a<<6|e[n.charCodeAt(s)],o+=6,o>=8&&(r[i++]=a>>(o-=8));return r}function uhe(n){return n&1?~n>>1:n>>1}function hhe(n,e){let t=Array(n);for(let r=0,s=0;r<n;r++)t[r]=s+=uhe(e());return t}function um(n,e=0){let t=[];for(;;){let r=n(),s=n();if(!s)break;e+=r;for(let i=0;i<s;i++)t.push(e+i);e+=s+1}return t}function NL(n){return hm(()=>{let e=um(n);if(e.length)return e})}function OL(n){let e=[];for(;;){let t=n();if(t==0)break;e.push(dhe(t,n))}for(;;){let t=n()-1;if(t<0)break;e.push(fhe(t,n))}return e.flat()}function hm(n){let e=[];for(;;){let t=n(e.length);if(!t)break;e.push(t)}return e}function xL(n,e,t){let r=Array(n).fill().map(()=>[]);for(let s=0;s<e;s++)hhe(n,t).forEach((i,o)=>r[o].push(i));return r}function dhe(n,e){let t=1+e(),r=e(),s=hm(e);return xL(s.length,1+n,e).flatMap((o,a)=>{let[c,...l]=o;return Array(s[a]).fill().map((u,h)=>{let d=h*r;return[c+h*t,l.map(f=>f+d)]})})}function fhe(n,e){let t=1+e();return xL(t,1+n,e).map(s=>[s[0],s.slice(1)])}function phe(n){let e=[],t=um(n);return s(r([]),[]),e;function r(i){let o=n(),a=hm(()=>{let c=um(n).map(l=>t[l]);if(c.length)return r(c)});return{S:o,B:a,Q:i}}function s({S:i,B:o},a,c){if(!(i&4&&c===a[a.length-1])){i&2&&(c=a[a.length-1]),i&1&&e.push(a);for(let l of o)for(let u of l.Q)s(l,[...a,u],c)}}}function ghe(n){return n.toString(16).toUpperCase().padStart(2,"0")}function RL(n){return`{${ghe(n)}}`}function mhe(n){let e=[];for(let t=0,r=n.length;t<r;){let s=n.codePointAt(t);t+=s<65536?1:2,e.push(s)}return e}function gf(n){let t=n.length;if(t<4096)return String.fromCodePoint(...n);let r=[];for(let s=0;s<t;)r.push(String.fromCodePoint(...n.slice(s,s+=4096)));return r.join("")}function yhe(n,e){let t=n.length,r=t-e.length;for(let s=0;r==0&&s<t;s++)r=n[s]-e[s];return r}var whe="AEUDTAHBCFQATQDRADAAcgAgADQAFAAsABQAHwAOACQADQARAAoAFwAHABIACAAPAAUACwAFAAwABAAQAAMABwAEAAoABQAIAAIACgABAAQAFAALAAIACwABAAIAAQAHAAMAAwAEAAsADAAMAAwACgANAA0AAwAKAAkABAAdAAYAZwDSAdsDJgC0CkMB8xhZAqfoC190UGcThgBurwf7PT09Pb09AjgJum8OjDllxHYUKXAPxzq6tABAxgK8ysUvWAgMPT09PT09PSs6LT2HcgWXWwFLoSMEEEl5RFVMKvO0XQ8ExDdJMnIgsj26PTQyy8FfEQ8AY8IPAGcEbwRwBHEEcgRzBHQEdQR2BHcEeAR6BHsEfAR+BIAEgfndBQoBYgULAWIFDAFiBNcE2ATZBRAFEQUvBdALFAsVDPcNBw13DYcOMA4xDjMB4BllHI0B2grbAMDpHLkQ7QHVAPRNQQFnGRUEg0yEB2uaJF8AJpIBpob5AERSMAKNoAXqaQLUBMCzEiACnwRZEkkVsS7tANAsBG0RuAQLEPABv9HICTUBXigPZwRBApMDOwAamhtaABqEAY8KvKx3LQ4ArAB8UhwEBAVSagD8AEFZADkBIadVj2UMUgx5Il4ANQC9AxIB1BlbEPMAs30CGxlXAhwZKQIECBc6EbsCoxngzv7UzRQA8M0BawL6ZwkN7wABAD33OQRcsgLJCjMCjqUChtw/km+NAsXPAoP2BT84PwURAK0RAvptb6cApQS/OMMey5HJS84UdxpxTPkCogVFITaTOwERAK5pAvkNBOVyA7q3BKlOJSALAgUIBRcEdASpBXqzABXFSWZOawLCOqw//AolCZdvv3dSBkEQGyelEPcMMwG1ATsN7UvYBPEGOwTJH30ZGQ/NlZwIpS3dDO0m4y6hgFoj9SqDBe1L9DzdC01RaA9ZC2UJ4zpjgU4DIQENIosK3Q05CG0Q8wrJaw3lEUUHOQPVSZoApQcBCxEdNRW1JhBirAsJOXcG+xr2C48mrxMpevwF0xohBk0BKRr/AM8u54WwWjFcHE9fBgMLJSPHFKhQIA0lQLd4SBobBxUlqQKRQ3BKh1E2HpMh9jw9DWYuE1F8B/U8BRlPC4E8nkarRQ4R0j6NPUgiSUwsBDV/LC8niwnPD4UMuXxyAVkJIQmxDHETMREXN8UIOQcZLZckJxUIIUaVYJoE958D8xPRAwsFPwlBBxMDtRwtEy4VKQUNgSTXAvM21S6zAo9WgAEXBcsPJR/fEFBH4A7pCJsCZQODJesALRUhABcimwhDYwBfj9hTBS7LCMdqbCN0A2cU52ERcweRDlcHpxwzFb8c4XDIXguGCCijrwlbAXUJmQFfBOMICTVbjKAgQWdTi1gYmyBhQT9d/AIxDGUVn0S9h3gCiw9rEhsBNQFzBzkNAQJ3Ee0RaxCVCOuGBDW1M/g6JQRPIYMgEQonA09szgsnJvkM+GkBoxJiAww0PXfuZ6tgtiQX/QcZMsVBYCHxC5JPzQycGsEYQlQuGeQHvwPzGvMn6kFXBf8DowMTOk0z7gS9C2kIiwk/AEkOoxcH1xhqCnGM0AExiwG3mQNXkYMCb48GNwcLAGcLhwV55QAdAqcIowAFAM8DVwA5Aq0HnQAZAIVBAT0DJy8BIeUCjwOTCDHLAZUvAfMpBBvDDBUA9zduSgLDsQKAamaiBd1YAo4CSTUBTSUEBU5HUQOvceEA2wBLBhPfRwEVq0rLGuNDAd9vKwDHAPsABTUHBUEBzQHzbQC3AV8LMQmis7UBTekpAIMAFWsB1wKJAN0ANQB/8QFTAE0FWfkF0wJPSQERMRgrV2EBuwMfATMBDQB5BsuNpckHHwRtB9MCEBsV4QLvLge1AQMi3xPNQsUCvd5VoWACZIECYkJbTa9bNyACofcCaJgCZgkCn4Q4GwsCZjsCZiYEbgR/A38TA36SOQY5dxc5gjojIwJsHQIyNjgKAm3HAm2u74ozZ0UrAWcA3gDhAEoFB5gMjQD+C8IADbUCdy8CdqI/AnlLQwJ4uh1c20WuRtcCfD8CesgCfQkCfPAFWQUgSABIfWMkAoFtAoAAAoAFAn+uSVhKWxUXSswC0QEC0MxLJwOITwOH5kTFkTIC8qFdAwMDrkvOTC0lA89NTE2vAos/AorYwRsHHUNnBbcCjjcCjlxAl4ECjtkCjlx4UbRTNQpS1FSFApP7ApMMAOkAHFUeVa9V0AYsGymVhjLheGZFOzkCl58C77JYIagAWSUClo8ClnycAKlZrFoJgU0AOwKWtQKWTlxEXNECmcsCmWRcyl0HGQKcmznCOp0CnBYCn5sCnriKAB0PMSoPAp3xAp6SALU9YTRh7wKe0wKgbgGpAp6fHwKeTqVjyGQnJSsCJ68CJn4CoPsCoEwCot0CocQCpi8Cpc4Cp/8AfQKn8mh8aLEAA0lqHGrRAqzjAqyuAq1nAq0CAlcdAlXcArHh1wMfTmyXArK9DQKy6Bds4G1jbUhfAyXNArZcOz9ukAMpRQK4XgK5RxUCuSp3cDZw4QK9GQK72nCWAzIRAr6IcgIDM3ECvhpzInNPAsPLAsMEc4J0SzVFdOADPKcDPJoDPb8CxXwCxkcCxhCJAshpUQLIRALJTwLJLgJknQLd0nh5YXiueSVL0AMYo2cCAmH0GfOVJHsLXpJeuxECz2sCz2wvS1PS8xOfAMatAs9zASnqA04SfksFAtwnAtuKAtJPA1JcA1NfAQEDVYyAiT8AyxbtYEWCHILTgs6DjQLaxwLZ3oQQhEmnPAOGpQAvA2QOhnFZ+QBVAt9lAt64c3cC4i/tFAHzMCcB9JsB8tKHAuvzAulweQLq+QLq5AD5RwG5Au6JAuuclqqXAwLuPwOF4Jh5cOBxoQLzAwBpA44WmZMC9xMDkW4DkocC95gC+dkC+GaaHJqruzebHgOdgwL++gEbADmfHJ+zAwWNA6ZqA6bZANHFAwZqoYiiBQkDDEkCwAA/AwDhQRdTARHzA2sHl2cFAJMtK7evvdsBiZkUfxEEOQH7KQUhDp0JnwCS/SlXxQL3AZ0AtwW5AG8LbUEuFCaNLgFDAYD8AbUmAHUDDgRtACwCFgyhAAAKAj0CagPdA34EkQEgRQUhfAoABQBEABMANhICdwEABdUDa+8KxQIA9wqfJ7+xt+UBkSFBQgHpFH8RNMCJAAQAGwBaAkUChIsABjpTOpSNbQC4Oo860ACNOME63AClAOgAywE6gTo7Ofw5+Tt2iTpbO56JOm85GAFWATMBbAUvNV01njWtNWY1dTW2NcU1gjWRNdI14TWeNa017jX9NbI1wTYCNhE1xjXVNhY2JzXeNe02LjY9Ni41LSE2OjY9Njw2yTcIBJA8VzY4Nt03IDcPNsogN4k3MAoEsDxnNiQ3GTdsOo03IULUQwdC4EMLHA8PCZsobShRVQYA6X8A6bABFCnXAukBowC9BbcAbwNzBL8MDAMMAQgDAAkKCwsLCQoGBAVVBI/DvwDz9b29kaUCb0QtsRTNLt4eGBcSHAMZFhYZEhYEARAEBUEcQRxBHEEcQRxBHEEaQRxBHEFCSTxBPElISUhBNkM2QTYbNklISVmBVIgBFLWZAu0BhQCjBcEAbykBvwGJAaQcEZ0ePCklMAAhMvAIMAL54gC7Bm8EescjzQMpARQpKgDUABavAj626xQAJP0A3etzuf4NNRA7efy2Z9NQrCnC0OSyANz5BBIbJ5IFDR6miIavYS6tprjjmuKebxm5C74Q225X1pkaYYPb6f1DK4k3xMEBb9S2WMjEibTNWhsRJIA+vwNVEiXTE5iXs/wezV66oFLfp9NZGYW+Gk19J2+bCT6Ye2w6LDYdgzKMUabk595eLBCXANz9HUpWbATq9vqXVx9XDg+Pc9Xp4+bsS005SVM/BJBM4687WUuf+Uj9dEi8aDNaPxtpbDxcG1THTImUMZq4UCaaNYpsVqraNyKLJXDYsFZ/5jl7bLRtO88t7P3xZaAxhb5OdPMXqsSkp1WCieG8jXm1U99+blvLlXzPCS+M93VnJCiK+09LfaSaBAVBomyDgJua8dfUzR7ga34IvR2Nvj+A9heJ6lsl1KG4NkI1032Cnff1m1wof2B9oHJK4bi6JkEdSqeNeiuo6QoZZincoc73/TH9SXF8sCE7XyuYyW8WSgbGFCjPV0ihLKhdPs08Tx82fYAkLLc4I2wdl4apY7GU5lHRFzRWJep7Ww3wbeA3qmd59/86P4xuNaqDpygXt6M85glSBHOCGgJDnt+pN9bK7HApMguX6+06RZNjzVmcZJ+wcUrJ9//bpRNxNuKpNl9uFds+S9tdx7LaM5ZkIrPj6nIU9mnbFtVbs9s/uLgl8MVczAwet+iOEzzBlYW7RCMgE6gyNLeq6+1tIx4dpgZnd0DksJS5f+JNDpwwcPNXaaVspq1fbQajOrJgK0ofKtJ1Ne90L6VO4MOl5S886p7u6xo7OLjG8TGL+HU1JXGJgppg4nNbNJ5nlzSpuPYy21JUEcUA94PoFiZfjZue+QnyQ80ekOuZVkxx4g+cvhJfHgNl4hy1/a6+RKcKlar/J29y//EztlbVPHVUeQ1zX86eQVAjR/M3dA9w4W8LfaXp4EgM85wOWasli837PzVMOnsLzR+k3o75/lRPAJSE1xAKQzEi5v10ke+VBvRt1cwQRMd+U5mLCTGVd6XiZtgBG5cDi0w22GKcVNvHiu5LQbZEDVtz0onn7k5+heuKXVsZtSzilkLRAUmjMXEMB3J9YC50XBxPiz53SC+EhnPl9WsKCv92SM/OFFIMJZYfl0WW8tIO3UxYcwdMAj7FSmgrsZ2aAZO03BOhP1bNNZItyXYQFTpC3SG1VuPDqH9GkiCDmE+JwxyIVSO5siDErAOpEXFgjy6PQtOVDj+s6e1r8heWVvmZnTciuf4EiNZzCAd7SOMhXERIOlsHIMG399i9aLTy3m2hRLZjJVDNLS53iGIK11dPqQt0zBDyg6qc7YqkDm2M5Ve6dCWCaCbTXX2rToaIgz6+zh4lYUi/+6nqcFMAkQJKHYLK0wYk5N9szV6xihDbDDFr45lN1K4aCXBq/FitPSud9gLt5ZVn+ZqGX7cwm2z5EGMgfFpIFyhGGuDPmso6TItTMwny+7uPnLCf4W6goFQFV0oQSsc9VfMmVLcLr6ZetDZbaSFTLqnSO/bIPjA3/zAUoqgGFAEQS4IhuMzEp2I3jJzbzkk/IEmyax+rhZTwd6f+CGtwPixu8IvzACquPWPREu9ZvGkUzpRwvRRuaNN6cr0W1wWits9ICdYJ7ltbgMiSL3sTPeufgNcVqMVWFkCPDH4jG2jA0XcVgQj62Cb29v9f/z/+2KbYvIv/zzjpQAPkliaVDzNrW57TZ/ZOyZD0nlfMmAIBIAGAI0D3k/mdN4xr9v85ZbZbbqfH2jGd5hUqNZWwl5SPfoGmfElmazUIeNL1j/mkF7VNAzTq4jNt8JoQ11NQOcmhprXoxSxfRGJ9LDEOAQ+dmxAQH90iti9e2u/MoeuaGcDTHoC+xsmEeWmxEKefQuIzHbpw5Tc5cEocboAD09oipWQhtTO1wivf/O+DRe2rpl/E9wlrzBorjJsOeG1B/XPW4EaJEFdNlECEZga5ZoGRHXgYouGRuVkm8tDESiEyFNo+3s5M5puSdTyUL2llnINVHEt91XUNW4ewdMgJ4boJfEyt/iY5WXqbA+A2Fkt5Z0lutiWhe9nZIyIUjyXDC3UsaG1t+eNx6z4W/OYoTB7A6x+dNSTOi9AInctbESqm5gvOLww7OWXPrmHwVZasrl4eD113pm+JtT7JVOvnCXqdzzdTRHgJ0PiGTFYW5Gvt9R9LD6Lzfs0v/TZZHSmyVNq7viIHE6DBK7Qp07Iz55EM8SYtQvZf/obBniTWi5C2/ovHfw4VndkE5XYdjOhCMRjDeOEfXeN/CwfGduiUIfsoFeUxXeQXba7c7972XNv8w+dTjjUM0QeNAReW+J014dKAD/McQYXT7c0GQPIkn3Ll6R7gGjuiQoZD0TEeEqQpKoZ15g/0OPQI17QiSv9AUROa/V/TQN3dvLArec3RrsYlvBm1b8LWzltdugsC50lNKYLEp2a+ZZYqPejULRlOJh5zj/LVMyTDvwKhMxxwuDkxJ1QpoNI0OTWLom4Z71SNzI9TV1iXJrIu9Wcnd+MCaAw8o1jSXd94YU/1gnkrC9BUEOtQvEIQ7g0i6h+KL2JKk8Ydl7HruvgWMSAmNe+LshGhV4qnWHhO9/RIPQzY1tHRj2VqOyNsDpK0cww+56AdDC4gsWwY0XxoucIWIqs/GcwnWqlaT0KPr8mbK5U94/301i1WLt4YINTVvCFBrFZbIbY8eycOdeJ2teD5IfPLCRg7jjcFTwlMFNl9zdh/o3E/hHPwj7BWg0MU09pPrBLbrCgm54A6H+I6v27+jL5gkjWg/iYdks9jbfVP5y/n0dlgWEMlKasl7JvFZd56LfybW1eeaVO0gxTfXZwD8G4SI116yx7UKVRgui6Ya1YpixqXeNLc8IxtAwCU5IhwQgn+NqHnRaDv61CxKhOq4pOX7M6pkA+Pmpd4j1vn6ACUALoLLc4vpXci8VidLxzm7qFBe7s+quuJs6ETYmnpgS3LwSZxPIltgBDXz8M1k/W2ySNv2f9/NPhxLGK2D21dkHeSGmenRT3Yqcdl0m/h3OYr8V+lXNYGf8aCCpd4bWjE4QIPj7vUKN4Nrfs7ML6Y2OyS830JCnofg/k7lpFpt4SqZc5HGg1HCOrHvOdC8bP6FGDbE/VV0mX4IakzbdS/op+Kt3G24/8QbBV7y86sGSQ/vZzU8FXs7u6jIvwchsEP2BpIhW3G8uWNwa3HmjfH/ZjhhCWvluAcF+nMf14ClKg5hGgtPLJ98ueNAkc5Hs2WZlk2QHvfreCK1CCGO6nMZVSb99VM/ajr8WHTte9JSmkXq/i/U943HEbdzW6Re/S88dKgg8pGOLlAeNiqrcLkUR3/aClFpMXcOUP3rmETcWSfMXZE3TUOi8i+fqRnTYLflVx/Vb/6GJ7eIRZUA6k3RYR3iFSK9c4iDdNwJuZL2FKz/IK5VimcNWEqdXjSoxSgmF0UPlDoUlNrPcM7ftmA8Y9gKiqKEHuWN+AZRIwtVSxye2Kf8rM3lhJ5XcBXU9n4v0Oy1RU2M+4qM8AQPVwse8ErNSob5oFPWxuqZnVzo1qB/IBxkM3EVUKFUUlO3e51259GgNcJbCmlvrdjtoTW7rChm1wyCKzpCTwozUUEOIcWLneRLgMXh+SjGSFkAllzbGS5HK7LlfCMRNRDSvbQPjcXaenNYxCvu2Qyznz6StuxVj66SgI0T8B6/sfHAJYZaZ78thjOSIFumNWLQbeZixDCCC+v0YBtkxiBB3jefHqZ/dFHU+crbj6OvS1x/JDD7vlm7zOVPwpUC01nhxZuY/63E7g";const dm=44032,ib=4352,ob=4449,ab=4519,PL=19,kL=21,mf=28,cb=kL*mf,bhe=PL*cb,Ehe=dm+bhe,vhe=ib+PL,Ahe=ob+kL,Che=ab+mf;function kp(n){return n>>24&255}function DL(n){return n&16777215}let MC,OR,LC,o0;function Ihe(){let n=TL(whe);MC=new Map(NL(n).flatMap((e,t)=>e.map(r=>[r,t+1<<24]))),OR=new Set(um(n)),LC=new Map,o0=new Map;for(let[e,t]of OL(n)){if(!OR.has(e)&&t.length==2){let[r,s]=t,i=o0.get(r);i||(i=new Map,o0.set(r,i)),i.set(s,e)}LC.set(e,t.reverse())}}function UL(n){return n>=dm&&n<Ehe}function _he(n,e){if(n>=ib&&n<vhe&&e>=ob&&e<Ahe)return dm+(n-ib)*cb+(e-ob)*mf;if(UL(n)&&e>ab&&e<Che&&(n-dm)%mf==0)return n+(e-ab);{let t=o0.get(n);return t&&(t=t.get(e),t)?t:-1}}function $L(n){MC||Ihe();let e=[],t=[],r=!1;function s(i){let o=MC.get(i);o&&(r=!0,i|=o),e.push(i)}for(let i of n)for(;;){if(i<128)e.push(i);else if(UL(i)){let o=i-dm,a=o/cb|0,c=o%cb/mf|0,l=o%mf;s(ib+a),s(ob+c),l>0&&s(ab+l)}else{let o=LC.get(i);o?t.push(...o):s(i)}if(!t.length)break;i=t.pop()}if(r&&e.length>1){let i=kp(e[0]);for(let o=1;o<e.length;o++){let a=kp(e[o]);if(a==0||i<=a){i=a;continue}let c=o-1;for(;;){let l=e[c+1];if(e[c+1]=e[c],e[c]=l,!c||(i=kp(e[--c]),i<=a))break}i=kp(e[o])}}return e}function She(n){let e=[],t=[],r=-1,s=0;for(let i of n){let o=kp(i),a=DL(i);if(r==-1)o==0?r=a:e.push(a);else if(s>0&&s>=o)o==0?(e.push(r,...t),t.length=0,r=a):t.push(a),s=o;else{let c=_he(r,a);c>=0?r=c:s==0&&o==0?(e.push(r),r=a):(t.push(a),s=o)}}return r>=0&&e.push(r,...t),e}function ML(n){return $L(n).map(DL)}function The(n){return She($L(n))}const xR=45,LL=".",BL=65039,FL=1,lb=n=>Array.from(n);function fm(n,e){return n.P.has(e)||n.Q.has(e)}class Nhe extends Array{get is_emoji(){return!0}}let BC,jL,Ol,FC,HL,td,N1,xh,hl,RR,jC;function tS(){if(BC)return;let n=TL(ohe);const e=()=>um(n),t=()=>new Set(e()),r=(u,h)=>h.forEach(d=>u.add(d));BC=new Map(OL(n)),jL=t(),Ol=e(),FC=new Set(e().map(u=>Ol[u])),Ol=new Set(Ol),HL=t(),t();let s=NL(n),i=n();const o=()=>{let u=new Set;return e().forEach(h=>r(u,s[h])),r(u,e()),u};td=hm(u=>{let h=hm(n).map(d=>d+96);if(h.length){let d=u>=i;h[0]-=32,h=gf(h),d&&(h=`Restricted[${h}]`);let f=o(),p=o(),g=!n();return{N:h,P:f,Q:p,M:g,R:d}}}),N1=t(),xh=new Map;let a=e().concat(lb(N1)).sort((u,h)=>u-h);a.forEach((u,h)=>{let d=n(),f=a[h]=d?a[h-d]:{V:[],M:new Map};f.V.push(u),N1.has(u)||xh.set(u,f)});for(let{V:u,M:h}of new Set(xh.values())){let d=[];for(let p of u){let g=td.filter(w=>fm(w,p)),m=d.find(({G:w})=>g.some(v=>w.has(v)));m||(m={G:new Set,V:[]},d.push(m)),m.V.push(p),r(m.G,g)}let f=d.flatMap(p=>lb(p.G));for(let{G:p,V:g}of d){let m=new Set(f.filter(w=>!p.has(w)));for(let w of g)h.set(w,m)}}hl=new Set;let c=new Set;const l=u=>hl.has(u)?c.add(u):hl.add(u);for(let u of td){for(let h of u.P)l(h);for(let h of u.Q)l(h)}for(let u of hl)!xh.has(u)&&!c.has(u)&&xh.set(u,FL);r(hl,ML(hl)),RR=phe(n).map(u=>Nhe.from(u)).sort(yhe),jC=new Map;for(let u of RR){let h=[jC];for(let d of u){let f=h.map(p=>{let g=p.get(d);return g||(g=new Map,p.set(d,g)),g});d===BL?h.push(...f):h=f}for(let d of h)d.V=u}}function nS(n){return(VL(n)?"":`${rS(EE([n]))} `)+RL(n)}function rS(n){return`"${n}"‎`}function Ohe(n){if(n.length>=4&&n[2]==xR&&n[3]==xR)throw new Error(`invalid label extension: "${gf(n.slice(0,4))}"`)}function xhe(n){for(let t=n.lastIndexOf(95);t>0;)if(n[--t]!==95)throw new Error("underscore allowed only at start")}function Rhe(n){let e=n[0],t=TR.get(e);if(t)throw ig(`leading ${t}`);let r=n.length,s=-1;for(let i=1;i<r;i++){e=n[i];let o=TR.get(e);if(o){if(s==i)throw ig(`${t} + ${o}`);s=i+1,t=o}}if(s==r)throw ig(`trailing ${t}`)}function EE(n,e=1/0,t=RL){let r=[];Phe(n[0])&&r.push("◌"),n.length>e&&(e>>=1,n=[...n.slice(0,e),8230,...n.slice(-e)]);let s=0,i=n.length;for(let o=0;o<i;o++){let a=n[o];VL(a)&&(r.push(gf(n.slice(s,o))),r.push(t(a)),s=o+1)}return r.push(gf(n.slice(s,i))),r.join("")}function Phe(n){return tS(),Ol.has(n)}function VL(n){return tS(),HL.has(n)}function khe(n){return Mhe(Dhe(n,The,Fhe))}function Dhe(n,e,t){if(!n)return[];tS();let r=0;return n.split(LL).map(s=>{let i=mhe(s),o={input:i,offset:r};r+=i.length+1;try{let a=o.tokens=Bhe(i,e,t),c=a.length,l;if(!c)throw new Error("empty label");let u=o.output=a.flat();if(xhe(u),!(o.emoji=c>1||a[0].is_emoji)&&u.every(d=>d<128))Ohe(u),l="ASCII";else{let d=a.flatMap(f=>f.is_emoji?[]:f);if(!d.length)l="Emoji";else{if(Ol.has(u[0]))throw ig("leading combining mark");for(let g=1;g<c;g++){let m=a[g];if(!m.is_emoji&&Ol.has(m[0]))throw ig(`emoji + combining mark: "${gf(a[g-1])} + ${EE([m[0]])}"`)}Rhe(u);let f=lb(new Set(d)),[p]=$he(f);Lhe(p,d),Uhe(p,f),l=p.N}}o.type=l}catch(a){o.error=a}return o})}function Uhe(n,e){let t,r=[];for(let s of e){let i=xh.get(s);if(i===FL)return;if(i){let o=i.M.get(s);if(t=t?t.filter(a=>o.has(a)):lb(o),!t.length)return}else r.push(s)}if(t){for(let s of t)if(r.every(i=>fm(s,i)))throw new Error(`whole-script confusable: ${n.N}/${s.N}`)}}function $he(n){let e=td;for(let t of n){let r=e.filter(s=>fm(s,t));if(!r.length)throw td.some(s=>fm(s,t))?zL(e[0],t):qL(t);if(e=r,r.length==1)break}return e}function Mhe(n){return n.map(({input:e,error:t,output:r})=>{if(t){let s=t.message;throw new Error(n.length==1?s:`Invalid label ${rS(EE(e,63))}: ${s}`)}return gf(r)}).join(LL)}function qL(n){return new Error(`disallowed character: ${nS(n)}`)}function zL(n,e){let t=nS(e),r=td.find(s=>s.P.has(e));return r&&(t=`${r.N} ${t}`),new Error(`illegal mixture: ${n.N} + ${t}`)}function ig(n){return new Error(`illegal placement: ${n}`)}function Lhe(n,e){for(let t of e)if(!fm(n,t))throw zL(n,t);if(n.M){let t=ML(e);for(let r=1,s=t.length;r<s;r++)if(FC.has(t[r])){let i=r+1;for(let o;i<s&&FC.has(o=t[i]);i++)for(let a=r;a<i;a++)if(t[a]==o)throw new Error(`duplicate non-spacing marks: ${nS(o)}`);if(i-r>NR)throw new Error(`excessive non-spacing marks: ${rS(EE(t.slice(r-1,i)))} (${i-r}/${NR})`);r=i}}}function Bhe(n,e,t){let r=[],s=[];for(n=n.slice().reverse();n.length;){let i=jhe(n);if(i)s.length&&(r.push(e(s)),s=[]),r.push(t(i));else{let o=n.pop();if(hl.has(o))s.push(o);else{let a=BC.get(o);if(a)s.push(...a);else if(!jL.has(o))throw qL(o)}}}return s.length&&r.push(e(s)),r}function Fhe(n){return n.filter(e=>e!=BL)}function jhe(n,e){let t=jC,r,s=n.length;for(;s&&(t=t.get(n[--s]),!!t);){let{V:i}=t;i&&(r=i,n.length=s)}return r}const WL=new Uint8Array(32);WL.fill(0);function PR(n){return x(n.length!==0,"invalid ENS name; empty component","comp",n),n}function GL(n){const e=Eo(Hhe(n)),t=[];if(n.length===0)return t;let r=0;for(let s=0;s<e.length;s++)e[s]===46&&(t.push(PR(e.slice(r,s))),r=s+1);return x(r<e.length,"invalid ENS name; empty component","name",n),t.push(PR(e.slice(r))),t}function Hhe(n){try{if(n.length===0)throw new Error("empty label");return khe(n)}catch(e){x(!1,`invalid ENS name (${e.message})`,"name",n)}}function HC(n){x(typeof n=="string","invalid ENS name; not a string","name",n),x(n.length,"invalid ENS name (empty label)","name",n);let e=WL;const t=GL(n);for(;t.length;)e=pn(on([e,pn(t.pop())]));return Ee(e)}function Vhe(n,e){const t=e;return x(t<=255,"DNS encoded label cannot exceed 255","length",t),Ee(on(GL(n).map(r=>{x(r.length<=t,`label ${JSON.stringify(n)} exceeds ${t} bytes`,"name",n);const s=new Uint8Array(r.length+1);return s.set(r,1),s[0]=s.length-1,s})))+"00"}function O1(n,e){return{address:Tt(n),storageKeys:e.map((t,r)=>(x(Ut(t,32),"invalid slot",`storageKeys[${r}]`,t),t.toLowerCase()))}}function qu(n){if(Array.isArray(n))return n.map((t,r)=>Array.isArray(t)?(x(t.length===2,"invalid slot set",`value[${r}]`,t),O1(t[0],t[1])):(x(t!=null&&typeof t=="object","invalid address-slot set","value",n),O1(t.address,t.storageKeys)));x(n!=null&&typeof n=="object","invalid access list","value",n);const e=Object.keys(n).map(t=>{const r=n[t].reduce((s,i)=>(s[i]=!0,s),{});return O1(t,Object.keys(r).sort())});return e.sort((t,r)=>t.address.localeCompare(r.address)),e}function qhe(n){let e;return typeof n=="string"?e=lm.computePublicKey(n,!1):e=n.publicKey,Tt(pn("0x"+e.substring(4)).substring(26))}function zhe(n,e){return qhe(lm.recoverPublicKey(n,e))}const On=BigInt(0),Whe=BigInt(2),Ghe=BigInt(27),Khe=BigInt(28),Yhe=BigInt(35),Qhe=BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),x1=4096*32;function kR(n,e){let t=n.toString(16);for(;t.length<2;)t="0"+t;return t+=jf(e).substring(4),"0x"+t}function vE(n){return n==="0x"?null:Tt(n)}function sS(n,e){try{return qu(n)}catch(t){x(!1,t.message,e,n)}}function vy(n,e){return n==="0x"?0:We(n,e)}function sn(n,e){if(n==="0x")return On;const t=Ae(n,e);return x(t<=Qhe,"value exceeds uint size",e,t),t}function Bt(n,e){const t=Ae(n,"value"),r=xr(t);return x(r.length<=32,"value too large",`tx.${e}`,t),r}function iS(n){return qu(n).map(e=>[e.address,e.storageKeys])}function Zhe(n,e){x(Array.isArray(n),`invalid ${e}`,"value",n);for(let t=0;t<n.length;t++)x(Ut(n[t],32),"invalid ${ param } hash",`value[${t}]`,n[t]);return n}function Jhe(n){const e=mE(n);x(Array.isArray(e)&&(e.length===9||e.length===6),"invalid field count for legacy transaction","data",n);const t={type:0,nonce:vy(e[0],"nonce"),gasPrice:sn(e[1],"gasPrice"),gasLimit:sn(e[2],"gasLimit"),to:vE(e[3]),value:sn(e[4],"value"),data:Ee(e[5]),chainId:On};if(e.length===6)return t;const r=sn(e[6],"v"),s=sn(e[7],"r"),i=sn(e[8],"s");if(s===On&&i===On)t.chainId=r;else{let o=(r-Yhe)/Whe;o<On&&(o=On),t.chainId=o,x(o!==On||r===Ghe||r===Khe,"non-canonical legacy v","v",e[6]),t.signature=Di.from({r:Au(e[7],32),s:Au(e[8],32),v:r})}return t}function Xhe(n,e){const t=[Bt(n.nonce,"nonce"),Bt(n.gasPrice||0,"gasPrice"),Bt(n.gasLimit,"gasLimit"),n.to||"0x",Bt(n.value,"value"),n.data];let r=On;if(n.chainId!=On)r=Ae(n.chainId,"tx.chainId"),x(!e||e.networkV==null||e.legacyChainId===r,"tx.chainId/sig.v mismatch","sig",e);else if(n.signature){const i=n.signature.legacyChainId;i!=null&&(r=i)}if(!e)return r!==On&&(t.push(xr(r)),t.push("0x"),t.push("0x")),Cu(t);let s=BigInt(27+e.yParity);return r!==On?s=Di.getChainIdV(r,e.v):BigInt(e.v)!==s&&x(!1,"tx.chainId/sig.v mismatch","sig",e),t.push(xr(s)),t.push(xr(e.r)),t.push(xr(e.s)),Cu(t)}function oS(n,e){let t;try{if(t=vy(e[0],"yParity"),t!==0&&t!==1)throw new Error("bad yParity")}catch{x(!1,"invalid yParity","yParity",e[0])}const r=Au(e[1],32),s=Au(e[2],32),i=Di.from({r,s,yParity:t});n.signature=i}function ede(n){const e=mE(ot(n).slice(1));x(Array.isArray(e)&&(e.length===9||e.length===12),"invalid field count for transaction type: 2","data",Ee(n));const t={type:2,chainId:sn(e[0],"chainId"),nonce:vy(e[1],"nonce"),maxPriorityFeePerGas:sn(e[2],"maxPriorityFeePerGas"),maxFeePerGas:sn(e[3],"maxFeePerGas"),gasPrice:null,gasLimit:sn(e[4],"gasLimit"),to:vE(e[5]),value:sn(e[6],"value"),data:Ee(e[7]),accessList:sS(e[8],"accessList")};return e.length===9||oS(t,e.slice(9)),t}function tde(n,e){const t=[Bt(n.chainId,"chainId"),Bt(n.nonce,"nonce"),Bt(n.maxPriorityFeePerGas||0,"maxPriorityFeePerGas"),Bt(n.maxFeePerGas||0,"maxFeePerGas"),Bt(n.gasLimit,"gasLimit"),n.to||"0x",Bt(n.value,"value"),n.data,iS(n.accessList||[])];return e&&(t.push(Bt(e.yParity,"yParity")),t.push(xr(e.r)),t.push(xr(e.s))),on(["0x02",Cu(t)])}function nde(n){const e=mE(ot(n).slice(1));x(Array.isArray(e)&&(e.length===8||e.length===11),"invalid field count for transaction type: 1","data",Ee(n));const t={type:1,chainId:sn(e[0],"chainId"),nonce:vy(e[1],"nonce"),gasPrice:sn(e[2],"gasPrice"),gasLimit:sn(e[3],"gasLimit"),to:vE(e[4]),value:sn(e[5],"value"),data:Ee(e[6]),accessList:sS(e[7],"accessList")};return e.length===8||oS(t,e.slice(8)),t}function rde(n,e){const t=[Bt(n.chainId,"chainId"),Bt(n.nonce,"nonce"),Bt(n.gasPrice||0,"gasPrice"),Bt(n.gasLimit,"gasLimit"),n.to||"0x",Bt(n.value,"value"),n.data,iS(n.accessList||[])];return e&&(t.push(Bt(e.yParity,"recoveryParam")),t.push(xr(e.r)),t.push(xr(e.s))),on(["0x01",Cu(t)])}function sde(n){let e=mE(ot(n).slice(1)),t="3",r=null;if(e.length===4&&Array.isArray(e[0])){t="3 (network format)";const i=e[1],o=e[2],a=e[3];x(Array.isArray(i),"invalid network format: blobs not an array","fields[1]",i),x(Array.isArray(o),"invalid network format: commitments not an array","fields[2]",o),x(Array.isArray(a),"invalid network format: proofs not an array","fields[3]",a),x(i.length===o.length,"invalid network format: blobs/commitments length mismatch","fields",e),x(i.length===a.length,"invalid network format: blobs/proofs length mismatch","fields",e),r=[];for(let c=0;c<e[1].length;c++)r.push({data:i[c],commitment:o[c],proof:a[c]});e=e[0]}x(Array.isArray(e)&&(e.length===11||e.length===14),`invalid field count for transaction type: ${t}`,"data",Ee(n));const s={type:3,chainId:sn(e[0],"chainId"),nonce:vy(e[1],"nonce"),maxPriorityFeePerGas:sn(e[2],"maxPriorityFeePerGas"),maxFeePerGas:sn(e[3],"maxFeePerGas"),gasPrice:null,gasLimit:sn(e[4],"gasLimit"),to:vE(e[5]),value:sn(e[6],"value"),data:Ee(e[7]),accessList:sS(e[8],"accessList"),maxFeePerBlobGas:sn(e[9],"maxFeePerBlobGas"),blobVersionedHashes:e[10]};r&&(s.blobs=r),x(s.to!=null,`invalid address for transaction type: ${t}`,"data",n),x(Array.isArray(s.blobVersionedHashes),"invalid blobVersionedHashes: must be an array","data",n);for(let i=0;i<s.blobVersionedHashes.length;i++)x(Ut(s.blobVersionedHashes[i],32),`invalid blobVersionedHash at index ${i}: must be length 32`,"data",n);return e.length===11||oS(s,e.slice(11)),s}function ide(n,e,t){const r=[Bt(n.chainId,"chainId"),Bt(n.nonce,"nonce"),Bt(n.maxPriorityFeePerGas||0,"maxPriorityFeePerGas"),Bt(n.maxFeePerGas||0,"maxFeePerGas"),Bt(n.gasLimit,"gasLimit"),n.to||cm,Bt(n.value,"value"),n.data,iS(n.accessList||[]),Bt(n.maxFeePerBlobGas||0,"maxFeePerBlobGas"),Zhe(n.blobVersionedHashes||[],"blobVersionedHashes")];return e&&(r.push(Bt(e.yParity,"yParity")),r.push(xr(e.r)),r.push(xr(e.s)),t)?on(["0x03",Cu([r,t.map(s=>s.data),t.map(s=>s.commitment),t.map(s=>s.proof)])]):on(["0x03",Cu(r)])}var Zi,bd,Ed,vd,Ad,Cd,Id,_d,Sd,Td,Nd,Od,Wl,uc,Qo,hc,xd,a0;const Ho=class Ho{constructor(){F(this,xd);F(this,Zi,void 0);F(this,bd,void 0);F(this,Ed,void 0);F(this,vd,void 0);F(this,Ad,void 0);F(this,Cd,void 0);F(this,Id,void 0);F(this,_d,void 0);F(this,Sd,void 0);F(this,Td,void 0);F(this,Nd,void 0);F(this,Od,void 0);F(this,Wl,void 0);F(this,uc,void 0);F(this,Qo,void 0);F(this,hc,void 0);_(this,Zi,null),_(this,bd,null),_(this,vd,0),_(this,Ad,On),_(this,Cd,null),_(this,Id,null),_(this,_d,null),_(this,Ed,"0x"),_(this,Sd,On),_(this,Td,On),_(this,Nd,null),_(this,Od,null),_(this,Wl,null),_(this,uc,null),_(this,hc,null),_(this,Qo,null)}get type(){return y(this,Zi)}set type(e){switch(e){case null:_(this,Zi,null);break;case 0:case"legacy":_(this,Zi,0);break;case 1:case"berlin":case"eip-2930":_(this,Zi,1);break;case 2:case"london":case"eip-1559":_(this,Zi,2);break;case 3:case"cancun":case"eip-4844":_(this,Zi,3);break;default:x(!1,"unsupported transaction type","type",e)}}get typeName(){switch(this.type){case 0:return"legacy";case 1:return"eip-2930";case 2:return"eip-1559";case 3:return"eip-4844"}return null}get to(){const e=y(this,bd);return e==null&&this.type===3?cm:e}set to(e){_(this,bd,e==null?null:Tt(e))}get nonce(){return y(this,vd)}set nonce(e){_(this,vd,We(e,"value"))}get gasLimit(){return y(this,Ad)}set gasLimit(e){_(this,Ad,Ae(e))}get gasPrice(){const e=y(this,Cd);return e==null&&(this.type===0||this.type===1)?On:e}set gasPrice(e){_(this,Cd,e==null?null:Ae(e,"gasPrice"))}get maxPriorityFeePerGas(){const e=y(this,Id);return e??(this.type===2||this.type===3?On:null)}set maxPriorityFeePerGas(e){_(this,Id,e==null?null:Ae(e,"maxPriorityFeePerGas"))}get maxFeePerGas(){const e=y(this,_d);return e??(this.type===2||this.type===3?On:null)}set maxFeePerGas(e){_(this,_d,e==null?null:Ae(e,"maxFeePerGas"))}get data(){return y(this,Ed)}set data(e){_(this,Ed,Ee(e))}get value(){return y(this,Sd)}set value(e){_(this,Sd,Ae(e,"value"))}get chainId(){return y(this,Td)}set chainId(e){_(this,Td,Ae(e))}get signature(){return y(this,Nd)||null}set signature(e){_(this,Nd,e==null?null:Di.from(e))}get accessList(){const e=y(this,Od)||null;return e??(this.type===1||this.type===2||this.type===3?[]:null)}set accessList(e){_(this,Od,e==null?null:qu(e))}get maxFeePerBlobGas(){const e=y(this,Wl);return e==null&&this.type===3?On:e}set maxFeePerBlobGas(e){_(this,Wl,e==null?null:Ae(e,"maxFeePerBlobGas"))}get blobVersionedHashes(){let e=y(this,uc);return e==null&&this.type===3?[]:e}set blobVersionedHashes(e){if(e!=null){x(Array.isArray(e),"blobVersionedHashes must be an Array","value",e),e=e.slice();for(let t=0;t<e.length;t++)x(Ut(e[t],32),"invalid blobVersionedHash",`value[${t}]`,e[t])}_(this,uc,e)}get blobs(){return y(this,hc)==null?null:y(this,hc).map(e=>Object.assign({},e))}set blobs(e){if(e==null){_(this,hc,null);return}const t=[],r=[];for(let s=0;s<e.length;s++){const i=e[s];if(z_(i)){K(y(this,Qo),"adding a raw blob requires a KZG library","UNSUPPORTED_OPERATION",{operation:"set blobs()"});let o=ot(i);if(x(o.length<=x1,"blob is too large",`blobs[${s}]`,i),o.length!==x1){const l=new Uint8Array(x1);l.set(o),o=l}const a=y(this,Qo).blobToKzgCommitment(o),c=Ee(y(this,Qo).computeBlobKzgProof(o,a));t.push({data:Ee(o),commitment:Ee(a),proof:c}),r.push(kR(1,a))}else{const o=Ee(i.commitment);t.push({data:Ee(i.data),commitment:o,proof:Ee(i.proof)}),r.push(kR(1,o))}}_(this,hc,t),_(this,uc,r)}get kzg(){return y(this,Qo)}set kzg(e){_(this,Qo,e)}get hash(){return this.signature==null?null:pn(Z(this,xd,a0).call(this,!0,!1))}get unsignedHash(){return pn(this.unsignedSerialized)}get from(){return this.signature==null?null:zhe(this.unsignedHash,this.signature)}get fromPublicKey(){return this.signature==null?null:lm.recoverPublicKey(this.unsignedHash,this.signature)}isSigned(){return this.signature!=null}get serialized(){return Z(this,xd,a0).call(this,!0,!0)}get unsignedSerialized(){return Z(this,xd,a0).call(this,!1,!1)}inferType(){const e=this.inferTypes();return e.indexOf(2)>=0?2:e.pop()}inferTypes(){const e=this.gasPrice!=null,t=this.maxFeePerGas!=null||this.maxPriorityFeePerGas!=null,r=this.accessList!=null,s=y(this,Wl)!=null||y(this,uc);this.maxFeePerGas!=null&&this.maxPriorityFeePerGas!=null&&K(this.maxFeePerGas>=this.maxPriorityFeePerGas,"priorityFee cannot be more than maxFee","BAD_DATA",{value:this}),K(!t||this.type!==0&&this.type!==1,"transaction type cannot have maxFeePerGas or maxPriorityFeePerGas","BAD_DATA",{value:this}),K(this.type!==0||!r,"legacy transaction cannot have accessList","BAD_DATA",{value:this});const i=[];return this.type!=null?i.push(this.type):t?i.push(2):e?(i.push(1),r||i.push(0)):r?(i.push(1),i.push(2)):(s&&this.to||(i.push(0),i.push(1),i.push(2)),i.push(3)),i.sort(),i}isLegacy(){return this.type===0}isBerlin(){return this.type===1}isLondon(){return this.type===2}isCancun(){return this.type===3}clone(){return Ho.from(this)}toJSON(){const e=t=>t==null?null:t.toString();return{type:this.type,to:this.to,data:this.data,nonce:this.nonce,gasLimit:e(this.gasLimit),gasPrice:e(this.gasPrice),maxPriorityFeePerGas:e(this.maxPriorityFeePerGas),maxFeePerGas:e(this.maxFeePerGas),value:e(this.value),chainId:e(this.chainId),sig:this.signature?this.signature.toJSON():null,accessList:this.accessList}}static from(e){if(e==null)return new Ho;if(typeof e=="string"){const r=ot(e);if(r[0]>=127)return Ho.from(Jhe(r));switch(r[0]){case 1:return Ho.from(nde(r));case 2:return Ho.from(ede(r));case 3:return Ho.from(sde(r))}K(!1,"unsupported transaction type","UNSUPPORTED_OPERATION",{operation:"from"})}const t=new Ho;return e.type!=null&&(t.type=e.type),e.to!=null&&(t.to=e.to),e.nonce!=null&&(t.nonce=e.nonce),e.gasLimit!=null&&(t.gasLimit=e.gasLimit),e.gasPrice!=null&&(t.gasPrice=e.gasPrice),e.maxPriorityFeePerGas!=null&&(t.maxPriorityFeePerGas=e.maxPriorityFeePerGas),e.maxFeePerGas!=null&&(t.maxFeePerGas=e.maxFeePerGas),e.maxFeePerBlobGas!=null&&(t.maxFeePerBlobGas=e.maxFeePerBlobGas),e.data!=null&&(t.data=e.data),e.value!=null&&(t.value=e.value),e.chainId!=null&&(t.chainId=e.chainId),e.signature!=null&&(t.signature=Di.from(e.signature)),e.accessList!=null&&(t.accessList=e.accessList),e.blobVersionedHashes!=null&&(t.blobVersionedHashes=e.blobVersionedHashes),e.kzg!=null&&(t.kzg=e.kzg),e.blobs!=null&&(t.blobs=e.blobs),e.hash!=null&&(x(t.isSigned(),"unsigned transaction cannot define '.hash'","tx",e),x(t.hash===e.hash,"hash mismatch","tx",e)),e.from!=null&&(x(t.isSigned(),"unsigned transaction cannot define '.from'","tx",e),x(t.from.toLowerCase()===(e.from||"").toLowerCase(),"from mismatch","tx",e)),t}};Zi=new WeakMap,bd=new WeakMap,Ed=new WeakMap,vd=new WeakMap,Ad=new WeakMap,Cd=new WeakMap,Id=new WeakMap,_d=new WeakMap,Sd=new WeakMap,Td=new WeakMap,Nd=new WeakMap,Od=new WeakMap,Wl=new WeakMap,uc=new WeakMap,Qo=new WeakMap,hc=new WeakMap,xd=new WeakSet,a0=function(e,t){K(!e||this.signature!=null,"cannot serialize unsigned transaction; maybe you meant .unsignedSerialized","UNSUPPORTED_OPERATION",{operation:".serialized"});const r=e?this.signature:null;switch(this.inferType()){case 0:return Xhe(this,r);case 1:return rde(this,r);case 2:return tde(this,r);case 3:return ide(this,r,t?this.blobs:null)}K(!1,"unsupported transaction type","UNSUPPORTED_OPERATION",{operation:".serialized"})};let ub=Ho;const KL=new Uint8Array(32);KL.fill(0);const ode=BigInt(-1),YL=BigInt(0),QL=BigInt(1),ade=BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");function cde(n){const e=ot(n),t=e.length%32;return t?on([e,KL.slice(t)]):Ee(e)}const lde=Fc(QL,32),ude=Fc(YL,32),DR={name:"string",version:"string",chainId:"uint256",verifyingContract:"address",salt:"bytes32"},R1=["name","version","chainId","verifyingContract","salt"];function UR(n){return function(e){return x(typeof e=="string",`invalid domain value for ${JSON.stringify(n)}`,`domain.${n}`,e),e}}const hde={name:UR("name"),version:UR("version"),chainId:function(n){const e=Ae(n,"domain.chainId");return x(e>=0,"invalid chain ID","domain.chainId",n),Number.isSafeInteger(e)?Number(e):Hh(e)},verifyingContract:function(n){try{return Tt(n).toLowerCase()}catch{}x(!1,'invalid domain value "verifyingContract"',"domain.verifyingContract",n)},salt:function(n){const e=ot(n,"domain.salt");return x(e.length===32,'invalid domain value "salt"',"domain.salt",n),Ee(e)}};function P1(n){{const e=n.match(/^(u?)int(\d+)$/);if(e){const t=e[1]==="",r=parseInt(e[2]);x(r%8===0&&r!==0&&r<=256&&e[2]===String(r),"invalid numeric width","type",n);const s=Tl(ade,t?r-1:r),i=t?(s+QL)*ode:YL;return function(o){const a=Ae(o,"value");return x(a>=i&&a<=s,`value out-of-bounds for ${n}`,"value",a),Fc(t?UM(a,256):a,32)}}}{const e=n.match(/^bytes(\d+)$/);if(e){const t=parseInt(e[1]);return x(t!==0&&t<=32&&e[1]===String(t),"invalid bytes width","type",n),function(r){const s=ot(r);return x(s.length===t,`invalid length for ${n}`,"value",r),cde(r)}}}switch(n){case"address":return function(e){return Au(Tt(e),32)};case"bool":return function(e){return e?lde:ude};case"bytes":return function(e){return pn(e)};case"string":return function(e){return Iu(e)}}return null}function $R(n,e){return`${n}(${e.map(({name:t,type:r})=>r+" "+t).join(",")})`}function Rw(n){const e=n.match(/^([^\x5b]*)((\x5b\d*\x5d)*)(\x5b(\d*)\x5d)$/);return e?{base:e[1],index:e[2]+e[4],array:{base:e[1],prefix:e[1]+e[2],count:e[5]?parseInt(e[5]):-1}}:{base:n}}var Fm,Zo,Rd,kb,ZL;const js=class js{constructor(e){F(this,kb);B(this,"primaryType");F(this,Fm,void 0);F(this,Zo,void 0);F(this,Rd,void 0);_(this,Zo,new Map),_(this,Rd,new Map);const t=new Map,r=new Map,s=new Map,i={};Object.keys(e).forEach(c=>{i[c]=e[c].map(({name:l,type:u})=>{let{base:h,index:d}=Rw(u);return h==="int"&&!e.int&&(h="int256"),h==="uint"&&!e.uint&&(h="uint256"),{name:l,type:h+(d||"")}}),t.set(c,new Set),r.set(c,[]),s.set(c,new Set)}),_(this,Fm,JSON.stringify(i));for(const c in i){const l=new Set;for(const u of i[c]){x(!l.has(u.name),`duplicate variable name ${JSON.stringify(u.name)} in ${JSON.stringify(c)}`,"types",e),l.add(u.name);const h=Rw(u.type).base;x(h!==c,`circular type reference to ${JSON.stringify(h)}`,"types",e),!P1(h)&&(x(r.has(h),`unknown type ${JSON.stringify(h)}`,"types",e),r.get(h).push(c),t.get(c).add(h))}}const o=Array.from(r.keys()).filter(c=>r.get(c).length===0);x(o.length!==0,"missing primary type","types",e),x(o.length===1,`ambiguous primary types or unused types: ${o.map(c=>JSON.stringify(c)).join(", ")}`,"types",e),Re(this,{primaryType:o[0]});function a(c,l){x(!l.has(c),`circular type reference to ${JSON.stringify(c)}`,"types",e),l.add(c);for(const u of t.get(c))if(r.has(u)){a(u,l);for(const h of l)s.get(h).add(u)}l.delete(c)}a(this.primaryType,new Set);for(const[c,l]of s){const u=Array.from(l);u.sort(),y(this,Zo).set(c,$R(c,i[c])+u.map(h=>$R(h,i[h])).join(""))}}get types(){return JSON.parse(y(this,Fm))}getEncoder(e){let t=y(this,Rd).get(e);return t||(t=Z(this,kb,ZL).call(this,e),y(this,Rd).set(e,t)),t}encodeType(e){const t=y(this,Zo).get(e);return x(t,`unknown type: ${JSON.stringify(e)}`,"name",e),t}encodeData(e,t){return this.getEncoder(e)(t)}hashStruct(e,t){return pn(this.encodeData(e,t))}encode(e){return this.encodeData(this.primaryType,e)}hash(e){return this.hashStruct(this.primaryType,e)}_visit(e,t,r){if(P1(e))return r(e,t);const s=Rw(e).array;if(s)return x(s.count===-1||s.count===t.length,`array length mismatch; expected length ${s.count}`,"value",t),t.map(o=>this._visit(s.prefix,o,r));const i=this.types[e];if(i)return i.reduce((o,{name:a,type:c})=>(o[a]=this._visit(c,t[a],r),o),{});x(!1,`unknown type: ${e}`,"type",e)}visit(e,t){return this._visit(this.primaryType,e,t)}static from(e){return new js(e)}static getPrimaryType(e){return js.from(e).primaryType}static hashStruct(e,t,r){return js.from(t).hashStruct(e,r)}static hashDomain(e){const t=[];for(const r in e){if(e[r]==null)continue;const s=DR[r];x(s,`invalid typed-data domain key: ${JSON.stringify(r)}`,"domain",e),t.push({name:r,type:s})}return t.sort((r,s)=>R1.indexOf(r.name)-R1.indexOf(s.name)),js.hashStruct("EIP712Domain",{EIP712Domain:t},e)}static encode(e,t,r){return on(["0x1901",js.hashDomain(e),js.from(t).hash(r)])}static hash(e,t,r){return pn(js.encode(e,t,r))}static async resolveNames(e,t,r,s){e=Object.assign({},e);for(const a in e)e[a]==null&&delete e[a];const i={};e.verifyingContract&&!Ut(e.verifyingContract,20)&&(i[e.verifyingContract]="0x");const o=js.from(t);o.visit(r,(a,c)=>(a==="address"&&!Ut(c,20)&&(i[c]="0x"),c));for(const a in i)i[a]=await s(a);return e.verifyingContract&&i[e.verifyingContract]&&(e.verifyingContract=i[e.verifyingContract]),r=o.visit(r,(a,c)=>a==="address"&&i[c]?i[c]:c),{domain:e,value:r}}static getPayload(e,t,r){js.hashDomain(e);const s={},i=[];R1.forEach(c=>{const l=e[c];l!=null&&(s[c]=hde[c](l),i.push({name:c,type:DR[c]}))});const o=js.from(t);t=o.types;const a=Object.assign({},t);return x(a.EIP712Domain==null,"types must not contain EIP712Domain type","types.EIP712Domain",t),a.EIP712Domain=i,o.encode(r),{types:a,domain:s,primaryType:o.primaryType,message:o.visit(r,(c,l)=>{if(c.match(/^bytes(\d*)/))return Ee(ot(l));if(c.match(/^u?int/))return Ae(l).toString();switch(c){case"address":return l.toLowerCase();case"bool":return!!l;case"string":return x(typeof l=="string","invalid string","value",l),l}x(!1,"unsupported type","type",c)})}}};Fm=new WeakMap,Zo=new WeakMap,Rd=new WeakMap,kb=new WeakSet,ZL=function(e){{const s=P1(e);if(s)return s}const t=Rw(e).array;if(t){const s=t.prefix,i=this.getEncoder(s);return o=>{x(t.count===-1||t.count===o.length,`array length mismatch; expected length ${t.count}`,"value",o);let a=o.map(i);return y(this,Zo).has(s)&&(a=a.map(pn)),pn(on(a))}}const r=this.types[e];if(r){const s=Iu(y(this,Zo).get(e));return i=>{const o=r.map(({name:a,type:c})=>{const l=this.getEncoder(c)(i[a]);return y(this,Zo).has(c)?pn(l):l});return o.unshift(s),on(o)}}x(!1,`unknown type: ${e}`,"type",e)};let hb=js;function kr(n){const e=new Set;return n.forEach(t=>e.add(t)),Object.freeze(e)}const dde="external public payable override",fde=kr(dde.split(" ")),JL="constant external internal payable private public pure view override",pde=kr(JL.split(" ")),XL="constructor error event fallback function receive struct",e4=kr(XL.split(" ")),t4="calldata memory storage payable indexed",gde=kr(t4.split(" ")),mde="tuple returns",yde=[XL,t4,mde,JL].join(" "),wde=kr(yde.split(" ")),bde={"(":"OPEN_PAREN",")":"CLOSE_PAREN","[":"OPEN_BRACKET","]":"CLOSE_BRACKET",",":"COMMA","@":"AT"},Ede=new RegExp("^(\\s*)"),vde=new RegExp("^([0-9]+)"),Ade=new RegExp("^([a-zA-Z$_][a-zA-Z0-9$_]*)"),n4=new RegExp("^([a-zA-Z$_][a-zA-Z0-9$_]*)$"),r4=new RegExp("^(address|bool|bytes([0-9]*)|string|u?int([0-9]*))$");var jn,vi,jm,VC;const Db=class Db{constructor(e){F(this,jm);F(this,jn,void 0);F(this,vi,void 0);_(this,jn,0),_(this,vi,e.slice())}get offset(){return y(this,jn)}get length(){return y(this,vi).length-y(this,jn)}clone(){return new Db(y(this,vi))}reset(){_(this,jn,0)}popKeyword(e){const t=this.peek();if(t.type!=="KEYWORD"||!e.has(t.text))throw new Error(`expected keyword ${t.text}`);return this.pop().text}popType(e){if(this.peek().type!==e){const t=this.peek();throw new Error(`expected ${e}; got ${t.type} ${JSON.stringify(t.text)}`)}return this.pop().text}popParen(){const e=this.peek();if(e.type!=="OPEN_PAREN")throw new Error("bad start");const t=Z(this,jm,VC).call(this,y(this,jn)+1,e.match+1);return _(this,jn,e.match+1),t}popParams(){const e=this.peek();if(e.type!=="OPEN_PAREN")throw new Error("bad start");const t=[];for(;y(this,jn)<e.match-1;){const r=this.peek().linkNext;t.push(Z(this,jm,VC).call(this,y(this,jn)+1,r)),_(this,jn,r)}return _(this,jn,e.match+1),t}peek(){if(y(this,jn)>=y(this,vi).length)throw new Error("out-of-bounds");return y(this,vi)[y(this,jn)]}peekKeyword(e){const t=this.peekType("KEYWORD");return t!=null&&e.has(t)?t:null}peekType(e){if(this.length===0)return null;const t=this.peek();return t.type===e?t.text:null}pop(){const e=this.peek();return Qf(this,jn)._++,e}toString(){const e=[];for(let t=y(this,jn);t<y(this,vi).length;t++){const r=y(this,vi)[t];e.push(`${r.type}:${r.text}`)}return`<TokenString ${e.join(" ")}>`}};jn=new WeakMap,vi=new WeakMap,jm=new WeakSet,VC=function(e=0,t=0){return new Db(y(this,vi).slice(e,t).map(r=>Object.freeze(Object.assign({},r,{match:r.match-e,linkBack:r.linkBack-e,linkNext:r.linkNext-e}))))};let Ui=Db;function Wc(n){const e=[],t=o=>{const a=i<n.length?JSON.stringify(n[i]):"$EOI";throw new Error(`invalid token ${a} at ${i}: ${o}`)};let r=[],s=[],i=0;for(;i<n.length;){let o=n.substring(i),a=o.match(Ede);a&&(i+=a[1].length,o=n.substring(i));const c={depth:r.length,linkBack:-1,linkNext:-1,match:-1,type:"",text:"",offset:i,value:-1};e.push(c);let l=bde[o[0]]||"";if(l){if(c.type=l,c.text=o[0],i++,l==="OPEN_PAREN")r.push(e.length-1),s.push(e.length-1);else if(l=="CLOSE_PAREN")r.length===0&&t("no matching open bracket"),c.match=r.pop(),e[c.match].match=e.length-1,c.depth--,c.linkBack=s.pop(),e[c.linkBack].linkNext=e.length-1;else if(l==="COMMA")c.linkBack=s.pop(),e[c.linkBack].linkNext=e.length-1,s.push(e.length-1);else if(l==="OPEN_BRACKET")c.type="BRACKET";else if(l==="CLOSE_BRACKET"){let u=e.pop().text;if(e.length>0&&e[e.length-1].type==="NUMBER"){const h=e.pop().text;u=h+u,e[e.length-1].value=We(h)}if(e.length===0||e[e.length-1].type!=="BRACKET")throw new Error("missing opening bracket");e[e.length-1].text+=u}continue}if(a=o.match(Ade),a){if(c.text=a[1],i+=c.text.length,wde.has(c.text)){c.type="KEYWORD";continue}if(c.text.match(r4)){c.type="TYPE";continue}c.type="ID";continue}if(a=o.match(vde),a){c.text=a[1],c.type="NUMBER",i+=c.text.length;continue}throw new Error(`unexpected token ${JSON.stringify(o[0])} at position ${i}`)}return new Ui(e.map(o=>Object.freeze(o)))}function MR(n,e){let t=[];for(const r in e.keys())n.has(r)&&t.push(r);if(t.length>1)throw new Error(`conflicting types: ${t.join(", ")}`)}function AE(n,e){if(e.peekKeyword(e4)){const t=e.pop().text;if(t!==n)throw new Error(`expected ${n}, got ${t}`)}return e.popType("ID")}function Ea(n,e){const t=new Set;for(;;){const r=n.peekType("KEYWORD");if(r==null||e&&!e.has(r))break;if(n.pop(),t.has(r))throw new Error(`duplicate keywords: ${JSON.stringify(r)}`);t.add(r)}return Object.freeze(t)}function s4(n){let e=Ea(n,pde);return MR(e,kr("constant payable nonpayable".split(" "))),MR(e,kr("pure view payable nonpayable".split(" "))),e.has("view")?"view":e.has("pure")?"pure":e.has("payable")?"payable":e.has("nonpayable")?"nonpayable":e.has("constant")?"view":"nonpayable"}function fa(n,e){return n.popParams().map(t=>Wn.from(t,e))}function i4(n){if(n.peekType("AT")){if(n.pop(),n.peekType("NUMBER"))return Ae(n.pop().text);throw new Error("invalid gas")}return null}function _u(n){if(n.length)throw new Error(`unexpected tokens at offset ${n.offset}: ${n.toString()}`)}const Cde=new RegExp(/^(.*)\[([0-9]*)\]$/);function LR(n){const e=n.match(r4);if(x(e,"invalid type","type",n),n==="uint")return"uint256";if(n==="int")return"int256";if(e[2]){const t=parseInt(e[2]);x(t!==0&&t<=32,"invalid bytes length","type",n)}else if(e[3]){const t=parseInt(e[3]);x(t!==0&&t<=256&&t%8===0,"invalid numeric width","type",n)}return n}const Gt={},ls=Symbol.for("_ethers_internal"),BR="_ParamTypeInternal",FR="_ErrorInternal",jR="_EventInternal",HR="_ConstructorInternal",VR="_FallbackInternal",qR="_FunctionInternal",zR="_StructInternal";var Pd,c0;const Hs=class Hs{constructor(e,t,r,s,i,o,a,c){F(this,Pd);B(this,"name");B(this,"type");B(this,"baseType");B(this,"indexed");B(this,"components");B(this,"arrayLength");B(this,"arrayChildren");if(by(e,Gt,"ParamType"),Object.defineProperty(this,ls,{value:BR}),o&&(o=Object.freeze(o.slice())),s==="array"){if(a==null||c==null)throw new Error("")}else if(a!=null||c!=null)throw new Error("");if(s==="tuple"){if(o==null)throw new Error("")}else if(o!=null)throw new Error("");Re(this,{name:t,type:r,baseType:s,indexed:i,components:o,arrayLength:a,arrayChildren:c})}format(e){if(e==null&&(e="sighash"),e==="json"){const r=this.name||"";if(this.isArray()){const i=JSON.parse(this.arrayChildren.format("json"));return i.name=r,i.type+=`[${this.arrayLength<0?"":String(this.arrayLength)}]`,JSON.stringify(i)}const s={type:this.baseType==="tuple"?"tuple":this.type,name:r};return typeof this.indexed=="boolean"&&(s.indexed=this.indexed),this.isTuple()&&(s.components=this.components.map(i=>JSON.parse(i.format(e)))),JSON.stringify(s)}let t="";return this.isArray()?(t+=this.arrayChildren.format(e),t+=`[${this.arrayLength<0?"":String(this.arrayLength)}]`):this.isTuple()?t+="("+this.components.map(r=>r.format(e)).join(e==="full"?", ":",")+")":t+=this.type,e!=="sighash"&&(this.indexed===!0&&(t+=" indexed"),e==="full"&&this.name&&(t+=" "+this.name)),t}isArray(){return this.baseType==="array"}isTuple(){return this.baseType==="tuple"}isIndexable(){return this.indexed!=null}walk(e,t){if(this.isArray()){if(!Array.isArray(e))throw new Error("invalid array value");if(this.arrayLength!==-1&&e.length!==this.arrayLength)throw new Error("array is wrong length");const r=this;return e.map(s=>r.arrayChildren.walk(s,t))}if(this.isTuple()){if(!Array.isArray(e))throw new Error("invalid tuple value");if(e.length!==this.components.length)throw new Error("array is wrong length");const r=this;return e.map((s,i)=>r.components[i].walk(s,t))}return t(this.type,e)}async walkAsync(e,t){const r=[],s=[e];return Z(this,Pd,c0).call(this,r,e,t,i=>{s[0]=i}),r.length&&await Promise.all(r),s[0]}static from(e,t){if(Hs.isParamType(e))return e;if(typeof e=="string")try{return Hs.from(Wc(e),t)}catch{x(!1,"invalid param type","obj",e)}else if(e instanceof Ui){let a="",c="",l=null;Ea(e,kr(["tuple"])).has("tuple")||e.peekType("OPEN_PAREN")?(c="tuple",l=e.popParams().map(g=>Hs.from(g)),a=`tuple(${l.map(g=>g.format()).join(",")})`):(a=LR(e.popType("TYPE")),c=a);let u=null,h=null;for(;e.length&&e.peekType("BRACKET");){const g=e.pop();u=new Hs(Gt,"",a,c,null,l,h,u),h=g.value,a+=g.text,c="array",l=null}let d=null;if(Ea(e,gde).has("indexed")){if(!t)throw new Error("");d=!0}const p=e.peekType("ID")?e.pop().text:"";if(e.length)throw new Error("leftover tokens");return new Hs(Gt,p,a,c,d,l,h,u)}const r=e.name;x(!r||typeof r=="string"&&r.match(n4),"invalid name","obj.name",r);let s=e.indexed;s!=null&&(x(t,"parameter cannot be indexed","obj.indexed",e.indexed),s=!!s);let i=e.type,o=i.match(Cde);if(o){const a=parseInt(o[2]||"-1"),c=Hs.from({type:o[1],components:e.components});return new Hs(Gt,r||"",i,"array",s,null,a,c)}if(i==="tuple"||i.startsWith("tuple(")||i.startsWith("(")){const a=e.components!=null?e.components.map(l=>Hs.from(l)):null;return new Hs(Gt,r||"",i,"tuple",s,a,null,null)}return i=LR(e.type),new Hs(Gt,r||"",i,i,s,null,null,null)}static isParamType(e){return e&&e[ls]===BR}};Pd=new WeakSet,c0=function(e,t,r,s){if(this.isArray()){if(!Array.isArray(t))throw new Error("invalid array value");if(this.arrayLength!==-1&&t.length!==this.arrayLength)throw new Error("array is wrong length");const o=this.arrayChildren,a=t.slice();a.forEach((c,l)=>{var u;Z(u=o,Pd,c0).call(u,e,c,r,h=>{a[l]=h})}),s(a);return}if(this.isTuple()){const o=this.components;let a;if(Array.isArray(t))a=t.slice();else{if(t==null||typeof t!="object")throw new Error("invalid tuple value");a=o.map(c=>{if(!c.name)throw new Error("cannot use object value with unnamed components");if(!(c.name in t))throw new Error(`missing value for component ${c.name}`);return t[c.name]})}if(a.length!==this.components.length)throw new Error("array is wrong length");a.forEach((c,l)=>{var u;Z(u=o[l],Pd,c0).call(u,e,c,r,h=>{a[l]=h})}),s(a);return}const i=r(this.type,t);i.then?e.push(async function(){s(await i)}()):s(i)};let Wn=Hs;class Su{constructor(e,t,r){B(this,"type");B(this,"inputs");by(e,Gt,"Fragment"),r=Object.freeze(r.slice()),Re(this,{type:t,inputs:r})}static from(e){if(typeof e=="string"){try{Su.from(JSON.parse(e))}catch{}return Su.from(Wc(e))}if(e instanceof Ui)switch(e.peekKeyword(e4)){case"constructor":return aa.from(e);case"error":return ss.from(e);case"event":return ao.from(e);case"fallback":case"receive":return qo.from(e);case"function":return co.from(e);case"struct":return uu.from(e)}else if(typeof e=="object"){switch(e.type){case"constructor":return aa.from(e);case"error":return ss.from(e);case"event":return ao.from(e);case"fallback":case"receive":return qo.from(e);case"function":return co.from(e);case"struct":return uu.from(e)}K(!1,`unsupported type: ${e.type}`,"UNSUPPORTED_OPERATION",{operation:"Fragment.from"})}x(!1,"unsupported frgament object","obj",e)}static isConstructor(e){return aa.isFragment(e)}static isError(e){return ss.isFragment(e)}static isEvent(e){return ao.isFragment(e)}static isFunction(e){return co.isFragment(e)}static isStruct(e){return uu.isFragment(e)}}class CE extends Su{constructor(t,r,s,i){super(t,r,i);B(this,"name");x(typeof s=="string"&&s.match(n4),"invalid identifier","name",s),i=Object.freeze(i.slice()),Re(this,{name:s})}}function pm(n,e){return"("+e.map(t=>t.format(n)).join(n==="full"?", ":",")+")"}class ss extends CE{constructor(e,t,r){super(e,"error",t,r),Object.defineProperty(this,ls,{value:FR})}get selector(){return Iu(this.format("sighash")).substring(0,10)}format(e){if(e==null&&(e="sighash"),e==="json")return JSON.stringify({type:"error",name:this.name,inputs:this.inputs.map(r=>JSON.parse(r.format(e)))});const t=[];return e!=="sighash"&&t.push("error"),t.push(this.name+pm(e,this.inputs)),t.join(" ")}static from(e){if(ss.isFragment(e))return e;if(typeof e=="string")return ss.from(Wc(e));if(e instanceof Ui){const t=AE("error",e),r=fa(e);return _u(e),new ss(Gt,t,r)}return new ss(Gt,e.name,e.inputs?e.inputs.map(Wn.from):[])}static isFragment(e){return e&&e[ls]===FR}}class ao extends CE{constructor(t,r,s,i){super(t,"event",r,s);B(this,"anonymous");Object.defineProperty(this,ls,{value:jR}),Re(this,{anonymous:i})}get topicHash(){return Iu(this.format("sighash"))}format(t){if(t==null&&(t="sighash"),t==="json")return JSON.stringify({type:"event",anonymous:this.anonymous,name:this.name,inputs:this.inputs.map(s=>JSON.parse(s.format(t)))});const r=[];return t!=="sighash"&&r.push("event"),r.push(this.name+pm(t,this.inputs)),t!=="sighash"&&this.anonymous&&r.push("anonymous"),r.join(" ")}static getTopicHash(t,r){return r=(r||[]).map(i=>Wn.from(i)),new ao(Gt,t,r,!1).topicHash}static from(t){if(ao.isFragment(t))return t;if(typeof t=="string")try{return ao.from(Wc(t))}catch{x(!1,"invalid event fragment","obj",t)}else if(t instanceof Ui){const r=AE("event",t),s=fa(t,!0),i=!!Ea(t,kr(["anonymous"])).has("anonymous");return _u(t),new ao(Gt,r,s,i)}return new ao(Gt,t.name,t.inputs?t.inputs.map(r=>Wn.from(r,!0)):[],!!t.anonymous)}static isFragment(t){return t&&t[ls]===jR}}class aa extends Su{constructor(t,r,s,i,o){super(t,r,s);B(this,"payable");B(this,"gas");Object.defineProperty(this,ls,{value:HR}),Re(this,{payable:i,gas:o})}format(t){if(K(t!=null&&t!=="sighash","cannot format a constructor for sighash","UNSUPPORTED_OPERATION",{operation:"format(sighash)"}),t==="json")return JSON.stringify({type:"constructor",stateMutability:this.payable?"payable":"undefined",payable:this.payable,gas:this.gas!=null?this.gas:void 0,inputs:this.inputs.map(s=>JSON.parse(s.format(t)))});const r=[`constructor${pm(t,this.inputs)}`];return this.payable&&r.push("payable"),this.gas!=null&&r.push(`@${this.gas.toString()}`),r.join(" ")}static from(t){if(aa.isFragment(t))return t;if(typeof t=="string")try{return aa.from(Wc(t))}catch{x(!1,"invalid constuctor fragment","obj",t)}else if(t instanceof Ui){Ea(t,kr(["constructor"]));const r=fa(t),s=!!Ea(t,fde).has("payable"),i=i4(t);return _u(t),new aa(Gt,"constructor",r,s,i)}return new aa(Gt,"constructor",t.inputs?t.inputs.map(Wn.from):[],!!t.payable,t.gas!=null?t.gas:null)}static isFragment(t){return t&&t[ls]===HR}}class qo extends Su{constructor(t,r,s){super(t,"fallback",r);B(this,"payable");Object.defineProperty(this,ls,{value:VR}),Re(this,{payable:s})}format(t){const r=this.inputs.length===0?"receive":"fallback";if(t==="json"){const s=this.payable?"payable":"nonpayable";return JSON.stringify({type:r,stateMutability:s})}return`${r}()${this.payable?" payable":""}`}static from(t){if(qo.isFragment(t))return t;if(typeof t=="string")try{return qo.from(Wc(t))}catch{x(!1,"invalid fallback fragment","obj",t)}else if(t instanceof Ui){const r=t.toString(),s=t.peekKeyword(kr(["fallback","receive"]));if(x(s,"type must be fallback or receive","obj",r),t.popKeyword(kr(["fallback","receive"]))==="receive"){const c=fa(t);return x(c.length===0,"receive cannot have arguments","obj.inputs",c),Ea(t,kr(["payable"])),_u(t),new qo(Gt,[],!0)}let o=fa(t);o.length?x(o.length===1&&o[0].type==="bytes","invalid fallback inputs","obj.inputs",o.map(c=>c.format("minimal")).join(", ")):o=[Wn.from("bytes")];const a=s4(t);if(x(a==="nonpayable"||a==="payable","fallback cannot be constants","obj.stateMutability",a),Ea(t,kr(["returns"])).has("returns")){const c=fa(t);x(c.length===1&&c[0].type==="bytes","invalid fallback outputs","obj.outputs",c.map(l=>l.format("minimal")).join(", "))}return _u(t),new qo(Gt,o,a==="payable")}if(t.type==="receive")return new qo(Gt,[],!0);if(t.type==="fallback"){const r=[Wn.from("bytes")],s=t.stateMutability==="payable";return new qo(Gt,r,s)}x(!1,"invalid fallback description","obj",t)}static isFragment(t){return t&&t[ls]===VR}}class co extends CE{constructor(t,r,s,i,o,a){super(t,"function",r,i);B(this,"constant");B(this,"outputs");B(this,"stateMutability");B(this,"payable");B(this,"gas");Object.defineProperty(this,ls,{value:qR}),o=Object.freeze(o.slice()),Re(this,{constant:s==="view"||s==="pure",gas:a,outputs:o,payable:s==="payable",stateMutability:s})}get selector(){return Iu(this.format("sighash")).substring(0,10)}format(t){if(t==null&&(t="sighash"),t==="json")return JSON.stringify({type:"function",name:this.name,constant:this.constant,stateMutability:this.stateMutability!=="nonpayable"?this.stateMutability:void 0,payable:this.payable,gas:this.gas!=null?this.gas:void 0,inputs:this.inputs.map(s=>JSON.parse(s.format(t))),outputs:this.outputs.map(s=>JSON.parse(s.format(t)))});const r=[];return t!=="sighash"&&r.push("function"),r.push(this.name+pm(t,this.inputs)),t!=="sighash"&&(this.stateMutability!=="nonpayable"&&r.push(this.stateMutability),this.outputs&&this.outputs.length&&(r.push("returns"),r.push(pm(t,this.outputs))),this.gas!=null&&r.push(`@${this.gas.toString()}`)),r.join(" ")}static getSelector(t,r){return r=(r||[]).map(i=>Wn.from(i)),new co(Gt,t,"view",r,[],null).selector}static from(t){if(co.isFragment(t))return t;if(typeof t=="string")try{return co.from(Wc(t))}catch{x(!1,"invalid function fragment","obj",t)}else if(t instanceof Ui){const s=AE("function",t),i=fa(t),o=s4(t);let a=[];Ea(t,kr(["returns"])).has("returns")&&(a=fa(t));const c=i4(t);return _u(t),new co(Gt,s,o,i,a,c)}let r=t.stateMutability;return r==null&&(r="payable",typeof t.constant=="boolean"?(r="view",t.constant||(r="payable",typeof t.payable=="boolean"&&!t.payable&&(r="nonpayable"))):typeof t.payable=="boolean"&&!t.payable&&(r="nonpayable")),new co(Gt,t.name,r,t.inputs?t.inputs.map(Wn.from):[],t.outputs?t.outputs.map(Wn.from):[],t.gas!=null?t.gas:null)}static isFragment(t){return t&&t[ls]===qR}}class uu extends CE{constructor(e,t,r){super(e,"struct",t,r),Object.defineProperty(this,ls,{value:zR})}format(){throw new Error("@TODO")}static from(e){if(typeof e=="string")try{return uu.from(Wc(e))}catch{x(!1,"invalid struct fragment","obj",e)}else if(e instanceof Ui){const t=AE("struct",e),r=fa(e);return _u(e),new uu(Gt,t,r)}return new uu(Gt,e.name,e.inputs?e.inputs.map(Wn.from):[])}static isFragment(e){return e&&e[ls]===zR}}const Fi=new Map;Fi.set(0,"GENERIC_PANIC");Fi.set(1,"ASSERT_FALSE");Fi.set(17,"OVERFLOW");Fi.set(18,"DIVIDE_BY_ZERO");Fi.set(33,"ENUM_RANGE_ERROR");Fi.set(34,"BAD_STORAGE_DATA");Fi.set(49,"STACK_UNDERFLOW");Fi.set(50,"ARRAY_RANGE_ERROR");Fi.set(65,"OUT_OF_MEMORY");Fi.set(81,"UNINITIALIZED_FUNCTION_CALL");const Ide=new RegExp(/^bytes([0-9]*)$/),_de=new RegExp(/^(u?int)([0-9]*)$/);let k1=null,WR=1024;function Sde(n,e,t,r){let s="missing revert data",i=null;const o=null;let a=null;if(t){s="execution reverted";const l=ot(t);if(t=Ee(t),l.length===0)s+=" (no data present; likely require(false) occurred",i="require(false)";else if(l.length%32!==4)s+=" (could not decode reason; invalid data length)";else if(Ee(l.slice(0,4))==="0x08c379a0")try{i=r.decode(["string"],l.slice(4))[0],a={signature:"Error(string)",name:"Error",args:[i]},s+=`: ${JSON.stringify(i)}`}catch{s+=" (could not decode reason; invalid string data)"}else if(Ee(l.slice(0,4))==="0x4e487b71")try{const u=Number(r.decode(["uint256"],l.slice(4))[0]);a={signature:"Panic(uint256)",name:"Panic",args:[u]},i=`Panic due to ${Fi.get(u)||"UNKNOWN"}(${u})`,s+=`: ${i}`}catch{s+=" (could not decode panic code)"}else s+=" (unknown custom error)"}const c={to:e.to?Tt(e.to):null,data:e.data||"0x"};return e.from&&(c.from=Tt(e.from)),un(s,"CALL_EXCEPTION",{action:n,data:t,reason:i,transaction:c,invocation:o,revert:a})}var dc,Rh;const Ub=class Ub{constructor(){F(this,dc)}getDefaultValue(e){const t=e.map(s=>Z(this,dc,Rh).call(this,Wn.from(s)));return new xw(t,"_").defaultValue()}encode(e,t){PM(t.length,e.length,"types/values length mismatch");const r=e.map(o=>Z(this,dc,Rh).call(this,Wn.from(o))),s=new xw(r,"_"),i=new OC;return s.encode(i,t),i.data}decode(e,t,r){const s=e.map(o=>Z(this,dc,Rh).call(this,Wn.from(o)));return new xw(s,"_").decode(new xC(t,r,WR))}static _setDefaultMaxInflation(e){x(typeof e=="number"&&Number.isInteger(e),"invalid defaultMaxInflation factor","value",e),WR=e}static defaultAbiCoder(){return k1==null&&(k1=new Ub),k1}static getBuiltinCallException(e,t,r){return Sde(e,t,r,Ub.defaultAbiCoder())}};dc=new WeakSet,Rh=function(e){if(e.isArray())return new Yue(Z(this,dc,Rh).call(this,e.arrayChildren),e.arrayLength,e.name);if(e.isTuple())return new xw(e.components.map(r=>Z(this,dc,Rh).call(this,r)),e.name);switch(e.baseType){case"address":return new Gue(e.name);case"bool":return new Que(e.name);case"string":return new ihe(e.name);case"bytes":return new Zue(e.name);case"":return new ehe(e.name)}let t=e.type.match(_de);if(t){let r=parseInt(t[2]||"256");return x(r!==0&&r<=256&&r%8===0,"invalid "+t[1]+" bit length","param",e),new she(r/8,t[1]==="int",e.name)}if(t=e.type.match(Ide),t){let r=parseInt(t[1]);return x(r!==0&&r<=32,"invalid bytes length","param",e),new Jue(r,e.name)}x(!1,"invalid type","type",e.type)};let gm=Ub;class Tde{constructor(e,t,r){B(this,"fragment");B(this,"name");B(this,"signature");B(this,"topic");B(this,"args");const s=e.name,i=e.format();Re(this,{fragment:e,name:s,signature:i,topic:t,args:r})}}class Nde{constructor(e,t,r,s){B(this,"fragment");B(this,"name");B(this,"args");B(this,"signature");B(this,"selector");B(this,"value");const i=e.name,o=e.format();Re(this,{fragment:e,name:i,args:r,signature:o,selector:t,value:s})}}class Ode{constructor(e,t,r){B(this,"fragment");B(this,"name");B(this,"args");B(this,"signature");B(this,"selector");const s=e.name,i=e.format();Re(this,{fragment:e,name:s,args:r,signature:i,selector:t})}}class GR{constructor(e){B(this,"hash");B(this,"_isIndexed");Re(this,{hash:e,_isIndexed:!0})}static isIndexed(e){return!!(e&&e._isIndexed)}}const KR={0:"generic panic",1:"assert(false)",17:"arithmetic overflow",18:"division or modulo by zero",33:"enum overflow",34:"invalid encoded storage byte array accessed",49:"out-of-bounds array access; popping on an empty array",50:"out-of-bounds access of an array or bytesN",65:"out of memory",81:"uninitialized function"},YR={"0x08c379a0":{signature:"Error(string)",name:"Error",inputs:["string"],reason:n=>`reverted with reason string ${JSON.stringify(n)}`},"0x4e487b71":{signature:"Panic(uint256)",name:"Panic",inputs:["uint256"],reason:n=>{let e="unknown panic code";return n>=0&&n<=255&&KR[n.toString()]&&(e=KR[n.toString()]),`reverted with panic code 0x${n.toString(16)} (${e})`}}};var Ji,Xi,eo,or,kd,l0,Dd,u0;const bl=class bl{constructor(e){F(this,kd);F(this,Dd);B(this,"fragments");B(this,"deploy");B(this,"fallback");B(this,"receive");F(this,Ji,void 0);F(this,Xi,void 0);F(this,eo,void 0);F(this,or,void 0);let t=[];typeof e=="string"?t=JSON.parse(e):t=e,_(this,eo,new Map),_(this,Ji,new Map),_(this,Xi,new Map);const r=[];for(const o of t)try{r.push(Su.from(o))}catch(a){console.log(`[Warning] Invalid Fragment ${JSON.stringify(o)}:`,a.message)}Re(this,{fragments:Object.freeze(r)});let s=null,i=!1;_(this,or,this.getAbiCoder()),this.fragments.forEach((o,a)=>{let c;switch(o.type){case"constructor":if(this.deploy){console.log("duplicate definition - constructor");return}Re(this,{deploy:o});return;case"fallback":o.inputs.length===0?i=!0:(x(!s||o.payable!==s.payable,"conflicting fallback fragments",`fragments[${a}]`,o),s=o,i=s.payable);return;case"function":c=y(this,eo);break;case"event":c=y(this,Xi);break;case"error":c=y(this,Ji);break;default:return}const l=o.format();c.has(l)||c.set(l,o)}),this.deploy||Re(this,{deploy:aa.from("constructor()")}),Re(this,{fallback:s,receive:i})}format(e){const t=e?"minimal":"full";return this.fragments.map(s=>s.format(t))}formatJson(){const e=this.fragments.map(t=>t.format("json"));return JSON.stringify(e.map(t=>JSON.parse(t)))}getAbiCoder(){return gm.defaultAbiCoder()}getFunctionName(e){const t=Z(this,kd,l0).call(this,e,null,!1);return x(t,"no matching function","key",e),t.name}hasFunction(e){return!!Z(this,kd,l0).call(this,e,null,!1)}getFunction(e,t){return Z(this,kd,l0).call(this,e,t||null,!0)}forEachFunction(e){const t=Array.from(y(this,eo).keys());t.sort((r,s)=>r.localeCompare(s));for(let r=0;r<t.length;r++){const s=t[r];e(y(this,eo).get(s),r)}}getEventName(e){const t=Z(this,Dd,u0).call(this,e,null,!1);return x(t,"no matching event","key",e),t.name}hasEvent(e){return!!Z(this,Dd,u0).call(this,e,null,!1)}getEvent(e,t){return Z(this,Dd,u0).call(this,e,t||null,!0)}forEachEvent(e){const t=Array.from(y(this,Xi).keys());t.sort((r,s)=>r.localeCompare(s));for(let r=0;r<t.length;r++){const s=t[r];e(y(this,Xi).get(s),r)}}getError(e,t){if(Ut(e)){const s=e.toLowerCase();if(YR[s])return ss.from(YR[s].signature);for(const i of y(this,Ji).values())if(s===i.selector)return i;return null}if(e.indexOf("(")===-1){const s=[];for(const[i,o]of y(this,Ji))i.split("(")[0]===e&&s.push(o);if(s.length===0)return e==="Error"?ss.from("error Error(string)"):e==="Panic"?ss.from("error Panic(uint256)"):null;if(s.length>1){const i=s.map(o=>JSON.stringify(o.format())).join(", ");x(!1,`ambiguous error description (i.e. ${i})`,"name",e)}return s[0]}if(e=ss.from(e).format(),e==="Error(string)")return ss.from("error Error(string)");if(e==="Panic(uint256)")return ss.from("error Panic(uint256)");const r=y(this,Ji).get(e);return r||null}forEachError(e){const t=Array.from(y(this,Ji).keys());t.sort((r,s)=>r.localeCompare(s));for(let r=0;r<t.length;r++){const s=t[r];e(y(this,Ji).get(s),r)}}_decodeParams(e,t){return y(this,or).decode(e,t)}_encodeParams(e,t){return y(this,or).encode(e,t)}encodeDeploy(e){return this._encodeParams(this.deploy.inputs,e||[])}decodeErrorResult(e,t){if(typeof e=="string"){const r=this.getError(e);x(r,"unknown error","fragment",e),e=r}return x(Zt(t,0,4)===e.selector,`data signature does not match error ${e.name}.`,"data",t),this._decodeParams(e.inputs,Zt(t,4))}encodeErrorResult(e,t){if(typeof e=="string"){const r=this.getError(e);x(r,"unknown error","fragment",e),e=r}return on([e.selector,this._encodeParams(e.inputs,t||[])])}decodeFunctionData(e,t){if(typeof e=="string"){const r=this.getFunction(e);x(r,"unknown function","fragment",e),e=r}return x(Zt(t,0,4)===e.selector,`data signature does not match function ${e.name}.`,"data",t),this._decodeParams(e.inputs,Zt(t,4))}encodeFunctionData(e,t){if(typeof e=="string"){const r=this.getFunction(e);x(r,"unknown function","fragment",e),e=r}return on([e.selector,this._encodeParams(e.inputs,t||[])])}decodeFunctionResult(e,t){if(typeof e=="string"){const i=this.getFunction(e);x(i,"unknown function","fragment",e),e=i}let r="invalid length for result data";const s=Nr(t);if(s.length%32===0)try{return y(this,or).decode(e.outputs,s)}catch{r="could not decode result data"}K(!1,r,"BAD_DATA",{value:Ee(s),info:{method:e.name,signature:e.format()}})}makeError(e,t){const r=ot(e,"data"),s=gm.getBuiltinCallException("call",t,r);if(s.message.startsWith("execution reverted (unknown custom error)")){const a=Ee(r.slice(0,4)),c=this.getError(a);if(c)try{const l=y(this,or).decode(c.inputs,r.slice(4));s.revert={name:c.name,signature:c.format(),args:l},s.reason=s.revert.signature,s.message=`execution reverted: ${s.reason}`}catch{s.message="execution reverted (coult not decode custom error)"}}const o=this.parseTransaction(t);return o&&(s.invocation={method:o.name,signature:o.signature,args:o.args}),s}encodeFunctionResult(e,t){if(typeof e=="string"){const r=this.getFunction(e);x(r,"unknown function","fragment",e),e=r}return Ee(y(this,or).encode(e.outputs,t||[]))}encodeFilterTopics(e,t){if(typeof e=="string"){const i=this.getEvent(e);x(i,"unknown event","eventFragment",e),e=i}K(t.length<=e.inputs.length,`too many arguments for ${e.format()}`,"UNEXPECTED_ARGUMENT",{count:t.length,expectedCount:e.inputs.length});const r=[];e.anonymous||r.push(e.topicHash);const s=(i,o)=>i.type==="string"?Iu(o):i.type==="bytes"?pn(Ee(o)):(i.type==="bool"&&typeof o=="boolean"?o=o?"0x01":"0x00":i.type.match(/^u?int/)?o=Fc(o):i.type.match(/^bytes/)?o=Zce(o,32):i.type==="address"&&y(this,or).encode(["address"],[o]),Au(Ee(o),32));for(t.forEach((i,o)=>{const a=e.inputs[o];if(!a.indexed){x(i==null,"cannot filter non-indexed parameters; must be null","contract."+a.name,i);return}i==null?r.push(null):a.baseType==="array"||a.baseType==="tuple"?x(!1,"filtering with tuples or arrays not supported","contract."+a.name,i):Array.isArray(i)?r.push(i.map(c=>s(a,c))):r.push(s(a,i))});r.length&&r[r.length-1]===null;)r.pop();return r}encodeEventLog(e,t){if(typeof e=="string"){const o=this.getEvent(e);x(o,"unknown event","eventFragment",e),e=o}const r=[],s=[],i=[];return e.anonymous||r.push(e.topicHash),x(t.length===e.inputs.length,"event arguments/values mismatch","values",t),e.inputs.forEach((o,a)=>{const c=t[a];if(o.indexed)if(o.type==="string")r.push(Iu(c));else if(o.type==="bytes")r.push(pn(c));else{if(o.baseType==="tuple"||o.baseType==="array")throw new Error("not implemented");r.push(y(this,or).encode([o.type],[c]))}else s.push(o),i.push(c)}),{data:y(this,or).encode(s,i),topics:r}}decodeEventLog(e,t,r){if(typeof e=="string"){const f=this.getEvent(e);x(f,"unknown event","eventFragment",e),e=f}if(r!=null&&!e.anonymous){const f=e.topicHash;x(Ut(r[0],32)&&r[0].toLowerCase()===f,"fragment/topic mismatch","topics[0]",r[0]),r=r.slice(1)}const s=[],i=[],o=[];e.inputs.forEach((f,p)=>{f.indexed?f.type==="string"||f.type==="bytes"||f.baseType==="tuple"||f.baseType==="array"?(s.push(Wn.from({type:"bytes32",name:f.name})),o.push(!0)):(s.push(f),o.push(!1)):(i.push(f),o.push(!1))});const a=r!=null?y(this,or).decode(s,on(r)):null,c=y(this,or).decode(i,t,!0),l=[],u=[];let h=0,d=0;return e.inputs.forEach((f,p)=>{let g=null;if(f.indexed)if(a==null)g=new GR(null);else if(o[p])g=new GR(a[d++]);else try{g=a[d++]}catch(m){g=m}else try{g=c[h++]}catch(m){g=m}l.push(g),u.push(f.name||null)}),rb.fromItems(l,u)}parseTransaction(e){const t=ot(e.data,"tx.data"),r=Ae(e.value!=null?e.value:0,"tx.value"),s=this.getFunction(Ee(t.slice(0,4)));if(!s)return null;const i=y(this,or).decode(s.inputs,t.slice(4));return new Nde(s,s.selector,i,r)}parseCallResult(e){throw new Error("@TODO")}parseLog(e){const t=this.getEvent(e.topics[0]);return!t||t.anonymous?null:new Tde(t,t.topicHash,this.decodeEventLog(t,e.data,e.topics))}parseError(e){const t=Ee(e),r=this.getError(Zt(t,0,4));if(!r)return null;const s=y(this,or).decode(r.inputs,Zt(t,4));return new Ode(r,r.selector,s)}static from(e){return e instanceof bl?e:typeof e=="string"?new bl(JSON.parse(e)):typeof e.formatJson=="function"?new bl(e.formatJson()):typeof e.format=="function"?new bl(e.format("json")):new bl(e)}};Ji=new WeakMap,Xi=new WeakMap,eo=new WeakMap,or=new WeakMap,kd=new WeakSet,l0=function(e,t,r){if(Ut(e)){const i=e.toLowerCase();for(const o of y(this,eo).values())if(i===o.selector)return o;return null}if(e.indexOf("(")===-1){const i=[];for(const[o,a]of y(this,eo))o.split("(")[0]===e&&i.push(a);if(t){const o=t.length>0?t[t.length-1]:null;let a=t.length,c=!0;gr.isTyped(o)&&o.type==="overrides"&&(c=!1,a--);for(let l=i.length-1;l>=0;l--){const u=i[l].inputs.length;u!==a&&(!c||u!==a-1)&&i.splice(l,1)}for(let l=i.length-1;l>=0;l--){const u=i[l].inputs;for(let h=0;h<t.length;h++)if(gr.isTyped(t[h])){if(h>=u.length){if(t[h].type==="overrides")continue;i.splice(l,1);break}if(t[h].type!==u[h].baseType){i.splice(l,1);break}}}}if(i.length===1&&t&&t.length!==i[0].inputs.length){const o=t[t.length-1];(o==null||Array.isArray(o)||typeof o!="object")&&i.splice(0,1)}if(i.length===0)return null;if(i.length>1&&r){const o=i.map(a=>JSON.stringify(a.format())).join(", ");x(!1,`ambiguous function description (i.e. matches ${o})`,"key",e)}return i[0]}const s=y(this,eo).get(co.from(e).format());return s||null},Dd=new WeakSet,u0=function(e,t,r){if(Ut(e)){const i=e.toLowerCase();for(const o of y(this,Xi).values())if(i===o.topicHash)return o;return null}if(e.indexOf("(")===-1){const i=[];for(const[o,a]of y(this,Xi))o.split("(")[0]===e&&i.push(a);if(t){for(let o=i.length-1;o>=0;o--)i[o].inputs.length<t.length&&i.splice(o,1);for(let o=i.length-1;o>=0;o--){const a=i[o].inputs;for(let c=0;c<t.length;c++)if(gr.isTyped(t[c])&&t[c].type!==a[c].baseType){i.splice(o,1);break}}}if(i.length===0)return null;if(i.length>1&&r){const o=i.map(a=>JSON.stringify(a.format())).join(", ");x(!1,`ambiguous event description (i.e. matches ${o})`,"key",e)}return i[0]}const s=y(this,Xi).get(ao.from(e).format());return s||null};let qC=bl;const o4=BigInt(0);function nd(n){return n??null}function tn(n){return n==null?null:n.toString()}class QR{constructor(e,t,r){B(this,"gasPrice");B(this,"maxFeePerGas");B(this,"maxPriorityFeePerGas");Re(this,{gasPrice:nd(e),maxFeePerGas:nd(t),maxPriorityFeePerGas:nd(r)})}toJSON(){const{gasPrice:e,maxFeePerGas:t,maxPriorityFeePerGas:r}=this;return{_type:"FeeData",gasPrice:tn(e),maxFeePerGas:tn(t),maxPriorityFeePerGas:tn(r)}}}function db(n){const e={};n.to&&(e.to=n.to),n.from&&(e.from=n.from),n.data&&(e.data=Ee(n.data));const t="chainId,gasLimit,gasPrice,maxFeePerBlobGas,maxFeePerGas,maxPriorityFeePerGas,value".split(/,/);for(const s of t)!(s in n)||n[s]==null||(e[s]=Ae(n[s],`request.${s}`));const r="type,nonce".split(/,/);for(const s of r)!(s in n)||n[s]==null||(e[s]=We(n[s],`request.${s}`));return n.accessList&&(e.accessList=qu(n.accessList)),"blockTag"in n&&(e.blockTag=n.blockTag),"enableCcipRead"in n&&(e.enableCcipRead=!!n.enableCcipRead),"customData"in n&&(e.customData=n.customData),"blobVersionedHashes"in n&&n.blobVersionedHashes&&(e.blobVersionedHashes=n.blobVersionedHashes.slice()),"kzg"in n&&(e.kzg=n.kzg),"blobs"in n&&n.blobs&&(e.blobs=n.blobs.map(s=>z_(s)?Ee(s):Object.assign({},s))),e}var Jo;class xde{constructor(e,t){B(this,"provider");B(this,"number");B(this,"hash");B(this,"timestamp");B(this,"parentHash");B(this,"parentBeaconBlockRoot");B(this,"nonce");B(this,"difficulty");B(this,"gasLimit");B(this,"gasUsed");B(this,"stateRoot");B(this,"receiptsRoot");B(this,"blobGasUsed");B(this,"excessBlobGas");B(this,"miner");B(this,"prevRandao");B(this,"extraData");B(this,"baseFeePerGas");F(this,Jo,void 0);_(this,Jo,e.transactions.map(r=>typeof r!="string"?new mm(r,t):r)),Re(this,{provider:t,hash:nd(e.hash),number:e.number,timestamp:e.timestamp,parentHash:e.parentHash,parentBeaconBlockRoot:e.parentBeaconBlockRoot,nonce:e.nonce,difficulty:e.difficulty,gasLimit:e.gasLimit,gasUsed:e.gasUsed,blobGasUsed:e.blobGasUsed,excessBlobGas:e.excessBlobGas,miner:e.miner,prevRandao:nd(e.prevRandao),extraData:e.extraData,baseFeePerGas:nd(e.baseFeePerGas),stateRoot:e.stateRoot,receiptsRoot:e.receiptsRoot})}get transactions(){return y(this,Jo).map(e=>typeof e=="string"?e:e.hash)}get prefetchedTransactions(){const e=y(this,Jo).slice();return e.length===0?[]:(K(typeof e[0]=="object","transactions were not prefetched with block request","UNSUPPORTED_OPERATION",{operation:"transactionResponses()"}),e)}toJSON(){const{baseFeePerGas:e,difficulty:t,extraData:r,gasLimit:s,gasUsed:i,hash:o,miner:a,prevRandao:c,nonce:l,number:u,parentHash:h,parentBeaconBlockRoot:d,stateRoot:f,receiptsRoot:p,timestamp:g,transactions:m}=this;return{_type:"Block",baseFeePerGas:tn(e),difficulty:tn(t),extraData:r,gasLimit:tn(s),gasUsed:tn(i),blobGasUsed:tn(this.blobGasUsed),excessBlobGas:tn(this.excessBlobGas),hash:o,miner:a,prevRandao:c,nonce:l,number:u,parentHash:h,timestamp:g,parentBeaconBlockRoot:d,stateRoot:f,receiptsRoot:p,transactions:m}}[Symbol.iterator](){let e=0;const t=this.transactions;return{next:()=>e<this.length?{value:t[e++],done:!1}:{value:void 0,done:!0}}}get length(){return y(this,Jo).length}get date(){return this.timestamp==null?null:new Date(this.timestamp*1e3)}async getTransaction(e){let t;if(typeof e=="number")t=y(this,Jo)[e];else{const r=e.toLowerCase();for(const s of y(this,Jo))if(typeof s=="string"){if(s!==r)continue;t=s;break}else{if(s.hash===r)continue;t=s;break}}if(t==null)throw new Error("no such tx");return typeof t=="string"?await this.provider.getTransaction(t):t}getPrefetchedTransaction(e){const t=this.prefetchedTransactions;if(typeof e=="number")return t[e];e=e.toLowerCase();for(const r of t)if(r.hash===e)return r;x(!1,"no matching transaction","indexOrHash",e)}isMined(){return!!this.hash}isLondon(){return!!this.baseFeePerGas}orphanedEvent(){if(!this.isMined())throw new Error("");return Rde(this)}}Jo=new WeakMap;class Ay{constructor(e,t){B(this,"provider");B(this,"transactionHash");B(this,"blockHash");B(this,"blockNumber");B(this,"removed");B(this,"address");B(this,"data");B(this,"topics");B(this,"index");B(this,"transactionIndex");this.provider=t;const r=Object.freeze(e.topics.slice());Re(this,{transactionHash:e.transactionHash,blockHash:e.blockHash,blockNumber:e.blockNumber,removed:e.removed,address:e.address,data:e.data,topics:r,index:e.index,transactionIndex:e.transactionIndex})}toJSON(){const{address:e,blockHash:t,blockNumber:r,data:s,index:i,removed:o,topics:a,transactionHash:c,transactionIndex:l}=this;return{_type:"log",address:e,blockHash:t,blockNumber:r,data:s,index:i,removed:o,topics:a,transactionHash:c,transactionIndex:l}}async getBlock(){const e=await this.provider.getBlock(this.blockHash);return K(!!e,"failed to find transaction","UNKNOWN_ERROR",{}),e}async getTransaction(){const e=await this.provider.getTransaction(this.transactionHash);return K(!!e,"failed to find transaction","UNKNOWN_ERROR",{}),e}async getTransactionReceipt(){const e=await this.provider.getTransactionReceipt(this.transactionHash);return K(!!e,"failed to find transaction receipt","UNKNOWN_ERROR",{}),e}removedEvent(){return Pde(this)}}var Hm;class a4{constructor(e,t){B(this,"provider");B(this,"to");B(this,"from");B(this,"contractAddress");B(this,"hash");B(this,"index");B(this,"blockHash");B(this,"blockNumber");B(this,"logsBloom");B(this,"gasUsed");B(this,"blobGasUsed");B(this,"cumulativeGasUsed");B(this,"gasPrice");B(this,"blobGasPrice");B(this,"type");B(this,"status");B(this,"root");F(this,Hm,void 0);_(this,Hm,Object.freeze(e.logs.map(s=>new Ay(s,t))));let r=o4;e.effectiveGasPrice!=null?r=e.effectiveGasPrice:e.gasPrice!=null&&(r=e.gasPrice),Re(this,{provider:t,to:e.to,from:e.from,contractAddress:e.contractAddress,hash:e.hash,index:e.index,blockHash:e.blockHash,blockNumber:e.blockNumber,logsBloom:e.logsBloom,gasUsed:e.gasUsed,cumulativeGasUsed:e.cumulativeGasUsed,blobGasUsed:e.blobGasUsed,gasPrice:r,blobGasPrice:e.blobGasPrice,type:e.type,status:e.status,root:e.root})}get logs(){return y(this,Hm)}toJSON(){const{to:e,from:t,contractAddress:r,hash:s,index:i,blockHash:o,blockNumber:a,logsBloom:c,logs:l,status:u,root:h}=this;return{_type:"TransactionReceipt",blockHash:o,blockNumber:a,contractAddress:r,cumulativeGasUsed:tn(this.cumulativeGasUsed),from:t,gasPrice:tn(this.gasPrice),blobGasUsed:tn(this.blobGasUsed),blobGasPrice:tn(this.blobGasPrice),gasUsed:tn(this.gasUsed),hash:s,index:i,logs:l,logsBloom:c,root:h,status:u,to:e}}get length(){return this.logs.length}[Symbol.iterator](){let e=0;return{next:()=>e<this.length?{value:this.logs[e++],done:!1}:{value:void 0,done:!0}}}get fee(){return this.gasUsed*this.gasPrice}async getBlock(){const e=await this.provider.getBlock(this.blockHash);if(e==null)throw new Error("TODO");return e}async getTransaction(){const e=await this.provider.getTransaction(this.hash);if(e==null)throw new Error("TODO");return e}async getResult(){return await this.provider.getTransactionResult(this.hash)}async confirmations(){return await this.provider.getBlockNumber()-this.blockNumber+1}removedEvent(){return l4(this)}reorderedEvent(e){return K(!e||e.isMined(),"unmined 'other' transction cannot be orphaned","UNSUPPORTED_OPERATION",{operation:"reorderedEvent(other)"}),c4(this,e)}}Hm=new WeakMap;var fc;const TT=class TT{constructor(e,t){B(this,"provider");B(this,"blockNumber");B(this,"blockHash");B(this,"index");B(this,"hash");B(this,"type");B(this,"to");B(this,"from");B(this,"nonce");B(this,"gasLimit");B(this,"gasPrice");B(this,"maxPriorityFeePerGas");B(this,"maxFeePerGas");B(this,"maxFeePerBlobGas");B(this,"data");B(this,"value");B(this,"chainId");B(this,"signature");B(this,"accessList");B(this,"blobVersionedHashes");F(this,fc,void 0);this.provider=t,this.blockNumber=e.blockNumber!=null?e.blockNumber:null,this.blockHash=e.blockHash!=null?e.blockHash:null,this.hash=e.hash,this.index=e.index,this.type=e.type,this.from=e.from,this.to=e.to||null,this.gasLimit=e.gasLimit,this.nonce=e.nonce,this.data=e.data,this.value=e.value,this.gasPrice=e.gasPrice,this.maxPriorityFeePerGas=e.maxPriorityFeePerGas!=null?e.maxPriorityFeePerGas:null,this.maxFeePerGas=e.maxFeePerGas!=null?e.maxFeePerGas:null,this.maxFeePerBlobGas=e.maxFeePerBlobGas!=null?e.maxFeePerBlobGas:null,this.chainId=e.chainId,this.signature=e.signature,this.accessList=e.accessList!=null?e.accessList:null,this.blobVersionedHashes=e.blobVersionedHashes!=null?e.blobVersionedHashes:null,_(this,fc,-1)}toJSON(){const{blockNumber:e,blockHash:t,index:r,hash:s,type:i,to:o,from:a,nonce:c,data:l,signature:u,accessList:h,blobVersionedHashes:d}=this;return{_type:"TransactionResponse",accessList:h,blockNumber:e,blockHash:t,blobVersionedHashes:d,chainId:tn(this.chainId),data:l,from:a,gasLimit:tn(this.gasLimit),gasPrice:tn(this.gasPrice),hash:s,maxFeePerGas:tn(this.maxFeePerGas),maxPriorityFeePerGas:tn(this.maxPriorityFeePerGas),maxFeePerBlobGas:tn(this.maxFeePerBlobGas),nonce:c,signature:u,to:o,index:r,type:i,value:tn(this.value)}}async getBlock(){let e=this.blockNumber;if(e==null){const r=await this.getTransaction();r&&(e=r.blockNumber)}if(e==null)return null;const t=this.provider.getBlock(e);if(t==null)throw new Error("TODO");return t}async getTransaction(){return this.provider.getTransaction(this.hash)}async confirmations(){if(this.blockNumber==null){const{tx:t,blockNumber:r}=await Sr({tx:this.getTransaction(),blockNumber:this.provider.getBlockNumber()});return t==null||t.blockNumber==null?0:r-t.blockNumber+1}return await this.provider.getBlockNumber()-this.blockNumber+1}async wait(e,t){const r=e??1,s=t??0;let i=y(this,fc),o=-1,a=i===-1;const c=async()=>{if(a)return null;const{blockNumber:d,nonce:f}=await Sr({blockNumber:this.provider.getBlockNumber(),nonce:this.provider.getTransactionCount(this.from)});if(f<this.nonce){i=d;return}if(a)return null;const p=await this.getTransaction();if(!(p&&p.blockNumber!=null))for(o===-1&&(o=i-3,o<y(this,fc)&&(o=y(this,fc)));o<=d;){if(a)return null;const g=await this.provider.getBlock(o,!0);if(g==null)return;for(const m of g)if(m===this.hash)return;for(let m=0;m<g.length;m++){const w=await g.getTransaction(m);if(w.from===this.from&&w.nonce===this.nonce){if(a)return null;const v=await this.provider.getTransactionReceipt(w.hash);if(v==null||d-v.blockNumber+1<r)return;let A="replaced";w.data===this.data&&w.to===this.to&&w.value===this.value?A="repriced":w.data==="0x"&&w.from===w.to&&w.value===o4&&(A="cancelled"),K(!1,"transaction was replaced","TRANSACTION_REPLACED",{cancelled:A==="replaced"||A==="cancelled",reason:A,replacement:w.replaceableTransaction(i),hash:w.hash,receipt:v})}}o++}},l=d=>{if(d==null||d.status!==0)return d;K(!1,"transaction execution reverted","CALL_EXCEPTION",{action:"sendTransaction",data:null,reason:null,invocation:null,revert:null,transaction:{to:d.to,from:d.from,data:""},receipt:d})},u=await this.provider.getTransactionReceipt(this.hash);if(r===0)return l(u);if(u){if(await u.confirmations()>=r)return l(u)}else if(await c(),r===0)return null;return await new Promise((d,f)=>{const p=[],g=()=>{p.forEach(w=>w())};if(p.push(()=>{a=!0}),s>0){const w=setTimeout(()=>{g(),f(un("wait for transaction timeout","TIMEOUT"))},s);p.push(()=>{clearTimeout(w)})}const m=async w=>{if(await w.confirmations()>=r){g();try{d(l(w))}catch(v){f(v)}}};if(p.push(()=>{this.provider.off(this.hash,m)}),this.provider.on(this.hash,m),i>=0){const w=async()=>{try{await c()}catch(v){if(pr(v,"TRANSACTION_REPLACED")){g(),f(v);return}}a||this.provider.once("block",w)};p.push(()=>{this.provider.off("block",w)}),this.provider.once("block",w)}})}isMined(){return this.blockHash!=null}isLegacy(){return this.type===0}isBerlin(){return this.type===1}isLondon(){return this.type===2}isCancun(){return this.type===3}removedEvent(){return K(this.isMined(),"unmined transaction canot be orphaned","UNSUPPORTED_OPERATION",{operation:"removeEvent()"}),l4(this)}reorderedEvent(e){return K(this.isMined(),"unmined transaction canot be orphaned","UNSUPPORTED_OPERATION",{operation:"removeEvent()"}),K(!e||e.isMined(),"unmined 'other' transaction canot be orphaned","UNSUPPORTED_OPERATION",{operation:"removeEvent()"}),c4(this,e)}replaceableTransaction(e){x(Number.isInteger(e)&&e>=0,"invalid startBlock","startBlock",e);const t=new TT(this,this.provider);return _(t,fc,e),t}};fc=new WeakMap;let mm=TT;function Rde(n){return{orphan:"drop-block",hash:n.hash,number:n.number}}function c4(n,e){return{orphan:"reorder-transaction",tx:n,other:e}}function l4(n){return{orphan:"drop-transaction",tx:n}}function Pde(n){return{orphan:"drop-log",log:{transactionHash:n.transactionHash,blockHash:n.blockHash,blockNumber:n.blockNumber,address:n.address,data:n.data,topics:Object.freeze(n.topics.slice()),index:n.index}}}class aS extends Ay{constructor(t,r,s){super(t,t.provider);B(this,"interface");B(this,"fragment");B(this,"args");const i=r.decodeEventLog(s,t.data,t.topics);Re(this,{args:i,fragment:s,interface:r})}get eventName(){return this.fragment.name}get eventSignature(){return this.fragment.format()}}class u4 extends Ay{constructor(t,r){super(t,t.provider);B(this,"error");Re(this,{error:r})}}var Ud;class kde extends a4{constructor(t,r,s){super(s,r);F(this,Ud,void 0);_(this,Ud,t)}get logs(){return super.logs.map(t=>{const r=t.topics.length?y(this,Ud).getEvent(t.topics[0]):null;if(r)try{return new aS(t,y(this,Ud),r)}catch(s){return new u4(t,s)}return t})}}Ud=new WeakMap;var Vm;class cS extends mm{constructor(t,r,s){super(s,r);F(this,Vm,void 0);_(this,Vm,t)}async wait(t,r){const s=await super.wait(t,r);return s==null?null:new kde(y(this,Vm),this.provider,s)}}Vm=new WeakMap;class h4 extends $M{constructor(t,r,s,i){super(t,r,s);B(this,"log");Re(this,{log:i})}async getBlock(){return await this.log.getBlock()}async getTransaction(){return await this.log.getTransaction()}async getTransactionReceipt(){return await this.log.getTransactionReceipt()}}class Dde extends h4{constructor(e,t,r,s,i){super(e,t,r,new aS(i,e.interface,s));const o=e.interface.decodeEventLog(s,this.log.data,this.log.topics);Re(this,{args:o,fragment:s})}get eventName(){return this.fragment.name}get eventSignature(){return this.fragment.format()}}const ZR=BigInt(0);function d4(n){return n&&typeof n.call=="function"}function f4(n){return n&&typeof n.estimateGas=="function"}function IE(n){return n&&typeof n.resolveName=="function"}function p4(n){return n&&typeof n.sendTransaction=="function"}function g4(n){if(n!=null){if(IE(n))return n;if(n.provider)return n.provider}}var qm;class Ude{constructor(e,t,r){F(this,qm,void 0);B(this,"fragment");if(Re(this,{fragment:t}),t.inputs.length<r.length)throw new Error("too many arguments");const s=Tu(e.runner,"resolveName"),i=IE(s)?s:null;_(this,qm,async function(){const o=await Promise.all(t.inputs.map((a,c)=>r[c]==null?null:a.walkAsync(r[c],(u,h)=>u==="address"?Array.isArray(h)?Promise.all(h.map(d=>Pr(d,i))):Pr(h,i):h)));return e.interface.encodeFilterTopics(t,o)}())}getTopicFilter(){return y(this,qm)}}qm=new WeakMap;function Tu(n,e){return n==null?null:typeof n[e]=="function"?n:n.provider&&typeof n.provider[e]=="function"?n.provider:null}function xl(n){return n==null?null:n.provider||null}async function m4(n,e){const t=gr.dereference(n,"overrides");x(typeof t=="object","invalid overrides parameter","overrides",n);const r=db(t);return x(r.to==null||(e||[]).indexOf("to")>=0,"cannot override to","overrides.to",r.to),x(r.data==null||(e||[]).indexOf("data")>=0,"cannot override data","overrides.data",r.data),r.from&&(r.from=r.from),r}async function $de(n,e,t){const r=Tu(n,"resolveName"),s=IE(r)?r:null;return await Promise.all(e.map((i,o)=>i.walkAsync(t[o],(a,c)=>(c=gr.dereference(c,a),a==="address"?Pr(c,s):c))))}function Mde(n){const e=async function(o){const a=await m4(o,["data"]);a.to=await n.getAddress(),a.from&&(a.from=await Pr(a.from,g4(n.runner)));const c=n.interface,l=Ae(a.value||ZR,"overrides.value")===ZR,u=(a.data||"0x")==="0x";c.fallback&&!c.fallback.payable&&c.receive&&!u&&!l&&x(!1,"cannot send data to receive or send value to non-payable fallback","overrides",o),x(c.fallback||u,"cannot send data to receive-only contract","overrides.data",a.data);const h=c.receive||c.fallback&&c.fallback.payable;return x(h||l,"cannot send value to non-payable fallback","overrides.value",a.value),x(c.fallback||u,"cannot send data to receive-only contract","overrides.data",a.data),a},t=async function(o){const a=Tu(n.runner,"call");K(d4(a),"contract runner does not support calling","UNSUPPORTED_OPERATION",{operation:"call"});const c=await e(o);try{return await a.call(c)}catch(l){throw q_(l)&&l.data?n.interface.makeError(l.data,c):l}},r=async function(o){const a=n.runner;K(p4(a),"contract runner does not support sending transactions","UNSUPPORTED_OPERATION",{operation:"sendTransaction"});const c=await a.sendTransaction(await e(o)),l=xl(n.runner);return new cS(n.interface,l,c)},s=async function(o){const a=Tu(n.runner,"estimateGas");return K(f4(a),"contract runner does not support gas estimation","UNSUPPORTED_OPERATION",{operation:"estimateGas"}),await a.estimateGas(await e(o))},i=async o=>await r(o);return Re(i,{_contract:n,estimateGas:s,populateTransaction:e,send:r,staticCall:t}),i}function Lde(n,e){const t=function(...l){const u=n.interface.getFunction(e,l);return K(u,"no matching fragment","UNSUPPORTED_OPERATION",{operation:"fragment",info:{key:e,args:l}}),u},r=async function(...l){const u=t(...l);let h={};if(u.inputs.length+1===l.length&&(h=await m4(l.pop()),h.from&&(h.from=await Pr(h.from,g4(n.runner)))),u.inputs.length!==l.length)throw new Error("internal error: fragment inputs doesn't match arguments; should not happen");const d=await $de(n.runner,u.inputs,l);return Object.assign({},h,await Sr({to:n.getAddress(),data:n.interface.encodeFunctionData(u,d)}))},s=async function(...l){const u=await a(...l);return u.length===1?u[0]:u},i=async function(...l){const u=n.runner;K(p4(u),"contract runner does not support sending transactions","UNSUPPORTED_OPERATION",{operation:"sendTransaction"});const h=await u.sendTransaction(await r(...l)),d=xl(n.runner);return new cS(n.interface,d,h)},o=async function(...l){const u=Tu(n.runner,"estimateGas");return K(f4(u),"contract runner does not support gas estimation","UNSUPPORTED_OPERATION",{operation:"estimateGas"}),await u.estimateGas(await r(...l))},a=async function(...l){const u=Tu(n.runner,"call");K(d4(u),"contract runner does not support calling","UNSUPPORTED_OPERATION",{operation:"call"});const h=await r(...l);let d="0x";try{d=await u.call(h)}catch(p){throw q_(p)&&p.data?n.interface.makeError(p.data,h):p}const f=t(...l);return n.interface.decodeFunctionResult(f,d)},c=async(...l)=>t(...l).constant?await s(...l):await i(...l);return Re(c,{name:n.interface.getFunctionName(e),_contract:n,_key:e,getFragment:t,estimateGas:o,populateTransaction:r,send:i,staticCall:s,staticCallResult:a}),Object.defineProperty(c,"fragment",{configurable:!1,enumerable:!0,get:()=>{const l=n.interface.getFunction(e);return K(l,"no matching fragment","UNSUPPORTED_OPERATION",{operation:"fragment",info:{key:e}}),l}}),c}function Bde(n,e){const t=function(...s){const i=n.interface.getEvent(e,s);return K(i,"no matching fragment","UNSUPPORTED_OPERATION",{operation:"fragment",info:{key:e,args:s}}),i},r=function(...s){return new Ude(n,t(...s),s)};return Re(r,{name:n.interface.getEventName(e),_contract:n,_key:e,getFragment:t}),Object.defineProperty(r,"fragment",{configurable:!1,enumerable:!0,get:()=>{const s=n.interface.getEvent(e);return K(s,"no matching fragment","UNSUPPORTED_OPERATION",{operation:"fragment",info:{key:e}}),s}}),r}const fb=Symbol.for("_ethersInternal_contract"),y4=new WeakMap;function Fde(n,e){y4.set(n[fb],e)}function ys(n){return y4.get(n[fb])}function jde(n){return n&&typeof n=="object"&&"getTopicFilter"in n&&typeof n.getTopicFilter=="function"&&n.fragment}async function lS(n,e){let t,r=null;if(Array.isArray(e)){const i=function(o){if(Ut(o,32))return o;const a=n.interface.getEvent(o);return x(a,"unknown fragment","name",o),a.topicHash};t=e.map(o=>o==null?null:Array.isArray(o)?o.map(i):i(o))}else e==="*"?t=[null]:typeof e=="string"?Ut(e,32)?t=[e]:(r=n.interface.getEvent(e),x(r,"unknown fragment","event",e),t=[r.topicHash]):jde(e)?t=await e.getTopicFilter():"fragment"in e?(r=e.fragment,t=[r.topicHash]):x(!1,"unknown event name","event",e);t=t.map(i=>{if(i==null)return null;if(Array.isArray(i)){const o=Array.from(new Set(i.map(a=>a.toLowerCase())).values());return o.length===1?o[0]:(o.sort(),o)}return i.toLowerCase()});const s=t.map(i=>i==null?"null":Array.isArray(i)?i.join("|"):i).join("&");return{fragment:r,tag:s,topics:t}}async function Dp(n,e){const{subs:t}=ys(n);return t.get((await lS(n,e)).tag)||null}async function JR(n,e,t){const r=xl(n.runner);K(r,"contract runner does not support subscribing","UNSUPPORTED_OPERATION",{operation:e});const{fragment:s,tag:i,topics:o}=await lS(n,t),{addr:a,subs:c}=ys(n);let l=c.get(i);if(!l){const h={address:a||n,topics:o},d=m=>{let w=s;if(w==null)try{w=n.interface.getEvent(m.topics[0])}catch{}if(w){const v=w,A=s?n.interface.decodeEventLog(s,m.data,m.topics):[];WC(n,t,A,T=>new Dde(n,T,t,v,m))}else WC(n,t,[],v=>new h4(n,v,t,m))};let f=[];l={tag:i,listeners:[],start:()=>{f.length||f.push(r.on(h,d))},stop:async()=>{if(f.length==0)return;let m=f;f=[],await Promise.all(m),r.off(h,d)}},c.set(i,l)}return l}let zC=Promise.resolve();async function Hde(n,e,t,r){await zC;const s=await Dp(n,e);if(!s)return!1;const i=s.listeners.length;return s.listeners=s.listeners.filter(({listener:o,once:a})=>{const c=Array.from(t);r&&c.push(r(a?null:o));try{o.call(n,...c)}catch{}return!a}),s.listeners.length===0&&(s.stop(),ys(n).subs.delete(s.tag)),i>0}async function WC(n,e,t,r){try{await zC}catch{}const s=Hde(n,e,t,r);return zC=s,await s}const Pw=["then"];var Wbe;const dg=class dg{constructor(e,t,r,s){B(this,"target");B(this,"interface");B(this,"runner");B(this,"filters");B(this,Wbe);B(this,"fallback");x(typeof e=="string"||CL(e),"invalid value for Contract target","target",e),r==null&&(r=null);const i=qC.from(t);Re(this,{target:e,runner:r,interface:i}),Object.defineProperty(this,fb,{value:{}});let o,a=null,c=null;if(s){const h=xl(r);c=new cS(this.interface,h,s)}let l=new Map;if(typeof e=="string")if(Ut(e))a=e,o=Promise.resolve(e);else{const h=Tu(r,"resolveName");if(!IE(h))throw un("contract runner does not support name resolution","UNSUPPORTED_OPERATION",{operation:"resolveName"});o=h.resolveName(e).then(d=>{if(d==null)throw un("an ENS name used for a contract target must be correctly configured","UNCONFIGURED_NAME",{value:e});return ys(this).addr=d,d})}else o=e.getAddress().then(h=>{if(h==null)throw new Error("TODO");return ys(this).addr=h,h});Fde(this,{addrPromise:o,addr:a,deployTx:c,subs:l});const u=new Proxy({},{get:(h,d,f)=>{if(typeof d=="symbol"||Pw.indexOf(d)>=0)return Reflect.get(h,d,f);try{return this.getEvent(d)}catch(p){if(!pr(p,"INVALID_ARGUMENT")||p.argument!=="key")throw p}},has:(h,d)=>Pw.indexOf(d)>=0?Reflect.has(h,d):Reflect.has(h,d)||this.interface.hasEvent(String(d))});return Re(this,{filters:u}),Re(this,{fallback:i.receive||i.fallback?Mde(this):null}),new Proxy(this,{get:(h,d,f)=>{if(typeof d=="symbol"||d in h||Pw.indexOf(d)>=0)return Reflect.get(h,d,f);try{return h.getFunction(d)}catch(p){if(!pr(p,"INVALID_ARGUMENT")||p.argument!=="key")throw p}},has:(h,d)=>typeof d=="symbol"||d in h||Pw.indexOf(d)>=0?Reflect.has(h,d):h.interface.hasFunction(d)})}connect(e){return new dg(this.target,this.interface,e)}attach(e){return new dg(e,this.interface,this.runner)}async getAddress(){return await ys(this).addrPromise}async getDeployedCode(){const e=xl(this.runner);K(e,"runner does not support .provider","UNSUPPORTED_OPERATION",{operation:"getDeployedCode"});const t=await e.getCode(await this.getAddress());return t==="0x"?null:t}async waitForDeployment(){const e=this.deploymentTransaction();if(e)return await e.wait(),this;if(await this.getDeployedCode()!=null)return this;const r=xl(this.runner);return K(r!=null,"contract runner does not support .provider","UNSUPPORTED_OPERATION",{operation:"waitForDeployment"}),new Promise((s,i)=>{const o=async()=>{try{if(await this.getDeployedCode()!=null)return s(this);r.once("block",o)}catch(a){i(a)}};o()})}deploymentTransaction(){return ys(this).deployTx}getFunction(e){return typeof e!="string"&&(e=e.format()),Lde(this,e)}getEvent(e){return typeof e!="string"&&(e=e.format()),Bde(this,e)}async queryTransaction(e){throw new Error("@TODO")}async queryFilter(e,t,r){t==null&&(t=0),r==null&&(r="latest");const{addr:s,addrPromise:i}=ys(this),o=s||await i,{fragment:a,topics:c}=await lS(this,e),l={address:o,topics:c,fromBlock:t,toBlock:r},u=xl(this.runner);return K(u,"contract runner does not have a provider","UNSUPPORTED_OPERATION",{operation:"queryFilter"}),(await u.getLogs(l)).map(h=>{let d=a;if(d==null)try{d=this.interface.getEvent(h.topics[0])}catch{}if(d)try{return new aS(h,this.interface,d)}catch(f){return new u4(h,f)}return new Ay(h,u)})}async on(e,t){const r=await JR(this,"on",e);return r.listeners.push({listener:t,once:!1}),r.start(),this}async once(e,t){const r=await JR(this,"once",e);return r.listeners.push({listener:t,once:!0}),r.start(),this}async emit(e,...t){return await WC(this,e,t,null)}async listenerCount(e){if(e){const s=await Dp(this,e);return s?s.listeners.length:0}const{subs:t}=ys(this);let r=0;for(const{listeners:s}of t.values())r+=s.length;return r}async listeners(e){if(e){const s=await Dp(this,e);return s?s.listeners.map(({listener:i})=>i):[]}const{subs:t}=ys(this);let r=[];for(const{listeners:s}of t.values())r=r.concat(s.map(({listener:i})=>i));return r}async off(e,t){const r=await Dp(this,e);if(!r)return this;if(t){const s=r.listeners.map(({listener:i})=>i).indexOf(t);s>=0&&r.listeners.splice(s,1)}return(t==null||r.listeners.length===0)&&(r.stop(),ys(this).subs.delete(r.tag)),this}async removeAllListeners(e){if(e){const t=await Dp(this,e);if(!t)return this;t.stop(),ys(this).subs.delete(t.tag)}else{const{subs:t}=ys(this);for(const{tag:r,stop:s}of t.values())s(),t.delete(r)}return this}async addListener(e,t){return await this.on(e,t)}async removeListener(e,t){return await this.off(e,t)}static buildClass(e){class t extends dg{constructor(s,i=null){super(s,e,i)}}return t}static from(e,t,r){return r==null&&(r=null),new this(e,t,r)}};Wbe=fb;let GC=dg;function Vde(){return GC}class rd extends Vde(){}function D1(n){return n.match(/^ipfs:\/\/ipfs\//i)?n=n.substring(12):n.match(/^ipfs:\/\//i)?n=n.substring(7):x(!1,"unsupported IPFS format","link",n),`https://gateway.ipfs.io/ipfs/${n}`}class qde{constructor(e){B(this,"name");Re(this,{name:e})}connect(e){return this}supportsCoinType(e){return!1}async encodeAddress(e,t){throw new Error("unsupported coin")}async decodeAddress(e,t){throw new Error("unsupported coin")}}const w4=new RegExp("^(ipfs)://(.*)$","i"),XR=[new RegExp("^(https)://(.*)$","i"),new RegExp("^(data):(.*)$","i"),w4,new RegExp("^eip155:[0-9]+/(erc[0-9]+):(.*)$","i")];var pc,Gl,gc,Ph,$b,b4;const zh=class zh{constructor(e,t,r){F(this,gc);B(this,"provider");B(this,"address");B(this,"name");F(this,pc,void 0);F(this,Gl,void 0);Re(this,{provider:e,address:t,name:r}),_(this,pc,null),_(this,Gl,new rd(t,["function supportsInterface(bytes4) view returns (bool)","function resolve(bytes, bytes) view returns (bytes)","function addr(bytes32) view returns (address)","function addr(bytes32, uint) view returns (bytes)","function text(bytes32, string) view returns (string)","function contenthash(bytes32) view returns (bytes)"],e))}async supportsWildcard(){return y(this,pc)==null&&_(this,pc,(async()=>{try{return await y(this,Gl).supportsInterface("0x9061b923")}catch(e){if(pr(e,"CALL_EXCEPTION"))return!1;throw _(this,pc,null),e}})()),await y(this,pc)}async getAddress(e){if(e==null&&(e=60),e===60)try{const i=await Z(this,gc,Ph).call(this,"addr(bytes32)");return i==null||i===cm?null:i}catch(i){if(pr(i,"CALL_EXCEPTION"))return null;throw i}if(e>=0&&e<2147483648){let i=e+2147483648;const o=await Z(this,gc,Ph).call(this,"addr(bytes32,uint)",[i]);if(Ut(o,20))return Tt(o)}let t=null;for(const i of this.provider.plugins)if(i instanceof qde&&i.supportsCoinType(e)){t=i;break}if(t==null)return null;const r=await Z(this,gc,Ph).call(this,"addr(bytes32,uint)",[e]);if(r==null||r==="0x")return null;const s=await t.decodeAddress(e,r);if(s!=null)return s;K(!1,"invalid coin data","UNSUPPORTED_OPERATION",{operation:`getAddress(${e})`,info:{coinType:e,data:r}})}async getText(e){const t=await Z(this,gc,Ph).call(this,"text(bytes32,string)",[e]);return t==null||t==="0x"?null:t}async getContentHash(){const e=await Z(this,gc,Ph).call(this,"contenthash(bytes32)");if(e==null||e==="0x")return null;const t=e.match(/^0x(e3010170|e5010172)(([0-9a-f][0-9a-f])([0-9a-f][0-9a-f])([0-9a-f]*))$/);if(t){const s=t[1]==="e3010170"?"ipfs":"ipns",i=parseInt(t[4],16);if(t[5].length===i*2)return`${s}://${Xce("0x"+t[2])}`}const r=e.match(/^0xe40101fa011b20([0-9a-f]*)$/);if(r&&r[1].length===64)return`bzz://${r[1]}`;K(!1,"invalid or unsupported content hash data","UNSUPPORTED_OPERATION",{operation:"getContentHash()",info:{data:e}})}async getAvatar(){return(await this._getAvatar()).url}async _getAvatar(){const e=[{type:"name",value:this.name}];try{const t=await this.getText("avatar");if(t==null)return e.push({type:"!avatar",value:""}),{url:null,linkage:e};e.push({type:"avatar",value:t});for(let r=0;r<XR.length;r++){const s=t.match(XR[r]);if(s==null)continue;const i=s[1].toLowerCase();switch(i){case"https":case"data":return e.push({type:"url",value:t}),{linkage:e,url:t};case"ipfs":{const o=D1(t);return e.push({type:"ipfs",value:t}),e.push({type:"url",value:o}),{linkage:e,url:o}}case"erc721":case"erc1155":{const o=i==="erc721"?"tokenURI(uint256)":"uri(uint256)";e.push({type:i,value:t});const a=await this.getAddress();if(a==null)return e.push({type:"!owner",value:""}),{url:null,linkage:e};const c=(s[2]||"").split("/");if(c.length!==2)return e.push({type:`!${i}caip`,value:s[2]||""}),{url:null,linkage:e};const l=c[1],u=new rd(c[0],["function tokenURI(uint) view returns (string)","function ownerOf(uint) view returns (address)","function uri(uint) view returns (string)","function balanceOf(address, uint256) view returns (uint)"],this.provider);if(i==="erc721"){const g=await u.ownerOf(l);if(a!==g)return e.push({type:"!owner",value:g}),{url:null,linkage:e};e.push({type:"owner",value:g})}else if(i==="erc1155"){const g=await u.balanceOf(a,l);if(!g)return e.push({type:"!balance",value:"0"}),{url:null,linkage:e};e.push({type:"balance",value:g.toString()})}let h=await u[o](l);if(h==null||h==="0x")return e.push({type:"!metadata-url",value:""}),{url:null,linkage:e};e.push({type:"metadata-url-base",value:h}),i==="erc1155"&&(h=h.replace("{id}",Fc(l,32).substring(2)),e.push({type:"metadata-url-expanded",value:h})),h.match(/^ipfs:/i)&&(h=D1(h)),e.push({type:"metadata-url",value:h});let d={};const f=await new ba(h).send();f.assertOk();try{d=f.bodyJson}catch{try{e.push({type:"!metadata",value:f.bodyText})}catch{const w=f.body;return w&&e.push({type:"!metadata",value:Ee(w)}),{url:null,linkage:e}}return{url:null,linkage:e}}if(!d)return e.push({type:"!metadata",value:""}),{url:null,linkage:e};e.push({type:"metadata",value:JSON.stringify(d)});let p=d.image;if(typeof p!="string")return e.push({type:"!imageUrl",value:""}),{url:null,linkage:e};if(!p.match(/^(https:\/\/|data:)/i)){if(p.match(w4)==null)return e.push({type:"!imageUrl-ipfs",value:p}),{url:null,linkage:e};e.push({type:"imageUrl-ipfs",value:p}),p=D1(p)}return e.push({type:"url",value:p}),{linkage:e,url:p}}}}}catch{}return{linkage:e,url:null}}static async getEnsAddress(e){const t=await e.getNetwork(),r=t.getPlugin("org.ethers.plugins.network.Ens");return K(r,"network does not support ENS","UNSUPPORTED_OPERATION",{operation:"getEnsAddress",info:{network:t}}),r.address}static async fromName(e,t){var s;let r=t;for(;;){if(r===""||r==="."||t!=="eth"&&r==="eth")return null;const i=await Z(s=zh,$b,b4).call(s,e,r);if(i!=null){const o=new zh(e,i,t);return r!==t&&!await o.supportsWildcard()?null:o}r=r.split(".").slice(1).join(".")}}};pc=new WeakMap,Gl=new WeakMap,gc=new WeakSet,Ph=async function(e,t){t=(t||[]).slice();const r=y(this,Gl).interface;t.unshift(HC(this.name));let s=null;await this.supportsWildcard()&&(s=r.getFunction(e),K(s,"missing fragment","UNKNOWN_ERROR",{info:{funcName:e}}),t=[Vhe(this.name,255),r.encodeFunctionData(s,t)],e="resolve(bytes,bytes)"),t.push({enableCcipRead:!0});try{const i=await y(this,Gl)[e](...t);return s?r.decodeFunctionResult(s,i)[0]:i}catch(i){if(!pr(i,"CALL_EXCEPTION"))throw i}return null},$b=new WeakSet,b4=async function(e,t){const r=await zh.getEnsAddress(e);try{const i=await new rd(r,["function resolver(bytes32) view returns (address)"],e).resolver(HC(t),{enableCcipRead:!0});return i===cm?null:i}catch(s){throw s}return null},F(zh,$b);let pb=zh;const eP=BigInt(0);function it(n,e){return function(t){return t==null?e:n(t)}}function _E(n,e){return t=>{if(e&&t==null)return null;if(!Array.isArray(t))throw new Error("not an array");return t.map(r=>n(r))}}function Cy(n,e){return t=>{const r={};for(const s in n){let i=s;if(e&&s in e&&!(i in t)){for(const o of e[s])if(o in t){i=o;break}}try{const o=n[s](t[i]);o!==void 0&&(r[s]=o)}catch(o){const a=o instanceof Error?o.message:"not-an-error";K(!1,`invalid value for value.${s} (${a})`,"BAD_DATA",{value:t})}}return r}}function zde(n){switch(n){case!0:case"true":return!0;case!1:case"false":return!1}x(!1,`invalid boolean; ${JSON.stringify(n)}`,"value",n)}function yf(n){return x(Ut(n,!0),"invalid data","value",n),n}function Vn(n){return x(Ut(n,32),"invalid hash","value",n),n}const Wde=Cy({address:Tt,blockHash:Vn,blockNumber:We,data:yf,index:We,removed:it(zde,!1),topics:_E(Vn),transactionHash:Vn,transactionIndex:We},{index:["logIndex"]});function Gde(n){return Wde(n)}const Kde=Cy({hash:it(Vn),parentHash:Vn,parentBeaconBlockRoot:it(Vn,null),number:We,timestamp:We,nonce:it(yf),difficulty:Ae,gasLimit:Ae,gasUsed:Ae,stateRoot:it(Vn,null),receiptsRoot:it(Vn,null),blobGasUsed:it(Ae,null),excessBlobGas:it(Ae,null),miner:it(Tt),prevRandao:it(Vn,null),extraData:yf,baseFeePerGas:it(Ae)},{prevRandao:["mixHash"]});function Yde(n){const e=Kde(n);return e.transactions=n.transactions.map(t=>typeof t=="string"?t:E4(t)),e}const Qde=Cy({transactionIndex:We,blockNumber:We,transactionHash:Vn,address:Tt,topics:_E(Vn),data:yf,index:We,blockHash:Vn},{index:["logIndex"]});function Zde(n){return Qde(n)}const Jde=Cy({to:it(Tt,null),from:it(Tt,null),contractAddress:it(Tt,null),index:We,root:it(Ee),gasUsed:Ae,blobGasUsed:it(Ae,null),logsBloom:it(yf),blockHash:Vn,hash:Vn,logs:_E(Zde),blockNumber:We,cumulativeGasUsed:Ae,effectiveGasPrice:it(Ae),blobGasPrice:it(Ae,null),status:it(We),type:it(We,0)},{effectiveGasPrice:["gasPrice"],hash:["transactionHash"],index:["transactionIndex"]});function Xde(n){return Jde(n)}function E4(n){n.to&&Ae(n.to)===eP&&(n.to="0x0000000000000000000000000000000000000000");const e=Cy({hash:Vn,index:it(We,void 0),type:t=>t==="0x"||t==null?0:We(t),accessList:it(qu,null),blobVersionedHashes:it(_E(Vn,!0),null),blockHash:it(Vn,null),blockNumber:it(We,null),transactionIndex:it(We,null),from:Tt,gasPrice:it(Ae),maxPriorityFeePerGas:it(Ae),maxFeePerGas:it(Ae),maxFeePerBlobGas:it(Ae,null),gasLimit:Ae,to:it(Tt,null),value:Ae,nonce:We,data:yf,creates:it(Tt,null),chainId:it(Ae,null)},{data:["input"],gasLimit:["gas"],index:["transactionIndex"]})(n);if(e.to==null&&e.creates==null&&(e.creates=Wue(e)),(n.type===1||n.type===2)&&n.accessList==null&&(e.accessList=[]),n.signature?e.signature=Di.from(n.signature):e.signature=Di.from(n),e.chainId==null){const t=e.signature.legacyChainId;t!=null&&(e.chainId=t)}return e.blockHash&&Ae(e.blockHash)===eP&&(e.blockHash=null),e}const efe="0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e";class Iy{constructor(e){B(this,"name");Re(this,{name:e})}clone(){return new Iy(this.name)}}class SE extends Iy{constructor(t,r){t==null&&(t=0);super(`org.ethers.network.plugins.GasCost#${t||0}`);B(this,"effectiveBlock");B(this,"txBase");B(this,"txCreate");B(this,"txDataZero");B(this,"txDataNonzero");B(this,"txAccessListStorageKey");B(this,"txAccessListAddress");const s={effectiveBlock:t};function i(o,a){let c=(r||{})[o];c==null&&(c=a),x(typeof c=="number",`invalud value for ${o}`,"costs",r),s[o]=c}i("txBase",21e3),i("txCreate",32e3),i("txDataZero",4),i("txDataNonzero",16),i("txAccessListStorageKey",1900),i("txAccessListAddress",2400),Re(this,s)}clone(){return new SE(this.effectiveBlock,this)}}class TE extends Iy{constructor(t,r){super("org.ethers.plugins.network.Ens");B(this,"address");B(this,"targetNetwork");Re(this,{address:t||efe,targetNetwork:r??1})}clone(){return new TE(this.address,this.targetNetwork)}}var zm,Wm;class tfe extends Iy{constructor(t,r){super("org.ethers.plugins.network.FetchUrlFeeDataPlugin");F(this,zm,void 0);F(this,Wm,void 0);_(this,zm,t),_(this,Wm,r)}get url(){return y(this,zm)}get processFunc(){return y(this,Wm)}clone(){return this}}zm=new WeakMap,Wm=new WeakMap;const U1=new Map;var $d,Md,mc;const Wh=class Wh{constructor(e,t){F(this,$d,void 0);F(this,Md,void 0);F(this,mc,void 0);_(this,$d,e),_(this,Md,Ae(t)),_(this,mc,new Map)}toJSON(){return{name:this.name,chainId:String(this.chainId)}}get name(){return y(this,$d)}set name(e){_(this,$d,e)}get chainId(){return y(this,Md)}set chainId(e){_(this,Md,Ae(e,"chainId"))}matches(e){if(e==null)return!1;if(typeof e=="string"){try{return this.chainId===Ae(e)}catch{}return this.name===e}if(typeof e=="number"||typeof e=="bigint"){try{return this.chainId===Ae(e)}catch{}return!1}if(typeof e=="object"){if(e.chainId!=null){try{return this.chainId===Ae(e.chainId)}catch{}return!1}return e.name!=null?this.name===e.name:!1}return!1}get plugins(){return Array.from(y(this,mc).values())}attachPlugin(e){if(y(this,mc).get(e.name))throw new Error(`cannot replace existing plugin: ${e.name} `);return y(this,mc).set(e.name,e.clone()),this}getPlugin(e){return y(this,mc).get(e)||null}getPlugins(e){return this.plugins.filter(t=>t.name.split("#")[0]===e)}clone(){const e=new Wh(this.name,this.chainId);return this.plugins.forEach(t=>{e.attachPlugin(t.clone())}),e}computeIntrinsicGas(e){const t=this.getPlugin("org.ethers.plugins.network.GasCost")||new SE;let r=t.txBase;if(e.to==null&&(r+=t.txCreate),e.data)for(let s=2;s<e.data.length;s+=2)e.data.substring(s,s+2)==="00"?r+=t.txDataZero:r+=t.txDataNonzero;if(e.accessList){const s=qu(e.accessList);for(const i in s)r+=t.txAccessListAddress+t.txAccessListStorageKey*s[i].storageKeys.length}return r}static from(e){if(nfe(),e==null)return Wh.from("mainnet");if(typeof e=="number"&&(e=BigInt(e)),typeof e=="string"||typeof e=="bigint"){const t=U1.get(e);if(t)return t();if(typeof e=="bigint")return new Wh("unknown",e);x(!1,"unknown network","network",e)}if(typeof e.clone=="function")return e.clone();if(typeof e=="object"){x(typeof e.name=="string"&&typeof e.chainId=="number","invalid network object name or chainId","network",e);const t=new Wh(e.name,e.chainId);return(e.ensAddress||e.ensNetwork!=null)&&t.attachPlugin(new TE(e.ensAddress,e.ensNetwork)),t}x(!1,"invalid network","network",e)}static register(e,t){typeof e=="number"&&(e=BigInt(e));const r=U1.get(e);r&&x(!1,`conflicting network for ${JSON.stringify(r.name)}`,"nameOrChainId",e),U1.set(e,t)}};$d=new WeakMap,Md=new WeakMap,mc=new WeakMap;let fo=Wh;function tP(n,e){const t=String(n);if(!t.match(/^[0-9.]+$/))throw new Error(`invalid gwei value: ${n}`);const r=t.split(".");if(r.length===1&&r.push(""),r.length!==2)throw new Error(`invalid gwei value: ${n}`);for(;r[1].length<e;)r[1]+="0";if(r[1].length>9){let s=BigInt(r[1].substring(0,9));r[1].substring(9).match(/^0+$/)||s++,r[1]=s.toString()}return BigInt(r[0]+r[1])}function nP(n){return new tfe(n,async(e,t,r)=>{r.setHeader("User-Agent","ethers");let s;try{const[i,o]=await Promise.all([r.send(),e()]);s=i;const a=s.bodyJson.standard;return{gasPrice:o.gasPrice,maxFeePerGas:tP(a.maxFee,9),maxPriorityFeePerGas:tP(a.maxPriorityFee,9)}}catch(i){K(!1,`error encountered with polygon gas station (${JSON.stringify(r.url)})`,"SERVER_ERROR",{request:r,response:s,error:i})}})}let rP=!1;function nfe(){if(rP)return;rP=!0;function n(e,t,r){const s=function(){const i=new fo(e,t);return r.ensNetwork!=null&&i.attachPlugin(new TE(null,r.ensNetwork)),i.attachPlugin(new SE),(r.plugins||[]).forEach(o=>{i.attachPlugin(o)}),i};fo.register(e,s),fo.register(t,s),r.altNames&&r.altNames.forEach(i=>{fo.register(i,s)})}n("mainnet",1,{ensNetwork:1,altNames:["homestead"]}),n("ropsten",3,{ensNetwork:3}),n("rinkeby",4,{ensNetwork:4}),n("goerli",5,{ensNetwork:5}),n("kovan",42,{ensNetwork:42}),n("sepolia",11155111,{ensNetwork:11155111}),n("holesky",17e3,{ensNetwork:17e3}),n("classic",61,{}),n("classicKotti",6,{}),n("arbitrum",42161,{ensNetwork:1}),n("arbitrum-goerli",421613,{}),n("arbitrum-sepolia",421614,{}),n("base",8453,{ensNetwork:1}),n("base-goerli",84531,{}),n("base-sepolia",84532,{}),n("bnb",56,{ensNetwork:1}),n("bnbt",97,{}),n("linea",59144,{ensNetwork:1}),n("linea-goerli",59140,{}),n("linea-sepolia",59141,{}),n("matic",137,{ensNetwork:1,plugins:[nP("https://gasstation.polygon.technology/v2")]}),n("matic-amoy",80002,{}),n("matic-mumbai",80001,{altNames:["maticMumbai","maticmum"],plugins:[nP("https://gasstation-testnet.polygon.technology/v2")]}),n("optimism",10,{ensNetwork:1,plugins:[]}),n("optimism-goerli",420,{}),n("optimism-sepolia",11155420,{}),n("xdai",100,{ensNetwork:1})}function KC(n){return JSON.parse(JSON.stringify(n))}var Xo,Vs,yc,to,Ld,h0;class rfe{constructor(e){F(this,Ld);F(this,Xo,void 0);F(this,Vs,void 0);F(this,yc,void 0);F(this,to,void 0);_(this,Xo,e),_(this,Vs,null),_(this,yc,4e3),_(this,to,-2)}get pollingInterval(){return y(this,yc)}set pollingInterval(e){_(this,yc,e)}start(){y(this,Vs)||(_(this,Vs,y(this,Xo)._setTimeout(Z(this,Ld,h0).bind(this),y(this,yc))),Z(this,Ld,h0).call(this))}stop(){y(this,Vs)&&(y(this,Xo)._clearTimeout(y(this,Vs)),_(this,Vs,null))}pause(e){this.stop(),e&&_(this,to,-2)}resume(){this.start()}}Xo=new WeakMap,Vs=new WeakMap,yc=new WeakMap,to=new WeakMap,Ld=new WeakSet,h0=async function(){try{const e=await y(this,Xo).getBlockNumber();if(y(this,to)===-2){_(this,to,e);return}if(e!==y(this,to)){for(let t=y(this,to)+1;t<=e;t++){if(y(this,Vs)==null)return;await y(this,Xo).emit("block",t)}_(this,to,e)}}catch{}y(this,Vs)!=null&&_(this,Vs,y(this,Xo)._setTimeout(Z(this,Ld,h0).bind(this),y(this,yc)))};var Kl,Yl,wc;class uS{constructor(e){F(this,Kl,void 0);F(this,Yl,void 0);F(this,wc,void 0);_(this,Kl,e),_(this,wc,!1),_(this,Yl,t=>{this._poll(t,y(this,Kl))})}async _poll(e,t){throw new Error("sub-classes must override this")}start(){y(this,wc)||(_(this,wc,!0),y(this,Yl).call(this,-2),y(this,Kl).on("block",y(this,Yl)))}stop(){y(this,wc)&&(_(this,wc,!1),y(this,Kl).off("block",y(this,Yl)))}pause(e){this.stop()}resume(){this.start()}}Kl=new WeakMap,Yl=new WeakMap,wc=new WeakMap;var Bd,ea;class sfe extends uS{constructor(t,r){super(t);F(this,Bd,void 0);F(this,ea,void 0);_(this,Bd,r),_(this,ea,-2)}pause(t){t&&_(this,ea,-2),super.pause(t)}async _poll(t,r){const s=await r.getBlock(y(this,Bd));s!=null&&(y(this,ea)===-2?_(this,ea,s.number):s.number>y(this,ea)&&(r.emit(y(this,Bd),s.number),_(this,ea,s.number)))}}Bd=new WeakMap,ea=new WeakMap;var Mb;class ife extends uS{constructor(t,r){super(t);F(this,Mb,void 0);_(this,Mb,KC(r))}async _poll(t,r){throw new Error("@TODO")}}Mb=new WeakMap;var Fd;class ofe extends uS{constructor(t,r){super(t);F(this,Fd,void 0);_(this,Fd,r)}async _poll(t,r){const s=await r.getTransactionReceipt(y(this,Fd));s&&r.emit(y(this,Fd),s)}}Fd=new WeakMap;var ta,jd,Hd,bc,qs,Lb,v4;class hS{constructor(e,t){F(this,Lb);F(this,ta,void 0);F(this,jd,void 0);F(this,Hd,void 0);F(this,bc,void 0);F(this,qs,void 0);_(this,ta,e),_(this,jd,KC(t)),_(this,Hd,Z(this,Lb,v4).bind(this)),_(this,bc,!1),_(this,qs,-2)}start(){y(this,bc)||(_(this,bc,!0),y(this,qs)===-2&&y(this,ta).getBlockNumber().then(e=>{_(this,qs,e)}),y(this,ta).on("block",y(this,Hd)))}stop(){y(this,bc)&&(_(this,bc,!1),y(this,ta).off("block",y(this,Hd)))}pause(e){this.stop(),e&&_(this,qs,-2)}resume(){this.start()}}ta=new WeakMap,jd=new WeakMap,Hd=new WeakMap,bc=new WeakMap,qs=new WeakMap,Lb=new WeakSet,v4=async function(e){if(y(this,qs)===-2)return;const t=KC(y(this,jd));t.fromBlock=y(this,qs)+1,t.toBlock=e;const r=await y(this,ta).getLogs(t);if(r.length===0){y(this,qs)<e-60&&_(this,qs,e-60);return}for(const s of r)y(this,ta).emit(y(this,jd),s),_(this,qs,s.blockNumber)};const afe=BigInt(2),cfe=10;function kw(n){return n&&typeof n.then=="function"}function d0(n,e){return n+":"+JSON.stringify(e,(t,r)=>{if(r==null)return"null";if(typeof r=="bigint")return`bigint:${r.toString()}`;if(typeof r=="string")return r.toLowerCase();if(typeof r=="object"&&!Array.isArray(r)){const s=Object.keys(r);return s.sort(),s.reduce((i,o)=>(i[o]=r[o],i),{})}return r})}class A4{constructor(e){B(this,"name");Re(this,{name:e})}start(){}stop(){}pause(e){}resume(){}}function lfe(n){return JSON.parse(JSON.stringify(n))}function YC(n){return n=Array.from(new Set(n).values()),n.sort(),n}async function $1(n,e){if(n==null)throw new Error("invalid event");if(Array.isArray(n)&&(n={topics:n}),typeof n=="string")switch(n){case"block":case"debug":case"error":case"finalized":case"network":case"pending":case"safe":return{type:n,tag:n}}if(Ut(n,32)){const t=n.toLowerCase();return{type:"transaction",tag:d0("tx",{hash:t}),hash:t}}if(n.orphan){const t=n;return{type:"orphan",tag:d0("orphan",t),filter:lfe(t)}}if(n.address||n.topics){const t=n,r={topics:(t.topics||[]).map(s=>s==null?null:Array.isArray(s)?YC(s.map(i=>i.toLowerCase())):s.toLowerCase())};if(t.address){const s=[],i=[],o=a=>{Ut(a)?s.push(a):i.push((async()=>{s.push(await Pr(a,e))})())};Array.isArray(t.address)?t.address.forEach(o):o(t.address),i.length&&await Promise.all(i),r.address=YC(s.map(a=>a.toLowerCase()))}return{filter:r,tag:d0("event",r),type:"event"}}x(!1,"unknown ProviderEvent","event",n)}function M1(){return new Date().getTime()}const ufe={cacheTimeout:250,pollingInterval:4e3};var ar,Ec,cr,Vd,vs,Ql,vc,na,Gm,zs,qd,zd,Cr,gs,Km,QC,Ym,ZC,Zl,Up,Qm,JC,Jl,$p,Wd,f0;class hfe{constructor(e,t){F(this,Cr);F(this,Km);F(this,Ym);F(this,Zl);F(this,Qm);F(this,Jl);F(this,Wd);F(this,ar,void 0);F(this,Ec,void 0);F(this,cr,void 0);F(this,Vd,void 0);F(this,vs,void 0);F(this,Ql,void 0);F(this,vc,void 0);F(this,na,void 0);F(this,Gm,void 0);F(this,zs,void 0);F(this,qd,void 0);F(this,zd,void 0);if(_(this,zd,Object.assign({},ufe,t||{})),e==="any")_(this,Ql,!0),_(this,vs,null);else if(e){const r=fo.from(e);_(this,Ql,!1),_(this,vs,Promise.resolve(r)),setTimeout(()=>{this.emit("network",r,null)},0)}else _(this,Ql,!1),_(this,vs,null);_(this,na,-1),_(this,vc,new Map),_(this,ar,new Map),_(this,Ec,new Map),_(this,cr,null),_(this,Vd,!1),_(this,Gm,1),_(this,zs,new Map),_(this,qd,!1)}get pollingInterval(){return y(this,zd).pollingInterval}get provider(){return this}get plugins(){return Array.from(y(this,Ec).values())}attachPlugin(e){if(y(this,Ec).get(e.name))throw new Error(`cannot replace existing plugin: ${e.name} `);return y(this,Ec).set(e.name,e.connect(this)),this}getPlugin(e){return y(this,Ec).get(e)||null}get disableCcipRead(){return y(this,qd)}set disableCcipRead(e){_(this,qd,!!e)}async ccipReadFetch(e,t,r){if(this.disableCcipRead||r.length===0||e.to==null)return null;const s=e.to.toLowerCase(),i=t.toLowerCase(),o=[];for(let a=0;a<r.length;a++){const c=r[a],l=c.replace("{sender}",s).replace("{data}",i),u=new ba(l);c.indexOf("{data}")===-1&&(u.body={data:i,sender:s}),this.emit("debug",{action:"sendCcipReadFetchRequest",request:u,index:a,urls:r});let h="unknown error";const d=await u.send();try{const f=d.bodyJson;if(f.data)return this.emit("debug",{action:"receiveCcipReadFetchResult",request:u,result:f}),f.data;f.message&&(h=f.message),this.emit("debug",{action:"receiveCcipReadFetchError",request:u,result:f})}catch{}K(d.statusCode<400||d.statusCode>=500,`response not found during CCIP fetch: ${h}`,"OFFCHAIN_FAULT",{reason:"404_MISSING_RESOURCE",transaction:e,info:{url:c,errorMessage:h}}),o.push(h)}K(!1,`error encountered during CCIP fetch: ${o.map(a=>JSON.stringify(a)).join(", ")}`,"OFFCHAIN_FAULT",{reason:"500_SERVER_ERROR",transaction:e,info:{urls:r,errorMessages:o}})}_wrapBlock(e,t){return new xde(Yde(e),this)}_wrapLog(e,t){return new Ay(Gde(e),this)}_wrapTransactionReceipt(e,t){return new a4(Xde(e),this)}_wrapTransactionResponse(e,t){return new mm(E4(e),this)}_detectNetwork(){K(!1,"sub-classes must implement this","UNSUPPORTED_OPERATION",{operation:"_detectNetwork"})}async _perform(e){K(!1,`unsupported method: ${e.method}`,"UNSUPPORTED_OPERATION",{operation:e.method,info:e})}async getBlockNumber(){const e=We(await Z(this,Cr,gs).call(this,{method:"getBlockNumber"}),"%response");return y(this,na)>=0&&_(this,na,e),e}_getAddress(e){return Pr(e,this)}_getBlockTag(e){if(e==null)return"latest";switch(e){case"earliest":return"0x0";case"finalized":case"latest":case"pending":case"safe":return e}if(Ut(e))return Ut(e,32)?e:Hh(e);if(typeof e=="bigint"&&(e=We(e,"blockTag")),typeof e=="number")return e>=0?Hh(e):y(this,na)>=0?Hh(y(this,na)+e):this.getBlockNumber().then(t=>Hh(t+e));x(!1,"invalid blockTag","blockTag",e)}_getFilter(e){const t=(e.topics||[]).map(c=>c==null?null:Array.isArray(c)?YC(c.map(l=>l.toLowerCase())):c.toLowerCase()),r="blockHash"in e?e.blockHash:void 0,s=(c,l,u)=>{let h;switch(c.length){case 0:break;case 1:h=c[0];break;default:c.sort(),h=c}if(r&&(l!=null||u!=null))throw new Error("invalid filter");const d={};return h&&(d.address=h),t.length&&(d.topics=t),l&&(d.fromBlock=l),u&&(d.toBlock=u),r&&(d.blockHash=r),d};let i=[];if(e.address)if(Array.isArray(e.address))for(const c of e.address)i.push(this._getAddress(c));else i.push(this._getAddress(e.address));let o;"fromBlock"in e&&(o=this._getBlockTag(e.fromBlock));let a;return"toBlock"in e&&(a=this._getBlockTag(e.toBlock)),i.filter(c=>typeof c!="string").length||o!=null&&typeof o!="string"||a!=null&&typeof a!="string"?Promise.all([Promise.all(i),o,a]).then(c=>s(c[0],c[1],c[2])):s(i,o,a)}_getTransactionRequest(e){const t=db(e),r=[];if(["to","from"].forEach(s=>{if(t[s]==null)return;const i=Pr(t[s],this);kw(i)?r.push(async function(){t[s]=await i}()):t[s]=i}),t.blockTag!=null){const s=this._getBlockTag(t.blockTag);kw(s)?r.push(async function(){t.blockTag=await s}()):t.blockTag=s}return r.length?async function(){return await Promise.all(r),t}():t}async getNetwork(){if(y(this,vs)==null){const s=(async()=>{try{const i=await this._detectNetwork();return this.emit("network",i,null),i}catch(i){throw y(this,vs)===s&&_(this,vs,null),i}})();return _(this,vs,s),(await s).clone()}const e=y(this,vs),[t,r]=await Promise.all([e,this._detectNetwork()]);return t.chainId!==r.chainId&&(y(this,Ql)?(this.emit("network",r,t),y(this,vs)===e&&_(this,vs,Promise.resolve(r))):K(!1,`network changed: ${t.chainId} => ${r.chainId} `,"NETWORK_ERROR",{event:"changed"})),t.clone()}async getFeeData(){const e=await this.getNetwork(),t=async()=>{const{_block:s,gasPrice:i,priorityFee:o}=await Sr({_block:Z(this,Qm,JC).call(this,"latest",!1),gasPrice:(async()=>{try{const u=await Z(this,Cr,gs).call(this,{method:"getGasPrice"});return Ae(u,"%response")}catch{}return null})(),priorityFee:(async()=>{try{const u=await Z(this,Cr,gs).call(this,{method:"getPriorityFee"});return Ae(u,"%response")}catch{}return null})()});let a=null,c=null;const l=this._wrapBlock(s,e);return l&&l.baseFeePerGas&&(c=o??BigInt("1000000000"),a=l.baseFeePerGas*afe+c),new QR(i,a,c)},r=e.getPlugin("org.ethers.plugins.network.FetchUrlFeeDataPlugin");if(r){const s=new ba(r.url),i=await r.processFunc(t,this,s);return new QR(i.gasPrice,i.maxFeePerGas,i.maxPriorityFeePerGas)}return await t()}async estimateGas(e){let t=this._getTransactionRequest(e);return kw(t)&&(t=await t),Ae(await Z(this,Cr,gs).call(this,{method:"estimateGas",transaction:t}),"%response")}async call(e){const{tx:t,blockTag:r}=await Sr({tx:this._getTransactionRequest(e),blockTag:this._getBlockTag(e.blockTag)});return await Z(this,Ym,ZC).call(this,Z(this,Km,QC).call(this,t,r,e.enableCcipRead?0:-1))}async getBalance(e,t){return Ae(await Z(this,Zl,Up).call(this,{method:"getBalance"},e,t),"%response")}async getTransactionCount(e,t){return We(await Z(this,Zl,Up).call(this,{method:"getTransactionCount"},e,t),"%response")}async getCode(e,t){return Ee(await Z(this,Zl,Up).call(this,{method:"getCode"},e,t))}async getStorage(e,t,r){const s=Ae(t,"position");return Ee(await Z(this,Zl,Up).call(this,{method:"getStorage",position:s},e,r))}async broadcastTransaction(e){const{blockNumber:t,hash:r,network:s}=await Sr({blockNumber:this.getBlockNumber(),hash:this._perform({method:"broadcastTransaction",signedTransaction:e}),network:this.getNetwork()}),i=ub.from(e);if(i.hash!==r)throw new Error("@TODO: the returned hash did not match");return this._wrapTransactionResponse(i,s).replaceableTransaction(t)}async getBlock(e,t){const{network:r,params:s}=await Sr({network:this.getNetwork(),params:Z(this,Qm,JC).call(this,e,!!t)});return s==null?null:this._wrapBlock(s,r)}async getTransaction(e){const{network:t,params:r}=await Sr({network:this.getNetwork(),params:Z(this,Cr,gs).call(this,{method:"getTransaction",hash:e})});return r==null?null:this._wrapTransactionResponse(r,t)}async getTransactionReceipt(e){const{network:t,params:r}=await Sr({network:this.getNetwork(),params:Z(this,Cr,gs).call(this,{method:"getTransactionReceipt",hash:e})});if(r==null)return null;if(r.gasPrice==null&&r.effectiveGasPrice==null){const s=await Z(this,Cr,gs).call(this,{method:"getTransaction",hash:e});if(s==null)throw new Error("report this; could not find tx or effectiveGasPrice");r.effectiveGasPrice=s.gasPrice}return this._wrapTransactionReceipt(r,t)}async getTransactionResult(e){const{result:t}=await Sr({network:this.getNetwork(),result:Z(this,Cr,gs).call(this,{method:"getTransactionResult",hash:e})});return t==null?null:Ee(t)}async getLogs(e){let t=this._getFilter(e);kw(t)&&(t=await t);const{network:r,params:s}=await Sr({network:this.getNetwork(),params:Z(this,Cr,gs).call(this,{method:"getLogs",filter:t})});return s.map(i=>this._wrapLog(i,r))}_getProvider(e){K(!1,"provider cannot connect to target network","UNSUPPORTED_OPERATION",{operation:"_getProvider()"})}async getResolver(e){return await pb.fromName(this,e)}async getAvatar(e){const t=await this.getResolver(e);return t?await t.getAvatar():null}async resolveName(e){const t=await this.getResolver(e);return t?await t.getAddress():null}async lookupAddress(e){e=Tt(e);const t=HC(e.substring(2).toLowerCase()+".addr.reverse");try{const r=await pb.getEnsAddress(this),i=await new rd(r,["function resolver(bytes32) view returns (address)"],this).resolver(t);if(i==null||i===cm)return null;const a=await new rd(i,["function name(bytes32) view returns (string)"],this).name(t);return await this.resolveName(a)!==e?null:a}catch(r){if(pr(r,"BAD_DATA")&&r.value==="0x"||pr(r,"CALL_EXCEPTION"))return null;throw r}return null}async waitForTransaction(e,t,r){const s=t??1;return s===0?this.getTransactionReceipt(e):new Promise(async(i,o)=>{let a=null;const c=async l=>{try{const u=await this.getTransactionReceipt(e);if(u!=null&&l-u.blockNumber+1>=s){i(u),a&&(clearTimeout(a),a=null);return}}catch(u){console.log("EEE",u)}this.once("block",c)};r!=null&&(a=setTimeout(()=>{a!=null&&(a=null,this.off("block",c),o(un("timeout","TIMEOUT",{reason:"timeout"})))},r)),c(await this.getBlockNumber())})}async waitForBlock(e){K(!1,"not implemented yet","NOT_IMPLEMENTED",{operation:"waitForBlock"})}_clearTimeout(e){const t=y(this,zs).get(e);t&&(t.timer&&clearTimeout(t.timer),y(this,zs).delete(e))}_setTimeout(e,t){t==null&&(t=0);const r=Qf(this,Gm)._++,s=()=>{y(this,zs).delete(r),e()};if(this.paused)y(this,zs).set(r,{timer:null,func:s,time:t});else{const i=setTimeout(s,t);y(this,zs).set(r,{timer:i,func:s,time:M1()})}return r}_forEachSubscriber(e){for(const t of y(this,ar).values())e(t.subscriber)}_getSubscriber(e){switch(e.type){case"debug":case"error":case"network":return new A4(e.type);case"block":{const t=new rfe(this);return t.pollingInterval=this.pollingInterval,t}case"safe":case"finalized":return new sfe(this,e.type);case"event":return new hS(this,e.filter);case"transaction":return new ofe(this,e.hash);case"orphan":return new ife(this,e.filter)}throw new Error(`unsupported event: ${e.type}`)}_recoverSubscriber(e,t){for(const r of y(this,ar).values())if(r.subscriber===e){r.started&&r.subscriber.stop(),r.subscriber=t,r.started&&t.start(),y(this,cr)!=null&&t.pause(y(this,cr));break}}async on(e,t){const r=await Z(this,Wd,f0).call(this,e);return r.listeners.push({listener:t,once:!1}),r.started||(r.subscriber.start(),r.started=!0,y(this,cr)!=null&&r.subscriber.pause(y(this,cr))),this}async once(e,t){const r=await Z(this,Wd,f0).call(this,e);return r.listeners.push({listener:t,once:!0}),r.started||(r.subscriber.start(),r.started=!0,y(this,cr)!=null&&r.subscriber.pause(y(this,cr))),this}async emit(e,...t){const r=await Z(this,Jl,$p).call(this,e,t);if(!r||r.listeners.length===0)return!1;const s=r.listeners.length;return r.listeners=r.listeners.filter(({listener:i,once:o})=>{const a=new $M(this,o?null:i,e);try{i.call(this,...t,a)}catch{}return!o}),r.listeners.length===0&&(r.started&&r.subscriber.stop(),y(this,ar).delete(r.tag)),s>0}async listenerCount(e){if(e){const r=await Z(this,Jl,$p).call(this,e);return r?r.listeners.length:0}let t=0;for(const{listeners:r}of y(this,ar).values())t+=r.length;return t}async listeners(e){if(e){const r=await Z(this,Jl,$p).call(this,e);return r?r.listeners.map(({listener:s})=>s):[]}let t=[];for(const{listeners:r}of y(this,ar).values())t=t.concat(r.map(({listener:s})=>s));return t}async off(e,t){const r=await Z(this,Jl,$p).call(this,e);if(!r)return this;if(t){const s=r.listeners.map(({listener:i})=>i).indexOf(t);s>=0&&r.listeners.splice(s,1)}return(!t||r.listeners.length===0)&&(r.started&&r.subscriber.stop(),y(this,ar).delete(r.tag)),this}async removeAllListeners(e){if(e){const{tag:t,started:r,subscriber:s}=await Z(this,Wd,f0).call(this,e);r&&s.stop(),y(this,ar).delete(t)}else for(const[t,{started:r,subscriber:s}]of y(this,ar))r&&s.stop(),y(this,ar).delete(t);return this}async addListener(e,t){return await this.on(e,t)}async removeListener(e,t){return this.off(e,t)}get destroyed(){return y(this,Vd)}destroy(){this.removeAllListeners();for(const e of y(this,zs).keys())this._clearTimeout(e);_(this,Vd,!0)}get paused(){return y(this,cr)!=null}set paused(e){!!e!==this.paused&&(this.paused?this.resume():this.pause(!1))}pause(e){if(_(this,na,-1),y(this,cr)!=null){if(y(this,cr)==!!e)return;K(!1,"cannot change pause type; resume first","UNSUPPORTED_OPERATION",{operation:"pause"})}this._forEachSubscriber(t=>t.pause(e)),_(this,cr,!!e);for(const t of y(this,zs).values())t.timer&&clearTimeout(t.timer),t.time=M1()-t.time}resume(){if(y(this,cr)!=null){this._forEachSubscriber(e=>e.resume()),_(this,cr,null);for(const e of y(this,zs).values()){let t=e.time;t<0&&(t=0),e.time=M1(),setTimeout(e.func,t)}}}}ar=new WeakMap,Ec=new WeakMap,cr=new WeakMap,Vd=new WeakMap,vs=new WeakMap,Ql=new WeakMap,vc=new WeakMap,na=new WeakMap,Gm=new WeakMap,zs=new WeakMap,qd=new WeakMap,zd=new WeakMap,Cr=new WeakSet,gs=async function(e){const t=y(this,zd).cacheTimeout;if(t<0)return await this._perform(e);const r=d0(e.method,e);let s=y(this,vc).get(r);return s||(s=this._perform(e),y(this,vc).set(r,s),setTimeout(()=>{y(this,vc).get(r)===s&&y(this,vc).delete(r)},t)),await s},Km=new WeakSet,QC=async function(e,t,r){K(r<cfe,"CCIP read exceeded maximum redirections","OFFCHAIN_FAULT",{reason:"TOO_MANY_REDIRECTS",transaction:Object.assign({},e,{blockTag:t,enableCcipRead:!0})});const s=db(e);try{return Ee(await this._perform({method:"call",transaction:s,blockTag:t}))}catch(i){if(!this.disableCcipRead&&q_(i)&&i.data&&r>=0&&t==="latest"&&s.to!=null&&Zt(i.data,0,4)==="0x556f1830"){const o=i.data,a=await Pr(s.to,this);let c;try{c=mfe(Zt(i.data,4))}catch(h){K(!1,h.message,"OFFCHAIN_FAULT",{reason:"BAD_DATA",transaction:s,info:{data:o}})}K(c.sender.toLowerCase()===a.toLowerCase(),"CCIP Read sender mismatch","CALL_EXCEPTION",{action:"call",data:o,reason:"OffchainLookup",transaction:s,invocation:null,revert:{signature:"OffchainLookup(address,string[],bytes,bytes4,bytes)",name:"OffchainLookup",args:c.errorArgs}});const l=await this.ccipReadFetch(s,c.calldata,c.urls);K(l!=null,"CCIP Read failed to fetch data","OFFCHAIN_FAULT",{reason:"FETCH_FAILED",transaction:s,info:{data:i.data,errorArgs:c.errorArgs}});const u={to:a,data:on([c.selector,gfe([l,c.extraData])])};this.emit("debug",{action:"sendCcipReadCall",transaction:u});try{const h=await Z(this,Km,QC).call(this,u,t,r+1);return this.emit("debug",{action:"receiveCcipReadCallResult",transaction:Object.assign({},u),result:h}),h}catch(h){throw this.emit("debug",{action:"receiveCcipReadCallError",transaction:Object.assign({},u),error:h}),h}}throw i}},Ym=new WeakSet,ZC=async function(e){const{value:t}=await Sr({network:this.getNetwork(),value:e});return t},Zl=new WeakSet,Up=async function(e,t,r){let s=this._getAddress(t),i=this._getBlockTag(r);return(typeof s!="string"||typeof i!="string")&&([s,i]=await Promise.all([s,i])),await Z(this,Ym,ZC).call(this,Z(this,Cr,gs).call(this,Object.assign(e,{address:s,blockTag:i})))},Qm=new WeakSet,JC=async function(e,t){if(Ut(e,32))return await Z(this,Cr,gs).call(this,{method:"getBlock",blockHash:e,includeTransactions:t});let r=this._getBlockTag(e);return typeof r!="string"&&(r=await r),await Z(this,Cr,gs).call(this,{method:"getBlock",blockTag:r,includeTransactions:t})},Jl=new WeakSet,$p=async function(e,t){let r=await $1(e,this);return r.type==="event"&&t&&t.length>0&&t[0].removed===!0&&(r=await $1({orphan:"drop-log",log:t[0]},this)),y(this,ar).get(r.tag)||null},Wd=new WeakSet,f0=async function(e){const t=await $1(e,this),r=t.tag;let s=y(this,ar).get(r);return s||(s={subscriber:this._getSubscriber(t),tag:r,addressableMap:new WeakMap,nameMap:new Map,started:!1,listeners:[]},y(this,ar).set(r,s)),s};function dfe(n,e){try{const t=XC(n,e);if(t)return tb(t)}catch{}return null}function XC(n,e){if(n==="0x")return null;try{const t=We(Zt(n,e,e+32)),r=We(Zt(n,t,t+32));return Zt(n,t+32,t+32+r)}catch{}return null}function sP(n){const e=xr(n);if(e.length>32)throw new Error("internal; should not happen");const t=new Uint8Array(32);return t.set(e,32-e.length),t}function ffe(n){if(n.length%32===0)return n;const e=new Uint8Array(Math.ceil(n.length/32)*32);return e.set(n),e}const pfe=new Uint8Array([]);function gfe(n){const e=[];let t=0;for(let r=0;r<n.length;r++)e.push(pfe),t+=32;for(let r=0;r<n.length;r++){const s=ot(n[r]);e[r]=sP(t),e.push(sP(s.length)),e.push(ffe(s)),t+=32+Math.ceil(s.length/32)*32}return on(e)}const iP="0x0000000000000000000000000000000000000000000000000000000000000000";function mfe(n){const e={sender:"",urls:[],calldata:"",selector:"",extraData:"",errorArgs:[]};K(Xh(n)>=5*32,"insufficient OffchainLookup data","OFFCHAIN_FAULT",{reason:"insufficient OffchainLookup data"});const t=Zt(n,0,32);K(Zt(t,0,12)===Zt(iP,0,12),"corrupt OffchainLookup sender","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup sender"}),e.sender=Zt(t,12);try{const r=[],s=We(Zt(n,32,64)),i=We(Zt(n,s,s+32)),o=Zt(n,s+32);for(let a=0;a<i;a++){const c=dfe(o,a*32);if(c==null)throw new Error("abort");r.push(c)}e.urls=r}catch{K(!1,"corrupt OffchainLookup urls","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup urls"})}try{const r=XC(n,64);if(r==null)throw new Error("abort");e.calldata=r}catch{K(!1,"corrupt OffchainLookup calldata","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup calldata"})}K(Zt(n,100,128)===Zt(iP,0,28),"corrupt OffchainLookup callbaackSelector","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup callbaackSelector"}),e.selector=Zt(n,96,100);try{const r=XC(n,128);if(r==null)throw new Error("abort");e.extraData=r}catch{K(!1,"corrupt OffchainLookup extraData","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup extraData"})}return e.errorArgs="sender,urls,calldata,selector,extraData".split(/,/).map(r=>e[r]),e}function Ah(n,e){if(n.provider)return n.provider;K(!1,"missing provider","UNSUPPORTED_OPERATION",{operation:e})}async function oP(n,e){let t=db(e);if(t.to!=null&&(t.to=Pr(t.to,n)),t.from!=null){const r=t.from;t.from=Promise.all([n.getAddress(),Pr(r,n)]).then(([s,i])=>(x(s.toLowerCase()===i.toLowerCase(),"transaction from mismatch","tx.from",i),s))}else t.from=n.getAddress();return await Sr(t)}class yfe{constructor(e){B(this,"provider");Re(this,{provider:e||null})}async getNonce(e){return Ah(this,"getTransactionCount").getTransactionCount(await this.getAddress(),e)}async populateCall(e){return await oP(this,e)}async populateTransaction(e){const t=Ah(this,"populateTransaction"),r=await oP(this,e);r.nonce==null&&(r.nonce=await this.getNonce("pending")),r.gasLimit==null&&(r.gasLimit=await this.estimateGas(r));const s=await this.provider.getNetwork();if(r.chainId!=null){const o=Ae(r.chainId);x(o===s.chainId,"transaction chainId mismatch","tx.chainId",e.chainId)}else r.chainId=s.chainId;const i=r.maxFeePerGas!=null||r.maxPriorityFeePerGas!=null;if(r.gasPrice!=null&&(r.type===2||i)?x(!1,"eip-1559 transaction do not support gasPrice","tx",e):(r.type===0||r.type===1)&&i&&x(!1,"pre-eip-1559 transaction do not support maxFeePerGas/maxPriorityFeePerGas","tx",e),(r.type===2||r.type==null)&&r.maxFeePerGas!=null&&r.maxPriorityFeePerGas!=null)r.type=2;else if(r.type===0||r.type===1){const o=await t.getFeeData();K(o.gasPrice!=null,"network does not support gasPrice","UNSUPPORTED_OPERATION",{operation:"getGasPrice"}),r.gasPrice==null&&(r.gasPrice=o.gasPrice)}else{const o=await t.getFeeData();if(r.type==null)if(o.maxFeePerGas!=null&&o.maxPriorityFeePerGas!=null)if(r.type=2,r.gasPrice!=null){const a=r.gasPrice;delete r.gasPrice,r.maxFeePerGas=a,r.maxPriorityFeePerGas=a}else r.maxFeePerGas==null&&(r.maxFeePerGas=o.maxFeePerGas),r.maxPriorityFeePerGas==null&&(r.maxPriorityFeePerGas=o.maxPriorityFeePerGas);else o.gasPrice!=null?(K(!i,"network does not support EIP-1559","UNSUPPORTED_OPERATION",{operation:"populateTransaction"}),r.gasPrice==null&&(r.gasPrice=o.gasPrice),r.type=0):K(!1,"failed to get consistent fee data","UNSUPPORTED_OPERATION",{operation:"signer.getFeeData"});else(r.type===2||r.type===3)&&(r.maxFeePerGas==null&&(r.maxFeePerGas=o.maxFeePerGas),r.maxPriorityFeePerGas==null&&(r.maxPriorityFeePerGas=o.maxPriorityFeePerGas))}return await Sr(r)}async estimateGas(e){return Ah(this,"estimateGas").estimateGas(await this.populateCall(e))}async call(e){return Ah(this,"call").call(await this.populateCall(e))}async resolveName(e){return await Ah(this,"resolveName").resolveName(e)}async sendTransaction(e){const t=Ah(this,"sendTransaction"),r=await this.populateTransaction(e);delete r.from;const s=ub.from(r);return await t.broadcastTransaction(await this.signTransaction(s))}}function wfe(n){return JSON.parse(JSON.stringify(n))}var Ir,no,Xl,Ac,eu,Gd,Zm,eI,Jm,tI;class C4{constructor(e){F(this,Zm);F(this,Jm);F(this,Ir,void 0);F(this,no,void 0);F(this,Xl,void 0);F(this,Ac,void 0);F(this,eu,void 0);F(this,Gd,void 0);_(this,Ir,e),_(this,no,null),_(this,Xl,Z(this,Zm,eI).bind(this)),_(this,Ac,!1),_(this,eu,null),_(this,Gd,!1)}_subscribe(e){throw new Error("subclasses must override this")}_emitResults(e,t){throw new Error("subclasses must override this")}_recover(e){throw new Error("subclasses must override this")}start(){y(this,Ac)||(_(this,Ac,!0),Z(this,Zm,eI).call(this,-2))}stop(){y(this,Ac)&&(_(this,Ac,!1),_(this,Gd,!0),Z(this,Jm,tI).call(this),y(this,Ir).off("block",y(this,Xl)))}pause(e){e&&Z(this,Jm,tI).call(this),y(this,Ir).off("block",y(this,Xl))}resume(){this.start()}}Ir=new WeakMap,no=new WeakMap,Xl=new WeakMap,Ac=new WeakMap,eu=new WeakMap,Gd=new WeakMap,Zm=new WeakSet,eI=async function(e){try{y(this,no)==null&&_(this,no,this._subscribe(y(this,Ir)));let t=null;try{t=await y(this,no)}catch(i){if(!pr(i,"UNSUPPORTED_OPERATION")||i.operation!=="eth_newFilter")throw i}if(t==null){_(this,no,null),y(this,Ir)._recoverSubscriber(this,this._recover(y(this,Ir)));return}const r=await y(this,Ir).getNetwork();if(y(this,eu)||_(this,eu,r),y(this,eu).chainId!==r.chainId)throw new Error("chaid changed");if(y(this,Gd))return;const s=await y(this,Ir).send("eth_getFilterChanges",[t]);await this._emitResults(y(this,Ir),s)}catch(t){console.log("@TODO",t)}y(this,Ir).once("block",y(this,Xl))},Jm=new WeakSet,tI=function(){const e=y(this,no);e&&(_(this,no,null),e.then(t=>{y(this,Ir).destroyed||y(this,Ir).send("eth_uninstallFilter",[t])}))};var tu;class bfe extends C4{constructor(t,r){super(t);F(this,tu,void 0);_(this,tu,wfe(r))}_recover(t){return new hS(t,y(this,tu))}async _subscribe(t){return await t.send("eth_newFilter",[y(this,tu)])}async _emitResults(t,r){for(const s of r)t.emit(y(this,tu),t._wrapLog(s,t._network))}}tu=new WeakMap;class Efe extends C4{async _subscribe(e){return await e.send("eth_newPendingTransactionFilter",[])}async _emitResults(e,t){for(const r of t)e.emit("pending",r)}}const vfe="bigint,boolean,function,number,string,symbol".split(/,/g);function p0(n){if(n==null||vfe.indexOf(typeof n)>=0||typeof n.getAddress=="function")return n;if(Array.isArray(n))return n.map(p0);if(typeof n=="object")return Object.keys(n).reduce((e,t)=>(e[t]=n[t],e),{});throw new Error(`should not happen: ${n} (${typeof n})`)}function Afe(n){return new Promise(e=>{setTimeout(e,n)})}function Ch(n){return n&&n.toLowerCase()}function aP(n){return n&&typeof n.pollingInterval=="number"}const I4={polling:!1,staticNetwork:null,batchStallTime:10,batchMaxSize:1<<20,batchMaxCount:100,cacheTimeout:250,pollingInterval:4e3};class sd extends yfe{constructor(t,r){super(t);B(this,"address");r=Tt(r),Re(this,{address:r})}connect(t){K(!1,"cannot reconnect JsonRpcSigner","UNSUPPORTED_OPERATION",{operation:"signer.connect"})}async getAddress(){return this.address}async populateTransaction(t){return await this.populateCall(t)}async sendUncheckedTransaction(t){const r=p0(t),s=[];if(r.from){const o=r.from;s.push((async()=>{const a=await Pr(o,this.provider);x(a!=null&&a.toLowerCase()===this.address.toLowerCase(),"from address mismatch","transaction",t),r.from=a})())}else r.from=this.address;if(r.gasLimit==null&&s.push((async()=>{r.gasLimit=await this.provider.estimateGas({...r,from:this.address})})()),r.to!=null){const o=r.to;s.push((async()=>{r.to=await Pr(o,this.provider)})())}s.length&&await Promise.all(s);const i=this.provider.getRpcTransaction(r);return this.provider.send("eth_sendTransaction",[i])}async sendTransaction(t){const r=await this.provider.getBlockNumber(),s=await this.sendUncheckedTransaction(t);return await new Promise((i,o)=>{const a=[1e3,100];let c=0;const l=async()=>{try{const u=await this.provider.getTransaction(s);if(u!=null){i(u.replaceableTransaction(r));return}}catch(u){if(pr(u,"CANCELLED")||pr(u,"BAD_DATA")||pr(u,"NETWORK_ERROR")){u.info==null&&(u.info={}),u.info.sendTransactionHash=s,o(u);return}if(pr(u,"INVALID_ARGUMENT")&&(c++,u.info==null&&(u.info={}),u.info.sendTransactionHash=s,c>10)){o(u);return}this.provider.emit("error",un("failed to fetch transation after sending (will try again)","UNKNOWN_ERROR",{error:u}))}this.provider._setTimeout(()=>{l()},a.pop()||4e3)};l()})}async signTransaction(t){const r=p0(t);if(r.from){const i=await Pr(r.from,this.provider);x(i!=null&&i.toLowerCase()===this.address.toLowerCase(),"from address mismatch","transaction",t),r.from=i}else r.from=this.address;const s=this.provider.getRpcTransaction(r);return await this.provider.send("eth_signTransaction",[s])}async signMessage(t){const r=typeof t=="string"?Eo(t):t;return await this.provider.send("personal_sign",[Ee(r),this.address.toLowerCase()])}async signTypedData(t,r,s){const i=p0(s),o=await hb.resolveNames(t,r,i,async a=>{const c=await Pr(a);return x(c!=null,"TypedData does not support null address","value",a),c});return await this.provider.send("eth_signTypedData_v4",[this.address.toLowerCase(),JSON.stringify(hb.getPayload(o.domain,r,o.value))])}async unlock(t){return this.provider.send("personal_unlockAccount",[this.address.toLowerCase(),t,null])}async _legacySignMessage(t){const r=typeof t=="string"?Eo(t):t;return await this.provider.send("eth_sign",[this.address.toLowerCase(),Ee(r)])}}var nu,Kd,ra,ro,Ai,Ws,Zr,Xm,nI;class Cfe extends hfe{constructor(t,r){super(t,r);F(this,Xm);F(this,nu,void 0);F(this,Kd,void 0);F(this,ra,void 0);F(this,ro,void 0);F(this,Ai,void 0);F(this,Ws,void 0);F(this,Zr,void 0);_(this,Kd,1),_(this,nu,Object.assign({},I4,r||{})),_(this,ra,[]),_(this,ro,null),_(this,Ws,null),_(this,Zr,null);{let i=null;const o=new Promise(a=>{i=a});_(this,Ai,{promise:o,resolve:i})}const s=this._getOption("staticNetwork");typeof s=="boolean"?(x(!s||t!=="any","staticNetwork cannot be used on special network 'any'","options",r),s&&t!=null&&_(this,Ws,fo.from(t))):s&&(x(t==null||s.matches(t),"staticNetwork MUST match network object","options",r),_(this,Ws,s))}_getOption(t){return y(this,nu)[t]}get _network(){return K(y(this,Ws),"network is not available yet","NETWORK_ERROR"),y(this,Ws)}async _perform(t){if(t.method==="call"||t.method==="estimateGas"){let s=t.transaction;if(s&&s.type!=null&&Ae(s.type)&&s.maxFeePerGas==null&&s.maxPriorityFeePerGas==null){const i=await this.getFeeData();i.maxFeePerGas==null&&i.maxPriorityFeePerGas==null&&(t=Object.assign({},t,{transaction:Object.assign({},s,{type:void 0})}))}}const r=this.getRpcRequest(t);return r!=null?await this.send(r.method,r.args):super._perform(t)}async _detectNetwork(){const t=this._getOption("staticNetwork");if(t)if(t===!0){if(y(this,Ws))return y(this,Ws)}else return t;return y(this,Zr)?await y(this,Zr):this.ready?(_(this,Zr,(async()=>{try{const r=fo.from(Ae(await this.send("eth_chainId",[])));return _(this,Zr,null),r}catch(r){throw _(this,Zr,null),r}})()),await y(this,Zr)):(_(this,Zr,(async()=>{const r={id:Qf(this,Kd)._++,method:"eth_chainId",params:[],jsonrpc:"2.0"};this.emit("debug",{action:"sendRpcPayload",payload:r});let s;try{s=(await this._send(r))[0],_(this,Zr,null)}catch(i){throw _(this,Zr,null),this.emit("debug",{action:"receiveRpcError",error:i}),i}if(this.emit("debug",{action:"receiveRpcResult",result:s}),"result"in s)return fo.from(Ae(s.result));throw this.getRpcError(r,s)})()),await y(this,Zr))}_start(){y(this,Ai)==null||y(this,Ai).resolve==null||(y(this,Ai).resolve(),_(this,Ai,null),(async()=>{for(;y(this,Ws)==null&&!this.destroyed;)try{_(this,Ws,await this._detectNetwork())}catch(t){if(this.destroyed)break;console.log("JsonRpcProvider failed to detect network and cannot start up; retry in 1s (perhaps the URL is wrong or the node is not started)"),this.emit("error",un("failed to bootstrap network detection","NETWORK_ERROR",{event:"initial-network-discovery",info:{error:t}})),await Afe(1e3)}Z(this,Xm,nI).call(this)})())}async _waitUntilReady(){if(y(this,Ai)!=null)return await y(this,Ai).promise}_getSubscriber(t){return t.type==="pending"?new Efe(this):t.type==="event"?this._getOption("polling")?new hS(this,t.filter):new bfe(this,t.filter):t.type==="orphan"&&t.filter.orphan==="drop-log"?new A4("orphan"):super._getSubscriber(t)}get ready(){return y(this,Ai)==null}getRpcTransaction(t){const r={};return["chainId","gasLimit","gasPrice","type","maxFeePerGas","maxPriorityFeePerGas","nonce","value"].forEach(s=>{if(t[s]==null)return;let i=s;s==="gasLimit"&&(i="gas"),r[i]=Hh(Ae(t[s],`tx.${s}`))}),["from","to","data"].forEach(s=>{t[s]!=null&&(r[s]=Ee(t[s]))}),t.accessList&&(r.accessList=qu(t.accessList)),r}getRpcRequest(t){switch(t.method){case"chainId":return{method:"eth_chainId",args:[]};case"getBlockNumber":return{method:"eth_blockNumber",args:[]};case"getGasPrice":return{method:"eth_gasPrice",args:[]};case"getPriorityFee":return{method:"eth_maxPriorityFeePerGas",args:[]};case"getBalance":return{method:"eth_getBalance",args:[Ch(t.address),t.blockTag]};case"getTransactionCount":return{method:"eth_getTransactionCount",args:[Ch(t.address),t.blockTag]};case"getCode":return{method:"eth_getCode",args:[Ch(t.address),t.blockTag]};case"getStorage":return{method:"eth_getStorageAt",args:[Ch(t.address),"0x"+t.position.toString(16),t.blockTag]};case"broadcastTransaction":return{method:"eth_sendRawTransaction",args:[t.signedTransaction]};case"getBlock":if("blockTag"in t)return{method:"eth_getBlockByNumber",args:[t.blockTag,!!t.includeTransactions]};if("blockHash"in t)return{method:"eth_getBlockByHash",args:[t.blockHash,!!t.includeTransactions]};break;case"getTransaction":return{method:"eth_getTransactionByHash",args:[t.hash]};case"getTransactionReceipt":return{method:"eth_getTransactionReceipt",args:[t.hash]};case"call":return{method:"eth_call",args:[this.getRpcTransaction(t.transaction),t.blockTag]};case"estimateGas":return{method:"eth_estimateGas",args:[this.getRpcTransaction(t.transaction)]};case"getLogs":return t.filter&&t.filter.address!=null&&(Array.isArray(t.filter.address)?t.filter.address=t.filter.address.map(Ch):t.filter.address=Ch(t.filter.address)),{method:"eth_getLogs",args:[t.filter]}}return null}getRpcError(t,r){const{method:s}=t,{error:i}=r;if(s==="eth_estimateGas"&&i.message){const c=i.message;if(!c.match(/revert/i)&&c.match(/insufficient funds/i))return un("insufficient funds","INSUFFICIENT_FUNDS",{transaction:t.params[0],info:{payload:t,error:i}})}if(s==="eth_call"||s==="eth_estimateGas"){const c=rI(i),l=gm.getBuiltinCallException(s==="eth_call"?"call":"estimateGas",t.params[0],c?c.data:null);return l.info={error:i,payload:t},l}const o=JSON.stringify(_fe(i));if(typeof i.message=="string"&&i.message.match(/user denied|ethers-user-denied/i))return un("user rejected action","ACTION_REJECTED",{action:{eth_sign:"signMessage",personal_sign:"signMessage",eth_signTypedData_v4:"signTypedData",eth_signTransaction:"signTransaction",eth_sendTransaction:"sendTransaction",eth_requestAccounts:"requestAccess",wallet_requestAccounts:"requestAccess"}[s]||"unknown",reason:"rejected",info:{payload:t,error:i}});if(s==="eth_sendRawTransaction"||s==="eth_sendTransaction"){const c=t.params[0];if(o.match(/insufficient funds|base fee exceeds gas limit/i))return un("insufficient funds for intrinsic transaction cost","INSUFFICIENT_FUNDS",{transaction:c,info:{error:i}});if(o.match(/nonce/i)&&o.match(/too low/i))return un("nonce has already been used","NONCE_EXPIRED",{transaction:c,info:{error:i}});if(o.match(/replacement transaction/i)&&o.match(/underpriced/i))return un("replacement fee too low","REPLACEMENT_UNDERPRICED",{transaction:c,info:{error:i}});if(o.match(/only replay-protected/i))return un("legacy pre-eip-155 transactions not supported","UNSUPPORTED_OPERATION",{operation:s,info:{transaction:c,info:{error:i}}})}let a=!!o.match(/the method .* does not exist/i);return a||i&&i.details&&i.details.startsWith("Unauthorized method:")&&(a=!0),a?un("unsupported operation","UNSUPPORTED_OPERATION",{operation:t.method,info:{error:i,payload:t}}):un("could not coalesce error","UNKNOWN_ERROR",{error:i,payload:t})}send(t,r){if(this.destroyed)return Promise.reject(un("provider destroyed; cancelled request","UNSUPPORTED_OPERATION",{operation:t}));const s=Qf(this,Kd)._++,i=new Promise((o,a)=>{y(this,ra).push({resolve:o,reject:a,payload:{method:t,params:r,id:s,jsonrpc:"2.0"}})});return Z(this,Xm,nI).call(this),i}async getSigner(t){t==null&&(t=0);const r=this.send("eth_accounts",[]);if(typeof t=="number"){const i=await r;if(t>=i.length)throw new Error("no such account");return new sd(this,i[t])}const{accounts:s}=await Sr({network:this.getNetwork(),accounts:r});t=Tt(t);for(const i of s)if(Tt(i)===t)return new sd(this,t);throw new Error("invalid account")}async listAccounts(){return(await this.send("eth_accounts",[])).map(r=>new sd(this,r))}destroy(){y(this,ro)&&(clearTimeout(y(this,ro)),_(this,ro,null));for(const{payload:t,reject:r}of y(this,ra))r(un("provider destroyed; cancelled request","UNSUPPORTED_OPERATION",{operation:t.method}));_(this,ra,[]),super.destroy()}}nu=new WeakMap,Kd=new WeakMap,ra=new WeakMap,ro=new WeakMap,Ai=new WeakMap,Ws=new WeakMap,Zr=new WeakMap,Xm=new WeakSet,nI=function(){if(y(this,ro))return;const t=this._getOption("batchMaxCount")===1?0:this._getOption("batchStallTime");_(this,ro,setTimeout(()=>{_(this,ro,null);const r=y(this,ra);for(_(this,ra,[]);r.length;){const s=[r.shift()];for(;r.length&&s.length!==y(this,nu).batchMaxCount;)if(s.push(r.shift()),JSON.stringify(s.map(o=>o.payload)).length>y(this,nu).batchMaxSize){r.unshift(s.pop());break}(async()=>{const i=s.length===1?s[0].payload:s.map(o=>o.payload);this.emit("debug",{action:"sendRpcPayload",payload:i});try{const o=await this._send(i);this.emit("debug",{action:"receiveRpcResult",result:o});for(const{resolve:a,reject:c,payload:l}of s){if(this.destroyed){c(un("provider destroyed; cancelled request","UNSUPPORTED_OPERATION",{operation:l.method}));continue}const u=o.filter(h=>h.id===l.id)[0];if(u==null){const h=un("missing response for request","BAD_DATA",{value:o,info:{payload:l}});this.emit("error",h),c(h);continue}if("error"in u){c(this.getRpcError(l,u));continue}a(u.result)}}catch(o){this.emit("debug",{action:"receiveRpcError",error:o});for(const{reject:a}of s)a(o)}})()}},t))};var Cc;class _4 extends Cfe{constructor(t,r){super(t,r);F(this,Cc,void 0);let s=this._getOption("pollingInterval");s==null&&(s=I4.pollingInterval),_(this,Cc,s)}_getSubscriber(t){const r=super._getSubscriber(t);return aP(r)&&(r.pollingInterval=y(this,Cc)),r}get pollingInterval(){return y(this,Cc)}set pollingInterval(t){if(!Number.isInteger(t)||t<0)throw new Error("invalid interval");_(this,Cc,t),this._forEachSubscriber(r=>{aP(r)&&(r.pollingInterval=y(this,Cc))})}}Cc=new WeakMap;var Yd;class Ife extends _4{constructor(t,r,s){t==null&&(t="http://localhost:8545");super(r,s);F(this,Yd,void 0);typeof t=="string"?_(this,Yd,new ba(t)):_(this,Yd,t.clone())}_getConnection(){return y(this,Yd).clone()}async send(t,r){return await this._start(),await super.send(t,r)}async _send(t){const r=this._getConnection();r.body=JSON.stringify(t),r.setHeader("content-type","application/json");const s=await r.send();s.assertOk();let i=s.bodyJson;return Array.isArray(i)||(i=[i]),i}}Yd=new WeakMap;function rI(n){if(n==null)return null;if(typeof n.message=="string"&&n.message.match(/revert/i)&&Ut(n.data))return{message:n.message,data:n.data};if(typeof n=="object"){for(const e in n){const t=rI(n[e]);if(t)return t}return null}if(typeof n=="string")try{return rI(JSON.parse(n))}catch{}return null}function sI(n,e){if(n!=null){if(typeof n.message=="string"&&e.push(n.message),typeof n=="object")for(const t in n)sI(n[t],e);if(typeof n=="string")try{return sI(JSON.parse(n),e)}catch{}}}function _fe(n){const e=[];return sI(n,e),e}var Qd;class L1 extends _4{constructor(t,r){x(t&&t.request,"invalid EIP-1193 provider","ethereum",t);super(r,{batchMaxCount:1});F(this,Qd,void 0);_(this,Qd,async(s,i)=>{const o={method:s,params:i};this.emit("debug",{action:"sendEip1193Request",payload:o});try{const a=await t.request(o);return this.emit("debug",{action:"receiveEip1193Result",result:a}),a}catch(a){const c=new Error(a.message);throw c.code=a.code,c.data=a.data,c.payload=o,this.emit("debug",{action:"receiveEip1193Error",error:c}),c}})}async send(t,r){return await this._start(),await super.send(t,r)}async _send(t){x(!Array.isArray(t),"EIP-1193 does not support batch request","payload",t);try{const r=await y(this,Qd).call(this,t.method,t.params||[]);return[{id:t.id,result:r}]}catch(r){return[{id:t.id,error:{code:r.code,data:r.data,message:r.message}}]}}getRpcError(t,r){switch(r=JSON.parse(JSON.stringify(r)),r.error.code||-1){case 4001:r.error.message=`ethers-user-denied: ${r.error.message}`;break;case 4200:r.error.message=`ethers-unsupported: ${r.error.message}`;break}return super.getRpcError(t,r)}async hasSigner(t){t==null&&(t=0);const r=await this.send("eth_accounts",[]);return typeof t=="number"?r.length>t:(t=t.toLowerCase(),r.filter(s=>s.toLowerCase()===t).length!==0)}async getSigner(t){if(t==null&&(t=0),!await this.hasSigner(t))try{await y(this,Qd).call(this,"eth_requestAccounts",[])}catch(r){const s=r.payload;throw this.getRpcError(s,{id:s.id,error:r})}return await super.getSigner(t)}}Qd=new WeakMap;const Ih={signMessage:async(n,e,t)=>{if(!e)throw new Error("signMessage - provider is undefined");const r=Ut(n)?n:Ee(Eo(n));return await e.request({method:"personal_sign",params:[r,t]})},estimateGas:async(n,e,t,r)=>{if(!e)throw new Error("estimateGas - provider is undefined");if(!t)throw new Error("estimateGas - address is undefined");if(n.chainNamespace&&n.chainNamespace!=="eip155")throw new Error("estimateGas - chainNamespace is not eip155");const s={from:n.address,to:n.to,data:n.data,type:0},i=new L1(e,r);return await new sd(i,t).estimateGas(s)},sendTransaction:async(n,e,t,r)=>{if(!e)throw new Error("sendTransaction - provider is undefined");if(!t)throw new Error("sendTransaction - address is undefined");if(n.chainNamespace&&n.chainNamespace!=="eip155")throw new Error("sendTransaction - chainNamespace is not eip155");const s={to:n.to,value:n.value,gasLimit:n.gas,gasPrice:n.gasPrice,data:n.data,type:0},i=new L1(e,r),c=await(await new sd(i,t).sendTransaction(s)).wait();return(c==null?void 0:c.hash)||null},writeContract:async(n,e,t,r)=>{if(!e)throw new Error("writeContract - provider is undefined");if(!t)throw new Error("writeContract - address is undefined");const s=new L1(e,r),i=new sd(s,t),o=new rd(n.tokenAddress,n.abi,i);if(!o||!n.method)throw new Error("Contract method is undefined");const a=o[n.method];if(a)return await a(...n.args);throw new Error("Contract method is undefined")},parseWalletCapabilities:n=>{try{return JSON.parse(n)}catch{throw new Error("Error parsing wallet capabilities")}},parseUnits:WM,formatUnits:zM};class Sfe extends RM{constructor(){super({adapterType:H.ADAPTER_TYPES.ETHERS,namespace:H.CHAIN.EVM}),this.balancePromises={}}async createEthersConfig(e){if(!e.metadata)return;let t;function r(){if(t)return t;if(!(typeof window>"u")&&window.ethereum)return t=window.ethereum,t}async function s(){const{SafeProvider:a}=await Sn(()=>import("./iB-xP0jJ.js"),__vite__mapDeps([55,1,2,56,3]),import.meta.url),{default:c}=await Sn(()=>import("./-PZ8JFYE.js").then(d=>d.e),__vite__mapDeps([56,1,2]),import.meta.url),l=new c,u=await l.safe.getInfo(),h=new a(u,l);return await h.connect().catch(d=>{console.info("Failed to auto-connect to Safe:",d)}),h}async function i(){var a,c,l;try{const{createCoinbaseWalletSDK:u}=await Sn(()=>import("./BEzOdVLG.js"),__vite__mapDeps([57,1,2]),import.meta.url);return typeof window>"u"?void 0:u({appName:(a=e==null?void 0:e.metadata)==null?void 0:a.name,appLogoUrl:(c=e==null?void 0:e.metadata)==null?void 0:c.icons[0],appChainIds:((l=e.networks)==null?void 0:l.map(d=>d.id))||[1,84532],preference:{options:e.coinbasePreference??"all"}}).getProvider()}catch(u){console.error("Failed to import Coinbase Wallet SDK:",u);return}}const o={metadata:e.metadata};if(e.enableInjected!==!1&&(o.injected=r()),e.enableCoinbase!==!1){const a=await i();a&&(o.coinbase=a)}if(ye.isSafeApp()){const a=await s();a&&(o.safe=a)}return o.EIP6963=e.enableEIP6963!==!1,o}async signMessage(e){const{message:t,address:r,provider:s}=e;if(!s)throw new Error("Provider is undefined");try{return{signature:await Ih.signMessage(t,s,r)}}catch{throw new Error("EthersAdapter:signMessage - Sign message failed")}}async sendTransaction(e){var r;if(!e.provider)throw new Error("Provider is undefined");return{hash:await Ih.sendTransaction({value:Number.isNaN(Number(e.value))?BigInt(0):BigInt(e.value),to:e.to,data:e.data?e.data:"0x",gas:e.gas?BigInt(e.gas):void 0,gasPrice:e.gasPrice?BigInt(e.gasPrice):void 0,address:ge.state.address},e.provider,ge.state.address,Number((r=e.caipNetwork)==null?void 0:r.id))}}async writeContract(e){var s;if(!e.provider)throw new Error("Provider is undefined");const{address:t}=Tr.parseCaipAddress(e.caipAddress);return{hash:await Ih.writeContract(e,e.provider,t,Number((s=e.caipNetwork)==null?void 0:s.id))}}async estimateGas(e){const{provider:t,caipNetwork:r,address:s}=e;if(!t)throw new Error("Provider is undefined");try{return{gas:await Ih.estimateGas({data:e.data,to:e.to,address:s},t,s,Number(r==null?void 0:r.id))}}catch{throw new Error("EthersAdapter:estimateGas - Estimate gas failed")}}parseUnits(e){return Ih.parseUnits(e.value,e.decimals)}formatUnits(e){return Ih.formatUnits(e.value,e.decimals)}async syncConnection(e){const{id:t,chainId:r}=e,s=this.connectors.find(c=>c.id===t),i=s==null?void 0:s.provider;if(!i)throw new Error("Provider not found");const o=await i.request({method:"eth_requestAccounts"}),a=await i.request({method:"eth_chainId"});if(this.listenProviderEvents(t,i),!o[0])throw new Error("No accounts found");if(!(s!=null&&s.type))throw new Error("Connector type not found");return{address:this.toChecksummedAddress(o[0]),chainId:Number(a)||Number(r),provider:i,type:s.type,id:t}}async syncConnectors(e){var r;this.ethersConfig=await this.createEthersConfig(e),(r=this.ethersConfig)!=null&&r.EIP6963&&this.listenInjectedConnector(!0),Object.keys(this.ethersConfig||{}).filter(s=>s!=="metadata"&&s!=="EIP6963").forEach(s=>{var a,c;const i=s==="coinbase"?"coinbaseWalletSDK":s,o=s===H.CONNECTOR_ID.INJECTED;this.namespace&&this.addConnector({id:i,explorerId:oo.ConnectorExplorerIds[i],imageUrl:(a=e==null?void 0:e.connectorImages)==null?void 0:a[i],name:oo.ConnectorNamesMap[i]||"Unknown",imageId:oo.ConnectorImageIds[i],type:oo.ConnectorTypesMap[i]??"EXTERNAL",info:o?void 0:{rdns:i},chain:this.namespace,chains:[],provider:(c=this.ethersConfig)==null?void 0:c[s]})})}async disconnectAll(){return{connections:await Promise.all(this.connections.map(async t=>{const r=this.connectors.find(s=>zn.isLowerCaseMatch(s.id,t.connectorId));if(!r)throw new Error("Connector not found");return await this.disconnect({id:r.id}),t}))}}async syncConnections({connectToFirstConnector:e,getConnectorStorageInfo:t}){var r;await((r=this.connectionManager)==null?void 0:r.syncConnections({connectors:this.connectors,caipNetworks:this.getCaipNetworks(),universalProvider:this.universalProvider,onConnection:this.addConnection.bind(this),onListenProvider:this.listenProviderEvents.bind(this),getConnectionStatusInfo(s){return t(s)}})),e&&this.emitFirstAvailableConnection()}async setUniversalProvider(e){this.universalProvider=e;const t=H.CONNECTOR_ID.WALLET_CONNECT;return da.listenWcProvider({universalProvider:e,namespace:H.CHAIN.EVM,onConnect:r=>this.onConnect(r,t),onDisconnect:()=>this.onDisconnect(t),onAccountsChanged:r=>this.onAccountsChanged(r,t,!1),onChainChanged:r=>this.onChainChanged(r,t)}),this.addConnector(new V_({provider:e,caipNetworks:this.getCaipNetworks(),namespace:H.CHAIN.EVM})),Promise.resolve()}eip6963EventHandler(e){var t;if(e.detail){const{info:r,provider:s}=e.detail;if(!((t=this.connectors)==null?void 0:t.find(o=>o.name===(r==null?void 0:r.name)))){const o=oo.ConnectorTypesMap[H.CONNECTOR_ID.EIP6963],a=(r==null?void 0:r.rdns)||(r==null?void 0:r.name)||(r==null?void 0:r.uuid);this.namespace&&a&&this.addConnector({id:a,type:o,imageUrl:r==null?void 0:r.icon,name:(r==null?void 0:r.name)||"Unknown",provider:s,info:r,chain:this.namespace,chains:[]})}}}listenInjectedConnector(e){if(typeof window<"u"&&e){const t=this.eip6963EventHandler.bind(this);window.addEventListener(lt.EIP6963_ANNOUNCE_EVENT,t),window.dispatchEvent(new Event(lt.EIP6963_REQUEST_EVENT))}}async connect({id:e,address:t,type:r,chainId:s,socialUri:i}){var h;const o=this.connectors.find(d=>zn.isLowerCaseMatch(d.id,e));if(!o)throw new Error("Connector not found");const a=(h=this.connectionManager)==null?void 0:h.getConnection({address:t,connectorId:e,connections:this.connections,connectors:this.connectors});if(a){const d=a.caipNetwork;if(!d)throw new Error("EthersAdapter:connect - could not find the caipNetwork to connect");if(a.account)return this.emit("accountChanged",{address:this.toChecksummedAddress(a.account.address),chainId:d.id,connector:o}),{address:this.toChecksummedAddress(a.account.address),chainId:d.id,provider:o.provider,type:o.type,id:e}}const c=o==null?void 0:o.provider;if(!c)throw new Error("Provider not found");let l=[],u;if(r===lt.CONNECTOR_TYPE_AUTH){const{address:d,accounts:f}=await Cs.authConnectorAuthenticate({authConnector:c,chainNamespace:H.CHAIN.EVM,chainId:s,socialUri:i,preferredAccountType:Ns("eip155")}),p=this.getCaipNetworks().find(g=>g.id.toString()===(s==null?void 0:s.toString()));l=[d],this.addConnection({connectorId:e,accounts:f?f.map(g=>({address:g.address})):l.map(g=>({address:g})),caipNetwork:p,auth:{name:Q.getConnectedSocialProvider(),username:Q.getConnectedSocialUsername()}}),this.emit("accountChanged",{address:this.toChecksummedAddress(l[0]),chainId:Number(s),connector:o})}else{l=await c.request({method:"eth_requestAccounts"}),u=await c.request({method:"eth_chainId"});const d=this.getCaipNetworks().find(f=>f.id.toString()===(s==null?void 0:s.toString()));if(u!==s){if(!d)throw new Error("EthersAdapter:connect - could not find the caipNetwork to switch");try{await this.switchNetwork({caipNetwork:d,provider:c,providerType:r})}catch{throw new Error("EthersAdapter:connect - Switch network failed")}}this.emit("accountChanged",{address:this.toChecksummedAddress(l[0]),chainId:Number(s),connector:o}),this.addConnection({connectorId:e,accounts:l.map(f=>({address:f})),caipNetwork:d}),o.id!==H.CONNECTOR_ID.WALLET_CONNECT&&this.listenProviderEvents(e,c)}return{address:this.toChecksummedAddress(l[0]),chainId:Number(s),provider:c,type:r,id:e}}async reconnect(e){const{id:t,chainId:r}=e,s=this.connectors.find(i=>i.id===t);s&&s.type==="AUTH"&&r&&await Cs.authConnectorAuthenticate({authConnector:s.provider,chainNamespace:H.CHAIN.EVM,chainId:r,preferredAccountType:Ns("eip155")})}async getAccounts(e){var o;const t=this.connectors.find(a=>a.id===e.id),r=t==null?void 0:t.provider;if(!r||!t)throw new Error("Provider not found");const s=(o=this.connectionManager)==null?void 0:o.getConnection({connectorId:e.id,connections:this.connections,connectors:this.connectors});if(s)return{accounts:s.accounts.map(({address:a})=>ye.createAccount(H.CHAIN.EVM,a,"eoa"))};if(e.id===H.CONNECTOR_ID.AUTH){const a=t.provider;if(!a.user)return{accounts:[]};const{accounts:c,address:l}=a.user;return Promise.resolve({accounts:(c||[{address:l,type:"eoa"}]).map(u=>ye.createAccount(H.CHAIN.EVM,u.address,u.type))})}return{accounts:(await r.request({method:"eth_requestAccounts"})).map(a=>ye.createAccount(H.CHAIN.EVM,a,"eoa"))}}async disconnect(e){var t,r;if(e.id){const s=this.connectors.find(o=>zn.isLowerCaseMatch(o.id,e.id));if(!s)throw new Error("Connector not found");const i=(t=this.connectionManager)==null?void 0:t.getConnection({connectorId:e.id,connections:this.connections,connectors:this.connectors});switch(s.type){case lt.CONNECTOR_TYPE_WALLET_CONNECT:s.provider.session&&s.provider.disconnect();break;case lt.CONNECTOR_TYPE_AUTH:await((r=s.provider)==null?void 0:r.disconnect());break;case lt.CONNECTOR_TYPE_ANNOUNCED:case lt.CONNECTOR_TYPE_EXTERNAL:await this.revokeProviderPermissions(s.provider);break;default:throw new Error("Unsupported provider type")}return s.id&&(this.removeProviderListeners(s.id),this.deleteConnection(s.id)),this.connections.length===0?this.emit("disconnect"):this.emitFirstAvailableConnection(),{connections:i?[i]:[]}}return this.disconnectAll()}async getBalance(e){const t=e.address,r=this.getCaipNetworks().find(s=>{var i;return s.id.toString()===((i=e.chainId)==null?void 0:i.toString())});if(!t)return Promise.resolve({balance:"0.00",symbol:"ETH"});if(r&&r.chainNamespace===H.CHAIN.EVM){const s=`${r.caipNetworkId}:${t}`,i=this.balancePromises[s];if(i)return i;const o=Q.getNativeBalanceCacheForCaipAddress(s);if(o)return{balance:o.balance,symbol:o.symbol};const a=new Ife(r.rpcUrls.default.http[0],{chainId:r.id,name:r.name});if(a)try{return this.balancePromises[s]=new Promise(async c=>{try{const l=await a.getBalance(t),u=wle(l);Q.updateNativeBalanceCache({caipAddress:s,balance:u,symbol:r.nativeCurrency.symbol,timestamp:Date.now()}),c({balance:u,symbol:r.nativeCurrency.symbol})}catch{c({balance:"0.00",symbol:"ETH"})}}).finally(()=>{delete this.balancePromises[s]}),this.balancePromises[s]||{balance:"0.00",symbol:"ETH"}}catch{return{balance:"0.00",symbol:"ETH"}}}return{balance:"0.00",symbol:"ETH"}}async switchNetwork(e){var i,o;const{caipNetwork:t,provider:r,providerType:s}=e;if(s==="AUTH"){await super.switchNetwork(e);return}try{await r.request({method:"wallet_switchEthereumChain",params:[{chainId:Jh.numberToHexString(t.id)}]})}catch(a){if(a.code===oa.ERROR_CODE_UNRECOGNIZED_CHAIN_ID||a.code===oa.ERROR_INVALID_CHAIN_ID||a.code===oa.ERROR_CODE_DEFAULT||((o=(i=a==null?void 0:a.data)==null?void 0:i.originalError)==null?void 0:o.code)===oa.ERROR_CODE_UNRECOGNIZED_CHAIN_ID)await Jh.addEthereumChain(r,t);else if(s==="ANNOUNCED"||s==="EXTERNAL"||s==="INJECTED")throw new Error("Chain is not supported")}}getWalletConnectProvider(){var e;return(e=this.connectors.find(t=>t.type==="WALLET_CONNECT"))==null?void 0:e.provider}async revokeProviderPermissions(e){try{(await e.request({method:"wallet_getPermissions"})).find(s=>s.parentCapability==="eth_accounts")&&await e.request({method:"wallet_revokePermissions",params:[{eth_accounts:{}}]})}catch(t){console.info("Could not revoke permissions from wallet. Disconnecting...",t)}}async getCapabilities(e){const t=mt.getProvider(H.CHAIN.EVM);if(!t)throw new Error("Provider is undefined");return await t.request({method:"wallet_getCapabilities",params:[e]})}async grantPermissions(e){const t=mt.getProvider(H.CHAIN.EVM);if(!t)throw new Error("Provider is undefined");return await t.request({method:"wallet_grantPermissions",params:e})}async revokePermissions(e){const t=mt.getProvider(H.CHAIN.EVM);if(!t)throw new Error("Provider is undefined");return await t.request({method:"wallet_revokePermissions",params:[e]})}async walletGetAssets(e){const t=mt.getProvider(H.CHAIN.EVM);if(!t)throw new Error("Provider is undefined");return await t.request({method:"wallet_getAssets",params:[e]})}toChecksummedAddress(e){try{return Tt(e.toLowerCase())}catch{return e}}}class Tfe{constructor(){this._events={}}on(e,t){return this._events[e]||(this._events[e]=[]),this._events[e].push(t),()=>{this._events[e]=this._events[e].filter(r=>r!==t)}}publish(e,...t){this._events[e]&&this._events[e].forEach(r=>{r(...t)})}}const Nfe={name:"UHT Crypto",description:"Turning healthy living into real rewards",url:"https://uhtcrypto.com/",icons:["https://avatars.mywebsite.com/"]},Gc=Kce({metadata:Nfe,adapters:[new Sfe],networks:[xM,Mce],projectId:"cb5946e99ced72b20309cf8519d852d2",features:{socials:!1,email:!1}});async function Zve(){return new Promise((n,e)=>{Gc.open().then(n).catch(e)})}async function Jve(){return new Promise((n,e)=>{Gc.disconnect().then(n).catch(e)})}function Xve(){return Gc.getAddress()}function e1e(){return Gc.getIsConnectedState()}async function t1e(n){return Gc.switchNetwork(xM)}function n1e(){return Gc.getChainId()}function r1e(){const n=new Tfe;return Gc.subscribeAccount(e=>{n.publish("STATE_CHANGED",e)}),n}function s1e(){return Gc.getWalletProvider()}var cP={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const S4=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let s=n.charCodeAt(r);s<128?e[t++]=s:s<2048?(e[t++]=s>>6|192,e[t++]=s&63|128):(s&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=s>>18|240,e[t++]=s>>12&63|128,e[t++]=s>>6&63|128,e[t++]=s&63|128):(e[t++]=s>>12|224,e[t++]=s>>6&63|128,e[t++]=s&63|128)}return e},Ofe=function(n){const e=[];let t=0,r=0;for(;t<n.length;){const s=n[t++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=n[t++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=n[t++],o=n[t++],a=n[t++],c=((s&7)<<18|(i&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(c>>10)),e[r++]=String.fromCharCode(56320+(c&1023))}else{const i=n[t++],o=n[t++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},T4={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<n.length;s+=3){const i=n[s],o=s+1<n.length,a=o?n[s+1]:0,c=s+2<n.length,l=c?n[s+2]:0,u=i>>2,h=(i&3)<<4|a>>4;let d=(a&15)<<2|l>>6,f=l&63;c||(f=64,o||(d=64)),r.push(t[u],t[h],t[d],t[f])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(S4(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):Ofe(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<n.length;){const i=t[n.charAt(s++)],a=s<n.length?t[n.charAt(s)]:0;++s;const l=s<n.length?t[n.charAt(s)]:64;++s;const h=s<n.length?t[n.charAt(s)]:64;if(++s,i==null||a==null||l==null||h==null)throw new xfe;const d=i<<2|a>>4;if(r.push(d),l!==64){const f=a<<4&240|l>>2;if(r.push(f),h!==64){const p=l<<6&192|h;r.push(p)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class xfe extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Rfe=function(n){const e=S4(n);return T4.encodeByteArray(e,!0)},gb=function(n){return Rfe(n).replace(/\./g,"")},Pfe=function(n){try{return T4.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kfe(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dfe=()=>kfe().__FIREBASE_DEFAULTS__,Ufe=()=>{if(typeof process>"u"||typeof cP>"u")return;const n=cP.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},$fe=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&Pfe(n[1]);return e&&JSON.parse(e)},N4=()=>{try{return Dfe()||Ufe()||$fe()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},Mfe=n=>{var e,t;return(t=(e=N4())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},Lfe=n=>{const e=Mfe(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},O4=()=>{var n;return(n=N4())===null||n===void 0?void 0:n.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bfe{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ffe(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},r=e||"demo-project",s=n.iat||0,i=n.sub||n.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},n);return[gb(JSON.stringify(t)),gb(JSON.stringify(o)),""].join(".")}function jfe(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function x4(){try{return typeof indexedDB=="object"}catch{return!1}}function R4(){return new Promise((n,e)=>{try{let t=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},s.onupgradeneeded=()=>{t=!1},s.onerror=()=>{var i;e(((i=s.error)===null||i===void 0?void 0:i.message)||"")}}catch(t){e(t)}})}function Hfe(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vfe="FirebaseError";class Kc extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=Vfe,Object.setPrototypeOf(this,Kc.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,NE.prototype.create)}}class NE{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){const r=t[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?qfe(i,r):"Error",a=`${this.serviceName}: ${o} (${s}).`;return new Kc(s,a,r)}}function qfe(n,e){return n.replace(zfe,(t,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const zfe=/\{\$([^}]+)}/g;function iI(n,e){if(n===e)return!0;const t=Object.keys(n),r=Object.keys(e);for(const s of t){if(!r.includes(s))return!1;const i=n[s],o=e[s];if(lP(i)&&lP(o)){if(!iI(i,o))return!1}else if(i!==o)return!1}for(const s of r)if(!t.includes(s))return!1;return!0}function lP(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wfe=1e3,Gfe=2,Kfe=4*60*60*1e3,Yfe=.5;function uP(n,e=Wfe,t=Gfe){const r=e*Math.pow(t,n),s=Math.round(Yfe*r*(Math.random()-.5)*2);return Math.min(Kfe,r+s)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function So(n){return n&&n._delegate?n._delegate:n}class va{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dl="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qfe{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const r=new Bfe;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:t});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(t=e==null?void 0:e.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(s)return null;throw i}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(Jfe(e))try{this.getOrInitializeService({instanceIdentifier:dl})}catch{}for(const[t,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(t);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=dl){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=dl){return this.instances.has(e)}getOptions(e=dl){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[i,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(i);r===a&&o.resolve(s)}return s}onInit(e,t){var r;const s=this.normalizeInstanceIdentifier(t),i=(r=this.onInitCallbacks.get(s))!==null&&r!==void 0?r:new Set;i.add(e),this.onInitCallbacks.set(s,i);const o=this.instances.get(s);return o&&e(o,s),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const s of r)try{s(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:Zfe(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=dl){return this.component?this.component.multipleInstances?e:dl:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function Zfe(n){return n===dl?void 0:n}function Jfe(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xfe{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new Qfe(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ct;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(Ct||(Ct={}));const epe={debug:Ct.DEBUG,verbose:Ct.VERBOSE,info:Ct.INFO,warn:Ct.WARN,error:Ct.ERROR,silent:Ct.SILENT},tpe=Ct.INFO,npe={[Ct.DEBUG]:"log",[Ct.VERBOSE]:"log",[Ct.INFO]:"info",[Ct.WARN]:"warn",[Ct.ERROR]:"error"},rpe=(n,e,...t)=>{if(e<n.logLevel)return;const r=new Date().toISOString(),s=npe[e];if(s)console[s](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class dS{constructor(e){this.name=e,this._logLevel=tpe,this._logHandler=rpe,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ct))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?epe[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ct.DEBUG,...e),this._logHandler(this,Ct.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ct.VERBOSE,...e),this._logHandler(this,Ct.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ct.INFO,...e),this._logHandler(this,Ct.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ct.WARN,...e),this._logHandler(this,Ct.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ct.ERROR,...e),this._logHandler(this,Ct.ERROR,...e)}}const spe=(n,e)=>e.some(t=>n instanceof t);let hP,dP;function ipe(){return hP||(hP=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function ope(){return dP||(dP=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const P4=new WeakMap,oI=new WeakMap,k4=new WeakMap,B1=new WeakMap,fS=new WeakMap;function ape(n){const e=new Promise((t,r)=>{const s=()=>{n.removeEventListener("success",i),n.removeEventListener("error",o)},i=()=>{t(Rc(n.result)),s()},o=()=>{r(n.error),s()};n.addEventListener("success",i),n.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&P4.set(t,n)}).catch(()=>{}),fS.set(e,n),e}function cpe(n){if(oI.has(n))return;const e=new Promise((t,r)=>{const s=()=>{n.removeEventListener("complete",i),n.removeEventListener("error",o),n.removeEventListener("abort",o)},i=()=>{t(),s()},o=()=>{r(n.error||new DOMException("AbortError","AbortError")),s()};n.addEventListener("complete",i),n.addEventListener("error",o),n.addEventListener("abort",o)});oI.set(n,e)}let aI={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return oI.get(n);if(e==="objectStoreNames")return n.objectStoreNames||k4.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Rc(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function lpe(n){aI=n(aI)}function upe(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const r=n.call(F1(this),e,...t);return k4.set(r,e.sort?e.sort():[e]),Rc(r)}:ope().includes(n)?function(...e){return n.apply(F1(this),e),Rc(P4.get(this))}:function(...e){return Rc(n.apply(F1(this),e))}}function hpe(n){return typeof n=="function"?upe(n):(n instanceof IDBTransaction&&cpe(n),spe(n,ipe())?new Proxy(n,aI):n)}function Rc(n){if(n instanceof IDBRequest)return ape(n);if(B1.has(n))return B1.get(n);const e=hpe(n);return e!==n&&(B1.set(n,e),fS.set(e,n)),e}const F1=n=>fS.get(n);function dpe(n,e,{blocked:t,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(n,e),a=Rc(o);return r&&o.addEventListener("upgradeneeded",c=>{r(Rc(o.result),c.oldVersion,c.newVersion,Rc(o.transaction),c)}),t&&o.addEventListener("blocked",c=>t(c.oldVersion,c.newVersion,c)),a.then(c=>{i&&c.addEventListener("close",()=>i()),s&&c.addEventListener("versionchange",l=>s(l.oldVersion,l.newVersion,l))}).catch(()=>{}),a}const fpe=["get","getKey","getAll","getAllKeys","count"],ppe=["put","add","delete","clear"],j1=new Map;function fP(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(j1.get(e))return j1.get(e);const t=e.replace(/FromIndex$/,""),r=e!==t,s=ppe.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(s||fpe.includes(t)))return;const i=async function(o,...a){const c=this.transaction(o,s?"readwrite":"readonly");let l=c.store;return r&&(l=l.index(a.shift())),(await Promise.all([l[t](...a),s&&c.done]))[0]};return j1.set(e,i),i}lpe(n=>({...n,get:(e,t,r)=>fP(e,t)||n.get(e,t,r),has:(e,t)=>!!fP(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gpe{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(mpe(t)){const r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}}function mpe(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const cI="@firebase/app",pP="0.9.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nu=new dS("@firebase/app"),ype="@firebase/app-compat",wpe="@firebase/analytics-compat",bpe="@firebase/analytics",Epe="@firebase/app-check-compat",vpe="@firebase/app-check",Ape="@firebase/auth",Cpe="@firebase/auth-compat",Ipe="@firebase/database",_pe="@firebase/database-compat",Spe="@firebase/functions",Tpe="@firebase/functions-compat",Npe="@firebase/installations",Ope="@firebase/installations-compat",xpe="@firebase/messaging",Rpe="@firebase/messaging-compat",Ppe="@firebase/performance",kpe="@firebase/performance-compat",Dpe="@firebase/remote-config",Upe="@firebase/remote-config-compat",$pe="@firebase/storage",Mpe="@firebase/storage-compat",Lpe="@firebase/firestore",Bpe="@firebase/firestore-compat",Fpe="firebase",jpe="9.23.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lI="[DEFAULT]",Hpe={[cI]:"fire-core",[ype]:"fire-core-compat",[bpe]:"fire-analytics",[wpe]:"fire-analytics-compat",[vpe]:"fire-app-check",[Epe]:"fire-app-check-compat",[Ape]:"fire-auth",[Cpe]:"fire-auth-compat",[Ipe]:"fire-rtdb",[_pe]:"fire-rtdb-compat",[Spe]:"fire-fn",[Tpe]:"fire-fn-compat",[Npe]:"fire-iid",[Ope]:"fire-iid-compat",[xpe]:"fire-fcm",[Rpe]:"fire-fcm-compat",[Ppe]:"fire-perf",[kpe]:"fire-perf-compat",[Dpe]:"fire-rc",[Upe]:"fire-rc-compat",[$pe]:"fire-gcs",[Mpe]:"fire-gcs-compat",[Lpe]:"fire-fst",[Bpe]:"fire-fst-compat","fire-js":"fire-js",[Fpe]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mb=new Map,uI=new Map;function Vpe(n,e){try{n.container.addComponent(e)}catch(t){Nu.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function jc(n){const e=n.name;if(uI.has(e))return Nu.debug(`There were multiple attempts to register component ${e}.`),!1;uI.set(e,n);for(const t of mb.values())Vpe(t,n);return!0}function pS(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qpe={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."},Pc=new NE("app","Firebase",qpe);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zpe{constructor(e,t,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new va("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Pc.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wpe=jpe;function gS(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const r=Object.assign({name:lI,automaticDataCollectionEnabled:!1},e),s=r.name;if(typeof s!="string"||!s)throw Pc.create("bad-app-name",{appName:String(s)});if(t||(t=O4()),!t)throw Pc.create("no-options");const i=mb.get(s);if(i){if(iI(t,i.options)&&iI(r,i.config))return i;throw Pc.create("duplicate-app",{appName:s})}const o=new Xfe(s);for(const c of uI.values())o.addComponent(c);const a=new zpe(t,r,o);return mb.set(s,a),a}function Gpe(n=lI){const e=mb.get(n);if(!e&&n===lI&&O4())return gS();if(!e)throw Pc.create("no-app",{appName:n});return e}function vo(n,e,t){var r;let s=(r=Hpe[n])!==null&&r!==void 0?r:n;t&&(s+=`-${t}`);const i=s.match(/\s|\//),o=e.match(/\s|\//);if(i||o){const a=[`Unable to register library "${s}" with version "${e}":`];i&&a.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Nu.warn(a.join(" "));return}jc(new va(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kpe="firebase-heartbeat-database",Ype=1,ym="firebase-heartbeat-store";let H1=null;function D4(){return H1||(H1=dpe(Kpe,Ype,{upgrade:(n,e)=>{switch(e){case 0:n.createObjectStore(ym)}}}).catch(n=>{throw Pc.create("idb-open",{originalErrorMessage:n.message})})),H1}async function Qpe(n){try{return await(await D4()).transaction(ym).objectStore(ym).get(U4(n))}catch(e){if(e instanceof Kc)Nu.warn(e.message);else{const t=Pc.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Nu.warn(t.message)}}}async function gP(n,e){try{const r=(await D4()).transaction(ym,"readwrite");await r.objectStore(ym).put(e,U4(n)),await r.done}catch(t){if(t instanceof Kc)Nu.warn(t.message);else{const r=Pc.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});Nu.warn(r.message)}}}function U4(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zpe=1024,Jpe=30*24*60*60*1e3;class Xpe{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new tge(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=mP();if(this._heartbeatsCache===null&&(this._heartbeatsCache=await this._heartbeatsCachePromise),!(this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(s=>s.date===r)))return this._heartbeatsCache.heartbeats.push({date:r,agent:t}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(s=>{const i=new Date(s.date).valueOf();return Date.now()-i<=Jpe}),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache===null||this._heartbeatsCache.heartbeats.length===0)return"";const e=mP(),{heartbeatsToSend:t,unsentEntries:r}=ege(this._heartbeatsCache.heartbeats),s=gb(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}}function mP(){return new Date().toISOString().substring(0,10)}function ege(n,e=Zpe){const t=[];let r=n.slice();for(const s of n){const i=t.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),yP(t)>e){i.dates.pop();break}}else if(t.push({agent:s.agent,dates:[s.date]}),yP(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}class tge{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return x4()?R4().then(()=>!0).catch(()=>!1):!1}async read(){return await this._canUseIndexedDBPromise?await Qpe(this.app)||{heartbeats:[]}:{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const s=await this.read();return gP(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const s=await this.read();return gP(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function yP(n){return gb(JSON.stringify({version:2,heartbeats:n})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nge(n){jc(new va("platform-logger",e=>new gpe(e),"PRIVATE")),jc(new va("heartbeat",e=>new Xpe(e),"PRIVATE")),vo(cI,pP,n),vo(cI,pP,"esm2017"),vo("fire-js","")}nge("");var rge=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},ae,mS=mS||{},$e=rge||self;function OE(n){var e=typeof n;return e=e!="object"?e:n?Array.isArray(n)?"array":e:"null",e=="array"||e=="object"&&typeof n.length=="number"}function xE(n){var e=typeof n;return e=="object"&&n!=null||e=="function"}function sge(n){return Object.prototype.hasOwnProperty.call(n,V1)&&n[V1]||(n[V1]=++ige)}var V1="closure_uid_"+(1e9*Math.random()>>>0),ige=0;function oge(n,e,t){return n.call.apply(n.bind,arguments)}function age(n,e,t){if(!n)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var s=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(s,r),n.apply(e,s)}}return function(){return n.apply(e,arguments)}}function mr(n,e,t){return Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?mr=oge:mr=age,mr.apply(null,arguments)}function Dw(n,e){var t=Array.prototype.slice.call(arguments,1);return function(){var r=t.slice();return r.push.apply(r,arguments),n.apply(this,r)}}function Dn(n,e){function t(){}t.prototype=e.prototype,n.$=e.prototype,n.prototype=new t,n.prototype.constructor=n,n.ac=function(r,s,i){for(var o=Array(arguments.length-2),a=2;a<arguments.length;a++)o[a-2]=arguments[a];return e.prototype[s].apply(r,o)}}function Yc(){this.s=this.s,this.o=this.o}var cge=0;Yc.prototype.s=!1;Yc.prototype.sa=function(){!this.s&&(this.s=!0,this.N(),cge!=0)&&sge(this)};Yc.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const $4=Array.prototype.indexOf?function(n,e){return Array.prototype.indexOf.call(n,e,void 0)}:function(n,e){if(typeof n=="string")return typeof e!="string"||e.length!=1?-1:n.indexOf(e,0);for(let t=0;t<n.length;t++)if(t in n&&n[t]===e)return t;return-1};function yS(n){const e=n.length;if(0<e){const t=Array(e);for(let r=0;r<e;r++)t[r]=n[r];return t}return[]}function wP(n,e){for(let t=1;t<arguments.length;t++){const r=arguments[t];if(OE(r)){const s=n.length||0,i=r.length||0;n.length=s+i;for(let o=0;o<i;o++)n[s+o]=r[o]}else n.push(r)}}function yr(n,e){this.type=n,this.g=this.target=e,this.defaultPrevented=!1}yr.prototype.h=function(){this.defaultPrevented=!0};var lge=function(){if(!$e.addEventListener||!Object.defineProperty)return!1;var n=!1,e=Object.defineProperty({},"passive",{get:function(){n=!0}});try{$e.addEventListener("test",()=>{},e),$e.removeEventListener("test",()=>{},e)}catch{}return n}();function wm(n){return/^[\s\xa0]*$/.test(n)}function RE(){var n=$e.navigator;return n&&(n=n.userAgent)?n:""}function lo(n){return RE().indexOf(n)!=-1}function wS(n){return wS[" "](n),n}wS[" "]=function(){};function uge(n,e){var t=rme;return Object.prototype.hasOwnProperty.call(t,n)?t[n]:t[n]=e(n)}var hge=lo("Opera"),wf=lo("Trident")||lo("MSIE"),M4=lo("Edge"),hI=M4||wf,L4=lo("Gecko")&&!(RE().toLowerCase().indexOf("webkit")!=-1&&!lo("Edge"))&&!(lo("Trident")||lo("MSIE"))&&!lo("Edge"),dge=RE().toLowerCase().indexOf("webkit")!=-1&&!lo("Edge");function B4(){var n=$e.document;return n?n.documentMode:void 0}var dI;e:{var q1="",z1=function(){var n=RE();if(L4)return/rv:([^\);]+)(\)|;)/.exec(n);if(M4)return/Edge\/([\d\.]+)/.exec(n);if(wf)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(n);if(dge)return/WebKit\/(\S+)/.exec(n);if(hge)return/(?:Version)[ \/]?(\S+)/.exec(n)}();if(z1&&(q1=z1?z1[1]:""),wf){var W1=B4();if(W1!=null&&W1>parseFloat(q1)){dI=String(W1);break e}}dI=q1}var fI;if($e.document&&wf){var bP=B4();fI=bP||parseInt(dI,10)||void 0}else fI=void 0;var fge=fI;function bm(n,e){if(yr.call(this,n?n.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,n){var t=this.type=n.type,r=n.changedTouches&&n.changedTouches.length?n.changedTouches[0]:null;if(this.target=n.target||n.srcElement,this.g=e,e=n.relatedTarget){if(L4){e:{try{wS(e.nodeName);var s=!0;break e}catch{}s=!1}s||(e=null)}}else t=="mouseover"?e=n.fromElement:t=="mouseout"&&(e=n.toElement);this.relatedTarget=e,r?(this.clientX=r.clientX!==void 0?r.clientX:r.pageX,this.clientY=r.clientY!==void 0?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=n.clientX!==void 0?n.clientX:n.pageX,this.clientY=n.clientY!==void 0?n.clientY:n.pageY,this.screenX=n.screenX||0,this.screenY=n.screenY||0),this.button=n.button,this.key=n.key||"",this.ctrlKey=n.ctrlKey,this.altKey=n.altKey,this.shiftKey=n.shiftKey,this.metaKey=n.metaKey,this.pointerId=n.pointerId||0,this.pointerType=typeof n.pointerType=="string"?n.pointerType:pge[n.pointerType]||"",this.state=n.state,this.i=n,n.defaultPrevented&&bm.$.h.call(this)}}Dn(bm,yr);var pge={2:"touch",3:"pen",4:"mouse"};bm.prototype.h=function(){bm.$.h.call(this);var n=this.i;n.preventDefault?n.preventDefault():n.returnValue=!1};var PE="closure_listenable_"+(1e6*Math.random()|0),gge=0;function mge(n,e,t,r,s){this.listener=n,this.proxy=null,this.src=e,this.type=t,this.capture=!!r,this.la=s,this.key=++gge,this.fa=this.ia=!1}function kE(n){n.fa=!0,n.listener=null,n.proxy=null,n.src=null,n.la=null}function bS(n,e,t){for(const r in n)e.call(t,n[r],r,n)}function yge(n,e){for(const t in n)e.call(void 0,n[t],t,n)}function F4(n){const e={};for(const t in n)e[t]=n[t];return e}const EP="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function j4(n,e){let t,r;for(let s=1;s<arguments.length;s++){r=arguments[s];for(t in r)n[t]=r[t];for(let i=0;i<EP.length;i++)t=EP[i],Object.prototype.hasOwnProperty.call(r,t)&&(n[t]=r[t])}}function DE(n){this.src=n,this.g={},this.h=0}DE.prototype.add=function(n,e,t,r,s){var i=n.toString();n=this.g[i],n||(n=this.g[i]=[],this.h++);var o=gI(n,e,r,s);return-1<o?(e=n[o],t||(e.ia=!1)):(e=new mge(e,this.src,i,!!r,s),e.ia=t,n.push(e)),e};function pI(n,e){var t=e.type;if(t in n.g){var r=n.g[t],s=$4(r,e),i;(i=0<=s)&&Array.prototype.splice.call(r,s,1),i&&(kE(e),n.g[t].length==0&&(delete n.g[t],n.h--))}}function gI(n,e,t,r){for(var s=0;s<n.length;++s){var i=n[s];if(!i.fa&&i.listener==e&&i.capture==!!t&&i.la==r)return s}return-1}var ES="closure_lm_"+(1e6*Math.random()|0),G1={};function H4(n,e,t,r,s){if(Array.isArray(e)){for(var i=0;i<e.length;i++)H4(n,e[i],t,r,s);return null}return t=z4(t),n&&n[PE]?n.O(e,t,xE(r)?!!r.capture:!!r,s):wge(n,e,t,!1,r,s)}function wge(n,e,t,r,s,i){if(!e)throw Error("Invalid event type");var o=xE(s)?!!s.capture:!!s,a=AS(n);if(a||(n[ES]=a=new DE(n)),t=a.add(e,t,r,o,i),t.proxy)return t;if(r=bge(),t.proxy=r,r.src=n,r.listener=t,n.addEventListener)lge||(s=o),s===void 0&&(s=!1),n.addEventListener(e.toString(),r,s);else if(n.attachEvent)n.attachEvent(q4(e.toString()),r);else if(n.addListener&&n.removeListener)n.addListener(r);else throw Error("addEventListener and attachEvent are unavailable.");return t}function bge(){function n(t){return e.call(n.src,n.listener,t)}const e=Ege;return n}function V4(n,e,t,r,s){if(Array.isArray(e))for(var i=0;i<e.length;i++)V4(n,e[i],t,r,s);else r=xE(r)?!!r.capture:!!r,t=z4(t),n&&n[PE]?(n=n.i,e=String(e).toString(),e in n.g&&(i=n.g[e],t=gI(i,t,r,s),-1<t&&(kE(i[t]),Array.prototype.splice.call(i,t,1),i.length==0&&(delete n.g[e],n.h--)))):n&&(n=AS(n))&&(e=n.g[e.toString()],n=-1,e&&(n=gI(e,t,r,s)),(t=-1<n?e[n]:null)&&vS(t))}function vS(n){if(typeof n!="number"&&n&&!n.fa){var e=n.src;if(e&&e[PE])pI(e.i,n);else{var t=n.type,r=n.proxy;e.removeEventListener?e.removeEventListener(t,r,n.capture):e.detachEvent?e.detachEvent(q4(t),r):e.addListener&&e.removeListener&&e.removeListener(r),(t=AS(e))?(pI(t,n),t.h==0&&(t.src=null,e[ES]=null)):kE(n)}}}function q4(n){return n in G1?G1[n]:G1[n]="on"+n}function Ege(n,e){if(n.fa)n=!0;else{e=new bm(e,this);var t=n.listener,r=n.la||n.src;n.ia&&vS(n),n=t.call(r,e)}return n}function AS(n){return n=n[ES],n instanceof DE?n:null}var K1="__closure_events_fn_"+(1e9*Math.random()>>>0);function z4(n){return typeof n=="function"?n:(n[K1]||(n[K1]=function(e){return n.handleEvent(e)}),n[K1])}function kn(){Yc.call(this),this.i=new DE(this),this.S=this,this.J=null}Dn(kn,Yc);kn.prototype[PE]=!0;kn.prototype.removeEventListener=function(n,e,t,r){V4(this,n,e,t,r)};function Gn(n,e){var t,r=n.J;if(r)for(t=[];r;r=r.J)t.push(r);if(n=n.S,r=e.type||e,typeof e=="string")e=new yr(e,n);else if(e instanceof yr)e.target=e.target||n;else{var s=e;e=new yr(r,n),j4(e,s)}if(s=!0,t)for(var i=t.length-1;0<=i;i--){var o=e.g=t[i];s=Uw(o,r,!0,e)&&s}if(o=e.g=n,s=Uw(o,r,!0,e)&&s,s=Uw(o,r,!1,e)&&s,t)for(i=0;i<t.length;i++)o=e.g=t[i],s=Uw(o,r,!1,e)&&s}kn.prototype.N=function(){if(kn.$.N.call(this),this.i){var n=this.i,e;for(e in n.g){for(var t=n.g[e],r=0;r<t.length;r++)kE(t[r]);delete n.g[e],n.h--}}this.J=null};kn.prototype.O=function(n,e,t,r){return this.i.add(String(n),e,!1,t,r)};kn.prototype.P=function(n,e,t,r){return this.i.add(String(n),e,!0,t,r)};function Uw(n,e,t,r){if(e=n.i.g[String(e)],!e)return!0;e=e.concat();for(var s=!0,i=0;i<e.length;++i){var o=e[i];if(o&&!o.fa&&o.capture==t){var a=o.listener,c=o.la||o.src;o.ia&&pI(n.i,o),s=a.call(c,r)!==!1&&s}}return s&&!r.defaultPrevented}var CS=$e.JSON.stringify;class vge{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}function Age(){var n=IS;let e=null;return n.g&&(e=n.g,n.g=n.g.next,n.g||(n.h=null),e.next=null),e}class Cge{constructor(){this.h=this.g=null}add(e,t){const r=W4.get();r.set(e,t),this.h?this.h.next=r:this.g=r,this.h=r}}var W4=new vge(()=>new Ige,n=>n.reset());class Ige{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}function _ge(n){var e=1;n=n.split(":");const t=[];for(;0<e&&n.length;)t.push(n.shift()),e--;return n.length&&t.push(n.join(":")),t}function Sge(n){$e.setTimeout(()=>{throw n},0)}let Em,vm=!1,IS=new Cge,G4=()=>{const n=$e.Promise.resolve(void 0);Em=()=>{n.then(Tge)}};var Tge=()=>{for(var n;n=Age();){try{n.h.call(n.g)}catch(t){Sge(t)}var e=W4;e.j(n),100>e.h&&(e.h++,n.next=e.g,e.g=n)}vm=!1};function UE(n,e){kn.call(this),this.h=n||1,this.g=e||$e,this.j=mr(this.qb,this),this.l=Date.now()}Dn(UE,kn);ae=UE.prototype;ae.ga=!1;ae.T=null;ae.qb=function(){if(this.ga){var n=Date.now()-this.l;0<n&&n<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-n):(this.T&&(this.g.clearTimeout(this.T),this.T=null),Gn(this,"tick"),this.ga&&(_S(this),this.start()))}};ae.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())};function _S(n){n.ga=!1,n.T&&(n.g.clearTimeout(n.T),n.T=null)}ae.N=function(){UE.$.N.call(this),_S(this),delete this.g};function SS(n,e,t){if(typeof n=="function")t&&(n=mr(n,t));else if(n&&typeof n.handleEvent=="function")n=mr(n.handleEvent,n);else throw Error("Invalid listener argument");return 2147483647<Number(e)?-1:$e.setTimeout(n,e||0)}function K4(n){n.g=SS(()=>{n.g=null,n.i&&(n.i=!1,K4(n))},n.j);const e=n.h;n.h=null,n.m.apply(null,e)}class Nge extends Yc{constructor(e,t){super(),this.m=e,this.j=t,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:K4(this)}N(){super.N(),this.g&&($e.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Am(n){Yc.call(this),this.h=n,this.g={}}Dn(Am,Yc);var vP=[];function Y4(n,e,t,r){Array.isArray(t)||(t&&(vP[0]=t.toString()),t=vP);for(var s=0;s<t.length;s++){var i=H4(e,t[s],r||n.handleEvent,!1,n.h||n);if(!i)break;n.g[i.key]=i}}function Q4(n){bS(n.g,function(e,t){this.g.hasOwnProperty(t)&&vS(e)},n),n.g={}}Am.prototype.N=function(){Am.$.N.call(this),Q4(this)};Am.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};function $E(){this.g=!0}$E.prototype.Ea=function(){this.g=!1};function Oge(n,e,t,r,s,i){n.info(function(){if(n.g)if(i)for(var o="",a=i.split("&"),c=0;c<a.length;c++){var l=a[c].split("=");if(1<l.length){var u=l[0];l=l[1];var h=u.split("_");o=2<=h.length&&h[1]=="type"?o+(u+"="+l+"&"):o+(u+"=redacted&")}}else o=null;else o=i;return"XMLHTTP REQ ("+r+") [attempt "+s+"]: "+e+`
`+t+`
`+o})}function xge(n,e,t,r,s,i,o){n.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+s+"]: "+e+`
`+t+`
`+i+" "+o})}function qh(n,e,t,r){n.info(function(){return"XMLHTTP TEXT ("+e+"): "+Pge(n,t)+(r?" "+r:"")})}function Rge(n,e){n.info(function(){return"TIMEOUT: "+e})}$E.prototype.info=function(){};function Pge(n,e){if(!n.g)return e;if(!e)return null;try{var t=JSON.parse(e);if(t){for(n=0;n<t.length;n++)if(Array.isArray(t[n])){var r=t[n];if(!(2>r.length)){var s=r[1];if(Array.isArray(s)&&!(1>s.length)){var i=s[0];if(i!="noop"&&i!="stop"&&i!="close")for(var o=1;o<s.length;o++)s[o]=""}}}}return CS(t)}catch{return e}}var zu={},AP=null;function ME(){return AP=AP||new kn}zu.Ta="serverreachability";function Z4(n){yr.call(this,zu.Ta,n)}Dn(Z4,yr);function Cm(n){const e=ME();Gn(e,new Z4(e))}zu.STAT_EVENT="statevent";function J4(n,e){yr.call(this,zu.STAT_EVENT,n),this.stat=e}Dn(J4,yr);function Dr(n){const e=ME();Gn(e,new J4(e,n))}zu.Ua="timingevent";function X4(n,e){yr.call(this,zu.Ua,n),this.size=e}Dn(X4,yr);function _y(n,e){if(typeof n!="function")throw Error("Fn must not be null and must be a function");return $e.setTimeout(function(){n()},e)}var LE={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},e5={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function TS(){}TS.prototype.h=null;function CP(n){return n.h||(n.h=n.i())}function t5(){}var Sy={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function NS(){yr.call(this,"d")}Dn(NS,yr);function OS(){yr.call(this,"c")}Dn(OS,yr);var mI;function BE(){}Dn(BE,TS);BE.prototype.g=function(){return new XMLHttpRequest};BE.prototype.i=function(){return{}};mI=new BE;function Ty(n,e,t,r){this.l=n,this.j=e,this.m=t,this.W=r||1,this.U=new Am(this),this.P=kge,n=hI?125:void 0,this.V=new UE(n),this.I=null,this.i=!1,this.s=this.A=this.v=this.L=this.G=this.Y=this.B=null,this.F=[],this.g=null,this.C=0,this.o=this.u=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new n5}function n5(){this.i=null,this.g="",this.h=!1}var kge=45e3,yI={},yb={};ae=Ty.prototype;ae.setTimeout=function(n){this.P=n};function wI(n,e,t){n.L=1,n.v=jE(Aa(e)),n.s=t,n.S=!0,r5(n,null)}function r5(n,e){n.G=Date.now(),Ny(n),n.A=Aa(n.v);var t=n.A,r=n.W;Array.isArray(r)||(r=[String(r)]),h5(t.i,"t",r),n.C=0,t=n.l.J,n.h=new n5,n.g=P5(n.l,t?e:null,!n.s),0<n.O&&(n.M=new Nge(mr(n.Pa,n,n.g),n.O)),Y4(n.U,n.g,"readystatechange",n.nb),e=n.I?F4(n.I):{},n.s?(n.u||(n.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",n.g.ha(n.A,n.u,n.s,e)):(n.u="GET",n.g.ha(n.A,n.u,null,e)),Cm(),Oge(n.j,n.u,n.A,n.m,n.W,n.s)}ae.nb=function(n){n=n.target;const e=this.M;e&&po(n)==3?e.l():this.Pa(n)};ae.Pa=function(n){try{if(n==this.g)e:{const u=po(this.g);var e=this.g.Ia();const h=this.g.da();if(!(3>u)&&(u!=3||hI||this.g&&(this.h.h||this.g.ja()||TP(this.g)))){this.J||u!=4||e==7||(e==8||0>=h?Cm(3):Cm(2)),FE(this);var t=this.g.da();this.ca=t;t:if(s5(this)){var r=TP(this.g);n="";var s=r.length,i=po(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Rl(this),og(this);var o="";break t}this.h.i=new $e.TextDecoder}for(e=0;e<s;e++)this.h.h=!0,n+=this.h.i.decode(r[e],{stream:i&&e==s-1});r.splice(0,s),this.h.g+=n,this.C=0,o=this.h.g}else o=this.g.ja();if(this.i=t==200,xge(this.j,this.u,this.A,this.m,this.W,u,t),this.i){if(this.aa&&!this.K){t:{if(this.g){var a,c=this.g;if((a=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!wm(a)){var l=a;break t}}l=null}if(t=l)qh(this.j,this.m,t,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,bI(this,t);else{this.i=!1,this.o=3,Dr(12),Rl(this),og(this);break e}}this.S?(i5(this,u,o),hI&&this.i&&u==3&&(Y4(this.U,this.V,"tick",this.mb),this.V.start())):(qh(this.j,this.m,o,null),bI(this,o)),u==4&&Rl(this),this.i&&!this.J&&(u==4?N5(this.l,this):(this.i=!1,Ny(this)))}else eme(this.g),t==400&&0<o.indexOf("Unknown SID")?(this.o=3,Dr(12)):(this.o=0,Dr(13)),Rl(this),og(this)}}}catch{}finally{}};function s5(n){return n.g?n.u=="GET"&&n.L!=2&&n.l.Ha:!1}function i5(n,e,t){let r=!0,s;for(;!n.J&&n.C<t.length;)if(s=Dge(n,t),s==yb){e==4&&(n.o=4,Dr(14),r=!1),qh(n.j,n.m,null,"[Incomplete Response]");break}else if(s==yI){n.o=4,Dr(15),qh(n.j,n.m,t,"[Invalid Chunk]"),r=!1;break}else qh(n.j,n.m,s,null),bI(n,s);s5(n)&&s!=yb&&s!=yI&&(n.h.g="",n.C=0),e!=4||t.length!=0||n.h.h||(n.o=1,Dr(16),r=!1),n.i=n.i&&r,r?0<t.length&&!n.ba&&(n.ba=!0,e=n.l,e.g==n&&e.ca&&!e.M&&(e.l.info("Great, no buffering proxy detected. Bytes received: "+t.length),US(e),e.M=!0,Dr(11))):(qh(n.j,n.m,t,"[Invalid Chunked Response]"),Rl(n),og(n))}ae.mb=function(){if(this.g){var n=po(this.g),e=this.g.ja();this.C<e.length&&(FE(this),i5(this,n,e),this.i&&n!=4&&Ny(this))}};function Dge(n,e){var t=n.C,r=e.indexOf(`
`,t);return r==-1?yb:(t=Number(e.substring(t,r)),isNaN(t)?yI:(r+=1,r+t>e.length?yb:(e=e.slice(r,r+t),n.C=r+t,e)))}ae.cancel=function(){this.J=!0,Rl(this)};function Ny(n){n.Y=Date.now()+n.P,o5(n,n.P)}function o5(n,e){if(n.B!=null)throw Error("WatchDog timer not null");n.B=_y(mr(n.lb,n),e)}function FE(n){n.B&&($e.clearTimeout(n.B),n.B=null)}ae.lb=function(){this.B=null;const n=Date.now();0<=n-this.Y?(Rge(this.j,this.A),this.L!=2&&(Cm(),Dr(17)),Rl(this),this.o=2,og(this)):o5(this,this.Y-n)};function og(n){n.l.H==0||n.J||N5(n.l,n)}function Rl(n){FE(n);var e=n.M;e&&typeof e.sa=="function"&&e.sa(),n.M=null,_S(n.V),Q4(n.U),n.g&&(e=n.g,n.g=null,e.abort(),e.sa())}function bI(n,e){try{var t=n.l;if(t.H!=0&&(t.g==n||EI(t.i,n))){if(!n.K&&EI(t.i,n)&&t.H==3){try{var r=t.Ja.g.parse(e)}catch{r=null}if(Array.isArray(r)&&r.length==3){var s=r;if(s[0]==0){e:if(!t.u){if(t.g)if(t.g.G+3e3<n.G)Eb(t),qE(t);else break e;DS(t),Dr(18)}}else t.Fa=s[1],0<t.Fa-t.V&&37500>s[2]&&t.G&&t.A==0&&!t.v&&(t.v=_y(mr(t.ib,t),6e3));if(1>=p5(t.i)&&t.oa){try{t.oa()}catch{}t.oa=void 0}}else Pl(t,11)}else if((n.K||t.g==n)&&Eb(t),!wm(e))for(s=t.Ja.g.parse(e),e=0;e<s.length;e++){let l=s[e];if(t.V=l[0],l=l[1],t.H==2)if(l[0]=="c"){t.K=l[1],t.pa=l[2];const u=l[3];u!=null&&(t.ra=u,t.l.info("VER="+t.ra));const h=l[4];h!=null&&(t.Ga=h,t.l.info("SVER="+t.Ga));const d=l[5];d!=null&&typeof d=="number"&&0<d&&(r=1.5*d,t.L=r,t.l.info("backChannelRequestTimeoutMs_="+r)),r=t;const f=n.g;if(f){const p=f.g?f.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(p){var i=r.i;i.g||p.indexOf("spdy")==-1&&p.indexOf("quic")==-1&&p.indexOf("h2")==-1||(i.j=i.l,i.g=new Set,i.h&&(xS(i,i.h),i.h=null))}if(r.F){const g=f.g?f.g.getResponseHeader("X-HTTP-Session-Id"):null;g&&(r.Da=g,Ft(r.I,r.F,g))}}t.H=3,t.h&&t.h.Ba(),t.ca&&(t.S=Date.now()-n.G,t.l.info("Handshake RTT: "+t.S+"ms")),r=t;var o=n;if(r.wa=R5(r,r.J?r.pa:null,r.Y),o.K){g5(r.i,o);var a=o,c=r.L;c&&a.setTimeout(c),a.B&&(FE(a),Ny(a)),r.g=o}else S5(r);0<t.j.length&&zE(t)}else l[0]!="stop"&&l[0]!="close"||Pl(t,7);else t.H==3&&(l[0]=="stop"||l[0]=="close"?l[0]=="stop"?Pl(t,7):kS(t):l[0]!="noop"&&t.h&&t.h.Aa(l),t.A=0)}}Cm(4)}catch{}}function Uge(n){if(n.Z&&typeof n.Z=="function")return n.Z();if(typeof Map<"u"&&n instanceof Map||typeof Set<"u"&&n instanceof Set)return Array.from(n.values());if(typeof n=="string")return n.split("");if(OE(n)){for(var e=[],t=n.length,r=0;r<t;r++)e.push(n[r]);return e}e=[],t=0;for(r in n)e[t++]=n[r];return e}function $ge(n){if(n.ta&&typeof n.ta=="function")return n.ta();if(!n.Z||typeof n.Z!="function"){if(typeof Map<"u"&&n instanceof Map)return Array.from(n.keys());if(!(typeof Set<"u"&&n instanceof Set)){if(OE(n)||typeof n=="string"){var e=[];n=n.length;for(var t=0;t<n;t++)e.push(t);return e}e=[],t=0;for(const r in n)e[t++]=r;return e}}}function a5(n,e){if(n.forEach&&typeof n.forEach=="function")n.forEach(e,void 0);else if(OE(n)||typeof n=="string")Array.prototype.forEach.call(n,e,void 0);else for(var t=$ge(n),r=Uge(n),s=r.length,i=0;i<s;i++)e.call(void 0,r[i],t&&t[i],n)}var c5=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Mge(n,e){if(n){n=n.split("&");for(var t=0;t<n.length;t++){var r=n[t].indexOf("="),s=null;if(0<=r){var i=n[t].substring(0,r);s=n[t].substring(r+1)}else i=n[t];e(i,s?decodeURIComponent(s.replace(/\+/g," ")):"")}}}function hu(n){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,n instanceof hu){this.h=n.h,wb(this,n.j),this.s=n.s,this.g=n.g,bb(this,n.m),this.l=n.l;var e=n.i,t=new Im;t.i=e.i,e.g&&(t.g=new Map(e.g),t.h=e.h),IP(this,t),this.o=n.o}else n&&(e=String(n).match(c5))?(this.h=!1,wb(this,e[1]||"",!0),this.s=Mp(e[2]||""),this.g=Mp(e[3]||"",!0),bb(this,e[4]),this.l=Mp(e[5]||"",!0),IP(this,e[6]||"",!0),this.o=Mp(e[7]||"")):(this.h=!1,this.i=new Im(null,this.h))}hu.prototype.toString=function(){var n=[],e=this.j;e&&n.push(Lp(e,_P,!0),":");var t=this.g;return(t||e=="file")&&(n.push("//"),(e=this.s)&&n.push(Lp(e,_P,!0),"@"),n.push(encodeURIComponent(String(t)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t=this.m,t!=null&&n.push(":",String(t))),(t=this.l)&&(this.g&&t.charAt(0)!="/"&&n.push("/"),n.push(Lp(t,t.charAt(0)=="/"?Fge:Bge,!0))),(t=this.i.toString())&&n.push("?",t),(t=this.o)&&n.push("#",Lp(t,Hge)),n.join("")};function Aa(n){return new hu(n)}function wb(n,e,t){n.j=t?Mp(e,!0):e,n.j&&(n.j=n.j.replace(/:$/,""))}function bb(n,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);n.m=e}else n.m=null}function IP(n,e,t){e instanceof Im?(n.i=e,Vge(n.i,n.h)):(t||(e=Lp(e,jge)),n.i=new Im(e,n.h))}function Ft(n,e,t){n.i.set(e,t)}function jE(n){return Ft(n,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),n}function Mp(n,e){return n?e?decodeURI(n.replace(/%25/g,"%2525")):decodeURIComponent(n):""}function Lp(n,e,t){return typeof n=="string"?(n=encodeURI(n).replace(e,Lge),t&&(n=n.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n):null}function Lge(n){return n=n.charCodeAt(0),"%"+(n>>4&15).toString(16)+(n&15).toString(16)}var _P=/[#\/\?@]/g,Bge=/[#\?:]/g,Fge=/[#\?]/g,jge=/[#\?@]/g,Hge=/#/g;function Im(n,e){this.h=this.g=null,this.i=n||null,this.j=!!e}function Qc(n){n.g||(n.g=new Map,n.h=0,n.i&&Mge(n.i,function(e,t){n.add(decodeURIComponent(e.replace(/\+/g," ")),t)}))}ae=Im.prototype;ae.add=function(n,e){Qc(this),this.i=null,n=Hf(this,n);var t=this.g.get(n);return t||this.g.set(n,t=[]),t.push(e),this.h+=1,this};function l5(n,e){Qc(n),e=Hf(n,e),n.g.has(e)&&(n.i=null,n.h-=n.g.get(e).length,n.g.delete(e))}function u5(n,e){return Qc(n),e=Hf(n,e),n.g.has(e)}ae.forEach=function(n,e){Qc(this),this.g.forEach(function(t,r){t.forEach(function(s){n.call(e,s,r,this)},this)},this)};ae.ta=function(){Qc(this);const n=Array.from(this.g.values()),e=Array.from(this.g.keys()),t=[];for(let r=0;r<e.length;r++){const s=n[r];for(let i=0;i<s.length;i++)t.push(e[r])}return t};ae.Z=function(n){Qc(this);let e=[];if(typeof n=="string")u5(this,n)&&(e=e.concat(this.g.get(Hf(this,n))));else{n=Array.from(this.g.values());for(let t=0;t<n.length;t++)e=e.concat(n[t])}return e};ae.set=function(n,e){return Qc(this),this.i=null,n=Hf(this,n),u5(this,n)&&(this.h-=this.g.get(n).length),this.g.set(n,[e]),this.h+=1,this};ae.get=function(n,e){return n?(n=this.Z(n),0<n.length?String(n[0]):e):e};function h5(n,e,t){l5(n,e),0<t.length&&(n.i=null,n.g.set(Hf(n,e),yS(t)),n.h+=t.length)}ae.toString=function(){if(this.i)return this.i;if(!this.g)return"";const n=[],e=Array.from(this.g.keys());for(var t=0;t<e.length;t++){var r=e[t];const i=encodeURIComponent(String(r)),o=this.Z(r);for(r=0;r<o.length;r++){var s=i;o[r]!==""&&(s+="="+encodeURIComponent(String(o[r]))),n.push(s)}}return this.i=n.join("&")};function Hf(n,e){return e=String(e),n.j&&(e=e.toLowerCase()),e}function Vge(n,e){e&&!n.j&&(Qc(n),n.i=null,n.g.forEach(function(t,r){var s=r.toLowerCase();r!=s&&(l5(this,r),h5(this,s,t))},n)),n.j=e}var qge=class{constructor(n,e){this.g=n,this.map=e}};function d5(n){this.l=n||zge,$e.PerformanceNavigationTiming?(n=$e.performance.getEntriesByType("navigation"),n=0<n.length&&(n[0].nextHopProtocol=="hq"||n[0].nextHopProtocol=="h2")):n=!!($e.g&&$e.g.Ka&&$e.g.Ka()&&$e.g.Ka().ec),this.j=n?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var zge=10;function f5(n){return n.h?!0:n.g?n.g.size>=n.j:!1}function p5(n){return n.h?1:n.g?n.g.size:0}function EI(n,e){return n.h?n.h==e:n.g?n.g.has(e):!1}function xS(n,e){n.g?n.g.add(e):n.h=e}function g5(n,e){n.h&&n.h==e?n.h=null:n.g&&n.g.has(e)&&n.g.delete(e)}d5.prototype.cancel=function(){if(this.i=m5(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const n of this.g.values())n.cancel();this.g.clear()}};function m5(n){if(n.h!=null)return n.i.concat(n.h.F);if(n.g!=null&&n.g.size!==0){let e=n.i;for(const t of n.g.values())e=e.concat(t.F);return e}return yS(n.i)}var Wge=class{stringify(n){return $e.JSON.stringify(n,void 0)}parse(n){return $e.JSON.parse(n,void 0)}};function Gge(){this.g=new Wge}function Kge(n,e,t){const r=t||"";try{a5(n,function(s,i){let o=s;xE(s)&&(o=CS(s)),e.push(r+i+"="+encodeURIComponent(o))})}catch(s){throw e.push(r+"type="+encodeURIComponent("_badmap")),s}}function Yge(n,e){const t=new $E;if($e.Image){const r=new Image;r.onload=Dw($w,t,r,"TestLoadImage: loaded",!0,e),r.onerror=Dw($w,t,r,"TestLoadImage: error",!1,e),r.onabort=Dw($w,t,r,"TestLoadImage: abort",!1,e),r.ontimeout=Dw($w,t,r,"TestLoadImage: timeout",!1,e),$e.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=n}else e(!1)}function $w(n,e,t,r,s){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,s(r)}catch{}}function Oy(n){this.l=n.fc||null,this.j=n.ob||!1}Dn(Oy,TS);Oy.prototype.g=function(){return new HE(this.l,this.j)};Oy.prototype.i=function(n){return function(){return n}}({});function HE(n,e){kn.call(this),this.F=n,this.u=e,this.m=void 0,this.readyState=RS,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}Dn(HE,kn);var RS=0;ae=HE.prototype;ae.open=function(n,e){if(this.readyState!=RS)throw this.abort(),Error("Error reopening a connection");this.C=n,this.B=e,this.readyState=1,_m(this)};ae.send=function(n){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};n&&(e.body=n),(this.F||$e).fetch(new Request(this.B,e)).then(this.$a.bind(this),this.ka.bind(this))};ae.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,xy(this)),this.readyState=RS};ae.$a=function(n){if(this.g&&(this.l=n,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=n.headers,this.readyState=2,_m(this)),this.g&&(this.readyState=3,_m(this),this.g)))if(this.responseType==="arraybuffer")n.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(typeof $e.ReadableStream<"u"&&"body"in n){if(this.j=n.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;y5(this)}else n.text().then(this.Za.bind(this),this.ka.bind(this))};function y5(n){n.j.read().then(n.Xa.bind(n)).catch(n.ka.bind(n))}ae.Xa=function(n){if(this.g){if(this.u&&n.value)this.response.push(n.value);else if(!this.u){var e=n.value?n.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!n.done}))&&(this.response=this.responseText+=e)}n.done?xy(this):_m(this),this.readyState==3&&y5(this)}};ae.Za=function(n){this.g&&(this.response=this.responseText=n,xy(this))};ae.Ya=function(n){this.g&&(this.response=n,xy(this))};ae.ka=function(){this.g&&xy(this)};function xy(n){n.readyState=4,n.l=null,n.j=null,n.A=null,_m(n)}ae.setRequestHeader=function(n,e){this.v.append(n,e)};ae.getResponseHeader=function(n){return this.h&&this.h.get(n.toLowerCase())||""};ae.getAllResponseHeaders=function(){if(!this.h)return"";const n=[],e=this.h.entries();for(var t=e.next();!t.done;)t=t.value,n.push(t[0]+": "+t[1]),t=e.next();return n.join(`\r
`)};function _m(n){n.onreadystatechange&&n.onreadystatechange.call(n)}Object.defineProperty(HE.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(n){this.m=n?"include":"same-origin"}});var Qge=$e.JSON.parse;function Jt(n){kn.call(this),this.headers=new Map,this.u=n||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=w5,this.L=this.M=!1}Dn(Jt,kn);var w5="",Zge=/^https?$/i,Jge=["POST","PUT"];ae=Jt.prototype;ae.Oa=function(n){this.M=n};ae.ha=function(n,e,t,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+n);e=e?e.toUpperCase():"GET",this.I=n,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():mI.g(),this.C=this.u?CP(this.u):CP(mI),this.g.onreadystatechange=mr(this.La,this);try{this.G=!0,this.g.open(e,String(n),!0),this.G=!1}catch(i){SP(this,i);return}if(n=t||"",t=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var s in r)t.set(s,r[s]);else if(typeof r.keys=="function"&&typeof r.get=="function")for(const i of r.keys())t.set(i,r.get(i));else throw Error("Unknown input type for opt_headers: "+String(r));r=Array.from(t.keys()).find(i=>i.toLowerCase()=="content-type"),s=$e.FormData&&n instanceof $e.FormData,!(0<=$4(Jge,e))||r||s||t.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[i,o]of t)this.g.setRequestHeader(i,o);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{v5(this),0<this.B&&((this.L=Xge(this.g))?(this.g.timeout=this.B,this.g.ontimeout=mr(this.ua,this)):this.A=SS(this.ua,this.B,this)),this.v=!0,this.g.send(n),this.v=!1}catch(i){SP(this,i)}};function Xge(n){return wf&&typeof n.timeout=="number"&&n.ontimeout!==void 0}ae.ua=function(){typeof mS<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,Gn(this,"timeout"),this.abort(8))};function SP(n,e){n.h=!1,n.g&&(n.l=!0,n.g.abort(),n.l=!1),n.j=e,n.m=5,b5(n),VE(n)}function b5(n){n.F||(n.F=!0,Gn(n,"complete"),Gn(n,"error"))}ae.abort=function(n){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=n||7,Gn(this,"complete"),Gn(this,"abort"),VE(this))};ae.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),VE(this,!0)),Jt.$.N.call(this)};ae.La=function(){this.s||(this.G||this.v||this.l?E5(this):this.kb())};ae.kb=function(){E5(this)};function E5(n){if(n.h&&typeof mS<"u"&&(!n.C[1]||po(n)!=4||n.da()!=2)){if(n.v&&po(n)==4)SS(n.La,0,n);else if(Gn(n,"readystatechange"),po(n)==4){n.h=!1;try{const o=n.da();e:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var t;if(!(t=e)){var r;if(r=o===0){var s=String(n.I).match(c5)[1]||null;!s&&$e.self&&$e.self.location&&(s=$e.self.location.protocol.slice(0,-1)),r=!Zge.test(s?s.toLowerCase():"")}t=r}if(t)Gn(n,"complete"),Gn(n,"success");else{n.m=6;try{var i=2<po(n)?n.g.statusText:""}catch{i=""}n.j=i+" ["+n.da()+"]",b5(n)}}finally{VE(n)}}}}function VE(n,e){if(n.g){v5(n);const t=n.g,r=n.C[0]?()=>{}:null;n.g=null,n.C=null,e||Gn(n,"ready");try{t.onreadystatechange=r}catch{}}}function v5(n){n.g&&n.L&&(n.g.ontimeout=null),n.A&&($e.clearTimeout(n.A),n.A=null)}ae.isActive=function(){return!!this.g};function po(n){return n.g?n.g.readyState:0}ae.da=function(){try{return 2<po(this)?this.g.status:-1}catch{return-1}};ae.ja=function(){try{return this.g?this.g.responseText:""}catch{return""}};ae.Wa=function(n){if(this.g){var e=this.g.responseText;return n&&e.indexOf(n)==0&&(e=e.substring(n.length)),Qge(e)}};function TP(n){try{if(!n.g)return null;if("response"in n.g)return n.g.response;switch(n.K){case w5:case"text":return n.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in n.g)return n.g.mozResponseArrayBuffer}return null}catch{return null}}function eme(n){const e={};n=(n.g&&2<=po(n)&&n.g.getAllResponseHeaders()||"").split(`\r
`);for(let r=0;r<n.length;r++){if(wm(n[r]))continue;var t=_ge(n[r]);const s=t[0];if(t=t[1],typeof t!="string")continue;t=t.trim();const i=e[s]||[];e[s]=i,i.push(t)}yge(e,function(r){return r.join(", ")})}ae.Ia=function(){return this.m};ae.Sa=function(){return typeof this.j=="string"?this.j:String(this.j)};function A5(n){let e="";return bS(n,function(t,r){e+=r,e+=":",e+=t,e+=`\r
`}),e}function PS(n,e,t){e:{for(r in t){var r=!1;break e}r=!0}r||(t=A5(t),typeof n=="string"?t!=null&&encodeURIComponent(String(t)):Ft(n,e,t))}function Cp(n,e,t){return t&&t.internalChannelParams&&t.internalChannelParams[n]||e}function C5(n){this.Ga=0,this.j=[],this.l=new $E,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=Cp("failFast",!1,n),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=Cp("baseRetryDelayMs",5e3,n),this.hb=Cp("retryDelaySeedMs",1e4,n),this.eb=Cp("forwardChannelMaxRetries",2,n),this.xa=Cp("forwardChannelRequestTimeoutMs",2e4,n),this.va=n&&n.xmlHttpFactory||void 0,this.Ha=n&&n.dc||!1,this.L=void 0,this.J=n&&n.supportsCrossDomainXhr||!1,this.K="",this.i=new d5(n&&n.concurrentRequestLimit),this.Ja=new Gge,this.P=n&&n.fastHandshake||!1,this.O=n&&n.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=n&&n.bc||!1,n&&n.Ea&&this.l.Ea(),n&&n.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&n&&n.detectBufferingProxy||!1,this.qa=void 0,n&&n.longPollingTimeout&&0<n.longPollingTimeout&&(this.qa=n.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}ae=C5.prototype;ae.ra=8;ae.H=1;function kS(n){if(I5(n),n.H==3){var e=n.W++,t=Aa(n.I);if(Ft(t,"SID",n.K),Ft(t,"RID",e),Ft(t,"TYPE","terminate"),Ry(n,t),e=new Ty(n,n.l,e),e.L=2,e.v=jE(Aa(t)),t=!1,$e.navigator&&$e.navigator.sendBeacon)try{t=$e.navigator.sendBeacon(e.v.toString(),"")}catch{}!t&&$e.Image&&(new Image().src=e.v,t=!0),t||(e.g=P5(e.l,null),e.g.ha(e.v)),e.G=Date.now(),Ny(e)}x5(n)}function qE(n){n.g&&(US(n),n.g.cancel(),n.g=null)}function I5(n){qE(n),n.u&&($e.clearTimeout(n.u),n.u=null),Eb(n),n.i.cancel(),n.m&&(typeof n.m=="number"&&$e.clearTimeout(n.m),n.m=null)}function zE(n){if(!f5(n.i)&&!n.m){n.m=!0;var e=n.Na;Em||G4(),vm||(Em(),vm=!0),IS.add(e,n),n.C=0}}function tme(n,e){return p5(n.i)>=n.i.j-(n.m?1:0)?!1:n.m?(n.j=e.F.concat(n.j),!0):n.H==1||n.H==2||n.C>=(n.cb?0:n.eb)?!1:(n.m=_y(mr(n.Na,n,e),O5(n,n.C)),n.C++,!0)}ae.Na=function(n){if(this.m)if(this.m=null,this.H==1){if(!n){this.W=Math.floor(1e5*Math.random()),n=this.W++;const s=new Ty(this,this.l,n);let i=this.s;if(this.U&&(i?(i=F4(i),j4(i,this.U)):i=this.U),this.o!==null||this.O||(s.I=i,i=null),this.P)e:{for(var e=0,t=0;t<this.j.length;t++){t:{var r=this.j[t];if("__data__"in r.map&&(r=r.map.__data__,typeof r=="string")){r=r.length;break t}r=void 0}if(r===void 0)break;if(e+=r,4096<e){e=t;break e}if(e===4096||t===this.j.length-1){e=t+1;break e}}e=1e3}else e=1e3;e=_5(this,s,e),t=Aa(this.I),Ft(t,"RID",n),Ft(t,"CVER",22),this.F&&Ft(t,"X-HTTP-Session-Id",this.F),Ry(this,t),i&&(this.O?e="headers="+encodeURIComponent(String(A5(i)))+"&"+e:this.o&&PS(t,this.o,i)),xS(this.i,s),this.bb&&Ft(t,"TYPE","init"),this.P?(Ft(t,"$req",e),Ft(t,"SID","null"),s.aa=!0,wI(s,t,null)):wI(s,t,e),this.H=2}}else this.H==3&&(n?NP(this,n):this.j.length==0||f5(this.i)||NP(this))};function NP(n,e){var t;e?t=e.m:t=n.W++;const r=Aa(n.I);Ft(r,"SID",n.K),Ft(r,"RID",t),Ft(r,"AID",n.V),Ry(n,r),n.o&&n.s&&PS(r,n.o,n.s),t=new Ty(n,n.l,t,n.C+1),n.o===null&&(t.I=n.s),e&&(n.j=e.F.concat(n.j)),e=_5(n,t,1e3),t.setTimeout(Math.round(.5*n.xa)+Math.round(.5*n.xa*Math.random())),xS(n.i,t),wI(t,r,e)}function Ry(n,e){n.na&&bS(n.na,function(t,r){Ft(e,r,t)}),n.h&&a5({},function(t,r){Ft(e,r,t)})}function _5(n,e,t){t=Math.min(n.j.length,t);var r=n.h?mr(n.h.Va,n.h,n):null;e:{var s=n.j;let i=-1;for(;;){const o=["count="+t];i==-1?0<t?(i=s[0].g,o.push("ofs="+i)):i=0:o.push("ofs="+i);let a=!0;for(let c=0;c<t;c++){let l=s[c].g;const u=s[c].map;if(l-=i,0>l)i=Math.max(0,s[c].g-100),a=!1;else try{Kge(u,o,"req"+l+"_")}catch{r&&r(u)}}if(a){r=o.join("&");break e}}}return n=n.j.splice(0,t),e.F=n,r}function S5(n){if(!n.g&&!n.u){n.ba=1;var e=n.Ma;Em||G4(),vm||(Em(),vm=!0),IS.add(e,n),n.A=0}}function DS(n){return n.g||n.u||3<=n.A?!1:(n.ba++,n.u=_y(mr(n.Ma,n),O5(n,n.A)),n.A++,!0)}ae.Ma=function(){if(this.u=null,T5(this),this.ca&&!(this.M||this.g==null||0>=this.S)){var n=2*this.S;this.l.info("BP detection timer enabled: "+n),this.B=_y(mr(this.jb,this),n)}};ae.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,Dr(10),qE(this),T5(this))};function US(n){n.B!=null&&($e.clearTimeout(n.B),n.B=null)}function T5(n){n.g=new Ty(n,n.l,"rpc",n.ba),n.o===null&&(n.g.I=n.s),n.g.O=0;var e=Aa(n.wa);Ft(e,"RID","rpc"),Ft(e,"SID",n.K),Ft(e,"AID",n.V),Ft(e,"CI",n.G?"0":"1"),!n.G&&n.qa&&Ft(e,"TO",n.qa),Ft(e,"TYPE","xmlhttp"),Ry(n,e),n.o&&n.s&&PS(e,n.o,n.s),n.L&&n.g.setTimeout(n.L);var t=n.g;n=n.pa,t.L=1,t.v=jE(Aa(e)),t.s=null,t.S=!0,r5(t,n)}ae.ib=function(){this.v!=null&&(this.v=null,qE(this),DS(this),Dr(19))};function Eb(n){n.v!=null&&($e.clearTimeout(n.v),n.v=null)}function N5(n,e){var t=null;if(n.g==e){Eb(n),US(n),n.g=null;var r=2}else if(EI(n.i,e))t=e.F,g5(n.i,e),r=1;else return;if(n.H!=0){if(e.i)if(r==1){t=e.s?e.s.length:0,e=Date.now()-e.G;var s=n.C;r=ME(),Gn(r,new X4(r,t)),zE(n)}else S5(n);else if(s=e.o,s==3||s==0&&0<e.ca||!(r==1&&tme(n,e)||r==2&&DS(n)))switch(t&&0<t.length&&(e=n.i,e.i=e.i.concat(t)),s){case 1:Pl(n,5);break;case 4:Pl(n,10);break;case 3:Pl(n,6);break;default:Pl(n,2)}}}function O5(n,e){let t=n.ab+Math.floor(Math.random()*n.hb);return n.isActive()||(t*=2),t*e}function Pl(n,e){if(n.l.info("Error code "+e),e==2){var t=null;n.h&&(t=null);var r=mr(n.pb,n);t||(t=new hu("//www.google.com/images/cleardot.gif"),$e.location&&$e.location.protocol=="http"||wb(t,"https"),jE(t)),Yge(t.toString(),r)}else Dr(2);n.H=0,n.h&&n.h.za(e),x5(n),I5(n)}ae.pb=function(n){n?(this.l.info("Successfully pinged google.com"),Dr(2)):(this.l.info("Failed to ping google.com"),Dr(1))};function x5(n){if(n.H=0,n.ma=[],n.h){const e=m5(n.i);(e.length!=0||n.j.length!=0)&&(wP(n.ma,e),wP(n.ma,n.j),n.i.i.length=0,yS(n.j),n.j.length=0),n.h.ya()}}function R5(n,e,t){var r=t instanceof hu?Aa(t):new hu(t);if(r.g!="")e&&(r.g=e+"."+r.g),bb(r,r.m);else{var s=$e.location;r=s.protocol,e=e?e+"."+s.hostname:s.hostname,s=+s.port;var i=new hu(null);r&&wb(i,r),e&&(i.g=e),s&&bb(i,s),t&&(i.l=t),r=i}return t=n.F,e=n.Da,t&&e&&Ft(r,t,e),Ft(r,"VER",n.ra),Ry(n,r),r}function P5(n,e,t){if(e&&!n.J)throw Error("Can't create secondary domain capable XhrIo object.");return e=t&&n.Ha&&!n.va?new Jt(new Oy({ob:!0})):new Jt(n.va),e.Oa(n.J),e}ae.isActive=function(){return!!this.h&&this.h.isActive(this)};function k5(){}ae=k5.prototype;ae.Ba=function(){};ae.Aa=function(){};ae.za=function(){};ae.ya=function(){};ae.isActive=function(){return!0};ae.Va=function(){};function vb(){if(wf&&!(10<=Number(fge)))throw Error("Environmental error: no available transport.")}vb.prototype.g=function(n,e){return new xs(n,e)};function xs(n,e){kn.call(this),this.g=new C5(e),this.l=n,this.h=e&&e.messageUrlParams||null,n=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(n?n["X-Client-Protocol"]="webchannel":n={"X-Client-Protocol":"webchannel"}),this.g.s=n,n=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(n?n["X-WebChannel-Content-Type"]=e.messageContentType:n={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.Ca&&(n?n["X-WebChannel-Client-Profile"]=e.Ca:n={"X-WebChannel-Client-Profile":e.Ca}),this.g.U=n,(n=e&&e.cc)&&!wm(n)&&(this.g.o=n),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!wm(e)&&(this.g.F=e,n=this.h,n!==null&&e in n&&(n=this.h,e in n&&delete n[e])),this.j=new Vf(this)}Dn(xs,kn);xs.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var n=this.g,e=this.l,t=this.h||void 0;Dr(0),n.Y=e,n.na=t||{},n.G=n.aa,n.I=R5(n,null,n.Y),zE(n)};xs.prototype.close=function(){kS(this.g)};xs.prototype.u=function(n){var e=this.g;if(typeof n=="string"){var t={};t.__data__=n,n=t}else this.v&&(t={},t.__data__=CS(n),n=t);e.j.push(new qge(e.fb++,n)),e.H==3&&zE(e)};xs.prototype.N=function(){this.g.h=null,delete this.j,kS(this.g),delete this.g,xs.$.N.call(this)};function D5(n){NS.call(this),n.__headers__&&(this.headers=n.__headers__,this.statusCode=n.__status__,delete n.__headers__,delete n.__status__);var e=n.__sm__;if(e){e:{for(const t in e){n=t;break e}n=void 0}(this.i=n)&&(n=this.i,e=e!==null&&n in e?e[n]:void 0),this.data=e}else this.data=n}Dn(D5,NS);function U5(){OS.call(this),this.status=1}Dn(U5,OS);function Vf(n){this.g=n}Dn(Vf,k5);Vf.prototype.Ba=function(){Gn(this.g,"a")};Vf.prototype.Aa=function(n){Gn(this.g,new D5(n))};Vf.prototype.za=function(n){Gn(this.g,new U5)};Vf.prototype.ya=function(){Gn(this.g,"b")};function nme(){this.blockSize=-1}function $i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}Dn($i,nme);$i.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0};function Y1(n,e,t){t||(t=0);var r=Array(16);if(typeof e=="string")for(var s=0;16>s;++s)r[s]=e.charCodeAt(t++)|e.charCodeAt(t++)<<8|e.charCodeAt(t++)<<16|e.charCodeAt(t++)<<24;else for(s=0;16>s;++s)r[s]=e[t++]|e[t++]<<8|e[t++]<<16|e[t++]<<24;e=n.g[0],t=n.g[1],s=n.g[2];var i=n.g[3],o=e+(i^t&(s^i))+r[0]+3614090360&4294967295;e=t+(o<<7&4294967295|o>>>25),o=i+(s^e&(t^s))+r[1]+3905402710&4294967295,i=e+(o<<12&4294967295|o>>>20),o=s+(t^i&(e^t))+r[2]+606105819&4294967295,s=i+(o<<17&4294967295|o>>>15),o=t+(e^s&(i^e))+r[3]+3250441966&4294967295,t=s+(o<<22&4294967295|o>>>10),o=e+(i^t&(s^i))+r[4]+4118548399&4294967295,e=t+(o<<7&4294967295|o>>>25),o=i+(s^e&(t^s))+r[5]+1200080426&4294967295,i=e+(o<<12&4294967295|o>>>20),o=s+(t^i&(e^t))+r[6]+2821735955&4294967295,s=i+(o<<17&4294967295|o>>>15),o=t+(e^s&(i^e))+r[7]+4249261313&4294967295,t=s+(o<<22&4294967295|o>>>10),o=e+(i^t&(s^i))+r[8]+1770035416&4294967295,e=t+(o<<7&4294967295|o>>>25),o=i+(s^e&(t^s))+r[9]+2336552879&4294967295,i=e+(o<<12&4294967295|o>>>20),o=s+(t^i&(e^t))+r[10]+4294925233&4294967295,s=i+(o<<17&4294967295|o>>>15),o=t+(e^s&(i^e))+r[11]+2304563134&4294967295,t=s+(o<<22&4294967295|o>>>10),o=e+(i^t&(s^i))+r[12]+1804603682&4294967295,e=t+(o<<7&4294967295|o>>>25),o=i+(s^e&(t^s))+r[13]+4254626195&4294967295,i=e+(o<<12&4294967295|o>>>20),o=s+(t^i&(e^t))+r[14]+2792965006&4294967295,s=i+(o<<17&4294967295|o>>>15),o=t+(e^s&(i^e))+r[15]+1236535329&4294967295,t=s+(o<<22&4294967295|o>>>10),o=e+(s^i&(t^s))+r[1]+4129170786&4294967295,e=t+(o<<5&4294967295|o>>>27),o=i+(t^s&(e^t))+r[6]+3225465664&4294967295,i=e+(o<<9&4294967295|o>>>23),o=s+(e^t&(i^e))+r[11]+643717713&4294967295,s=i+(o<<14&4294967295|o>>>18),o=t+(i^e&(s^i))+r[0]+3921069994&4294967295,t=s+(o<<20&4294967295|o>>>12),o=e+(s^i&(t^s))+r[5]+3593408605&4294967295,e=t+(o<<5&4294967295|o>>>27),o=i+(t^s&(e^t))+r[10]+38016083&4294967295,i=e+(o<<9&4294967295|o>>>23),o=s+(e^t&(i^e))+r[15]+3634488961&4294967295,s=i+(o<<14&4294967295|o>>>18),o=t+(i^e&(s^i))+r[4]+3889429448&4294967295,t=s+(o<<20&4294967295|o>>>12),o=e+(s^i&(t^s))+r[9]+568446438&4294967295,e=t+(o<<5&4294967295|o>>>27),o=i+(t^s&(e^t))+r[14]+3275163606&4294967295,i=e+(o<<9&4294967295|o>>>23),o=s+(e^t&(i^e))+r[3]+4107603335&4294967295,s=i+(o<<14&4294967295|o>>>18),o=t+(i^e&(s^i))+r[8]+1163531501&4294967295,t=s+(o<<20&4294967295|o>>>12),o=e+(s^i&(t^s))+r[13]+2850285829&4294967295,e=t+(o<<5&4294967295|o>>>27),o=i+(t^s&(e^t))+r[2]+4243563512&4294967295,i=e+(o<<9&4294967295|o>>>23),o=s+(e^t&(i^e))+r[7]+1735328473&4294967295,s=i+(o<<14&4294967295|o>>>18),o=t+(i^e&(s^i))+r[12]+2368359562&4294967295,t=s+(o<<20&4294967295|o>>>12),o=e+(t^s^i)+r[5]+4294588738&4294967295,e=t+(o<<4&4294967295|o>>>28),o=i+(e^t^s)+r[8]+2272392833&4294967295,i=e+(o<<11&4294967295|o>>>21),o=s+(i^e^t)+r[11]+1839030562&4294967295,s=i+(o<<16&4294967295|o>>>16),o=t+(s^i^e)+r[14]+4259657740&4294967295,t=s+(o<<23&4294967295|o>>>9),o=e+(t^s^i)+r[1]+2763975236&4294967295,e=t+(o<<4&4294967295|o>>>28),o=i+(e^t^s)+r[4]+1272893353&4294967295,i=e+(o<<11&4294967295|o>>>21),o=s+(i^e^t)+r[7]+4139469664&4294967295,s=i+(o<<16&4294967295|o>>>16),o=t+(s^i^e)+r[10]+3200236656&4294967295,t=s+(o<<23&4294967295|o>>>9),o=e+(t^s^i)+r[13]+681279174&4294967295,e=t+(o<<4&4294967295|o>>>28),o=i+(e^t^s)+r[0]+3936430074&4294967295,i=e+(o<<11&4294967295|o>>>21),o=s+(i^e^t)+r[3]+3572445317&4294967295,s=i+(o<<16&4294967295|o>>>16),o=t+(s^i^e)+r[6]+76029189&4294967295,t=s+(o<<23&4294967295|o>>>9),o=e+(t^s^i)+r[9]+3654602809&4294967295,e=t+(o<<4&4294967295|o>>>28),o=i+(e^t^s)+r[12]+3873151461&4294967295,i=e+(o<<11&4294967295|o>>>21),o=s+(i^e^t)+r[15]+530742520&4294967295,s=i+(o<<16&4294967295|o>>>16),o=t+(s^i^e)+r[2]+3299628645&4294967295,t=s+(o<<23&4294967295|o>>>9),o=e+(s^(t|~i))+r[0]+4096336452&4294967295,e=t+(o<<6&4294967295|o>>>26),o=i+(t^(e|~s))+r[7]+1126891415&4294967295,i=e+(o<<10&4294967295|o>>>22),o=s+(e^(i|~t))+r[14]+2878612391&4294967295,s=i+(o<<15&4294967295|o>>>17),o=t+(i^(s|~e))+r[5]+4237533241&4294967295,t=s+(o<<21&4294967295|o>>>11),o=e+(s^(t|~i))+r[12]+1700485571&4294967295,e=t+(o<<6&4294967295|o>>>26),o=i+(t^(e|~s))+r[3]+2399980690&4294967295,i=e+(o<<10&4294967295|o>>>22),o=s+(e^(i|~t))+r[10]+4293915773&4294967295,s=i+(o<<15&4294967295|o>>>17),o=t+(i^(s|~e))+r[1]+2240044497&4294967295,t=s+(o<<21&4294967295|o>>>11),o=e+(s^(t|~i))+r[8]+1873313359&4294967295,e=t+(o<<6&4294967295|o>>>26),o=i+(t^(e|~s))+r[15]+4264355552&4294967295,i=e+(o<<10&4294967295|o>>>22),o=s+(e^(i|~t))+r[6]+2734768916&4294967295,s=i+(o<<15&4294967295|o>>>17),o=t+(i^(s|~e))+r[13]+1309151649&4294967295,t=s+(o<<21&4294967295|o>>>11),o=e+(s^(t|~i))+r[4]+4149444226&4294967295,e=t+(o<<6&4294967295|o>>>26),o=i+(t^(e|~s))+r[11]+3174756917&4294967295,i=e+(o<<10&4294967295|o>>>22),o=s+(e^(i|~t))+r[2]+718787259&4294967295,s=i+(o<<15&4294967295|o>>>17),o=t+(i^(s|~e))+r[9]+3951481745&4294967295,n.g[0]=n.g[0]+e&4294967295,n.g[1]=n.g[1]+(s+(o<<21&4294967295|o>>>11))&4294967295,n.g[2]=n.g[2]+s&4294967295,n.g[3]=n.g[3]+i&4294967295}$i.prototype.j=function(n,e){e===void 0&&(e=n.length);for(var t=e-this.blockSize,r=this.m,s=this.h,i=0;i<e;){if(s==0)for(;i<=t;)Y1(this,n,i),i+=this.blockSize;if(typeof n=="string"){for(;i<e;)if(r[s++]=n.charCodeAt(i++),s==this.blockSize){Y1(this,r),s=0;break}}else for(;i<e;)if(r[s++]=n[i++],s==this.blockSize){Y1(this,r),s=0;break}}this.h=s,this.i+=e};$i.prototype.l=function(){var n=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);n[0]=128;for(var e=1;e<n.length-8;++e)n[e]=0;var t=8*this.i;for(e=n.length-8;e<n.length;++e)n[e]=t&255,t/=256;for(this.j(n),n=Array(16),e=t=0;4>e;++e)for(var r=0;32>r;r+=8)n[t++]=this.g[e]>>>r&255;return n};function Nt(n,e){this.h=e;for(var t=[],r=!0,s=n.length-1;0<=s;s--){var i=n[s]|0;r&&i==e||(t[s]=i,r=!1)}this.g=t}var rme={};function $S(n){return-128<=n&&128>n?uge(n,function(e){return new Nt([e|0],0>e?-1:0)}):new Nt([n|0],0>n?-1:0)}function go(n){if(isNaN(n)||!isFinite(n))return id;if(0>n)return qn(go(-n));for(var e=[],t=1,r=0;n>=t;r++)e[r]=n/t|0,t*=vI;return new Nt(e,0)}function $5(n,e){if(n.length==0)throw Error("number format error: empty string");if(e=e||10,2>e||36<e)throw Error("radix out of range: "+e);if(n.charAt(0)=="-")return qn($5(n.substring(1),e));if(0<=n.indexOf("-"))throw Error('number format error: interior "-" character');for(var t=go(Math.pow(e,8)),r=id,s=0;s<n.length;s+=8){var i=Math.min(8,n.length-s),o=parseInt(n.substring(s,s+i),e);8>i?(i=go(Math.pow(e,i)),r=r.R(i).add(go(o))):(r=r.R(t),r=r.add(go(o)))}return r}var vI=4294967296,id=$S(0),AI=$S(1),OP=$S(16777216);ae=Nt.prototype;ae.ea=function(){if(Js(this))return-qn(this).ea();for(var n=0,e=1,t=0;t<this.g.length;t++){var r=this.D(t);n+=(0<=r?r:vI+r)*e,e*=vI}return n};ae.toString=function(n){if(n=n||10,2>n||36<n)throw Error("radix out of range: "+n);if(ca(this))return"0";if(Js(this))return"-"+qn(this).toString(n);for(var e=go(Math.pow(n,6)),t=this,r="";;){var s=Cb(t,e).g;t=Ab(t,s.R(e));var i=((0<t.g.length?t.g[0]:t.h)>>>0).toString(n);if(t=s,ca(t))return i+r;for(;6>i.length;)i="0"+i;r=i+r}};ae.D=function(n){return 0>n?0:n<this.g.length?this.g[n]:this.h};function ca(n){if(n.h!=0)return!1;for(var e=0;e<n.g.length;e++)if(n.g[e]!=0)return!1;return!0}function Js(n){return n.h==-1}ae.X=function(n){return n=Ab(this,n),Js(n)?-1:ca(n)?0:1};function qn(n){for(var e=n.g.length,t=[],r=0;r<e;r++)t[r]=~n.g[r];return new Nt(t,~n.h).add(AI)}ae.abs=function(){return Js(this)?qn(this):this};ae.add=function(n){for(var e=Math.max(this.g.length,n.g.length),t=[],r=0,s=0;s<=e;s++){var i=r+(this.D(s)&65535)+(n.D(s)&65535),o=(i>>>16)+(this.D(s)>>>16)+(n.D(s)>>>16);r=o>>>16,i&=65535,o&=65535,t[s]=o<<16|i}return new Nt(t,t[t.length-1]&-2147483648?-1:0)};function Ab(n,e){return n.add(qn(e))}ae.R=function(n){if(ca(this)||ca(n))return id;if(Js(this))return Js(n)?qn(this).R(qn(n)):qn(qn(this).R(n));if(Js(n))return qn(this.R(qn(n)));if(0>this.X(OP)&&0>n.X(OP))return go(this.ea()*n.ea());for(var e=this.g.length+n.g.length,t=[],r=0;r<2*e;r++)t[r]=0;for(r=0;r<this.g.length;r++)for(var s=0;s<n.g.length;s++){var i=this.D(r)>>>16,o=this.D(r)&65535,a=n.D(s)>>>16,c=n.D(s)&65535;t[2*r+2*s]+=o*c,Mw(t,2*r+2*s),t[2*r+2*s+1]+=i*c,Mw(t,2*r+2*s+1),t[2*r+2*s+1]+=o*a,Mw(t,2*r+2*s+1),t[2*r+2*s+2]+=i*a,Mw(t,2*r+2*s+2)}for(r=0;r<e;r++)t[r]=t[2*r+1]<<16|t[2*r];for(r=e;r<2*e;r++)t[r]=0;return new Nt(t,0)};function Mw(n,e){for(;(n[e]&65535)!=n[e];)n[e+1]+=n[e]>>>16,n[e]&=65535,e++}function Ip(n,e){this.g=n,this.h=e}function Cb(n,e){if(ca(e))throw Error("division by zero");if(ca(n))return new Ip(id,id);if(Js(n))return e=Cb(qn(n),e),new Ip(qn(e.g),qn(e.h));if(Js(e))return e=Cb(n,qn(e)),new Ip(qn(e.g),e.h);if(30<n.g.length){if(Js(n)||Js(e))throw Error("slowDivide_ only works with positive integers.");for(var t=AI,r=e;0>=r.X(n);)t=xP(t),r=xP(r);var s=_h(t,1),i=_h(r,1);for(r=_h(r,2),t=_h(t,2);!ca(r);){var o=i.add(r);0>=o.X(n)&&(s=s.add(t),i=o),r=_h(r,1),t=_h(t,1)}return e=Ab(n,s.R(e)),new Ip(s,e)}for(s=id;0<=n.X(e);){for(t=Math.max(1,Math.floor(n.ea()/e.ea())),r=Math.ceil(Math.log(t)/Math.LN2),r=48>=r?1:Math.pow(2,r-48),i=go(t),o=i.R(e);Js(o)||0<o.X(n);)t-=r,i=go(t),o=i.R(e);ca(i)&&(i=AI),s=s.add(i),n=Ab(n,o)}return new Ip(s,n)}ae.gb=function(n){return Cb(this,n).h};ae.and=function(n){for(var e=Math.max(this.g.length,n.g.length),t=[],r=0;r<e;r++)t[r]=this.D(r)&n.D(r);return new Nt(t,this.h&n.h)};ae.or=function(n){for(var e=Math.max(this.g.length,n.g.length),t=[],r=0;r<e;r++)t[r]=this.D(r)|n.D(r);return new Nt(t,this.h|n.h)};ae.xor=function(n){for(var e=Math.max(this.g.length,n.g.length),t=[],r=0;r<e;r++)t[r]=this.D(r)^n.D(r);return new Nt(t,this.h^n.h)};function xP(n){for(var e=n.g.length+1,t=[],r=0;r<e;r++)t[r]=n.D(r)<<1|n.D(r-1)>>>31;return new Nt(t,n.h)}function _h(n,e){var t=e>>5;e%=32;for(var r=n.g.length-t,s=[],i=0;i<r;i++)s[i]=0<e?n.D(i+t)>>>e|n.D(i+t+1)<<32-e:n.D(i+t);return new Nt(s,n.h)}vb.prototype.createWebChannel=vb.prototype.g;xs.prototype.send=xs.prototype.u;xs.prototype.open=xs.prototype.m;xs.prototype.close=xs.prototype.close;LE.NO_ERROR=0;LE.TIMEOUT=8;LE.HTTP_ERROR=6;e5.COMPLETE="complete";t5.EventType=Sy;Sy.OPEN="a";Sy.CLOSE="b";Sy.ERROR="c";Sy.MESSAGE="d";kn.prototype.listen=kn.prototype.O;Jt.prototype.listenOnce=Jt.prototype.P;Jt.prototype.getLastError=Jt.prototype.Sa;Jt.prototype.getLastErrorCode=Jt.prototype.Ia;Jt.prototype.getStatus=Jt.prototype.da;Jt.prototype.getResponseJson=Jt.prototype.Wa;Jt.prototype.getResponseText=Jt.prototype.ja;Jt.prototype.send=Jt.prototype.ha;Jt.prototype.setWithCredentials=Jt.prototype.Oa;$i.prototype.digest=$i.prototype.l;$i.prototype.reset=$i.prototype.reset;$i.prototype.update=$i.prototype.j;Nt.prototype.add=Nt.prototype.add;Nt.prototype.multiply=Nt.prototype.R;Nt.prototype.modulo=Nt.prototype.gb;Nt.prototype.compare=Nt.prototype.X;Nt.prototype.toNumber=Nt.prototype.ea;Nt.prototype.toString=Nt.prototype.toString;Nt.prototype.getBits=Nt.prototype.D;Nt.fromNumber=go;Nt.fromString=$5;var sme=function(){return new vb},ime=function(){return ME()},Q1=LE,ome=e5,ame=zu,RP={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},cme=Oy,Lw=t5,lme=Jt,ume=$i,od=Nt;const PP="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ur{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}ur.UNAUTHENTICATED=new ur(null),ur.GOOGLE_CREDENTIALS=new ur("google-credentials-uid"),ur.FIRST_PARTY=new ur("first-party-uid"),ur.MOCK_USER=new ur("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let qf="9.23.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ou=new dS("@firebase/firestore");function kP(){return Ou.logLevel}function Ie(n,...e){if(Ou.logLevel<=Ct.DEBUG){const t=e.map(MS);Ou.debug(`Firestore (${qf}): ${n}`,...t)}}function Ca(n,...e){if(Ou.logLevel<=Ct.ERROR){const t=e.map(MS);Ou.error(`Firestore (${qf}): ${n}`,...t)}}function bf(n,...e){if(Ou.logLevel<=Ct.WARN){const t=e.map(MS);Ou.warn(`Firestore (${qf}): ${n}`,...t)}}function MS(n){if(typeof n=="string")return n;try{return e=n,JSON.stringify(e)}catch{return n}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/var e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ue(n="Unexpected state"){const e=`FIRESTORE (${qf}) INTERNAL ASSERTION FAILED: `+n;throw Ca(e),new Error(e)}function Ht(n,e){n||Ue()}function ze(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const W={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class we extends Kc{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pa{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M5{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class hme{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(ur.UNAUTHENTICATED))}shutdown(){}}class dme{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class fme{constructor(e){this.t=e,this.currentUser=ur.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){let r=this.i;const s=c=>this.i!==r?(r=this.i,t(c)):Promise.resolve();let i=new pa;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new pa,e.enqueueRetryable(()=>s(this.currentUser))};const o=()=>{const c=i;e.enqueueRetryable(async()=>{await c.promise,await s(this.currentUser)})},a=c=>{Ie("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.auth.addAuthTokenListener(this.o),o()};this.t.onInit(c=>a(c)),setTimeout(()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?a(c):(Ie("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new pa)}},0),o()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(Ie("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Ht(typeof r.accessToken=="string"),new M5(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return Ht(e===null||typeof e=="string"),new ur(e)}}class pme{constructor(e,t,r){this.h=e,this.l=t,this.m=r,this.type="FirstParty",this.user=ur.FIRST_PARTY,this.g=new Map}p(){return this.m?this.m():null}get headers(){this.g.set("X-Goog-AuthUser",this.h);const e=this.p();return e&&this.g.set("Authorization",e),this.l&&this.g.set("X-Goog-Iam-Authorization-Token",this.l),this.g}}class gme{constructor(e,t,r){this.h=e,this.l=t,this.m=r}getToken(){return Promise.resolve(new pme(this.h,this.l,this.m))}start(e,t){e.enqueueRetryable(()=>t(ur.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class mme{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class yme{constructor(e){this.I=e,this.forceRefresh=!1,this.appCheck=null,this.T=null}start(e,t){const r=i=>{i.error!=null&&Ie("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.T;return this.T=i.token,Ie("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>r(i))};const s=i=>{Ie("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.appCheck.addTokenListener(this.o)};this.I.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.I.getImmediate({optional:!0});i?s(i):Ie("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(Ht(typeof t.token=="string"),this.T=t.token,new mme(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wme(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L5{static A(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const s=wme(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<t&&(r+=e.charAt(s[i]%e.length))}return r}}function vt(n,e){return n<e?-1:n>e?1:0}function Ef(n,e,t){return n.length===e.length&&n.every((r,s)=>t(r,e[s]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class An{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new we(W.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new we(W.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new we(W.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new we(W.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return An.fromMillis(Date.now())}static fromDate(e){return An.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*t));return new An(t,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?vt(this.nanoseconds,e.nanoseconds):vt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fe{constructor(e){this.timestamp=e}static fromTimestamp(e){return new Fe(e)}static min(){return new Fe(new An(0,0))}static max(){return new Fe(new An(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sm{constructor(e,t,r){t===void 0?t=0:t>e.length&&Ue(),r===void 0?r=e.length-t:r>e.length-t&&Ue(),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return Sm.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Sm?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let s=0;s<r;s++){const i=e.get(s),o=t.get(s);if(i<o)return-1;if(i>o)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class jt extends Sm{construct(e,t,r){return new jt(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new we(W.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(s=>s.length>0))}return new jt(t)}static emptyPath(){return new jt([])}}const bme=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class fr extends Sm{construct(e,t,r){return new fr(e,t,r)}static isValidIdentifier(e){return bme.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),fr.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new fr(["__name__"])}static fromServerFormat(e){const t=[];let r="",s=0;const i=()=>{if(r.length===0)throw new we(W.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let o=!1;for(;s<e.length;){const a=e[s];if(a==="\\"){if(s+1===e.length)throw new we(W.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[s+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new we(W.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=c,s+=2}else a==="`"?(o=!o,s++):a!=="."||o?(r+=a,s++):(i(),s++)}if(i(),o)throw new we(W.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new fr(t)}static emptyPath(){return new fr([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Te{constructor(e){this.path=e}static fromPath(e){return new Te(jt.fromString(e))}static fromName(e){return new Te(jt.fromString(e).popFirst(5))}static empty(){return new Te(jt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&jt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return jt.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Te(new jt(e.slice()))}}function Eme(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,s=Fe.fromTimestamp(r===1e9?new An(t+1,0):new An(t,r));return new Hc(s,Te.empty(),e)}function vme(n){return new Hc(n.readTime,n.key,-1)}class Hc{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new Hc(Fe.min(),Te.empty(),-1)}static max(){return new Hc(Fe.max(),Te.empty(),-1)}}function Ame(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=Te.comparator(n.documentKey,e.documentKey),t!==0?t:vt(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cme="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Ime{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Py(n){if(n.code!==W.FAILED_PRECONDITION||n.message!==Cme)throw n;Ie("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Ue(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new J((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(t,i).next(r,s)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof J?t:J.resolve(t)}catch(t){return J.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):J.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):J.reject(t)}static resolve(e){return new J((t,r)=>{t(e)})}static reject(e){return new J((t,r)=>{r(e)})}static waitFor(e){return new J((t,r)=>{let s=0,i=0,o=!1;e.forEach(a=>{++s,a.next(()=>{++i,o&&i===s&&t()},c=>r(c))}),o=!0,i===s&&t()})}static or(e){let t=J.resolve(!1);for(const r of e)t=t.next(s=>s?J.resolve(s):r());return t}static forEach(e,t){const r=[];return e.forEach((s,i)=>{r.push(t.call(this,s,i))}),this.waitFor(r)}static mapArray(e,t){return new J((r,s)=>{const i=e.length,o=new Array(i);let a=0;for(let c=0;c<i;c++){const l=c;t(e[l]).next(u=>{o[l]=u,++a,a===i&&r(o)},u=>s(u))}})}static doWhile(e,t){return new J((r,s)=>{const i=()=>{e()===!0?t().next(()=>{i()},s):r()};i()})}}function ky(n){return n.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LS{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this.ot(r),this.ut=r=>t.writeSequenceNumber(r))}ot(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ut&&this.ut(e),e}}LS.ct=-1;function WE(n){return n==null}function Ib(n){return n===0&&1/n==-1/0}function _me(n){return typeof n=="number"&&Number.isInteger(n)&&!Ib(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DP(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Wu(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function B5(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kt{constructor(e,t){this.comparator=e,this.root=t||Hn.EMPTY}insert(e,t){return new Kt(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Hn.BLACK,null,null))}remove(e){return new Kt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Hn.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return t+r.left.size;s<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){const e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Bw(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Bw(this.root,e,this.comparator,!1)}getReverseIterator(){return new Bw(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Bw(this.root,e,this.comparator,!0)}}class Bw{constructor(e,t,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?r(e.key,t):1,t&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Hn{constructor(e,t,r,s,i){this.key=e,this.value=t,this.color=r??Hn.RED,this.left=s??Hn.EMPTY,this.right=i??Hn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,s,i){return new Hn(e??this.key,t??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,t,r),null):i===0?s.copy(null,t,null,null,null):s.copy(null,null,null,null,s.right.insert(e,t,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return Hn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,s=this;if(t(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,t),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),t(e,s.key)===0){if(s.right.isEmpty())return Hn.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,t))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Hn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Hn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw Ue();const e=this.left.check();if(e!==this.right.check())throw Ue();return e+(this.isRed()?0:1)}}Hn.EMPTY=null,Hn.RED=!0,Hn.BLACK=!1;Hn.EMPTY=new class{constructor(){this.size=0}get key(){throw Ue()}get value(){throw Ue()}get color(){throw Ue()}get left(){throw Ue()}get right(){throw Ue()}copy(n,e,t,r,s){return this}insert(n,e,t){return new Hn(n,e)}remove(n,e){return this}isEmpty(){return!0}inorderTraversal(n){return!1}reverseTraversal(n){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wr{constructor(e){this.comparator=e,this.data=new Kt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;t(s.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new UP(this.data.getIterator())}getIteratorFrom(e){return new UP(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof wr)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const s=t.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new wr(this.comparator);return t.data=e,t}}class UP{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ss{constructor(e){this.fields=e,e.sort(fr.comparator)}static empty(){return new Ss([])}unionWith(e){let t=new wr(fr.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new Ss(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Ef(this.fields,e.fields,(t,r)=>t.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F5 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Er{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(r){try{return atob(r)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new F5("Invalid base64 string: "+s):s}}(e);return new Er(t)}static fromUint8Array(e){const t=function(r){let s="";for(let i=0;i<r.length;++i)s+=String.fromCharCode(r[i]);return s}(e);return new Er(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return e=this.binaryString,btoa(e);var e}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return vt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Er.EMPTY_BYTE_STRING=new Er("");const Sme=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Vc(n){if(Ht(!!n),typeof n=="string"){let e=0;const t=Sme.exec(n);if(Ht(!!t),t[1]){let s=t[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:dn(n.seconds),nanos:dn(n.nanos)}}function dn(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function xu(n){return typeof n=="string"?Er.fromBase64String(n):Er.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BS(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="server_timestamp"}function FS(n){const e=n.mapValue.fields.__previous_value__;return BS(e)?FS(e):e}function Tm(n){const e=Vc(n.mapValue.fields.__local_write_time__.timestampValue);return new An(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tme{constructor(e,t,r,s,i,o,a,c,l){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=c,this.useFetchStreams=l}}class Nm{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new Nm("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof Nm&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fw={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function Ru(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?BS(n)?4:Nme(n)?9007199254740991:10:Ue()}function To(n,e){if(n===e)return!0;const t=Ru(n);if(t!==Ru(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Tm(n).isEqual(Tm(e));case 3:return function(r,s){if(typeof r.timestampValue=="string"&&typeof s.timestampValue=="string"&&r.timestampValue.length===s.timestampValue.length)return r.timestampValue===s.timestampValue;const i=Vc(r.timestampValue),o=Vc(s.timestampValue);return i.seconds===o.seconds&&i.nanos===o.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(r,s){return xu(r.bytesValue).isEqual(xu(s.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(r,s){return dn(r.geoPointValue.latitude)===dn(s.geoPointValue.latitude)&&dn(r.geoPointValue.longitude)===dn(s.geoPointValue.longitude)}(n,e);case 2:return function(r,s){if("integerValue"in r&&"integerValue"in s)return dn(r.integerValue)===dn(s.integerValue);if("doubleValue"in r&&"doubleValue"in s){const i=dn(r.doubleValue),o=dn(s.doubleValue);return i===o?Ib(i)===Ib(o):isNaN(i)&&isNaN(o)}return!1}(n,e);case 9:return Ef(n.arrayValue.values||[],e.arrayValue.values||[],To);case 10:return function(r,s){const i=r.mapValue.fields||{},o=s.mapValue.fields||{};if(DP(i)!==DP(o))return!1;for(const a in i)if(i.hasOwnProperty(a)&&(o[a]===void 0||!To(i[a],o[a])))return!1;return!0}(n,e);default:return Ue()}}function Om(n,e){return(n.values||[]).find(t=>To(t,e))!==void 0}function vf(n,e){if(n===e)return 0;const t=Ru(n),r=Ru(e);if(t!==r)return vt(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return vt(n.booleanValue,e.booleanValue);case 2:return function(s,i){const o=dn(s.integerValue||s.doubleValue),a=dn(i.integerValue||i.doubleValue);return o<a?-1:o>a?1:o===a?0:isNaN(o)?isNaN(a)?0:-1:1}(n,e);case 3:return $P(n.timestampValue,e.timestampValue);case 4:return $P(Tm(n),Tm(e));case 5:return vt(n.stringValue,e.stringValue);case 6:return function(s,i){const o=xu(s),a=xu(i);return o.compareTo(a)}(n.bytesValue,e.bytesValue);case 7:return function(s,i){const o=s.split("/"),a=i.split("/");for(let c=0;c<o.length&&c<a.length;c++){const l=vt(o[c],a[c]);if(l!==0)return l}return vt(o.length,a.length)}(n.referenceValue,e.referenceValue);case 8:return function(s,i){const o=vt(dn(s.latitude),dn(i.latitude));return o!==0?o:vt(dn(s.longitude),dn(i.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return function(s,i){const o=s.values||[],a=i.values||[];for(let c=0;c<o.length&&c<a.length;++c){const l=vf(o[c],a[c]);if(l)return l}return vt(o.length,a.length)}(n.arrayValue,e.arrayValue);case 10:return function(s,i){if(s===Fw.mapValue&&i===Fw.mapValue)return 0;if(s===Fw.mapValue)return 1;if(i===Fw.mapValue)return-1;const o=s.fields||{},a=Object.keys(o),c=i.fields||{},l=Object.keys(c);a.sort(),l.sort();for(let u=0;u<a.length&&u<l.length;++u){const h=vt(a[u],l[u]);if(h!==0)return h;const d=vf(o[a[u]],c[l[u]]);if(d!==0)return d}return vt(a.length,l.length)}(n.mapValue,e.mapValue);default:throw Ue()}}function $P(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return vt(n,e);const t=Vc(n),r=Vc(e),s=vt(t.seconds,r.seconds);return s!==0?s:vt(t.nanos,r.nanos)}function Af(n){return CI(n)}function CI(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(r){const s=Vc(r);return`time(${s.seconds},${s.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?xu(n.bytesValue).toBase64():"referenceValue"in n?(t=n.referenceValue,Te.fromName(t).toString()):"geoPointValue"in n?`geo(${(e=n.geoPointValue).latitude},${e.longitude})`:"arrayValue"in n?function(r){let s="[",i=!0;for(const o of r.values||[])i?i=!1:s+=",",s+=CI(o);return s+"]"}(n.arrayValue):"mapValue"in n?function(r){const s=Object.keys(r.fields||{}).sort();let i="{",o=!0;for(const a of s)o?o=!1:i+=",",i+=`${a}:${CI(r.fields[a])}`;return i+"}"}(n.mapValue):Ue();var e,t}function MP(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function II(n){return!!n&&"integerValue"in n}function jS(n){return!!n&&"arrayValue"in n}function LP(n){return!!n&&"nullValue"in n}function BP(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function g0(n){return!!n&&"mapValue"in n}function ag(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const e={mapValue:{fields:{}}};return Wu(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=ag(r)),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=ag(n.arrayValue.values[t]);return e}return Object.assign({},n)}function Nme(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class is{constructor(e){this.value=e}static empty(){return new is({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!g0(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=ag(t)}setAll(e){let t=fr.emptyPath(),r={},s=[];e.forEach((o,a)=>{if(!t.isImmediateParentOf(a)){const c=this.getFieldsMap(t);this.applyChanges(c,r,s),r={},s=[],t=a.popLast()}o?r[a.lastSegment()]=ag(o):s.push(a.lastSegment())});const i=this.getFieldsMap(t);this.applyChanges(i,r,s)}delete(e){const t=this.field(e.popLast());g0(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return To(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=t.mapValue.fields[e.get(r)];g0(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=s),t=s}return t.mapValue.fields}applyChanges(e,t,r){Wu(t,(s,i)=>e[s]=i);for(const s of r)delete e[s]}clone(){return new is(ag(this.value))}}function j5(n){const e=[];return Wu(n.fields,(t,r)=>{const s=new fr([t]);if(g0(r)){const i=j5(r.mapValue).fields;if(i.length===0)e.push(s);else for(const o of i)e.push(s.child(o))}else e.push(s)}),new Ss(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hr{constructor(e,t,r,s,i,o,a){this.key=e,this.documentType=t,this.version=r,this.readTime=s,this.createTime=i,this.data=o,this.documentState=a}static newInvalidDocument(e){return new hr(e,0,Fe.min(),Fe.min(),Fe.min(),is.empty(),0)}static newFoundDocument(e,t,r,s){return new hr(e,1,t,Fe.min(),r,s,0)}static newNoDocument(e,t){return new hr(e,2,t,Fe.min(),Fe.min(),is.empty(),0)}static newUnknownDocument(e,t){return new hr(e,3,t,Fe.min(),Fe.min(),is.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Fe.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=is.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=is.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Fe.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof hr&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new hr(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _b{constructor(e,t){this.position=e,this.inclusive=t}}function FP(n,e,t){let r=0;for(let s=0;s<n.position.length;s++){const i=e[s],o=n.position[s];if(i.field.isKeyField()?r=Te.comparator(Te.fromName(o.referenceValue),t.key):r=vf(o,t.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function jP(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!To(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cg{constructor(e,t="asc"){this.field=e,this.dir=t}}function Ome(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H5{}class gn extends H5{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new Rme(e,t,r):t==="array-contains"?new Dme(e,r):t==="in"?new Ume(e,r):t==="not-in"?new $me(e,r):t==="array-contains-any"?new Mme(e,r):new gn(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new Pme(e,r):new kme(e,r)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(vf(t,this.value)):t!==null&&Ru(this.value)===Ru(t)&&this.matchesComparison(vf(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Ue()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}getFirstInequalityField(){return this.isInequality()?this.field:null}}class Mi extends H5{constructor(e,t){super(),this.filters=e,this.op=t,this.lt=null}static create(e,t){return new Mi(e,t)}matches(e){return V5(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.lt!==null||(this.lt=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.lt}getFilters(){return Object.assign([],this.filters)}getFirstInequalityField(){const e=this.ft(t=>t.isInequality());return e!==null?e.field:null}ft(e){for(const t of this.getFlattenedFilters())if(e(t))return t;return null}}function V5(n){return n.op==="and"}function q5(n){return xme(n)&&V5(n)}function xme(n){for(const e of n.filters)if(e instanceof Mi)return!1;return!0}function _I(n){if(n instanceof gn)return n.field.canonicalString()+n.op.toString()+Af(n.value);if(q5(n))return n.filters.map(e=>_I(e)).join(",");{const e=n.filters.map(t=>_I(t)).join(",");return`${n.op}(${e})`}}function z5(n,e){return n instanceof gn?function(t,r){return r instanceof gn&&t.op===r.op&&t.field.isEqual(r.field)&&To(t.value,r.value)}(n,e):n instanceof Mi?function(t,r){return r instanceof Mi&&t.op===r.op&&t.filters.length===r.filters.length?t.filters.reduce((s,i,o)=>s&&z5(i,r.filters[o]),!0):!1}(n,e):void Ue()}function W5(n){return n instanceof gn?function(e){return`${e.field.canonicalString()} ${e.op} ${Af(e.value)}`}(n):n instanceof Mi?function(e){return e.op.toString()+" {"+e.getFilters().map(W5).join(" ,")+"}"}(n):"Filter"}class Rme extends gn{constructor(e,t,r){super(e,t,r),this.key=Te.fromName(r.referenceValue)}matches(e){const t=Te.comparator(e.key,this.key);return this.matchesComparison(t)}}class Pme extends gn{constructor(e,t){super(e,"in",t),this.keys=G5("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class kme extends gn{constructor(e,t){super(e,"not-in",t),this.keys=G5("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function G5(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(r=>Te.fromName(r.referenceValue))}class Dme extends gn{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return jS(t)&&Om(t.arrayValue,this.value)}}class Ume extends gn{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Om(this.value.arrayValue,t)}}class $me extends gn{constructor(e,t){super(e,"not-in",t)}matches(e){if(Om(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&!Om(this.value.arrayValue,t)}}class Mme extends gn{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!jS(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>Om(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lme{constructor(e,t=null,r=[],s=[],i=null,o=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=o,this.endAt=a,this.dt=null}}function HP(n,e=null,t=[],r=[],s=null,i=null,o=null){return new Lme(n,e,t,r,s,i,o)}function HS(n){const e=ze(n);if(e.dt===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>_I(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),WE(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>Af(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>Af(r)).join(",")),e.dt=t}return e.dt}function VS(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!Ome(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!z5(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!jP(n.startAt,e.startAt)&&jP(n.endAt,e.endAt)}function SI(n){return Te.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dy{constructor(e,t=null,r=[],s=[],i=null,o="F",a=null,c=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=o,this.startAt=a,this.endAt=c,this.wt=null,this._t=null,this.startAt,this.endAt}}function Bme(n,e,t,r,s,i,o,a){return new Dy(n,e,t,r,s,i,o,a)}function qS(n){return new Dy(n)}function VP(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function K5(n){return n.explicitOrderBy.length>0?n.explicitOrderBy[0].field:null}function zS(n){for(const e of n.filters){const t=e.getFirstInequalityField();if(t!==null)return t}return null}function Y5(n){return n.collectionGroup!==null}function ad(n){const e=ze(n);if(e.wt===null){e.wt=[];const t=zS(e),r=K5(e);if(t!==null&&r===null)t.isKeyField()||e.wt.push(new cg(t)),e.wt.push(new cg(fr.keyField(),"asc"));else{let s=!1;for(const i of e.explicitOrderBy)e.wt.push(i),i.field.isKeyField()&&(s=!0);if(!s){const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e.wt.push(new cg(fr.keyField(),i))}}}return e.wt}function Ia(n){const e=ze(n);if(!e._t)if(e.limitType==="F")e._t=HP(e.path,e.collectionGroup,ad(e),e.filters,e.limit,e.startAt,e.endAt);else{const t=[];for(const i of ad(e)){const o=i.dir==="desc"?"asc":"desc";t.push(new cg(i.field,o))}const r=e.endAt?new _b(e.endAt.position,e.endAt.inclusive):null,s=e.startAt?new _b(e.startAt.position,e.startAt.inclusive):null;e._t=HP(e.path,e.collectionGroup,t,e.filters,e.limit,r,s)}return e._t}function TI(n,e){e.getFirstInequalityField(),zS(n);const t=n.filters.concat([e]);return new Dy(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function NI(n,e,t){return new Dy(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function GE(n,e){return VS(Ia(n),Ia(e))&&n.limitType===e.limitType}function Q5(n){return`${HS(Ia(n))}|lt:${n.limitType}`}function OI(n){return`Query(target=${function(e){let t=e.path.canonicalString();return e.collectionGroup!==null&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=`, filters: [${e.filters.map(r=>W5(r)).join(", ")}]`),WE(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=`, orderBy: [${e.orderBy.map(r=>function(s){return`${s.field.canonicalString()} (${s.dir})`}(r)).join(", ")}]`),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>Af(r)).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>Af(r)).join(",")),`Target(${t})`}(Ia(n))}; limitType=${n.limitType})`}function KE(n,e){return e.isFoundDocument()&&function(t,r){const s=r.key.path;return t.collectionGroup!==null?r.key.hasCollectionId(t.collectionGroup)&&t.path.isPrefixOf(s):Te.isDocumentKey(t.path)?t.path.isEqual(s):t.path.isImmediateParentOf(s)}(n,e)&&function(t,r){for(const s of ad(t))if(!s.field.isKeyField()&&r.data.field(s.field)===null)return!1;return!0}(n,e)&&function(t,r){for(const s of t.filters)if(!s.matches(r))return!1;return!0}(n,e)&&function(t,r){return!(t.startAt&&!function(s,i,o){const a=FP(s,i,o);return s.inclusive?a<=0:a<0}(t.startAt,ad(t),r)||t.endAt&&!function(s,i,o){const a=FP(s,i,o);return s.inclusive?a>=0:a>0}(t.endAt,ad(t),r))}(n,e)}function Fme(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function Z5(n){return(e,t)=>{let r=!1;for(const s of ad(n)){const i=jme(s,e,t);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function jme(n,e,t){const r=n.field.isKeyField()?Te.comparator(e.key,t.key):function(s,i,o){const a=i.data.field(s),c=o.data.field(s);return a!==null&&c!==null?vf(a,c):Ue()}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return Ue()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zf{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,t){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,t]);s.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[t]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){Wu(this.inner,(t,r)=>{for(const[s,i]of r)e(s,i)})}isEmpty(){return B5(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hme=new Kt(Te.comparator);function _a(){return Hme}const J5=new Kt(Te.comparator);function Bp(...n){let e=J5;for(const t of n)e=e.insert(t.key,t);return e}function X5(n){let e=J5;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function kl(){return lg()}function eB(){return lg()}function lg(){return new zf(n=>n.toString(),(n,e)=>n.isEqual(e))}const Vme=new Kt(Te.comparator),qme=new wr(Te.comparator);function Ze(...n){let e=qme;for(const t of n)e=e.add(t);return e}const zme=new wr(vt);function Wme(){return zme}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tB(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ib(e)?"-0":e}}function nB(n){return{integerValue:""+n}}function rB(n,e){return _me(e)?nB(e):tB(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YE{constructor(){this._=void 0}}function Gme(n,e,t){return n instanceof Sb?function(r,s){const i={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return s&&BS(s)&&(s=FS(s)),s&&(i.fields.__previous_value__=s),{mapValue:i}}(t,e):n instanceof Cf?iB(n,e):n instanceof xm?oB(n,e):function(r,s){const i=sB(r,s),o=qP(i)+qP(r.gt);return II(i)&&II(r.gt)?nB(o):tB(r.serializer,o)}(n,e)}function Kme(n,e,t){return n instanceof Cf?iB(n,e):n instanceof xm?oB(n,e):t}function sB(n,e){return n instanceof Rm?II(t=e)||function(r){return!!r&&"doubleValue"in r}(t)?e:{integerValue:0}:null;var t}class Sb extends YE{}class Cf extends YE{constructor(e){super(),this.elements=e}}function iB(n,e){const t=aB(e);for(const r of n.elements)t.some(s=>To(s,r))||t.push(r);return{arrayValue:{values:t}}}class xm extends YE{constructor(e){super(),this.elements=e}}function oB(n,e){let t=aB(e);for(const r of n.elements)t=t.filter(s=>!To(s,r));return{arrayValue:{values:t}}}class Rm extends YE{constructor(e,t){super(),this.serializer=e,this.gt=t}}function qP(n){return dn(n.integerValue||n.doubleValue)}function aB(n){return jS(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cB{constructor(e,t){this.field=e,this.transform=t}}function Yme(n,e){return n.field.isEqual(e.field)&&function(t,r){return t instanceof Cf&&r instanceof Cf||t instanceof xm&&r instanceof xm?Ef(t.elements,r.elements,To):t instanceof Rm&&r instanceof Rm?To(t.gt,r.gt):t instanceof Sb&&r instanceof Sb}(n.transform,e.transform)}class Qme{constructor(e,t){this.version=e,this.transformResults=t}}class Ri{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Ri}static exists(e){return new Ri(void 0,e)}static updateTime(e){return new Ri(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function m0(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class QE{}function lB(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new WS(n.key,Ri.none()):new Uy(n.key,n.data,Ri.none());{const t=n.data,r=is.empty();let s=new wr(fr.comparator);for(let i of e.fields)if(!s.has(i)){let o=t.field(i);o===null&&i.length>1&&(i=i.popLast(),o=t.field(i)),o===null?r.delete(i):r.set(i,o),s=s.add(i)}return new Zc(n.key,r,new Ss(s.toArray()),Ri.none())}}function Zme(n,e,t){n instanceof Uy?function(r,s,i){const o=r.value.clone(),a=WP(r.fieldTransforms,s,i.transformResults);o.setAll(a),s.convertToFoundDocument(i.version,o).setHasCommittedMutations()}(n,e,t):n instanceof Zc?function(r,s,i){if(!m0(r.precondition,s))return void s.convertToUnknownDocument(i.version);const o=WP(r.fieldTransforms,s,i.transformResults),a=s.data;a.setAll(uB(r)),a.setAll(o),s.convertToFoundDocument(i.version,a).setHasCommittedMutations()}(n,e,t):function(r,s,i){s.convertToNoDocument(i.version).setHasCommittedMutations()}(0,e,t)}function ug(n,e,t,r){return n instanceof Uy?function(s,i,o,a){if(!m0(s.precondition,i))return o;const c=s.value.clone(),l=GP(s.fieldTransforms,a,i);return c.setAll(l),i.convertToFoundDocument(i.version,c).setHasLocalMutations(),null}(n,e,t,r):n instanceof Zc?function(s,i,o,a){if(!m0(s.precondition,i))return o;const c=GP(s.fieldTransforms,a,i),l=i.data;return l.setAll(uB(s)),l.setAll(c),i.convertToFoundDocument(i.version,l).setHasLocalMutations(),o===null?null:o.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(u=>u.field))}(n,e,t,r):function(s,i,o){return m0(s.precondition,i)?(i.convertToNoDocument(i.version).setHasLocalMutations(),null):o}(n,e,t)}function Jme(n,e){let t=null;for(const r of n.fieldTransforms){const s=e.data.field(r.field),i=sB(r.transform,s||null);i!=null&&(t===null&&(t=is.empty()),t.set(r.field,i))}return t||null}function zP(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(t,r){return t===void 0&&r===void 0||!(!t||!r)&&Ef(t,r,(s,i)=>Yme(s,i))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class Uy extends QE{constructor(e,t,r,s=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class Zc extends QE{constructor(e,t,r,s,i=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function uB(n){const e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}}),e}function WP(n,e,t){const r=new Map;Ht(n.length===t.length);for(let s=0;s<t.length;s++){const i=n[s],o=i.transform,a=e.data.field(i.field);r.set(i.field,Kme(o,a,t[s]))}return r}function GP(n,e,t){const r=new Map;for(const s of n){const i=s.transform,o=t.data.field(s.field);r.set(s.field,Gme(i,o,e))}return r}class WS extends QE{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Xme extends QE{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eye{constructor(e,t,r,s){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&Zme(i,e,r[s])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=ug(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=ug(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=eB();return this.mutations.forEach(s=>{const i=e.get(s.key),o=i.overlayedDocument;let a=this.applyToLocalView(o,i.mutatedFields);a=t.has(s.key)?null:a;const c=lB(o,a);c!==null&&r.set(s.key,c),o.isValidDocument()||o.convertToNoDocument(Fe.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),Ze())}isEqual(e){return this.batchId===e.batchId&&Ef(this.mutations,e.mutations,(t,r)=>zP(t,r))&&Ef(this.baseMutations,e.baseMutations,(t,r)=>zP(t,r))}}class GS{constructor(e,t,r,s){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=s}static from(e,t,r){Ht(e.mutations.length===r.length);let s=Vme;const i=e.mutations;for(let o=0;o<i.length;o++)s=s.insert(i[o].key,r[o].version);return new GS(e,t,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tye{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nye{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ln,rt;function rye(n){switch(n){default:return Ue();case W.CANCELLED:case W.UNKNOWN:case W.DEADLINE_EXCEEDED:case W.RESOURCE_EXHAUSTED:case W.INTERNAL:case W.UNAVAILABLE:case W.UNAUTHENTICATED:return!1;case W.INVALID_ARGUMENT:case W.NOT_FOUND:case W.ALREADY_EXISTS:case W.PERMISSION_DENIED:case W.FAILED_PRECONDITION:case W.ABORTED:case W.OUT_OF_RANGE:case W.UNIMPLEMENTED:case W.DATA_LOSS:return!0}}function hB(n){if(n===void 0)return Ca("GRPC error has no .code"),W.UNKNOWN;switch(n){case ln.OK:return W.OK;case ln.CANCELLED:return W.CANCELLED;case ln.UNKNOWN:return W.UNKNOWN;case ln.DEADLINE_EXCEEDED:return W.DEADLINE_EXCEEDED;case ln.RESOURCE_EXHAUSTED:return W.RESOURCE_EXHAUSTED;case ln.INTERNAL:return W.INTERNAL;case ln.UNAVAILABLE:return W.UNAVAILABLE;case ln.UNAUTHENTICATED:return W.UNAUTHENTICATED;case ln.INVALID_ARGUMENT:return W.INVALID_ARGUMENT;case ln.NOT_FOUND:return W.NOT_FOUND;case ln.ALREADY_EXISTS:return W.ALREADY_EXISTS;case ln.PERMISSION_DENIED:return W.PERMISSION_DENIED;case ln.FAILED_PRECONDITION:return W.FAILED_PRECONDITION;case ln.ABORTED:return W.ABORTED;case ln.OUT_OF_RANGE:return W.OUT_OF_RANGE;case ln.UNIMPLEMENTED:return W.UNIMPLEMENTED;case ln.DATA_LOSS:return W.DATA_LOSS;default:return Ue()}}(rt=ln||(ln={}))[rt.OK=0]="OK",rt[rt.CANCELLED=1]="CANCELLED",rt[rt.UNKNOWN=2]="UNKNOWN",rt[rt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",rt[rt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",rt[rt.NOT_FOUND=5]="NOT_FOUND",rt[rt.ALREADY_EXISTS=6]="ALREADY_EXISTS",rt[rt.PERMISSION_DENIED=7]="PERMISSION_DENIED",rt[rt.UNAUTHENTICATED=16]="UNAUTHENTICATED",rt[rt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",rt[rt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",rt[rt.ABORTED=10]="ABORTED",rt[rt.OUT_OF_RANGE=11]="OUT_OF_RANGE",rt[rt.UNIMPLEMENTED=12]="UNIMPLEMENTED",rt[rt.INTERNAL=13]="INTERNAL",rt[rt.UNAVAILABLE=14]="UNAVAILABLE",rt[rt.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KS{constructor(){this.onExistenceFilterMismatchCallbacks=new Map}static get instance(){return jw}static getOrCreateInstance(){return jw===null&&(jw=new KS),jw}onExistenceFilterMismatch(e){const t=Symbol();return this.onExistenceFilterMismatchCallbacks.set(t,e),()=>this.onExistenceFilterMismatchCallbacks.delete(t)}notifyOnExistenceFilterMismatch(e){this.onExistenceFilterMismatchCallbacks.forEach(t=>t(e))}}let jw=null;/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sye(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iye=new od([4294967295,4294967295],0);function KP(n){const e=sye().encode(n),t=new ume;return t.update(e),new Uint8Array(t.digest())}function YP(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new od([t,r],0),new od([s,i],0)]}class YS{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new Fp(`Invalid padding: ${t}`);if(r<0)throw new Fp(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Fp(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new Fp(`Invalid padding when bitmap length is 0: ${t}`);this.It=8*e.length-t,this.Tt=od.fromNumber(this.It)}Et(e,t,r){let s=e.add(t.multiply(od.fromNumber(r)));return s.compare(iye)===1&&(s=new od([s.getBits(0),s.getBits(1)],0)),s.modulo(this.Tt).toNumber()}At(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}vt(e){if(this.It===0)return!1;const t=KP(e),[r,s]=YP(t);for(let i=0;i<this.hashCount;i++){const o=this.Et(r,s,i);if(!this.At(o))return!1}return!0}static create(e,t,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new YS(i,s,t);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.It===0)return;const t=KP(e),[r,s]=YP(t);for(let i=0;i<this.hashCount;i++){const o=this.Et(r,s,i);this.Rt(o)}}Rt(e){const t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}}class Fp extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZE{constructor(e,t,r,s,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const s=new Map;return s.set(e,$y.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new ZE(Fe.min(),s,new Kt(vt),_a(),Ze())}}class $y{constructor(e,t,r,s,i){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new $y(r,t,Ze(),Ze(),Ze())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y0{constructor(e,t,r,s){this.Pt=e,this.removedTargetIds=t,this.key=r,this.bt=s}}class dB{constructor(e,t){this.targetId=e,this.Vt=t}}class fB{constructor(e,t,r=Er.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=s}}class QP{constructor(){this.St=0,this.Dt=JP(),this.Ct=Er.EMPTY_BYTE_STRING,this.xt=!1,this.Nt=!0}get current(){return this.xt}get resumeToken(){return this.Ct}get kt(){return this.St!==0}get Mt(){return this.Nt}$t(e){e.approximateByteSize()>0&&(this.Nt=!0,this.Ct=e)}Ot(){let e=Ze(),t=Ze(),r=Ze();return this.Dt.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:t=t.add(s);break;case 1:r=r.add(s);break;default:Ue()}}),new $y(this.Ct,this.xt,e,t,r)}Ft(){this.Nt=!1,this.Dt=JP()}Bt(e,t){this.Nt=!0,this.Dt=this.Dt.insert(e,t)}Lt(e){this.Nt=!0,this.Dt=this.Dt.remove(e)}qt(){this.St+=1}Ut(){this.St-=1}Kt(){this.Nt=!0,this.xt=!0}}class oye{constructor(e){this.Gt=e,this.Qt=new Map,this.jt=_a(),this.zt=ZP(),this.Wt=new Kt(vt)}Ht(e){for(const t of e.Pt)e.bt&&e.bt.isFoundDocument()?this.Jt(t,e.bt):this.Yt(t,e.key,e.bt);for(const t of e.removedTargetIds)this.Yt(t,e.key,e.bt)}Xt(e){this.forEachTarget(e,t=>{const r=this.Zt(t);switch(e.state){case 0:this.te(t)&&r.$t(e.resumeToken);break;case 1:r.Ut(),r.kt||r.Ft(),r.$t(e.resumeToken);break;case 2:r.Ut(),r.kt||this.removeTarget(t);break;case 3:this.te(t)&&(r.Kt(),r.$t(e.resumeToken));break;case 4:this.te(t)&&(this.ee(t),r.$t(e.resumeToken));break;default:Ue()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Qt.forEach((r,s)=>{this.te(s)&&t(s)})}ne(e){var t;const r=e.targetId,s=e.Vt.count,i=this.se(r);if(i){const o=i.target;if(SI(o))if(s===0){const a=new Te(o.path);this.Yt(r,a,hr.newNoDocument(a,Fe.min()))}else Ht(s===1);else{const a=this.ie(r);if(a!==s){const c=this.re(e,a);if(c!==0){this.ee(r);const l=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Wt=this.Wt.insert(r,l)}(t=KS.instance)===null||t===void 0||t.notifyOnExistenceFilterMismatch(function(l,u,h){var d,f,p,g,m,w;const v={localCacheCount:u,existenceFilterCount:h.count},A=h.unchangedNames;return A&&(v.bloomFilter={applied:l===0,hashCount:(d=A==null?void 0:A.hashCount)!==null&&d!==void 0?d:0,bitmapLength:(g=(p=(f=A==null?void 0:A.bits)===null||f===void 0?void 0:f.bitmap)===null||p===void 0?void 0:p.length)!==null&&g!==void 0?g:0,padding:(w=(m=A==null?void 0:A.bits)===null||m===void 0?void 0:m.padding)!==null&&w!==void 0?w:0}),v}(c,a,e.Vt))}}}}re(e,t){const{unchangedNames:r,count:s}=e.Vt;if(!r||!r.bits)return 1;const{bits:{bitmap:i="",padding:o=0},hashCount:a=0}=r;let c,l;try{c=xu(i).toUint8Array()}catch(u){if(u instanceof F5)return bf("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),1;throw u}try{l=new YS(c,o,a)}catch(u){return bf(u instanceof Fp?"BloomFilter error: ":"Applying bloom filter failed: ",u),1}return l.It===0?1:s!==t-this.oe(e.targetId,l)?2:0}oe(e,t){const r=this.Gt.getRemoteKeysForTarget(e);let s=0;return r.forEach(i=>{const o=this.Gt.ue(),a=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;t.vt(a)||(this.Yt(e,i,null),s++)}),s}ce(e){const t=new Map;this.Qt.forEach((i,o)=>{const a=this.se(o);if(a){if(i.current&&SI(a.target)){const c=new Te(a.target.path);this.jt.get(c)!==null||this.ae(o,c)||this.Yt(o,c,hr.newNoDocument(c,e))}i.Mt&&(t.set(o,i.Ot()),i.Ft())}});let r=Ze();this.zt.forEach((i,o)=>{let a=!0;o.forEachWhile(c=>{const l=this.se(c);return!l||l.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(i))}),this.jt.forEach((i,o)=>o.setReadTime(e));const s=new ZE(e,t,this.Wt,this.jt,r);return this.jt=_a(),this.zt=ZP(),this.Wt=new Kt(vt),s}Jt(e,t){if(!this.te(e))return;const r=this.ae(e,t.key)?2:0;this.Zt(e).Bt(t.key,r),this.jt=this.jt.insert(t.key,t),this.zt=this.zt.insert(t.key,this.he(t.key).add(e))}Yt(e,t,r){if(!this.te(e))return;const s=this.Zt(e);this.ae(e,t)?s.Bt(t,1):s.Lt(t),this.zt=this.zt.insert(t,this.he(t).delete(e)),r&&(this.jt=this.jt.insert(t,r))}removeTarget(e){this.Qt.delete(e)}ie(e){const t=this.Zt(e).Ot();return this.Gt.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}qt(e){this.Zt(e).qt()}Zt(e){let t=this.Qt.get(e);return t||(t=new QP,this.Qt.set(e,t)),t}he(e){let t=this.zt.get(e);return t||(t=new wr(vt),this.zt=this.zt.insert(e,t)),t}te(e){const t=this.se(e)!==null;return t||Ie("WatchChangeAggregator","Detected inactive target",e),t}se(e){const t=this.Qt.get(e);return t&&t.kt?null:this.Gt.le(e)}ee(e){this.Qt.set(e,new QP),this.Gt.getRemoteKeysForTarget(e).forEach(t=>{this.Yt(e,t,null)})}ae(e,t){return this.Gt.getRemoteKeysForTarget(e).has(t)}}function ZP(){return new Kt(Te.comparator)}function JP(){return new Kt(Te.comparator)}const aye={asc:"ASCENDING",desc:"DESCENDING"},cye={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},lye={and:"AND",or:"OR"};class uye{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function xI(n,e){return n.useProto3Json||WE(e)?e:{value:e}}function Tb(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function pB(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function hye(n,e){return Tb(n,e.toTimestamp())}function Ao(n){return Ht(!!n),Fe.fromTimestamp(function(e){const t=Vc(e);return new An(t.seconds,t.nanos)}(n))}function QS(n,e){return function(t){return new jt(["projects",t.projectId,"databases",t.database])}(n).child("documents").child(e).canonicalString()}function gB(n){const e=jt.fromString(n);return Ht(bB(e)),e}function RI(n,e){return QS(n.databaseId,e.path)}function Z1(n,e){const t=gB(e);if(t.get(1)!==n.databaseId.projectId)throw new we(W.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new we(W.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new Te(mB(t))}function PI(n,e){return QS(n.databaseId,e)}function dye(n){const e=gB(n);return e.length===4?jt.emptyPath():mB(e)}function kI(n){return new jt(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function mB(n){return Ht(n.length>4&&n.get(4)==="documents"),n.popFirst(5)}function XP(n,e,t){return{name:RI(n,e),fields:t.value.mapValue.fields}}function fye(n,e){let t;if("targetChange"in e){e.targetChange;const r=function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:Ue()}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(c,l){return c.useProto3Json?(Ht(l===void 0||typeof l=="string"),Er.fromBase64String(l||"")):(Ht(l===void 0||l instanceof Uint8Array),Er.fromUint8Array(l||new Uint8Array))}(n,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(c){const l=c.code===void 0?W.UNKNOWN:hB(c.code);return new we(l,c.message||"")}(o);t=new fB(r,s,i,a||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=Z1(n,r.document.name),i=Ao(r.document.updateTime),o=r.document.createTime?Ao(r.document.createTime):Fe.min(),a=new is({mapValue:{fields:r.document.fields}}),c=hr.newFoundDocument(s,i,o,a),l=r.targetIds||[],u=r.removedTargetIds||[];t=new y0(l,u,c.key,c)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=Z1(n,r.document),i=r.readTime?Ao(r.readTime):Fe.min(),o=hr.newNoDocument(s,i),a=r.removedTargetIds||[];t=new y0([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=Z1(n,r.document),i=r.removedTargetIds||[];t=new y0([],i,s,null)}else{if(!("filter"in e))return Ue();{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,o=new nye(s,i),a=r.targetId;t=new dB(a,o)}}return t}function pye(n,e){let t;if(e instanceof Uy)t={update:XP(n,e.key,e.value)};else if(e instanceof WS)t={delete:RI(n,e.key)};else if(e instanceof Zc)t={update:XP(n,e.key,e.data),updateMask:Cye(e.fieldMask)};else{if(!(e instanceof Xme))return Ue();t={verify:RI(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(s,i){const o=i.transform;if(o instanceof Sb)return{fieldPath:i.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof Cf)return{fieldPath:i.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof xm)return{fieldPath:i.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof Rm)return{fieldPath:i.field.canonicalString(),increment:o.gt};throw Ue()}(0,r))),e.precondition.isNone||(t.currentDocument=function(r,s){return s.updateTime!==void 0?{updateTime:hye(r,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:Ue()}(n,e.precondition)),t}function gye(n,e){return n&&n.length>0?(Ht(e!==void 0),n.map(t=>function(r,s){let i=r.updateTime?Ao(r.updateTime):Ao(s);return i.isEqual(Fe.min())&&(i=Ao(s)),new Qme(i,r.transformResults||[])}(t,e))):[]}function mye(n,e){return{documents:[PI(n,e.path)]}}function yye(n,e){const t={structuredQuery:{}},r=e.path;e.collectionGroup!==null?(t.parent=PI(n,r),t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(t.parent=PI(n,r.popLast()),t.structuredQuery.from=[{collectionId:r.lastSegment()}]);const s=function(c){if(c.length!==0)return wB(Mi.create(c,"and"))}(e.filters);s&&(t.structuredQuery.where=s);const i=function(c){if(c.length!==0)return c.map(l=>function(u){return{field:kh(u.field),direction:Eye(u.dir)}}(l))}(e.orderBy);i&&(t.structuredQuery.orderBy=i);const o=xI(n,e.limit);var a;return o!==null&&(t.structuredQuery.limit=o),e.startAt&&(t.structuredQuery.startAt={before:(a=e.startAt).inclusive,values:a.position}),e.endAt&&(t.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(e.endAt)),t}function wye(n){let e=dye(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let s=null;if(r>0){Ht(r===1);const u=t.from[0];u.allDescendants?s=u.collectionId:e=e.child(u.collectionId)}let i=[];t.where&&(i=function(u){const h=yB(u);return h instanceof Mi&&q5(h)?h.getFilters():[h]}(t.where));let o=[];t.orderBy&&(o=t.orderBy.map(u=>function(h){return new cg(Dh(h.field),function(d){switch(d){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(h.direction))}(u)));let a=null;t.limit&&(a=function(u){let h;return h=typeof u=="object"?u.value:u,WE(h)?null:h}(t.limit));let c=null;t.startAt&&(c=function(u){const h=!!u.before,d=u.values||[];return new _b(d,h)}(t.startAt));let l=null;return t.endAt&&(l=function(u){const h=!u.before,d=u.values||[];return new _b(d,h)}(t.endAt)),Bme(e,s,o,i,a,"F",c,l)}function bye(n,e){const t=function(r){switch(r){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Ue()}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function yB(n){return n.unaryFilter!==void 0?function(e){switch(e.unaryFilter.op){case"IS_NAN":const t=Dh(e.unaryFilter.field);return gn.create(t,"==",{doubleValue:NaN});case"IS_NULL":const r=Dh(e.unaryFilter.field);return gn.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=Dh(e.unaryFilter.field);return gn.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const i=Dh(e.unaryFilter.field);return gn.create(i,"!=",{nullValue:"NULL_VALUE"});default:return Ue()}}(n):n.fieldFilter!==void 0?function(e){return gn.create(Dh(e.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Ue()}}(e.fieldFilter.op),e.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(e){return Mi.create(e.compositeFilter.filters.map(t=>yB(t)),function(t){switch(t){case"AND":return"and";case"OR":return"or";default:return Ue()}}(e.compositeFilter.op))}(n):Ue()}function Eye(n){return aye[n]}function vye(n){return cye[n]}function Aye(n){return lye[n]}function kh(n){return{fieldPath:n.canonicalString()}}function Dh(n){return fr.fromServerFormat(n.fieldPath)}function wB(n){return n instanceof gn?function(e){if(e.op==="=="){if(BP(e.value))return{unaryFilter:{field:kh(e.field),op:"IS_NAN"}};if(LP(e.value))return{unaryFilter:{field:kh(e.field),op:"IS_NULL"}}}else if(e.op==="!="){if(BP(e.value))return{unaryFilter:{field:kh(e.field),op:"IS_NOT_NAN"}};if(LP(e.value))return{unaryFilter:{field:kh(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:kh(e.field),op:vye(e.op),value:e.value}}}(n):n instanceof Mi?function(e){const t=e.getFilters().map(r=>wB(r));return t.length===1?t[0]:{compositeFilter:{op:Aye(e.op),filters:t}}}(n):Ue()}function Cye(n){const e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function bB(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _c{constructor(e,t,r,s,i=Fe.min(),o=Fe.min(),a=Er.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=c}withSequenceNumber(e){return new _c(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new _c(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new _c(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new _c(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Iye{constructor(e){this.fe=e}}function _ye(n){const e=wye({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?NI(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sye{constructor(){this.rn=new Tye}addToCollectionParentIndex(e,t){return this.rn.add(t),J.resolve()}getCollectionParents(e,t){return J.resolve(this.rn.getEntries(t))}addFieldIndex(e,t){return J.resolve()}deleteFieldIndex(e,t){return J.resolve()}getDocumentsMatchingTarget(e,t){return J.resolve(null)}getIndexType(e,t){return J.resolve(0)}getFieldIndexes(e,t){return J.resolve([])}getNextCollectionGroupToUpdate(e){return J.resolve(null)}getMinOffset(e,t){return J.resolve(Hc.min())}getMinOffsetFromCollectionGroup(e,t){return J.resolve(Hc.min())}updateCollectionGroup(e,t,r){return J.resolve()}updateIndexEntries(e,t){return J.resolve()}}class Tye{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),s=this.index[t]||new wr(jt.comparator),i=!s.has(r);return this.index[t]=s.add(r),i}has(e){const t=e.lastSegment(),r=e.popLast(),s=this.index[t];return s&&s.has(r)}getEntries(e){return(this.index[e]||new wr(jt.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class If{constructor(e){this.Nn=e}next(){return this.Nn+=2,this.Nn}static kn(){return new If(0)}static Mn(){return new If(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nye{constructor(){this.changes=new zf(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,hr.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return r!==void 0?J.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oye{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xye{constructor(e,t,r,s){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,t))).next(s=>(r!==null&&ug(r.mutation,s,Ss.empty(),An.now()),s))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,Ze()).next(()=>r))}getLocalViewOfDocuments(e,t,r=Ze()){const s=kl();return this.populateOverlays(e,s,t).next(()=>this.computeViews(e,t,s,r).next(i=>{let o=Bp();return i.forEach((a,c)=>{o=o.insert(a,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){const r=kl();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,Ze()))}populateOverlays(e,t,r){const s=[];return r.forEach(i=>{t.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((o,a)=>{t.set(o,a)})})}computeViews(e,t,r,s){let i=_a();const o=lg(),a=lg();return t.forEach((c,l)=>{const u=r.get(l.key);s.has(l.key)&&(u===void 0||u.mutation instanceof Zc)?i=i.insert(l.key,l):u!==void 0?(o.set(l.key,u.mutation.getFieldMask()),ug(u.mutation,l,u.mutation.getFieldMask(),An.now())):o.set(l.key,Ss.empty())}),this.recalculateAndSaveOverlays(e,i).next(c=>(c.forEach((l,u)=>o.set(l,u)),t.forEach((l,u)=>{var h;return a.set(l,new Oye(u,(h=o.get(l))!==null&&h!==void 0?h:null))}),a))}recalculateAndSaveOverlays(e,t){const r=lg();let s=new Kt((o,a)=>o-a),i=Ze();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(const a of o)a.keys().forEach(c=>{const l=t.get(c);if(l===null)return;let u=r.get(c)||Ss.empty();u=a.applyToLocalView(l,u),r.set(c,u);const h=(s.get(a.batchId)||Ze()).add(c);s=s.insert(a.batchId,h)})}).next(()=>{const o=[],a=s.getReverseIterator();for(;a.hasNext();){const c=a.getNext(),l=c.key,u=c.value,h=eB();u.forEach(d=>{if(!i.has(d)){const f=lB(t.get(d),r.get(d));f!==null&&h.set(d,f),i=i.add(d)}}),o.push(this.documentOverlayCache.saveOverlays(e,l,h))}return J.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r){return function(s){return Te.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Y5(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r):this.getDocumentsMatchingCollectionQuery(e,t,r)}getNextDocuments(e,t,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,s).next(i=>{const o=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,s-i.size):J.resolve(kl());let a=-1,c=i;return o.next(l=>J.forEach(l,(u,h)=>(a<h.largestBatchId&&(a=h.largestBatchId),i.get(u)?J.resolve():this.remoteDocumentCache.getEntry(e,u).next(d=>{c=c.insert(u,d)}))).next(()=>this.populateOverlays(e,l,i)).next(()=>this.computeViews(e,c,l,Ze())).next(u=>({batchId:a,changes:X5(u)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Te(t)).next(r=>{let s=Bp();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,t,r){const s=t.collectionGroup;let i=Bp();return this.indexManager.getCollectionParents(e,s).next(o=>J.forEach(o,a=>{const c=function(l,u){return new Dy(u,null,l.explicitOrderBy.slice(),l.filters.slice(),l.limit,l.limitType,l.startAt,l.endAt)}(t,a.child(s));return this.getDocumentsMatchingCollectionQuery(e,c,r).next(l=>{l.forEach((u,h)=>{i=i.insert(u,h)})})}).next(()=>i))}getDocumentsMatchingCollectionQuery(e,t,r){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(i=>(s=i,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,s))).next(i=>{s.forEach((a,c)=>{const l=c.getKey();i.get(l)===null&&(i=i.insert(l,hr.newInvalidDocument(l)))});let o=Bp();return i.forEach((a,c)=>{const l=s.get(a);l!==void 0&&ug(l.mutation,c,Ss.empty(),An.now()),KE(t,c)&&(o=o.insert(a,c))}),o})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rye{constructor(e){this.serializer=e,this.cs=new Map,this.hs=new Map}getBundleMetadata(e,t){return J.resolve(this.cs.get(t))}saveBundleMetadata(e,t){var r;return this.cs.set(t.id,{id:(r=t).id,version:r.version,createTime:Ao(r.createTime)}),J.resolve()}getNamedQuery(e,t){return J.resolve(this.hs.get(t))}saveNamedQuery(e,t){return this.hs.set(t.name,function(r){return{name:r.name,query:_ye(r.bundledQuery),readTime:Ao(r.readTime)}}(t)),J.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pye{constructor(){this.overlays=new Kt(Te.comparator),this.ls=new Map}getOverlay(e,t){return J.resolve(this.overlays.get(t))}getOverlays(e,t){const r=kl();return J.forEach(t,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((s,i)=>{this.we(e,t,i)}),J.resolve()}removeOverlaysForBatchId(e,t,r){const s=this.ls.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.ls.delete(r)),J.resolve()}getOverlaysForCollection(e,t,r){const s=kl(),i=t.length+1,o=new Te(t.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const c=a.getNext().value,l=c.getKey();if(!t.isPrefixOf(l.path))break;l.path.length===i&&c.largestBatchId>r&&s.set(c.getKey(),c)}return J.resolve(s)}getOverlaysForCollectionGroup(e,t,r,s){let i=new Kt((l,u)=>l-u);const o=this.overlays.getIterator();for(;o.hasNext();){const l=o.getNext().value;if(l.getKey().getCollectionGroup()===t&&l.largestBatchId>r){let u=i.get(l.largestBatchId);u===null&&(u=kl(),i=i.insert(l.largestBatchId,u)),u.set(l.getKey(),l)}}const a=kl(),c=i.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((l,u)=>a.set(l,u)),!(a.size()>=s)););return J.resolve(a)}we(e,t,r){const s=this.overlays.get(r.key);if(s!==null){const o=this.ls.get(s.largestBatchId).delete(r.key);this.ls.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new tye(t,r));let i=this.ls.get(t);i===void 0&&(i=Ze(),this.ls.set(t,i)),this.ls.set(t,i.add(r.key))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZS{constructor(){this.fs=new wr(Tn.ds),this.ws=new wr(Tn._s)}isEmpty(){return this.fs.isEmpty()}addReference(e,t){const r=new Tn(e,t);this.fs=this.fs.add(r),this.ws=this.ws.add(r)}gs(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.ys(new Tn(e,t))}ps(e,t){e.forEach(r=>this.removeReference(r,t))}Is(e){const t=new Te(new jt([])),r=new Tn(t,e),s=new Tn(t,e+1),i=[];return this.ws.forEachInRange([r,s],o=>{this.ys(o),i.push(o.key)}),i}Ts(){this.fs.forEach(e=>this.ys(e))}ys(e){this.fs=this.fs.delete(e),this.ws=this.ws.delete(e)}Es(e){const t=new Te(new jt([])),r=new Tn(t,e),s=new Tn(t,e+1);let i=Ze();return this.ws.forEachInRange([r,s],o=>{i=i.add(o.key)}),i}containsKey(e){const t=new Tn(e,0),r=this.fs.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}}class Tn{constructor(e,t){this.key=e,this.As=t}static ds(e,t){return Te.comparator(e.key,t.key)||vt(e.As,t.As)}static _s(e,t){return vt(e.As,t.As)||Te.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kye{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.vs=1,this.Rs=new wr(Tn.ds)}checkEmpty(e){return J.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,s){const i=this.vs;this.vs++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new eye(i,t,r,s);this.mutationQueue.push(o);for(const a of s)this.Rs=this.Rs.add(new Tn(a.key,i)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return J.resolve(o)}lookupMutationBatch(e,t){return J.resolve(this.Ps(t))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,s=this.bs(r),i=s<0?0:s;return J.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return J.resolve(this.mutationQueue.length===0?-1:this.vs-1)}getAllMutationBatches(e){return J.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new Tn(t,0),s=new Tn(t,Number.POSITIVE_INFINITY),i=[];return this.Rs.forEachInRange([r,s],o=>{const a=this.Ps(o.As);i.push(a)}),J.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new wr(vt);return t.forEach(s=>{const i=new Tn(s,0),o=new Tn(s,Number.POSITIVE_INFINITY);this.Rs.forEachInRange([i,o],a=>{r=r.add(a.As)})}),J.resolve(this.Vs(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,s=r.length+1;let i=r;Te.isDocumentKey(i)||(i=i.child(""));const o=new Tn(new Te(i),0);let a=new wr(vt);return this.Rs.forEachWhile(c=>{const l=c.key.path;return!!r.isPrefixOf(l)&&(l.length===s&&(a=a.add(c.As)),!0)},o),J.resolve(this.Vs(a))}Vs(e){const t=[];return e.forEach(r=>{const s=this.Ps(r);s!==null&&t.push(s)}),t}removeMutationBatch(e,t){Ht(this.Ss(t.batchId,"removed")===0),this.mutationQueue.shift();let r=this.Rs;return J.forEach(t.mutations,s=>{const i=new Tn(s.key,t.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.Rs=r})}Cn(e){}containsKey(e,t){const r=new Tn(t,0),s=this.Rs.firstAfterOrEqual(r);return J.resolve(t.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,J.resolve()}Ss(e,t){return this.bs(e)}bs(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Ps(e){const t=this.bs(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dye{constructor(e){this.Ds=e,this.docs=new Kt(Te.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,s=this.docs.get(r),i=s?s.size:0,o=this.Ds(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return J.resolve(r?r.document.mutableCopy():hr.newInvalidDocument(t))}getEntries(e,t){let r=_a();return t.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():hr.newInvalidDocument(s))}),J.resolve(r)}getDocumentsMatchingQuery(e,t,r,s){let i=_a();const o=t.path,a=new Te(o.child("")),c=this.docs.getIteratorFrom(a);for(;c.hasNext();){const{key:l,value:{document:u}}=c.getNext();if(!o.isPrefixOf(l.path))break;l.path.length>o.length+1||Ame(vme(u),r)<=0||(s.has(u.key)||KE(t,u))&&(i=i.insert(u.key,u.mutableCopy()))}return J.resolve(i)}getAllFromCollectionGroup(e,t,r,s){Ue()}Cs(e,t){return J.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new Uye(this)}getSize(e){return J.resolve(this.size)}}class Uye extends Nye{constructor(e){super(),this.os=e}applyChanges(e){const t=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?t.push(this.os.addEntry(e,s)):this.os.removeEntry(r)}),J.waitFor(t)}getFromCache(e,t){return this.os.getEntry(e,t)}getAllFromCache(e,t){return this.os.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $ye{constructor(e){this.persistence=e,this.xs=new zf(t=>HS(t),VS),this.lastRemoteSnapshotVersion=Fe.min(),this.highestTargetId=0,this.Ns=0,this.ks=new ZS,this.targetCount=0,this.Ms=If.kn()}forEachTarget(e,t){return this.xs.forEach((r,s)=>t(s)),J.resolve()}getLastRemoteSnapshotVersion(e){return J.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return J.resolve(this.Ns)}allocateTargetId(e){return this.highestTargetId=this.Ms.next(),J.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.Ns&&(this.Ns=t),J.resolve()}Fn(e){this.xs.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.Ms=new If(t),this.highestTargetId=t),e.sequenceNumber>this.Ns&&(this.Ns=e.sequenceNumber)}addTargetData(e,t){return this.Fn(t),this.targetCount+=1,J.resolve()}updateTargetData(e,t){return this.Fn(t),J.resolve()}removeTargetData(e,t){return this.xs.delete(t.target),this.ks.Is(t.targetId),this.targetCount-=1,J.resolve()}removeTargets(e,t,r){let s=0;const i=[];return this.xs.forEach((o,a)=>{a.sequenceNumber<=t&&r.get(a.targetId)===null&&(this.xs.delete(o),i.push(this.removeMatchingKeysForTargetId(e,a.targetId)),s++)}),J.waitFor(i).next(()=>s)}getTargetCount(e){return J.resolve(this.targetCount)}getTargetData(e,t){const r=this.xs.get(t)||null;return J.resolve(r)}addMatchingKeys(e,t,r){return this.ks.gs(t,r),J.resolve()}removeMatchingKeys(e,t,r){this.ks.ps(t,r);const s=this.persistence.referenceDelegate,i=[];return s&&t.forEach(o=>{i.push(s.markPotentiallyOrphaned(e,o))}),J.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this.ks.Is(t),J.resolve()}getMatchingKeysForTargetId(e,t){const r=this.ks.Es(t);return J.resolve(r)}containsKey(e,t){return J.resolve(this.ks.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mye{constructor(e,t){this.$s={},this.overlays={},this.Os=new LS(0),this.Fs=!1,this.Fs=!0,this.referenceDelegate=e(this),this.Bs=new $ye(this),this.indexManager=new Sye,this.remoteDocumentCache=function(r){return new Dye(r)}(r=>this.referenceDelegate.Ls(r)),this.serializer=new Iye(t),this.qs=new Rye(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Fs=!1,Promise.resolve()}get started(){return this.Fs}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new Pye,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.$s[e.toKey()];return r||(r=new kye(t,this.referenceDelegate),this.$s[e.toKey()]=r),r}getTargetCache(){return this.Bs}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.qs}runTransaction(e,t,r){Ie("MemoryPersistence","Starting transaction:",e);const s=new Lye(this.Os.next());return this.referenceDelegate.Us(),r(s).next(i=>this.referenceDelegate.Ks(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Gs(e,t){return J.or(Object.values(this.$s).map(r=>()=>r.containsKey(e,t)))}}class Lye extends Ime{constructor(e){super(),this.currentSequenceNumber=e}}class JS{constructor(e){this.persistence=e,this.Qs=new ZS,this.js=null}static zs(e){return new JS(e)}get Ws(){if(this.js)return this.js;throw Ue()}addReference(e,t,r){return this.Qs.addReference(r,t),this.Ws.delete(r.toString()),J.resolve()}removeReference(e,t,r){return this.Qs.removeReference(r,t),this.Ws.add(r.toString()),J.resolve()}markPotentiallyOrphaned(e,t){return this.Ws.add(t.toString()),J.resolve()}removeTarget(e,t){this.Qs.Is(t.targetId).forEach(s=>this.Ws.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(s=>{s.forEach(i=>this.Ws.add(i.toString()))}).next(()=>r.removeTargetData(e,t))}Us(){this.js=new Set}Ks(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return J.forEach(this.Ws,r=>{const s=Te.fromPath(r);return this.Hs(e,s).next(i=>{i||t.removeEntry(s,Fe.min())})}).next(()=>(this.js=null,t.apply(e)))}updateLimboDocument(e,t){return this.Hs(e,t).next(r=>{r?this.Ws.delete(t.toString()):this.Ws.add(t.toString())})}Ls(e){return 0}Hs(e,t){return J.or([()=>J.resolve(this.Qs.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Gs(e,t)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XS{constructor(e,t,r,s){this.targetId=e,this.fromCache=t,this.Fi=r,this.Bi=s}static Li(e,t){let r=Ze(),s=Ze();for(const i of t.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new XS(e,t.fromCache,r,s)}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bye{constructor(){this.qi=!1}initialize(e,t){this.Ui=e,this.indexManager=t,this.qi=!0}getDocumentsMatchingQuery(e,t,r,s){return this.Ki(e,t).next(i=>i||this.Gi(e,t,s,r)).next(i=>i||this.Qi(e,t))}Ki(e,t){if(VP(t))return J.resolve(null);let r=Ia(t);return this.indexManager.getIndexType(e,r).next(s=>s===0?null:(t.limit!==null&&s===1&&(t=NI(t,null,"F"),r=Ia(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(i=>{const o=Ze(...i);return this.Ui.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(c=>{const l=this.ji(t,a);return this.zi(t,l,o,c.readTime)?this.Ki(e,NI(t,null,"F")):this.Wi(e,l,t,c)}))})))}Gi(e,t,r,s){return VP(t)||s.isEqual(Fe.min())?this.Qi(e,t):this.Ui.getDocuments(e,r).next(i=>{const o=this.ji(t,i);return this.zi(t,o,r,s)?this.Qi(e,t):(kP()<=Ct.DEBUG&&Ie("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),OI(t)),this.Wi(e,o,t,Eme(s,-1)))})}ji(e,t){let r=new wr(Z5(e));return t.forEach((s,i)=>{KE(e,i)&&(r=r.add(i))}),r}zi(e,t,r,s){if(e.limit===null)return!1;if(r.size!==t.size)return!0;const i=e.limitType==="F"?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Qi(e,t){return kP()<=Ct.DEBUG&&Ie("QueryEngine","Using full collection scan to execute query:",OI(t)),this.Ui.getDocumentsMatchingQuery(e,t,Hc.min())}Wi(e,t,r,s){return this.Ui.getDocumentsMatchingQuery(e,r,s).next(i=>(t.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fye{constructor(e,t,r,s){this.persistence=e,this.Hi=t,this.serializer=s,this.Ji=new Kt(vt),this.Yi=new zf(i=>HS(i),VS),this.Xi=new Map,this.Zi=e.getRemoteDocumentCache(),this.Bs=e.getTargetCache(),this.qs=e.getBundleCache(),this.tr(r)}tr(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new xye(this.Zi,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Zi.setIndexManager(this.indexManager),this.Hi.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Ji))}}function jye(n,e,t,r){return new Fye(n,e,t,r)}async function EB(n,e){const t=ze(n);return await t.persistence.runTransaction("Handle user change","readonly",r=>{let s;return t.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,t.tr(e),t.mutationQueue.getAllMutationBatches(r))).next(i=>{const o=[],a=[];let c=Ze();for(const l of s){o.push(l.batchId);for(const u of l.mutations)c=c.add(u.key)}for(const l of i){a.push(l.batchId);for(const u of l.mutations)c=c.add(u.key)}return t.localDocuments.getDocuments(r,c).next(l=>({er:l,removedBatchIds:o,addedBatchIds:a}))})})}function Hye(n,e){const t=ze(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),i=t.Zi.newChangeBuffer({trackRemovals:!0});return function(o,a,c,l){const u=c.batch,h=u.keys();let d=J.resolve();return h.forEach(f=>{d=d.next(()=>l.getEntry(a,f)).next(p=>{const g=c.docVersions.get(f);Ht(g!==null),p.version.compareTo(g)<0&&(u.applyToRemoteDocument(p,c),p.isValidDocument()&&(p.setReadTime(c.commitVersion),l.addEntry(p)))})}),d.next(()=>o.mutationQueue.removeMutationBatch(a,u))}(t,r,e,i).next(()=>i.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(o){let a=Ze();for(let c=0;c<o.mutationResults.length;++c)o.mutationResults[c].transformResults.length>0&&(a=a.add(o.batch.mutations[c].key));return a}(e))).next(()=>t.localDocuments.getDocuments(r,s))})}function vB(n){const e=ze(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Bs.getLastRemoteSnapshotVersion(t))}function Vye(n,e){const t=ze(n),r=e.snapshotVersion;let s=t.Ji;return t.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=t.Zi.newChangeBuffer({trackRemovals:!0});s=t.Ji;const a=[];e.targetChanges.forEach((u,h)=>{const d=s.get(h);if(!d)return;a.push(t.Bs.removeMatchingKeys(i,u.removedDocuments,h).next(()=>t.Bs.addMatchingKeys(i,u.addedDocuments,h)));let f=d.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(h)!==null?f=f.withResumeToken(Er.EMPTY_BYTE_STRING,Fe.min()).withLastLimboFreeSnapshotVersion(Fe.min()):u.resumeToken.approximateByteSize()>0&&(f=f.withResumeToken(u.resumeToken,r)),s=s.insert(h,f),function(p,g,m){return p.resumeToken.approximateByteSize()===0||g.snapshotVersion.toMicroseconds()-p.snapshotVersion.toMicroseconds()>=3e8?!0:m.addedDocuments.size+m.modifiedDocuments.size+m.removedDocuments.size>0}(d,f,u)&&a.push(t.Bs.updateTargetData(i,f))});let c=_a(),l=Ze();if(e.documentUpdates.forEach(u=>{e.resolvedLimboDocuments.has(u)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(i,u))}),a.push(qye(i,o,e.documentUpdates).next(u=>{c=u.nr,l=u.sr})),!r.isEqual(Fe.min())){const u=t.Bs.getLastRemoteSnapshotVersion(i).next(h=>t.Bs.setTargetsMetadata(i,i.currentSequenceNumber,r));a.push(u)}return J.waitFor(a).next(()=>o.apply(i)).next(()=>t.localDocuments.getLocalViewOfDocuments(i,c,l)).next(()=>c)}).then(i=>(t.Ji=s,i))}function qye(n,e,t){let r=Ze(),s=Ze();return t.forEach(i=>r=r.add(i)),e.getEntries(n,r).next(i=>{let o=_a();return t.forEach((a,c)=>{const l=i.get(a);c.isFoundDocument()!==l.isFoundDocument()&&(s=s.add(a)),c.isNoDocument()&&c.version.isEqual(Fe.min())?(e.removeEntry(a,c.readTime),o=o.insert(a,c)):!l.isValidDocument()||c.version.compareTo(l.version)>0||c.version.compareTo(l.version)===0&&l.hasPendingWrites?(e.addEntry(c),o=o.insert(a,c)):Ie("LocalStore","Ignoring outdated watch update for ",a,". Current version:",l.version," Watch version:",c.version)}),{nr:o,sr:s}})}function zye(n,e){const t=ze(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function Wye(n,e){const t=ze(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return t.Bs.getTargetData(r,e).next(i=>i?(s=i,J.resolve(s)):t.Bs.allocateTargetId(r).next(o=>(s=new _c(e,o,"TargetPurposeListen",r.currentSequenceNumber),t.Bs.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=t.Ji.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(t.Ji=t.Ji.insert(r.targetId,r),t.Yi.set(e,r.targetId)),r})}async function DI(n,e,t){const r=ze(n),s=r.Ji.get(e),i=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",i,o=>r.persistence.referenceDelegate.removeTarget(o,s))}catch(o){if(!ky(o))throw o;Ie("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.Ji=r.Ji.remove(e),r.Yi.delete(s.target)}function ek(n,e,t){const r=ze(n);let s=Fe.min(),i=Ze();return r.persistence.runTransaction("Execute query","readonly",o=>function(a,c,l){const u=ze(a),h=u.Yi.get(l);return h!==void 0?J.resolve(u.Ji.get(h)):u.Bs.getTargetData(c,l)}(r,o,Ia(e)).next(a=>{if(a)return s=a.lastLimboFreeSnapshotVersion,r.Bs.getMatchingKeysForTargetId(o,a.targetId).next(c=>{i=c})}).next(()=>r.Hi.getDocumentsMatchingQuery(o,e,t?s:Fe.min(),t?i:Ze())).next(a=>(Gye(r,Fme(e),a),{documents:a,ir:i})))}function Gye(n,e,t){let r=n.Xi.get(e)||Fe.min();t.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),n.Xi.set(e,r)}class tk{constructor(){this.activeTargetIds=Wme()}lr(e){this.activeTargetIds=this.activeTargetIds.add(e)}dr(e){this.activeTargetIds=this.activeTargetIds.delete(e)}hr(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Kye{constructor(){this.Hr=new tk,this.Jr={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e){return this.Hr.lr(e),this.Jr[e]||"not-current"}updateQueryState(e,t,r){this.Jr[e]=t}removeLocalQueryTarget(e){this.Hr.dr(e)}isLocalQueryTarget(e){return this.Hr.activeTargetIds.has(e)}clearQueryState(e){delete this.Jr[e]}getAllActiveQueryTargets(){return this.Hr.activeTargetIds}isActiveQueryTarget(e){return this.Hr.activeTargetIds.has(e)}start(){return this.Hr=new tk,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yye{Yr(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nk{constructor(){this.Xr=()=>this.Zr(),this.eo=()=>this.no(),this.so=[],this.io()}Yr(e){this.so.push(e)}shutdown(){window.removeEventListener("online",this.Xr),window.removeEventListener("offline",this.eo)}io(){window.addEventListener("online",this.Xr),window.addEventListener("offline",this.eo)}Zr(){Ie("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.so)e(0)}no(){Ie("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.so)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Hw=null;function J1(){return Hw===null?Hw=268435456+Math.round(2147483648*Math.random()):Hw++,"0x"+Hw.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qye={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zye{constructor(e){this.ro=e.ro,this.oo=e.oo}uo(e){this.co=e}ao(e){this.ho=e}onMessage(e){this.lo=e}close(){this.oo()}send(e){this.ro(e)}fo(){this.co()}wo(e){this.ho(e)}_o(e){this.lo(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ir="WebChannelConnection";class Jye extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http";this.mo=t+"://"+e.host,this.yo="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}get po(){return!1}Io(e,t,r,s,i){const o=J1(),a=this.To(e,t);Ie("RestConnection",`Sending RPC '${e}' ${o}:`,a,r);const c={};return this.Eo(c,s,i),this.Ao(e,a,c,r).then(l=>(Ie("RestConnection",`Received RPC '${e}' ${o}: `,l),l),l=>{throw bf("RestConnection",`RPC '${e}' ${o} failed with error: `,l,"url: ",a,"request:",r),l})}vo(e,t,r,s,i,o){return this.Io(e,t,r,s,i)}Eo(e,t,r){e["X-Goog-Api-Client"]="gl-js/ fire/"+qf,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((s,i)=>e[i]=s),r&&r.headers.forEach((s,i)=>e[i]=s)}To(e,t){const r=Qye[e];return`${this.mo}/v1/${t}:${r}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Ao(e,t,r,s){const i=J1();return new Promise((o,a)=>{const c=new lme;c.setWithCredentials(!0),c.listenOnce(ome.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case Q1.NO_ERROR:const u=c.getResponseJson();Ie(ir,`XHR for RPC '${e}' ${i} received:`,JSON.stringify(u)),o(u);break;case Q1.TIMEOUT:Ie(ir,`RPC '${e}' ${i} timed out`),a(new we(W.DEADLINE_EXCEEDED,"Request time out"));break;case Q1.HTTP_ERROR:const h=c.getStatus();if(Ie(ir,`RPC '${e}' ${i} failed with status:`,h,"response text:",c.getResponseText()),h>0){let d=c.getResponseJson();Array.isArray(d)&&(d=d[0]);const f=d==null?void 0:d.error;if(f&&f.status&&f.message){const p=function(g){const m=g.toLowerCase().replace(/_/g,"-");return Object.values(W).indexOf(m)>=0?m:W.UNKNOWN}(f.status);a(new we(p,f.message))}else a(new we(W.UNKNOWN,"Server responded with status "+c.getStatus()))}else a(new we(W.UNAVAILABLE,"Connection failed."));break;default:Ue()}}finally{Ie(ir,`RPC '${e}' ${i} completed.`)}});const l=JSON.stringify(s);Ie(ir,`RPC '${e}' ${i} sending request:`,s),c.send(t,"POST",l,r,15)})}Ro(e,t,r){const s=J1(),i=[this.mo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=sme(),a=ime(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;l!==void 0&&(c.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(c.xmlHttpFactory=new cme({})),this.Eo(c.initMessageHeaders,t,r),c.encodeInitMessageHeaders=!0;const u=i.join("");Ie(ir,`Creating RPC '${e}' stream ${s}: ${u}`,c);const h=o.createWebChannel(u,c);let d=!1,f=!1;const p=new Zye({ro:m=>{f?Ie(ir,`Not sending because RPC '${e}' stream ${s} is closed:`,m):(d||(Ie(ir,`Opening RPC '${e}' stream ${s} transport.`),h.open(),d=!0),Ie(ir,`RPC '${e}' stream ${s} sending:`,m),h.send(m))},oo:()=>h.close()}),g=(m,w,v)=>{m.listen(w,A=>{try{v(A)}catch(T){setTimeout(()=>{throw T},0)}})};return g(h,Lw.EventType.OPEN,()=>{f||Ie(ir,`RPC '${e}' stream ${s} transport opened.`)}),g(h,Lw.EventType.CLOSE,()=>{f||(f=!0,Ie(ir,`RPC '${e}' stream ${s} transport closed`),p.wo())}),g(h,Lw.EventType.ERROR,m=>{f||(f=!0,bf(ir,`RPC '${e}' stream ${s} transport errored:`,m),p.wo(new we(W.UNAVAILABLE,"The operation could not be completed")))}),g(h,Lw.EventType.MESSAGE,m=>{var w;if(!f){const v=m.data[0];Ht(!!v);const A=v,T=A.error||((w=A[0])===null||w===void 0?void 0:w.error);if(T){Ie(ir,`RPC '${e}' stream ${s} received error:`,T);const N=T.status;let R=function(D){const S=ln[D];if(S!==void 0)return hB(S)}(N),M=T.message;R===void 0&&(R=W.INTERNAL,M="Unknown error status: "+N+" with message "+T.message),f=!0,p.wo(new we(R,M)),h.close()}else Ie(ir,`RPC '${e}' stream ${s} received:`,v),p._o(v)}}),g(a,ame.STAT_EVENT,m=>{m.stat===RP.PROXY?Ie(ir,`RPC '${e}' stream ${s} detected buffering proxy`):m.stat===RP.NOPROXY&&Ie(ir,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{p.fo()},0),p}}function X1(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JE(n){return new uye(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AB{constructor(e,t,r=1e3,s=1.5,i=6e4){this.ii=e,this.timerId=t,this.Po=r,this.bo=s,this.Vo=i,this.So=0,this.Do=null,this.Co=Date.now(),this.reset()}reset(){this.So=0}xo(){this.So=this.Vo}No(e){this.cancel();const t=Math.floor(this.So+this.ko()),r=Math.max(0,Date.now()-this.Co),s=Math.max(0,t-r);s>0&&Ie("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.So} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.Do=this.ii.enqueueAfterDelay(this.timerId,s,()=>(this.Co=Date.now(),e())),this.So*=this.bo,this.So<this.Po&&(this.So=this.Po),this.So>this.Vo&&(this.So=this.Vo)}Mo(){this.Do!==null&&(this.Do.skipDelay(),this.Do=null)}cancel(){this.Do!==null&&(this.Do.cancel(),this.Do=null)}ko(){return(Math.random()-.5)*this.So}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CB{constructor(e,t,r,s,i,o,a,c){this.ii=e,this.$o=r,this.Oo=s,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=c,this.state=0,this.Fo=0,this.Bo=null,this.Lo=null,this.stream=null,this.qo=new AB(e,t)}Uo(){return this.state===1||this.state===5||this.Ko()}Ko(){return this.state===2||this.state===3}start(){this.state!==4?this.auth():this.Go()}async stop(){this.Uo()&&await this.close(0)}Qo(){this.state=0,this.qo.reset()}jo(){this.Ko()&&this.Bo===null&&(this.Bo=this.ii.enqueueAfterDelay(this.$o,6e4,()=>this.zo()))}Wo(e){this.Ho(),this.stream.send(e)}async zo(){if(this.Ko())return this.close(0)}Ho(){this.Bo&&(this.Bo.cancel(),this.Bo=null)}Jo(){this.Lo&&(this.Lo.cancel(),this.Lo=null)}async close(e,t){this.Ho(),this.Jo(),this.qo.cancel(),this.Fo++,e!==4?this.qo.reset():t&&t.code===W.RESOURCE_EXHAUSTED?(Ca(t.toString()),Ca("Using maximum backoff delay to prevent overloading the backend."),this.qo.xo()):t&&t.code===W.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.Yo(),this.stream.close(),this.stream=null),this.state=e,await this.listener.ao(t)}Yo(){}auth(){this.state=1;const e=this.Xo(this.Fo),t=this.Fo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.Fo===t&&this.Zo(r,s)},r=>{e(()=>{const s=new we(W.UNKNOWN,"Fetching auth token failed: "+r.message);return this.tu(s)})})}Zo(e,t){const r=this.Xo(this.Fo);this.stream=this.eu(e,t),this.stream.uo(()=>{r(()=>(this.state=2,this.Lo=this.ii.enqueueAfterDelay(this.Oo,1e4,()=>(this.Ko()&&(this.state=3),Promise.resolve())),this.listener.uo()))}),this.stream.ao(s=>{r(()=>this.tu(s))}),this.stream.onMessage(s=>{r(()=>this.onMessage(s))})}Go(){this.state=5,this.qo.No(async()=>{this.state=0,this.start()})}tu(e){return Ie("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}Xo(e){return t=>{this.ii.enqueueAndForget(()=>this.Fo===e?t():(Ie("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class Xye extends CB{constructor(e,t,r,s,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,s,o),this.serializer=i}eu(e,t){return this.connection.Ro("Listen",e,t)}onMessage(e){this.qo.reset();const t=fye(this.serializer,e),r=function(s){if(!("targetChange"in s))return Fe.min();const i=s.targetChange;return i.targetIds&&i.targetIds.length?Fe.min():i.readTime?Ao(i.readTime):Fe.min()}(e);return this.listener.nu(t,r)}su(e){const t={};t.database=kI(this.serializer),t.addTarget=function(s,i){let o;const a=i.target;if(o=SI(a)?{documents:mye(s,a)}:{query:yye(s,a)},o.targetId=i.targetId,i.resumeToken.approximateByteSize()>0){o.resumeToken=pB(s,i.resumeToken);const c=xI(s,i.expectedCount);c!==null&&(o.expectedCount=c)}else if(i.snapshotVersion.compareTo(Fe.min())>0){o.readTime=Tb(s,i.snapshotVersion.toTimestamp());const c=xI(s,i.expectedCount);c!==null&&(o.expectedCount=c)}return o}(this.serializer,e);const r=bye(this.serializer,e);r&&(t.labels=r),this.Wo(t)}iu(e){const t={};t.database=kI(this.serializer),t.removeTarget=e,this.Wo(t)}}class ewe extends CB{constructor(e,t,r,s,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,s,o),this.serializer=i,this.ru=!1}get ou(){return this.ru}start(){this.ru=!1,this.lastStreamToken=void 0,super.start()}Yo(){this.ru&&this.uu([])}eu(e,t){return this.connection.Ro("Write",e,t)}onMessage(e){if(Ht(!!e.streamToken),this.lastStreamToken=e.streamToken,this.ru){this.qo.reset();const t=gye(e.writeResults,e.commitTime),r=Ao(e.commitTime);return this.listener.cu(r,t)}return Ht(!e.writeResults||e.writeResults.length===0),this.ru=!0,this.listener.au()}hu(){const e={};e.database=kI(this.serializer),this.Wo(e)}uu(e){const t={streamToken:this.lastStreamToken,writes:e.map(r=>pye(this.serializer,r))};this.Wo(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class twe extends class{}{constructor(e,t,r,s){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=s,this.lu=!1}fu(){if(this.lu)throw new we(W.FAILED_PRECONDITION,"The client has already been terminated.")}Io(e,t,r){return this.fu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,i])=>this.connection.Io(e,t,r,s,i)).catch(s=>{throw s.name==="FirebaseError"?(s.code===W.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new we(W.UNKNOWN,s.toString())})}vo(e,t,r,s){return this.fu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.vo(e,t,r,i,o,s)).catch(i=>{throw i.name==="FirebaseError"?(i.code===W.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new we(W.UNKNOWN,i.toString())})}terminate(){this.lu=!0}}class nwe{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.wu=0,this._u=null,this.mu=!0}gu(){this.wu===0&&(this.yu("Unknown"),this._u=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._u=null,this.pu("Backend didn't respond within 10 seconds."),this.yu("Offline"),Promise.resolve())))}Iu(e){this.state==="Online"?this.yu("Unknown"):(this.wu++,this.wu>=1&&(this.Tu(),this.pu(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.yu("Offline")))}set(e){this.Tu(),this.wu=0,e==="Online"&&(this.mu=!1),this.yu(e)}yu(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}pu(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.mu?(Ca(t),this.mu=!1):Ie("OnlineStateTracker",t)}Tu(){this._u!==null&&(this._u.cancel(),this._u=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rwe{constructor(e,t,r,s,i){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.Eu=[],this.Au=new Map,this.vu=new Set,this.Ru=[],this.Pu=i,this.Pu.Yr(o=>{r.enqueueAndForget(async()=>{Gu(this)&&(Ie("RemoteStore","Restarting streams for network reachability change."),await async function(a){const c=ze(a);c.vu.add(4),await My(c),c.bu.set("Unknown"),c.vu.delete(4),await XE(c)}(this))})}),this.bu=new nwe(r,s)}}async function XE(n){if(Gu(n))for(const e of n.Ru)await e(!0)}async function My(n){for(const e of n.Ru)await e(!1)}function IB(n,e){const t=ze(n);t.Au.has(e.targetId)||(t.Au.set(e.targetId,e),nT(t)?tT(t):Wf(t).Ko()&&eT(t,e))}function _B(n,e){const t=ze(n),r=Wf(t);t.Au.delete(e),r.Ko()&&SB(t,e),t.Au.size===0&&(r.Ko()?r.jo():Gu(t)&&t.bu.set("Unknown"))}function eT(n,e){if(n.Vu.qt(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Fe.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Wf(n).su(e)}function SB(n,e){n.Vu.qt(e),Wf(n).iu(e)}function tT(n){n.Vu=new oye({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),le:e=>n.Au.get(e)||null,ue:()=>n.datastore.serializer.databaseId}),Wf(n).start(),n.bu.gu()}function nT(n){return Gu(n)&&!Wf(n).Uo()&&n.Au.size>0}function Gu(n){return ze(n).vu.size===0}function TB(n){n.Vu=void 0}async function swe(n){n.Au.forEach((e,t)=>{eT(n,e)})}async function iwe(n,e){TB(n),nT(n)?(n.bu.Iu(e),tT(n)):n.bu.set("Unknown")}async function owe(n,e,t){if(n.bu.set("Online"),e instanceof fB&&e.state===2&&e.cause)try{await async function(r,s){const i=s.cause;for(const o of s.targetIds)r.Au.has(o)&&(await r.remoteSyncer.rejectListen(o,i),r.Au.delete(o),r.Vu.removeTarget(o))}(n,e)}catch(r){Ie("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Nb(n,r)}else if(e instanceof y0?n.Vu.Ht(e):e instanceof dB?n.Vu.ne(e):n.Vu.Xt(e),!t.isEqual(Fe.min()))try{const r=await vB(n.localStore);t.compareTo(r)>=0&&await function(s,i){const o=s.Vu.ce(i);return o.targetChanges.forEach((a,c)=>{if(a.resumeToken.approximateByteSize()>0){const l=s.Au.get(c);l&&s.Au.set(c,l.withResumeToken(a.resumeToken,i))}}),o.targetMismatches.forEach((a,c)=>{const l=s.Au.get(a);if(!l)return;s.Au.set(a,l.withResumeToken(Er.EMPTY_BYTE_STRING,l.snapshotVersion)),SB(s,a);const u=new _c(l.target,a,c,l.sequenceNumber);eT(s,u)}),s.remoteSyncer.applyRemoteEvent(o)}(n,t)}catch(r){Ie("RemoteStore","Failed to raise snapshot:",r),await Nb(n,r)}}async function Nb(n,e,t){if(!ky(e))throw e;n.vu.add(1),await My(n),n.bu.set("Offline"),t||(t=()=>vB(n.localStore)),n.asyncQueue.enqueueRetryable(async()=>{Ie("RemoteStore","Retrying IndexedDB access"),await t(),n.vu.delete(1),await XE(n)})}function NB(n,e){return e().catch(t=>Nb(n,t,e))}async function ev(n){const e=ze(n),t=qc(e);let r=e.Eu.length>0?e.Eu[e.Eu.length-1].batchId:-1;for(;awe(e);)try{const s=await zye(e.localStore,r);if(s===null){e.Eu.length===0&&t.jo();break}r=s.batchId,cwe(e,s)}catch(s){await Nb(e,s)}OB(e)&&xB(e)}function awe(n){return Gu(n)&&n.Eu.length<10}function cwe(n,e){n.Eu.push(e);const t=qc(n);t.Ko()&&t.ou&&t.uu(e.mutations)}function OB(n){return Gu(n)&&!qc(n).Uo()&&n.Eu.length>0}function xB(n){qc(n).start()}async function lwe(n){qc(n).hu()}async function uwe(n){const e=qc(n);for(const t of n.Eu)e.uu(t.mutations)}async function hwe(n,e,t){const r=n.Eu.shift(),s=GS.from(r,e,t);await NB(n,()=>n.remoteSyncer.applySuccessfulWrite(s)),await ev(n)}async function dwe(n,e){e&&qc(n).ou&&await async function(t,r){if(s=r.code,rye(s)&&s!==W.ABORTED){const i=t.Eu.shift();qc(t).Qo(),await NB(t,()=>t.remoteSyncer.rejectFailedWrite(i.batchId,r)),await ev(t)}var s}(n,e),OB(n)&&xB(n)}async function rk(n,e){const t=ze(n);t.asyncQueue.verifyOperationInProgress(),Ie("RemoteStore","RemoteStore received new credentials");const r=Gu(t);t.vu.add(3),await My(t),r&&t.bu.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.vu.delete(3),await XE(t)}async function fwe(n,e){const t=ze(n);e?(t.vu.delete(2),await XE(t)):e||(t.vu.add(2),await My(t),t.bu.set("Unknown"))}function Wf(n){return n.Su||(n.Su=function(e,t,r){const s=ze(e);return s.fu(),new Xye(t,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,r)}(n.datastore,n.asyncQueue,{uo:swe.bind(null,n),ao:iwe.bind(null,n),nu:owe.bind(null,n)}),n.Ru.push(async e=>{e?(n.Su.Qo(),nT(n)?tT(n):n.bu.set("Unknown")):(await n.Su.stop(),TB(n))})),n.Su}function qc(n){return n.Du||(n.Du=function(e,t,r){const s=ze(e);return s.fu(),new ewe(t,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,r)}(n.datastore,n.asyncQueue,{uo:lwe.bind(null,n),ao:dwe.bind(null,n),au:uwe.bind(null,n),cu:hwe.bind(null,n)}),n.Ru.push(async e=>{e?(n.Du.Qo(),await ev(n)):(await n.Du.stop(),n.Eu.length>0&&(Ie("RemoteStore",`Stopping write stream with ${n.Eu.length} pending writes`),n.Eu=[]))})),n.Du}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rT{constructor(e,t,r,s,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new pa,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}static createAndSchedule(e,t,r,s,i){const o=Date.now()+r,a=new rT(e,t,o,s,i);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new we(W.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function sT(n,e){if(Ca("AsyncQueue",`${e}: ${n}`),ky(n))return new we(W.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cd{constructor(e){this.comparator=e?(t,r)=>e(t,r)||Te.comparator(t.key,r.key):(t,r)=>Te.comparator(t.key,r.key),this.keyedMap=Bp(),this.sortedSet=new Kt(this.comparator)}static emptySet(e){return new cd(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof cd)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const s=t.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const r=new cd;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sk{constructor(){this.Cu=new Kt(Te.comparator)}track(e){const t=e.doc.key,r=this.Cu.get(t);r?e.type!==0&&r.type===3?this.Cu=this.Cu.insert(t,e):e.type===3&&r.type!==1?this.Cu=this.Cu.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.Cu=this.Cu.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.Cu=this.Cu.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.Cu=this.Cu.remove(t):e.type===1&&r.type===2?this.Cu=this.Cu.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.Cu=this.Cu.insert(t,{type:2,doc:e.doc}):Ue():this.Cu=this.Cu.insert(t,e)}xu(){const e=[];return this.Cu.inorderTraversal((t,r)=>{e.push(r)}),e}}class _f{constructor(e,t,r,s,i,o,a,c,l){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=c,this.hasCachedResults=l}static fromInitialDocuments(e,t,r,s,i){const o=[];return t.forEach(a=>{o.push({type:0,doc:a})}),new _f(e,t,cd.emptySet(t),o,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&GE(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let s=0;s<t.length;s++)if(t[s].type!==r[s].type||!t[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pwe{constructor(){this.Nu=void 0,this.listeners=[]}}class gwe{constructor(){this.queries=new zf(e=>Q5(e),GE),this.onlineState="Unknown",this.ku=new Set}}async function RB(n,e){const t=ze(n),r=e.query;let s=!1,i=t.queries.get(r);if(i||(s=!0,i=new pwe),s)try{i.Nu=await t.onListen(r)}catch(o){const a=sT(o,`Initialization of query '${OI(e.query)}' failed`);return void e.onError(a)}t.queries.set(r,i),i.listeners.push(e),e.Mu(t.onlineState),i.Nu&&e.$u(i.Nu)&&iT(t)}async function PB(n,e){const t=ze(n),r=e.query;let s=!1;const i=t.queries.get(r);if(i){const o=i.listeners.indexOf(e);o>=0&&(i.listeners.splice(o,1),s=i.listeners.length===0)}if(s)return t.queries.delete(r),t.onUnlisten(r)}function mwe(n,e){const t=ze(n);let r=!1;for(const s of e){const i=s.query,o=t.queries.get(i);if(o){for(const a of o.listeners)a.$u(s)&&(r=!0);o.Nu=s}}r&&iT(t)}function ywe(n,e,t){const r=ze(n),s=r.queries.get(e);if(s)for(const i of s.listeners)i.onError(t);r.queries.delete(e)}function iT(n){n.ku.forEach(e=>{e.next()})}class kB{constructor(e,t,r){this.query=e,this.Ou=t,this.Fu=!1,this.Bu=null,this.onlineState="Unknown",this.options=r||{}}$u(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new _f(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Fu?this.Lu(e)&&(this.Ou.next(e),t=!0):this.qu(e,this.onlineState)&&(this.Uu(e),t=!0),this.Bu=e,t}onError(e){this.Ou.error(e)}Mu(e){this.onlineState=e;let t=!1;return this.Bu&&!this.Fu&&this.qu(this.Bu,e)&&(this.Uu(this.Bu),t=!0),t}qu(e,t){if(!e.fromCache)return!0;const r=t!=="Offline";return(!this.options.Ku||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Lu(e){if(e.docChanges.length>0)return!0;const t=this.Bu&&this.Bu.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}Uu(e){e=_f.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Fu=!0,this.Ou.next(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DB{constructor(e){this.key=e}}class UB{constructor(e){this.key=e}}class wwe{constructor(e,t){this.query=e,this.Yu=t,this.Xu=null,this.hasCachedResults=!1,this.current=!1,this.Zu=Ze(),this.mutatedKeys=Ze(),this.tc=Z5(e),this.ec=new cd(this.tc)}get nc(){return this.Yu}sc(e,t){const r=t?t.ic:new sk,s=t?t.ec:this.ec;let i=t?t.mutatedKeys:this.mutatedKeys,o=s,a=!1;const c=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,l=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((u,h)=>{const d=s.get(u),f=KE(this.query,h)?h:null,p=!!d&&this.mutatedKeys.has(d.key),g=!!f&&(f.hasLocalMutations||this.mutatedKeys.has(f.key)&&f.hasCommittedMutations);let m=!1;d&&f?d.data.isEqual(f.data)?p!==g&&(r.track({type:3,doc:f}),m=!0):this.rc(d,f)||(r.track({type:2,doc:f}),m=!0,(c&&this.tc(f,c)>0||l&&this.tc(f,l)<0)&&(a=!0)):!d&&f?(r.track({type:0,doc:f}),m=!0):d&&!f&&(r.track({type:1,doc:d}),m=!0,(c||l)&&(a=!0)),m&&(f?(o=o.add(f),i=g?i.add(u):i.delete(u)):(o=o.delete(u),i=i.delete(u)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const u=this.query.limitType==="F"?o.last():o.first();o=o.delete(u.key),i=i.delete(u.key),r.track({type:1,doc:u})}return{ec:o,ic:r,zi:a,mutatedKeys:i}}rc(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r){const s=this.ec;this.ec=e.ec,this.mutatedKeys=e.mutatedKeys;const i=e.ic.xu();i.sort((l,u)=>function(h,d){const f=p=>{switch(p){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ue()}};return f(h)-f(d)}(l.type,u.type)||this.tc(l.doc,u.doc)),this.oc(r);const o=t?this.uc():[],a=this.Zu.size===0&&this.current?1:0,c=a!==this.Xu;return this.Xu=a,i.length!==0||c?{snapshot:new _f(this.query,e.ec,s,i,e.mutatedKeys,a===0,c,!1,!!r&&r.resumeToken.approximateByteSize()>0),cc:o}:{cc:o}}Mu(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({ec:this.ec,ic:new sk,mutatedKeys:this.mutatedKeys,zi:!1},!1)):{cc:[]}}ac(e){return!this.Yu.has(e)&&!!this.ec.has(e)&&!this.ec.get(e).hasLocalMutations}oc(e){e&&(e.addedDocuments.forEach(t=>this.Yu=this.Yu.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Yu=this.Yu.delete(t)),this.current=e.current)}uc(){if(!this.current)return[];const e=this.Zu;this.Zu=Ze(),this.ec.forEach(r=>{this.ac(r.key)&&(this.Zu=this.Zu.add(r.key))});const t=[];return e.forEach(r=>{this.Zu.has(r)||t.push(new UB(r))}),this.Zu.forEach(r=>{e.has(r)||t.push(new DB(r))}),t}hc(e){this.Yu=e.ir,this.Zu=Ze();const t=this.sc(e.documents);return this.applyChanges(t,!0)}lc(){return _f.fromInitialDocuments(this.query,this.ec,this.mutatedKeys,this.Xu===0,this.hasCachedResults)}}class bwe{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class Ewe{constructor(e){this.key=e,this.fc=!1}}class vwe{constructor(e,t,r,s,i,o){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.dc={},this.wc=new zf(a=>Q5(a),GE),this._c=new Map,this.mc=new Set,this.gc=new Kt(Te.comparator),this.yc=new Map,this.Ic=new ZS,this.Tc={},this.Ec=new Map,this.Ac=If.Mn(),this.onlineState="Unknown",this.vc=void 0}get isPrimaryClient(){return this.vc===!0}}async function Awe(n,e){const t=Pwe(n);let r,s;const i=t.wc.get(e);if(i)r=i.targetId,t.sharedClientState.addLocalQueryTarget(r),s=i.view.lc();else{const o=await Wye(t.localStore,Ia(e)),a=t.sharedClientState.addLocalQueryTarget(o.targetId);r=o.targetId,s=await Cwe(t,e,r,a==="current",o.resumeToken),t.isPrimaryClient&&IB(t.remoteStore,o)}return s}async function Cwe(n,e,t,r,s){n.Rc=(h,d,f)=>async function(p,g,m,w){let v=g.view.sc(m);v.zi&&(v=await ek(p.localStore,g.query,!1).then(({documents:N})=>g.view.sc(N,v)));const A=w&&w.targetChanges.get(g.targetId),T=g.view.applyChanges(v,p.isPrimaryClient,A);return ok(p,g.targetId,T.cc),T.snapshot}(n,h,d,f);const i=await ek(n.localStore,e,!0),o=new wwe(e,i.ir),a=o.sc(i.documents),c=$y.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",s),l=o.applyChanges(a,n.isPrimaryClient,c);ok(n,t,l.cc);const u=new bwe(e,t,o);return n.wc.set(e,u),n._c.has(t)?n._c.get(t).push(e):n._c.set(t,[e]),l.snapshot}async function Iwe(n,e){const t=ze(n),r=t.wc.get(e),s=t._c.get(r.targetId);if(s.length>1)return t._c.set(r.targetId,s.filter(i=>!GE(i,e))),void t.wc.delete(e);t.isPrimaryClient?(t.sharedClientState.removeLocalQueryTarget(r.targetId),t.sharedClientState.isActiveQueryTarget(r.targetId)||await DI(t.localStore,r.targetId,!1).then(()=>{t.sharedClientState.clearQueryState(r.targetId),_B(t.remoteStore,r.targetId),UI(t,r.targetId)}).catch(Py)):(UI(t,r.targetId),await DI(t.localStore,r.targetId,!0))}async function _we(n,e,t){const r=kwe(n);try{const s=await function(i,o){const a=ze(i),c=An.now(),l=o.reduce((d,f)=>d.add(f.key),Ze());let u,h;return a.persistence.runTransaction("Locally write mutations","readwrite",d=>{let f=_a(),p=Ze();return a.Zi.getEntries(d,l).next(g=>{f=g,f.forEach((m,w)=>{w.isValidDocument()||(p=p.add(m))})}).next(()=>a.localDocuments.getOverlayedDocuments(d,f)).next(g=>{u=g;const m=[];for(const w of o){const v=Jme(w,u.get(w.key).overlayedDocument);v!=null&&m.push(new Zc(w.key,v,j5(v.value.mapValue),Ri.exists(!0)))}return a.mutationQueue.addMutationBatch(d,c,m,o)}).next(g=>{h=g;const m=g.applyToLocalDocumentSet(u,p);return a.documentOverlayCache.saveOverlays(d,g.batchId,m)})}).then(()=>({batchId:h.batchId,changes:X5(u)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(i,o,a){let c=i.Tc[i.currentUser.toKey()];c||(c=new Kt(vt)),c=c.insert(o,a),i.Tc[i.currentUser.toKey()]=c}(r,s.batchId,t),await Ly(r,s.changes),await ev(r.remoteStore)}catch(s){const i=sT(s,"Failed to persist write");t.reject(i)}}async function $B(n,e){const t=ze(n);try{const r=await Vye(t.localStore,e);e.targetChanges.forEach((s,i)=>{const o=t.yc.get(i);o&&(Ht(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?o.fc=!0:s.modifiedDocuments.size>0?Ht(o.fc):s.removedDocuments.size>0&&(Ht(o.fc),o.fc=!1))}),await Ly(t,r,e)}catch(r){await Py(r)}}function ik(n,e,t){const r=ze(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){const s=[];r.wc.forEach((i,o)=>{const a=o.view.Mu(e);a.snapshot&&s.push(a.snapshot)}),function(i,o){const a=ze(i);a.onlineState=o;let c=!1;a.queries.forEach((l,u)=>{for(const h of u.listeners)h.Mu(o)&&(c=!0)}),c&&iT(a)}(r.eventManager,e),s.length&&r.dc.nu(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function Swe(n,e,t){const r=ze(n);r.sharedClientState.updateQueryState(e,"rejected",t);const s=r.yc.get(e),i=s&&s.key;if(i){let o=new Kt(Te.comparator);o=o.insert(i,hr.newNoDocument(i,Fe.min()));const a=Ze().add(i),c=new ZE(Fe.min(),new Map,new Kt(vt),o,a);await $B(r,c),r.gc=r.gc.remove(i),r.yc.delete(e),oT(r)}else await DI(r.localStore,e,!1).then(()=>UI(r,e,t)).catch(Py)}async function Twe(n,e){const t=ze(n),r=e.batch.batchId;try{const s=await Hye(t.localStore,e);LB(t,r,null),MB(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await Ly(t,s)}catch(s){await Py(s)}}async function Nwe(n,e,t){const r=ze(n);try{const s=await function(i,o){const a=ze(i);return a.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let l;return a.mutationQueue.lookupMutationBatch(c,o).next(u=>(Ht(u!==null),l=u.keys(),a.mutationQueue.removeMutationBatch(c,u))).next(()=>a.mutationQueue.performConsistencyCheck(c)).next(()=>a.documentOverlayCache.removeOverlaysForBatchId(c,l,o)).next(()=>a.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,l)).next(()=>a.localDocuments.getDocuments(c,l))})}(r.localStore,e);LB(r,e,t),MB(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await Ly(r,s)}catch(s){await Py(s)}}function MB(n,e){(n.Ec.get(e)||[]).forEach(t=>{t.resolve()}),n.Ec.delete(e)}function LB(n,e,t){const r=ze(n);let s=r.Tc[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(t?i.reject(t):i.resolve(),s=s.remove(e)),r.Tc[r.currentUser.toKey()]=s}}function UI(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n._c.get(e))n.wc.delete(r),t&&n.dc.Pc(r,t);n._c.delete(e),n.isPrimaryClient&&n.Ic.Is(e).forEach(r=>{n.Ic.containsKey(r)||BB(n,r)})}function BB(n,e){n.mc.delete(e.path.canonicalString());const t=n.gc.get(e);t!==null&&(_B(n.remoteStore,t),n.gc=n.gc.remove(e),n.yc.delete(t),oT(n))}function ok(n,e,t){for(const r of t)r instanceof DB?(n.Ic.addReference(r.key,e),Owe(n,r)):r instanceof UB?(Ie("SyncEngine","Document no longer in limbo: "+r.key),n.Ic.removeReference(r.key,e),n.Ic.containsKey(r.key)||BB(n,r.key)):Ue()}function Owe(n,e){const t=e.key,r=t.path.canonicalString();n.gc.get(t)||n.mc.has(r)||(Ie("SyncEngine","New document in limbo: "+t),n.mc.add(r),oT(n))}function oT(n){for(;n.mc.size>0&&n.gc.size<n.maxConcurrentLimboResolutions;){const e=n.mc.values().next().value;n.mc.delete(e);const t=new Te(jt.fromString(e)),r=n.Ac.next();n.yc.set(r,new Ewe(t)),n.gc=n.gc.insert(t,r),IB(n.remoteStore,new _c(Ia(qS(t.path)),r,"TargetPurposeLimboResolution",LS.ct))}}async function Ly(n,e,t){const r=ze(n),s=[],i=[],o=[];r.wc.isEmpty()||(r.wc.forEach((a,c)=>{o.push(r.Rc(c,e,t).then(l=>{if((l||t)&&r.isPrimaryClient&&r.sharedClientState.updateQueryState(c.targetId,l!=null&&l.fromCache?"not-current":"current"),l){s.push(l);const u=XS.Li(c.targetId,l);i.push(u)}}))}),await Promise.all(o),r.dc.nu(s),await async function(a,c){const l=ze(a);try{await l.persistence.runTransaction("notifyLocalViewChanges","readwrite",u=>J.forEach(c,h=>J.forEach(h.Fi,d=>l.persistence.referenceDelegate.addReference(u,h.targetId,d)).next(()=>J.forEach(h.Bi,d=>l.persistence.referenceDelegate.removeReference(u,h.targetId,d)))))}catch(u){if(!ky(u))throw u;Ie("LocalStore","Failed to update sequence numbers: "+u)}for(const u of c){const h=u.targetId;if(!u.fromCache){const d=l.Ji.get(h),f=d.snapshotVersion,p=d.withLastLimboFreeSnapshotVersion(f);l.Ji=l.Ji.insert(h,p)}}}(r.localStore,i))}async function xwe(n,e){const t=ze(n);if(!t.currentUser.isEqual(e)){Ie("SyncEngine","User change. New user:",e.toKey());const r=await EB(t.localStore,e);t.currentUser=e,function(s,i){s.Ec.forEach(o=>{o.forEach(a=>{a.reject(new we(W.CANCELLED,i))})}),s.Ec.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Ly(t,r.er)}}function Rwe(n,e){const t=ze(n),r=t.yc.get(e);if(r&&r.fc)return Ze().add(r.key);{let s=Ze();const i=t._c.get(e);if(!i)return s;for(const o of i){const a=t.wc.get(o);s=s.unionWith(a.view.nc)}return s}}function Pwe(n){const e=ze(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=$B.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=Rwe.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=Swe.bind(null,e),e.dc.nu=mwe.bind(null,e.eventManager),e.dc.Pc=ywe.bind(null,e.eventManager),e}function kwe(n){const e=ze(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=Twe.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=Nwe.bind(null,e),e}class ak{constructor(){this.synchronizeTabs=!1}async initialize(e){this.serializer=JE(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),await this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)}createGarbageCollectionScheduler(e,t){return null}createIndexBackfillerScheduler(e,t){return null}createLocalStore(e){return jye(this.persistence,new Bye,e.initialUser,this.serializer)}createPersistence(e){return new Mye(JS.zs,this.serializer)}createSharedClientState(e){return new Kye}async terminate(){this.gcScheduler&&this.gcScheduler.stop(),await this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class Dwe{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>ik(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=xwe.bind(null,this.syncEngine),await fwe(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new gwe}createDatastore(e){const t=JE(e.databaseInfo.databaseId),r=(s=e.databaseInfo,new Jye(s));var s;return function(i,o,a,c){return new twe(i,o,a,c)}(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return t=this.localStore,r=this.datastore,s=e.asyncQueue,i=a=>ik(this.syncEngine,a,0),o=nk.D()?new nk:new Yye,new rwe(t,r,s,i,o);var t,r,s,i,o}createSyncEngine(e,t){return function(r,s,i,o,a,c,l){const u=new vwe(r,s,i,o,a,c);return l&&(u.vc=!0),u}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}terminate(){return async function(e){const t=ze(e);Ie("RemoteStore","RemoteStore shutting down."),t.vu.add(5),await My(t),t.Pu.shutdown(),t.bu.set("Unknown")}(this.remoteStore)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FB{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Sc(this.observer.next,e)}error(e){this.observer.error?this.Sc(this.observer.error,e):Ca("Uncaught Error in snapshot listener:",e.toString())}Dc(){this.muted=!0}Sc(e,t){this.muted||setTimeout(()=>{this.muted||e(t)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uwe{constructor(e,t,r,s){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=s,this.user=ur.UNAUTHENTICATED,this.clientId=L5.A(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,async i=>{Ie("FirestoreClient","Received user=",i.uid),await this.authCredentialListener(i),this.user=i}),this.appCheckCredentials.start(r,i=>(Ie("FirestoreClient","Received new app check token=",i),this.appCheckCredentialListener(i,this.user)))}async getConfiguration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new we(W.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const e=new pa;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const r=sT(t,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function eA(n,e){n.asyncQueue.verifyOperationInProgress(),Ie("FirestoreClient","Initializing OfflineComponentProvider");const t=await n.getConfiguration();await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(async s=>{r.isEqual(s)||(await EB(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e}async function ck(n,e){n.asyncQueue.verifyOperationInProgress();const t=await Mwe(n);Ie("FirestoreClient","Initializing OnlineComponentProvider");const r=await n.getConfiguration();await e.initialize(t,r),n.setCredentialChangeListener(s=>rk(e.remoteStore,s)),n.setAppCheckTokenChangeListener((s,i)=>rk(e.remoteStore,i)),n._onlineComponents=e}function $we(n){return n.name==="FirebaseError"?n.code===W.FAILED_PRECONDITION||n.code===W.UNIMPLEMENTED:!(typeof DOMException<"u"&&n instanceof DOMException)||n.code===22||n.code===20||n.code===11}async function Mwe(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){Ie("FirestoreClient","Using user provided OfflineComponentProvider");try{await eA(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!$we(t))throw t;bf("Error using user provided cache. Falling back to memory cache: "+t),await eA(n,new ak)}}else Ie("FirestoreClient","Using default OfflineComponentProvider"),await eA(n,new ak);return n._offlineComponents}async function jB(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(Ie("FirestoreClient","Using user provided OnlineComponentProvider"),await ck(n,n._uninitializedComponentsProvider._online)):(Ie("FirestoreClient","Using default OnlineComponentProvider"),await ck(n,new Dwe))),n._onlineComponents}function Lwe(n){return jB(n).then(e=>e.syncEngine)}async function HB(n){const e=await jB(n),t=e.eventManager;return t.onListen=Awe.bind(null,e.syncEngine),t.onUnlisten=Iwe.bind(null,e.syncEngine),t}function Bwe(n,e,t={}){const r=new pa;return n.asyncQueue.enqueueAndForget(async()=>function(s,i,o,a,c){const l=new FB({next:h=>{i.enqueueAndForget(()=>PB(s,u));const d=h.docs.has(o);!d&&h.fromCache?c.reject(new we(W.UNAVAILABLE,"Failed to get document because the client is offline.")):d&&h.fromCache&&a&&a.source==="server"?c.reject(new we(W.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(h)},error:h=>c.reject(h)}),u=new kB(qS(o.path),l,{includeMetadataChanges:!0,Ku:!0});return RB(s,u)}(await HB(n),n.asyncQueue,e,t,r)),r.promise}function Fwe(n,e,t={}){const r=new pa;return n.asyncQueue.enqueueAndForget(async()=>function(s,i,o,a,c){const l=new FB({next:h=>{i.enqueueAndForget(()=>PB(s,u)),h.fromCache&&a.source==="server"?c.reject(new we(W.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(h)},error:h=>c.reject(h)}),u=new kB(o,l,{includeMetadataChanges:!0,Ku:!0});return RB(s,u)}(await HB(n),n.asyncQueue,e,t,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VB(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lk=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qB(n,e,t){if(!t)throw new we(W.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function jwe(n,e,t,r){if(e===!0&&r===!0)throw new we(W.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function uk(n){if(!Te.isDocumentKey(n))throw new we(W.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function hk(n){if(Te.isDocumentKey(n))throw new we(W.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function tv(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=function(t){return t.constructor?t.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":Ue()}function No(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new we(W.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=tv(n);throw new we(W.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dk{constructor(e){var t,r;if(e.host===void 0){if(e.ssl!==void 0)throw new we(W.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(t=e.ssl)===null||t===void 0||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.cache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new we(W.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}jwe("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=VB((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new we(W.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new we(W.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new we(W.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(t=this.experimentalLongPollingOptions,r=e.experimentalLongPollingOptions,t.timeoutSeconds===r.timeoutSeconds)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams;var t,r}}class nv{constructor(e,t,r,s){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new dk({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new we(W.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(e){if(this._settingsFrozen)throw new we(W.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new dk(e),e.credentials!==void 0&&(this._authCredentials=function(t){if(!t)return new hme;switch(t.type){case"firstParty":return new gme(t.sessionIndex||"0",t.iamToken||null,t.authTokenFactory||null);case"provider":return t.client;default:throw new we(W.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=lk.get(e);t&&(Ie("ComponentProvider","Removing Datastore"),lk.delete(e),t.terminate())}(this),Promise.resolve()}}function Hwe(n,e,t,r={}){var s;const i=(n=No(n,nv))._getSettings(),o=`${e}:${t}`;if(i.host!=="firestore.googleapis.com"&&i.host!==o&&bf("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},i),{host:o,ssl:!1})),r.mockUserToken){let a,c;if(typeof r.mockUserToken=="string")a=r.mockUserToken,c=ur.MOCK_USER;else{a=Ffe(r.mockUserToken,(s=n._app)===null||s===void 0?void 0:s.options.projectId);const l=r.mockUserToken.sub||r.mockUserToken.user_id;if(!l)throw new we(W.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new ur(l)}n._authCredentials=new dme(new M5(a,c))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mr{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new kc(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Mr(this.firestore,e,this._key)}}class Gf{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new Gf(this.firestore,e,this._query)}}class kc extends Gf{constructor(e,t,r){super(e,t,qS(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Mr(this.firestore,null,new Te(e))}withConverter(e){return new kc(this.firestore,e,this._path)}}function rv(n,e,...t){if(n=So(n),qB("collection","path",e),n instanceof nv){const r=jt.fromString(e,...t);return hk(r),new kc(n,null,r)}{if(!(n instanceof Mr||n instanceof kc))throw new we(W.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(jt.fromString(e,...t));return hk(r),new kc(n.firestore,null,r)}}function By(n,e,...t){if(n=So(n),arguments.length===1&&(e=L5.A()),qB("doc","path",e),n instanceof nv){const r=jt.fromString(e,...t);return uk(r),new Mr(n,null,new Te(r))}{if(!(n instanceof Mr||n instanceof kc))throw new we(W.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(jt.fromString(e,...t));return uk(r),new Mr(n.firestore,n instanceof kc?n.converter:null,new Te(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vwe{constructor(){this.Gc=Promise.resolve(),this.Qc=[],this.jc=!1,this.zc=[],this.Wc=null,this.Hc=!1,this.Jc=!1,this.Yc=[],this.qo=new AB(this,"async_queue_retry"),this.Xc=()=>{const t=X1();t&&Ie("AsyncQueue","Visibility state changed to "+t.visibilityState),this.qo.Mo()};const e=X1();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this.Xc)}get isShuttingDown(){return this.jc}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Zc(),this.ta(e)}enterRestrictedMode(e){if(!this.jc){this.jc=!0,this.Jc=e||!1;const t=X1();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.Xc)}}enqueue(e){if(this.Zc(),this.jc)return new Promise(()=>{});const t=new pa;return this.ta(()=>this.jc&&this.Jc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Qc.push(e),this.ea()))}async ea(){if(this.Qc.length!==0){try{await this.Qc[0](),this.Qc.shift(),this.qo.reset()}catch(e){if(!ky(e))throw e;Ie("AsyncQueue","Operation failed with retryable error: "+e)}this.Qc.length>0&&this.qo.No(()=>this.ea())}}ta(e){const t=this.Gc.then(()=>(this.Hc=!0,e().catch(r=>{this.Wc=r,this.Hc=!1;const s=function(i){let o=i.message||"";return i.stack&&(o=i.stack.includes(i.message)?i.stack:i.message+`
`+i.stack),o}(r);throw Ca("INTERNAL UNHANDLED ERROR: ",s),r}).then(r=>(this.Hc=!1,r))));return this.Gc=t,t}enqueueAfterDelay(e,t,r){this.Zc(),this.Yc.indexOf(e)>-1&&(t=0);const s=rT.createAndSchedule(this,e,t,r,i=>this.na(i));return this.zc.push(s),s}Zc(){this.Wc&&Ue()}verifyOperationInProgress(){}async sa(){let e;do e=this.Gc,await e;while(e!==this.Gc)}ia(e){for(const t of this.zc)if(t.timerId===e)return!0;return!1}ra(e){return this.sa().then(()=>{this.zc.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(const t of this.zc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.sa()})}oa(e){this.Yc.push(e)}na(e){const t=this.zc.indexOf(e);this.zc.splice(t,1)}}class Kf extends nv{constructor(e,t,r,s){super(e,t,r,s),this.type="firestore",this._queue=new Vwe,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}_terminate(){return this._firestoreClient||WB(this),this._firestoreClient.terminate()}}function zB(n,e){const t=typeof n=="object"?n:Gpe(),r=typeof n=="string"?n:"(default)",s=pS(t,"firestore").getImmediate({identifier:r});if(!s._initialized){const i=Lfe("firestore");i&&Hwe(s,...i)}return s}function aT(n){return n._firestoreClient||WB(n),n._firestoreClient.verifyNotTerminated(),n._firestoreClient}function WB(n){var e,t,r;const s=n._freezeSettings(),i=function(o,a,c,l){return new Tme(o,a,c,l.host,l.ssl,l.experimentalForceLongPolling,l.experimentalAutoDetectLongPolling,VB(l.experimentalLongPollingOptions),l.useFetchStreams)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,s);n._firestoreClient=new Uwe(n._authCredentials,n._appCheckCredentials,n._queue,i),!((t=s.cache)===null||t===void 0)&&t._offlineComponentProvider&&(!((r=s.cache)===null||r===void 0)&&r._onlineComponentProvider)&&(n._firestoreClient._uninitializedComponentsProvider={_offlineKind:s.cache.kind,_offline:s.cache._offlineComponentProvider,_online:s.cache._onlineComponentProvider})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sf{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Sf(Er.fromBase64String(e))}catch(t){throw new we(W.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Sf(Er.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sv{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new we(W.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new fr(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fy{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cT{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new we(W.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new we(W.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return vt(this._lat,e._lat)||vt(this._long,e._long)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qwe=/^__.*__$/;class zwe{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new Zc(e,this.data,this.fieldMask,t,this.fieldTransforms):new Uy(e,this.data,t,this.fieldTransforms)}}class GB{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new Zc(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function KB(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Ue()}}class iv{constructor(e,t,r,s,i,o){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.ua(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get ca(){return this.settings.ca}aa(e){return new iv(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}ha(e){var t;const r=(t=this.path)===null||t===void 0?void 0:t.child(e),s=this.aa({path:r,la:!1});return s.fa(e),s}da(e){var t;const r=(t=this.path)===null||t===void 0?void 0:t.child(e),s=this.aa({path:r,la:!1});return s.ua(),s}wa(e){return this.aa({path:void 0,la:!0})}_a(e){return Ob(e,this.settings.methodName,this.settings.ma||!1,this.path,this.settings.ga)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}ua(){if(this.path)for(let e=0;e<this.path.length;e++)this.fa(this.path.get(e))}fa(e){if(e.length===0)throw this._a("Document fields must not be empty");if(KB(this.ca)&&qwe.test(e))throw this._a('Document fields cannot begin and end with "__"')}}class Wwe{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||JE(e)}ya(e,t,r,s=!1){return new iv({ca:e,methodName:t,ga:r,path:fr.emptyPath(),la:!1,ma:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function lT(n){const e=n._freezeSettings(),t=JE(n._databaseId);return new Wwe(n._databaseId,!!e.ignoreUndefinedProperties,t)}function Gwe(n,e,t,r,s,i={}){const o=n.ya(i.merge||i.mergeFields?2:0,e,t,s);uT("Data must be an object, but it was:",o,r);const a=YB(r,o);let c,l;if(i.merge)c=new Ss(o.fieldMask),l=o.fieldTransforms;else if(i.mergeFields){const u=[];for(const h of i.mergeFields){const d=$I(e,h,t);if(!o.contains(d))throw new we(W.INVALID_ARGUMENT,`Field '${d}' is specified in your field mask but missing from your input data.`);ZB(u,d)||u.push(d)}c=new Ss(u),l=o.fieldTransforms.filter(h=>c.covers(h.field))}else c=null,l=o.fieldTransforms;return new zwe(new is(a),c,l)}class ov extends Fy{_toFieldTransform(e){if(e.ca!==2)throw e.ca===1?e._a(`${this._methodName}() can only appear at the top level of your update data`):e._a(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof ov}}function Kwe(n,e,t){return new iv({ca:3,ga:e.settings.ga,methodName:n._methodName,la:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class Ywe extends Fy{constructor(e,t){super(e),this.pa=t}_toFieldTransform(e){const t=Kwe(this,e,!0),r=this.pa.map(i=>Yf(i,t)),s=new Cf(r);return new cB(e.path,s)}isEqual(e){return this===e}}class Qwe extends Fy{constructor(e,t){super(e),this.Ia=t}_toFieldTransform(e){const t=new Rm(e.serializer,rB(e.serializer,this.Ia));return new cB(e.path,t)}isEqual(e){return this===e}}function Zwe(n,e,t,r){const s=n.ya(1,e,t);uT("Data must be an object, but it was:",s,r);const i=[],o=is.empty();Wu(r,(c,l)=>{const u=hT(e,c,t);l=So(l);const h=s.da(u);if(l instanceof ov)i.push(u);else{const d=Yf(l,h);d!=null&&(i.push(u),o.set(u,d))}});const a=new Ss(i);return new GB(o,a,s.fieldTransforms)}function Jwe(n,e,t,r,s,i){const o=n.ya(1,e,t),a=[$I(e,r,t)],c=[s];if(i.length%2!=0)throw new we(W.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let d=0;d<i.length;d+=2)a.push($I(e,i[d])),c.push(i[d+1]);const l=[],u=is.empty();for(let d=a.length-1;d>=0;--d)if(!ZB(l,a[d])){const f=a[d];let p=c[d];p=So(p);const g=o.da(f);if(p instanceof ov)l.push(f);else{const m=Yf(p,g);m!=null&&(l.push(f),u.set(f,m))}}const h=new Ss(l);return new GB(u,h,o.fieldTransforms)}function Xwe(n,e,t,r=!1){return Yf(t,n.ya(r?4:3,e))}function Yf(n,e){if(QB(n=So(n)))return uT("Unsupported field value:",e,n),YB(n,e);if(n instanceof Fy)return function(t,r){if(!KB(r.ca))throw r._a(`${t._methodName}() can only be used with update() and set()`);if(!r.path)throw r._a(`${t._methodName}() is not currently supported inside arrays`);const s=t._toFieldTransform(r);s&&r.fieldTransforms.push(s)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.la&&e.ca!==4)throw e._a("Nested arrays are not supported");return function(t,r){const s=[];let i=0;for(const o of t){let a=Yf(o,r.wa(i));a==null&&(a={nullValue:"NULL_VALUE"}),s.push(a),i++}return{arrayValue:{values:s}}}(n,e)}return function(t,r){if((t=So(t))===null)return{nullValue:"NULL_VALUE"};if(typeof t=="number")return rB(r.serializer,t);if(typeof t=="boolean")return{booleanValue:t};if(typeof t=="string")return{stringValue:t};if(t instanceof Date){const s=An.fromDate(t);return{timestampValue:Tb(r.serializer,s)}}if(t instanceof An){const s=new An(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:Tb(r.serializer,s)}}if(t instanceof cT)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Sf)return{bytesValue:pB(r.serializer,t._byteString)};if(t instanceof Mr){const s=r.databaseId,i=t.firestore._databaseId;if(!i.isEqual(s))throw r._a(`Document reference is for database ${i.projectId}/${i.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:QS(t.firestore._databaseId||r.databaseId,t._key.path)}}throw r._a(`Unsupported field value: ${tv(t)}`)}(n,e)}function YB(n,e){const t={};return B5(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Wu(n,(r,s)=>{const i=Yf(s,e.ha(r));i!=null&&(t[r]=i)}),{mapValue:{fields:t}}}function QB(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof An||n instanceof cT||n instanceof Sf||n instanceof Mr||n instanceof Fy)}function uT(n,e,t){if(!QB(t)||!function(r){return typeof r=="object"&&r!==null&&(Object.getPrototypeOf(r)===Object.prototype||Object.getPrototypeOf(r)===null)}(t)){const r=tv(t);throw r==="an object"?e._a(n+" a custom object"):e._a(n+" "+r)}}function $I(n,e,t){if((e=So(e))instanceof sv)return e._internalPath;if(typeof e=="string")return hT(n,e);throw Ob("Field path arguments must be of type string or ",n,!1,void 0,t)}const e0e=new RegExp("[~\\*/\\[\\]]");function hT(n,e,t){if(e.search(e0e)>=0)throw Ob(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new sv(...e.split("."))._internalPath}catch{throw Ob(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Ob(n,e,t,r,s){const i=r&&!r.isEmpty(),o=s!==void 0;let a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(i||o)&&(c+=" (found",i&&(c+=` in field ${r}`),o&&(c+=` in document ${s}`),c+=")"),new we(W.INVALID_ARGUMENT,a+n+c)}function ZB(n,e){return n.some(t=>t.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JB{constructor(e,t,r,s,i){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Mr(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new t0e(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(dT("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class t0e extends JB{data(){return super.data()}}function dT(n,e){return typeof e=="string"?hT(n,e):e instanceof sv?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function n0e(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new we(W.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class fT{}class r0e extends fT{}function pT(n,e,...t){let r=[];e instanceof fT&&r.push(e),r=r.concat(t),function(s){const i=s.filter(a=>a instanceof mT).length,o=s.filter(a=>a instanceof av).length;if(i>1||i>0&&o>0)throw new we(W.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const s of r)n=s._apply(n);return n}class av extends r0e{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new av(e,t,r)}_apply(e){const t=this._parse(e);return XB(e._query,t),new Gf(e.firestore,e.converter,TI(e._query,t))}_parse(e){const t=lT(e.firestore);return function(s,i,o,a,c,l,u){let h;if(c.isKeyField()){if(l==="array-contains"||l==="array-contains-any")throw new we(W.INVALID_ARGUMENT,`Invalid Query. You can't perform '${l}' queries on documentId().`);if(l==="in"||l==="not-in"){pk(u,l);const d=[];for(const f of u)d.push(fk(a,s,f));h={arrayValue:{values:d}}}else h=fk(a,s,u)}else l!=="in"&&l!=="not-in"&&l!=="array-contains-any"||pk(u,l),h=Xwe(o,i,u,l==="in"||l==="not-in");return gn.create(c,l,h)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function gT(n,e,t){const r=e,s=dT("where",n);return av._create(s,r,t)}class mT extends fT{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new mT(e,t)}_parse(e){const t=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return t.length===1?t[0]:Mi.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:(function(r,s){let i=r;const o=s.getFlattenedFilters();for(const a of o)XB(i,a),i=TI(i,a)}(e._query,t),new Gf(e.firestore,e.converter,TI(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function fk(n,e,t){if(typeof(t=So(t))=="string"){if(t==="")throw new we(W.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Y5(e)&&t.indexOf("/")!==-1)throw new we(W.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const r=e.path.child(jt.fromString(t));if(!Te.isDocumentKey(r))throw new we(W.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return MP(n,new Te(r))}if(t instanceof Mr)return MP(n,t._key);throw new we(W.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${tv(t)}.`)}function pk(n,e){if(!Array.isArray(n)||n.length===0)throw new we(W.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function XB(n,e){if(e.isInequality()){const r=zS(n),s=e.field;if(r!==null&&!r.isEqual(s))throw new we(W.INVALID_ARGUMENT,`Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '${r.toString()}' and '${s.toString()}'`);const i=K5(n);i!==null&&s0e(n,s,i)}const t=function(r,s){for(const i of r)for(const o of i.getFlattenedFilters())if(s.indexOf(o.op)>=0)return o.op;return null}(n.filters,function(r){switch(r){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new we(W.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new we(W.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}function s0e(n,e,t){if(!t.isEqual(e))throw new we(W.INVALID_ARGUMENT,`Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '${e.toString()}' and so you must also use '${e.toString()}' as your first argument to orderBy(), but your first orderBy() is on field '${t.toString()}' instead.`)}class i0e{convertValue(e,t="none"){switch(Ru(e)){case 0:return null;case 1:return e.booleanValue;case 2:return dn(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(xu(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw Ue()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const r={};return Wu(e,(s,i)=>{r[s]=this.convertValue(i,t)}),r}convertGeoPoint(e){return new cT(dn(e.latitude),dn(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":const r=FS(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(Tm(e));default:return null}}convertTimestamp(e){const t=Vc(e);return new An(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=jt.fromString(e);Ht(bB(r));const s=new Nm(r.get(1),r.get(3)),i=new Te(r.popFirst(5));return s.isEqual(t)||Ca(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function o0e(n,e,t){let r;return r=n?n.toFirestore(e):e,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jp{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class e6 extends JB{constructor(e,t,r,s,i,o){super(e,t,r,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new w0(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(dT("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}}class w0 extends e6{data(e={}){return super.data(e)}}class a0e{constructor(e,t,r,s){this._firestore=e,this._userDataWriter=t,this._snapshot=s,this.metadata=new jp(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new w0(this._firestore,this._userDataWriter,r.key,r,new jp(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new we(W.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(r,s){if(r._snapshot.oldDocs.isEmpty()){let i=0;return r._snapshot.docChanges.map(o=>{const a=new w0(r._firestore,r._userDataWriter,o.doc.key,o.doc,new jp(r._snapshot.mutatedKeys.has(o.doc.key),r._snapshot.fromCache),r.query.converter);return o.doc,{type:"added",doc:a,oldIndex:-1,newIndex:i++}})}{let i=r._snapshot.oldDocs;return r._snapshot.docChanges.filter(o=>s||o.type!==3).map(o=>{const a=new w0(r._firestore,r._userDataWriter,o.doc.key,o.doc,new jp(r._snapshot.mutatedKeys.has(o.doc.key),r._snapshot.fromCache),r.query.converter);let c=-1,l=-1;return o.type!==0&&(c=i.indexOf(o.doc.key),i=i.delete(o.doc.key)),o.type!==1&&(i=i.add(o.doc),l=i.indexOf(o.doc.key)),{type:c0e(o.type),doc:a,oldIndex:c,newIndex:l}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function c0e(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ue()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function i1e(n){n=No(n,Mr);const e=No(n.firestore,Kf);return Bwe(aT(e),n._key).then(t=>l0e(e,n,t))}class t6 extends i0e{constructor(e){super(),this.firestore=e}convertBytes(e){return new Sf(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Mr(this.firestore,null,t)}}function yT(n){n=No(n,Gf);const e=No(n.firestore,Kf),t=aT(e),r=new t6(e);return n0e(n._query),Fwe(t,n._query).then(s=>new a0e(e,r,n,s))}function n6(n,e,t){n=No(n,Mr);const r=No(n.firestore,Kf),s=o0e(n.converter,e);return wT(r,[Gwe(lT(r),"setDoc",n._key,s,n.converter!==null,t).toMutation(n._key,Ri.none())])}function cv(n,e,t,...r){n=No(n,Mr);const s=No(n.firestore,Kf),i=lT(s);let o;return o=typeof(e=So(e))=="string"||e instanceof sv?Jwe(i,"updateDoc",n._key,e,t,r):Zwe(i,"updateDoc",n._key,e),wT(s,[o.toMutation(n._key,Ri.exists(!0))])}function o1e(n){return wT(No(n.firestore,Kf),[new WS(n._key,Ri.none())])}function wT(n,e){return function(t,r){const s=new pa;return t.asyncQueue.enqueueAndForget(async()=>_we(await Lwe(t),r,s)),s.promise}(aT(n),e)}function l0e(n,e,t){const r=t.docs.get(e._key),s=new t6(n);return new e6(n,s,e._key,r,new jp(t.hasPendingWrites,t.fromCache),e.converter)}function a1e(...n){return new Ywe("arrayUnion",n)}function u0e(n){return new Qwe("increment",n)}(function(n,e=!0){(function(t){qf=t})(Wpe),jc(new va("firestore",(t,{instanceIdentifier:r,options:s})=>{const i=t.getProvider("app").getImmediate(),o=new Kf(new fme(t.getProvider("auth-internal")),new yme(t.getProvider("app-check-internal")),function(a,c){if(!Object.prototype.hasOwnProperty.apply(a.options,["projectId"]))throw new we(W.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Nm(a.options.projectId,c)}(i,r),i);return s=Object.assign({useFetchStreams:e},s),o._setSettings(s),o},"PUBLIC").setMultipleInstances(!0)),vo(PP,"3.13.0",n),vo(PP,"3.13.0","esm2017")})();var h0e="firebase",d0e="9.23.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */vo(h0e,d0e,"app");const f0e=(n,e)=>e.some(t=>n instanceof t);let gk,mk;function p0e(){return gk||(gk=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function g0e(){return mk||(mk=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const r6=new WeakMap,MI=new WeakMap,s6=new WeakMap,tA=new WeakMap,bT=new WeakMap;function m0e(n){const e=new Promise((t,r)=>{const s=()=>{n.removeEventListener("success",i),n.removeEventListener("error",o)},i=()=>{t(Dc(n.result)),s()},o=()=>{r(n.error),s()};n.addEventListener("success",i),n.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&r6.set(t,n)}).catch(()=>{}),bT.set(e,n),e}function y0e(n){if(MI.has(n))return;const e=new Promise((t,r)=>{const s=()=>{n.removeEventListener("complete",i),n.removeEventListener("error",o),n.removeEventListener("abort",o)},i=()=>{t(),s()},o=()=>{r(n.error||new DOMException("AbortError","AbortError")),s()};n.addEventListener("complete",i),n.addEventListener("error",o),n.addEventListener("abort",o)});MI.set(n,e)}let LI={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return MI.get(n);if(e==="objectStoreNames")return n.objectStoreNames||s6.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Dc(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function w0e(n){LI=n(LI)}function b0e(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const r=n.call(nA(this),e,...t);return s6.set(r,e.sort?e.sort():[e]),Dc(r)}:g0e().includes(n)?function(...e){return n.apply(nA(this),e),Dc(r6.get(this))}:function(...e){return Dc(n.apply(nA(this),e))}}function E0e(n){return typeof n=="function"?b0e(n):(n instanceof IDBTransaction&&y0e(n),f0e(n,p0e())?new Proxy(n,LI):n)}function Dc(n){if(n instanceof IDBRequest)return m0e(n);if(tA.has(n))return tA.get(n);const e=E0e(n);return e!==n&&(tA.set(n,e),bT.set(e,n)),e}const nA=n=>bT.get(n);function v0e(n,e,{blocked:t,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(n,e),a=Dc(o);return r&&o.addEventListener("upgradeneeded",c=>{r(Dc(o.result),c.oldVersion,c.newVersion,Dc(o.transaction))}),t&&o.addEventListener("blocked",()=>t()),a.then(c=>{i&&c.addEventListener("close",()=>i()),s&&c.addEventListener("versionchange",()=>s())}).catch(()=>{}),a}const A0e=["get","getKey","getAll","getAllKeys","count"],C0e=["put","add","delete","clear"],rA=new Map;function yk(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(rA.get(e))return rA.get(e);const t=e.replace(/FromIndex$/,""),r=e!==t,s=C0e.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(s||A0e.includes(t)))return;const i=async function(o,...a){const c=this.transaction(o,s?"readwrite":"readonly");let l=c.store;return r&&(l=l.index(a.shift())),(await Promise.all([l[t](...a),s&&c.done]))[0]};return rA.set(e,i),i}w0e(n=>({...n,get:(e,t,r)=>yk(e,t)||n.get(e,t,r),has:(e,t)=>!!yk(e,t)||n.has(e,t)}));const i6="@firebase/installations",ET="0.6.4";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const o6=1e4,a6=`w:${ET}`,c6="FIS_v2",I0e="https://firebaseinstallations.googleapis.com/v1",_0e=60*60*1e3,S0e="installations",T0e="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const N0e={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},Pu=new NE(S0e,T0e,N0e);function l6(n){return n instanceof Kc&&n.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function u6({projectId:n}){return`${I0e}/projects/${n}/installations`}function h6(n){return{token:n.token,requestStatus:2,expiresIn:x0e(n.expiresIn),creationTime:Date.now()}}async function d6(n,e){const r=(await e.json()).error;return Pu.create("request-failed",{requestName:n,serverCode:r.code,serverMessage:r.message,serverStatus:r.status})}function f6({apiKey:n}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":n})}function O0e(n,{refreshToken:e}){const t=f6(n);return t.append("Authorization",R0e(e)),t}async function p6(n){const e=await n();return e.status>=500&&e.status<600?n():e}function x0e(n){return Number(n.replace("s","000"))}function R0e(n){return`${c6} ${n}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function P0e({appConfig:n,heartbeatServiceProvider:e},{fid:t}){const r=u6(n),s=f6(n),i=e.getImmediate({optional:!0});if(i){const l=await i.getHeartbeatsHeader();l&&s.append("x-firebase-client",l)}const o={fid:t,authVersion:c6,appId:n.appId,sdkVersion:a6},a={method:"POST",headers:s,body:JSON.stringify(o)},c=await p6(()=>fetch(r,a));if(c.ok){const l=await c.json();return{fid:l.fid||t,registrationStatus:2,refreshToken:l.refreshToken,authToken:h6(l.authToken)}}else throw await d6("Create Installation",c)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function g6(n){return new Promise(e=>{setTimeout(e,n)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function k0e(n){return btoa(String.fromCharCode(...n)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const D0e=/^[cdef][\w-]{21}$/,BI="";function U0e(){try{const n=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(n),n[0]=112+n[0]%16;const t=$0e(n);return D0e.test(t)?t:BI}catch{return BI}}function $0e(n){return k0e(n).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lv(n){return`${n.appName}!${n.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const m6=new Map;function y6(n,e){const t=lv(n);w6(t,e),M0e(t,e)}function w6(n,e){const t=m6.get(n);if(t)for(const r of t)r(e)}function M0e(n,e){const t=L0e();t&&t.postMessage({key:n,fid:e}),B0e()}let Dl=null;function L0e(){return!Dl&&"BroadcastChannel"in self&&(Dl=new BroadcastChannel("[Firebase] FID Change"),Dl.onmessage=n=>{w6(n.data.key,n.data.fid)}),Dl}function B0e(){m6.size===0&&Dl&&(Dl.close(),Dl=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F0e="firebase-installations-database",j0e=1,ku="firebase-installations-store";let sA=null;function vT(){return sA||(sA=v0e(F0e,j0e,{upgrade:(n,e)=>{switch(e){case 0:n.createObjectStore(ku)}}})),sA}async function xb(n,e){const t=lv(n),s=(await vT()).transaction(ku,"readwrite"),i=s.objectStore(ku),o=await i.get(t);return await i.put(e,t),await s.done,(!o||o.fid!==e.fid)&&y6(n,e.fid),e}async function b6(n){const e=lv(n),r=(await vT()).transaction(ku,"readwrite");await r.objectStore(ku).delete(e),await r.done}async function uv(n,e){const t=lv(n),s=(await vT()).transaction(ku,"readwrite"),i=s.objectStore(ku),o=await i.get(t),a=e(o);return a===void 0?await i.delete(t):await i.put(a,t),await s.done,a&&(!o||o.fid!==a.fid)&&y6(n,a.fid),a}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function AT(n){let e;const t=await uv(n.appConfig,r=>{const s=H0e(r),i=V0e(n,s);return e=i.registrationPromise,i.installationEntry});return t.fid===BI?{installationEntry:await e}:{installationEntry:t,registrationPromise:e}}function H0e(n){const e=n||{fid:U0e(),registrationStatus:0};return E6(e)}function V0e(n,e){if(e.registrationStatus===0){if(!navigator.onLine){const s=Promise.reject(Pu.create("app-offline"));return{installationEntry:e,registrationPromise:s}}const t={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},r=q0e(n,t);return{installationEntry:t,registrationPromise:r}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:z0e(n)}:{installationEntry:e}}async function q0e(n,e){try{const t=await P0e(n,e);return xb(n.appConfig,t)}catch(t){throw l6(t)&&t.customData.serverCode===409?await b6(n.appConfig):await xb(n.appConfig,{fid:e.fid,registrationStatus:0}),t}}async function z0e(n){let e=await wk(n.appConfig);for(;e.registrationStatus===1;)await g6(100),e=await wk(n.appConfig);if(e.registrationStatus===0){const{installationEntry:t,registrationPromise:r}=await AT(n);return r||t}return e}function wk(n){return uv(n,e=>{if(!e)throw Pu.create("installation-not-found");return E6(e)})}function E6(n){return W0e(n)?{fid:n.fid,registrationStatus:0}:n}function W0e(n){return n.registrationStatus===1&&n.registrationTime+o6<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function G0e({appConfig:n,heartbeatServiceProvider:e},t){const r=K0e(n,t),s=O0e(n,t),i=e.getImmediate({optional:!0});if(i){const l=await i.getHeartbeatsHeader();l&&s.append("x-firebase-client",l)}const o={installation:{sdkVersion:a6,appId:n.appId}},a={method:"POST",headers:s,body:JSON.stringify(o)},c=await p6(()=>fetch(r,a));if(c.ok){const l=await c.json();return h6(l)}else throw await d6("Generate Auth Token",c)}function K0e(n,{fid:e}){return`${u6(n)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function CT(n,e=!1){let t;const r=await uv(n.appConfig,i=>{if(!v6(i))throw Pu.create("not-registered");const o=i.authToken;if(!e&&Z0e(o))return i;if(o.requestStatus===1)return t=Y0e(n,e),i;{if(!navigator.onLine)throw Pu.create("app-offline");const a=X0e(i);return t=Q0e(n,a),a}});return t?await t:r.authToken}async function Y0e(n,e){let t=await bk(n.appConfig);for(;t.authToken.requestStatus===1;)await g6(100),t=await bk(n.appConfig);const r=t.authToken;return r.requestStatus===0?CT(n,e):r}function bk(n){return uv(n,e=>{if(!v6(e))throw Pu.create("not-registered");const t=e.authToken;return ebe(t)?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e})}async function Q0e(n,e){try{const t=await G0e(n,e),r=Object.assign(Object.assign({},e),{authToken:t});return await xb(n.appConfig,r),t}catch(t){if(l6(t)&&(t.customData.serverCode===401||t.customData.serverCode===404))await b6(n.appConfig);else{const r=Object.assign(Object.assign({},e),{authToken:{requestStatus:0}});await xb(n.appConfig,r)}throw t}}function v6(n){return n!==void 0&&n.registrationStatus===2}function Z0e(n){return n.requestStatus===2&&!J0e(n)}function J0e(n){const e=Date.now();return e<n.creationTime||n.creationTime+n.expiresIn<e+_0e}function X0e(n){const e={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},n),{authToken:e})}function ebe(n){return n.requestStatus===1&&n.requestTime+o6<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function tbe(n){const e=n,{installationEntry:t,registrationPromise:r}=await AT(e);return r?r.catch(console.error):CT(e).catch(console.error),t.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function nbe(n,e=!1){const t=n;return await rbe(t),(await CT(t,e)).token}async function rbe(n){const{registrationPromise:e}=await AT(n);e&&await e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sbe(n){if(!n||!n.options)throw iA("App Configuration");if(!n.name)throw iA("App Name");const e=["projectId","apiKey","appId"];for(const t of e)if(!n.options[t])throw iA(t);return{appName:n.name,projectId:n.options.projectId,apiKey:n.options.apiKey,appId:n.options.appId}}function iA(n){return Pu.create("missing-app-config-values",{valueName:n})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const A6="installations",ibe="installations-internal",obe=n=>{const e=n.getProvider("app").getImmediate(),t=sbe(e),r=pS(e,"heartbeat");return{app:e,appConfig:t,heartbeatServiceProvider:r,_delete:()=>Promise.resolve()}},abe=n=>{const e=n.getProvider("app").getImmediate(),t=pS(e,A6).getImmediate();return{getId:()=>tbe(t),getToken:s=>nbe(t,s)}};function cbe(){jc(new va(A6,obe,"PUBLIC")),jc(new va(ibe,abe,"PRIVATE"))}cbe();vo(i6,ET);vo(i6,ET,"esm2017");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ek="analytics",lbe="firebase_id",ube="origin",hbe=60*1e3,dbe="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",IT="https://www.googletagmanager.com/gtag/js";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cs=new dS("@firebase/analytics");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fbe={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-intialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."},ni=new NE("analytics","Analytics",fbe);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pbe(n){if(!n.startsWith(IT)){const e=ni.create("invalid-gtag-resource",{gtagURL:n});return cs.warn(e.message),""}return n}function C6(n){return Promise.all(n.map(e=>e.catch(t=>t)))}function gbe(n,e){let t;return window.trustedTypes&&(t=window.trustedTypes.createPolicy(n,e)),t}function mbe(n,e){const t=gbe("firebase-js-sdk-policy",{createScriptURL:pbe}),r=document.createElement("script"),s=`${IT}?l=${n}&id=${e}`;r.src=t?t==null?void 0:t.createScriptURL(s):s,r.async=!0,document.head.appendChild(r)}function ybe(n){let e=[];return Array.isArray(window[n])?e=window[n]:window[n]=e,e}async function wbe(n,e,t,r,s,i){const o=r[s];try{if(o)await e[o];else{const c=(await C6(t)).find(l=>l.measurementId===s);c&&await e[c.appId]}}catch(a){cs.error(a)}n("config",s,i)}async function bbe(n,e,t,r,s){try{let i=[];if(s&&s.send_to){let o=s.send_to;Array.isArray(o)||(o=[o]);const a=await C6(t);for(const c of o){const l=a.find(h=>h.measurementId===c),u=l&&e[l.appId];if(u)i.push(u);else{i=[];break}}}i.length===0&&(i=Object.values(e)),await Promise.all(i),n("event",r,s||{})}catch(i){cs.error(i)}}function Ebe(n,e,t,r){async function s(i,...o){try{if(i==="event"){const[a,c]=o;await bbe(n,e,t,a,c)}else if(i==="config"){const[a,c]=o;await wbe(n,e,t,r,a,c)}else if(i==="consent"){const[a]=o;n("consent","update",a)}else if(i==="get"){const[a,c,l]=o;n("get",a,c,l)}else if(i==="set"){const[a]=o;n("set",a)}else n(i,...o)}catch(a){cs.error(a)}}return s}function vbe(n,e,t,r,s){let i=function(...o){window[r].push(arguments)};return window[s]&&typeof window[s]=="function"&&(i=window[s]),window[s]=Ebe(i,n,e,t),{gtagCore:i,wrappedGtag:window[s]}}function Abe(n){const e=window.document.getElementsByTagName("script");for(const t of Object.values(e))if(t.src&&t.src.includes(IT)&&t.src.includes(n))return t;return null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cbe=30,Ibe=1e3;class _be{constructor(e={},t=Ibe){this.throttleMetadata=e,this.intervalMillis=t}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,t){this.throttleMetadata[e]=t}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}}const I6=new _be;function Sbe(n){return new Headers({Accept:"application/json","x-goog-api-key":n})}async function Tbe(n){var e;const{appId:t,apiKey:r}=n,s={method:"GET",headers:Sbe(r)},i=dbe.replace("{app-id}",t),o=await fetch(i,s);if(o.status!==200&&o.status!==304){let a="";try{const c=await o.json();!((e=c.error)===null||e===void 0)&&e.message&&(a=c.error.message)}catch{}throw ni.create("config-fetch-failed",{httpStatus:o.status,responseMessage:a})}return o.json()}async function Nbe(n,e=I6,t){const{appId:r,apiKey:s,measurementId:i}=n.options;if(!r)throw ni.create("no-app-id");if(!s){if(i)return{measurementId:i,appId:r};throw ni.create("no-api-key")}const o=e.getThrottleMetadata(r)||{backoffCount:0,throttleEndTimeMillis:Date.now()},a=new Rbe;return setTimeout(async()=>{a.abort()},hbe),_6({appId:r,apiKey:s,measurementId:i},o,a,e)}async function _6(n,{throttleEndTimeMillis:e,backoffCount:t},r,s=I6){var i;const{appId:o,measurementId:a}=n;try{await Obe(r,e)}catch(c){if(a)return cs.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${a} provided in the "measurementId" field in the local Firebase config. [${c==null?void 0:c.message}]`),{appId:o,measurementId:a};throw c}try{const c=await Tbe(n);return s.deleteThrottleMetadata(o),c}catch(c){const l=c;if(!xbe(l)){if(s.deleteThrottleMetadata(o),a)return cs.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${a} provided in the "measurementId" field in the local Firebase config. [${l==null?void 0:l.message}]`),{appId:o,measurementId:a};throw c}const u=Number((i=l==null?void 0:l.customData)===null||i===void 0?void 0:i.httpStatus)===503?uP(t,s.intervalMillis,Cbe):uP(t,s.intervalMillis),h={throttleEndTimeMillis:Date.now()+u,backoffCount:t+1};return s.setThrottleMetadata(o,h),cs.debug(`Calling attemptFetch again in ${u} millis`),_6(n,h,r,s)}}function Obe(n,e){return new Promise((t,r)=>{const s=Math.max(e-Date.now(),0),i=setTimeout(t,s);n.addEventListener(()=>{clearTimeout(i),r(ni.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function xbe(n){if(!(n instanceof Kc)||!n.customData)return!1;const e=Number(n.customData.httpStatus);return e===429||e===500||e===503||e===504}class Rbe{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}async function Pbe(n,e,t,r,s){if(s&&s.global){n("event",t,r);return}else{const i=await e,o=Object.assign(Object.assign({},r),{send_to:i});n("event",t,o)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function kbe(){if(x4())try{await R4()}catch(n){return cs.warn(ni.create("indexeddb-unavailable",{errorInfo:n==null?void 0:n.toString()}).message),!1}else return cs.warn(ni.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0}async function Dbe(n,e,t,r,s,i,o){var a;const c=Nbe(n);c.then(f=>{t[f.measurementId]=f.appId,n.options.measurementId&&f.measurementId!==n.options.measurementId&&cs.warn(`The measurement ID in the local Firebase config (${n.options.measurementId}) does not match the measurement ID fetched from the server (${f.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(f=>cs.error(f)),e.push(c);const l=kbe().then(f=>{if(f)return r.getId()}),[u,h]=await Promise.all([c,l]);Abe(i)||mbe(i,u.measurementId),s("js",new Date);const d=(a=o==null?void 0:o.config)!==null&&a!==void 0?a:{};return d[ube]="firebase",d.update=!0,h!=null&&(d[lbe]=h),s("config",u.measurementId,d),u.measurementId}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ube{constructor(e){this.app=e}_delete(){return delete hg[this.app.options.appId],Promise.resolve()}}let hg={},vk=[];const Ak={};let oA="dataLayer",$be="gtag",Ck,S6,Ik=!1;function Mbe(){const n=[];if(jfe()&&n.push("This is a browser extension environment."),Hfe()||n.push("Cookies are not available."),n.length>0){const e=n.map((r,s)=>`(${s+1}) ${r}`).join(" "),t=ni.create("invalid-analytics-context",{errorInfo:e});cs.warn(t.message)}}function Lbe(n,e,t){Mbe();const r=n.options.appId;if(!r)throw ni.create("no-app-id");if(!n.options.apiKey)if(n.options.measurementId)cs.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${n.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw ni.create("no-api-key");if(hg[r]!=null)throw ni.create("already-exists",{id:r});if(!Ik){ybe(oA);const{wrappedGtag:i,gtagCore:o}=vbe(hg,vk,Ak,oA,$be);S6=i,Ck=o,Ik=!0}return hg[r]=Dbe(n,vk,Ak,e,Ck,oA,t),new Ube(n)}function Bbe(n,e,t,r){n=So(n),Pbe(S6,hg[n.app.options.appId],e,t,r).catch(s=>cs.error(s))}const _k="@firebase/analytics",Sk="0.10.0";function Fbe(){jc(new va(Ek,(e,{options:t})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("installations-internal").getImmediate();return Lbe(r,s,t)},"PUBLIC")),jc(new va("analytics-internal",n,"PRIVATE")),vo(_k,Sk),vo(_k,Sk,"esm2017");function n(e){try{const t=e.getProvider(Ek).getImmediate();return{logEvent:(r,s,i)=>Bbe(t,r,s,i)}}catch(t){throw ni.create("interop-component-reg-failed",{reason:t})}}}Fbe();const jbe={apiKey:"AIzaSyA_D5pZvgjm8hmjOZNS2Jjv0Kx2UGFNzvI",authDomain:"artsvese.firebaseapp.com",projectId:"artsvese",storageBucket:"artsvese.appspot.com",messagingSenderId:"373875142366",appId:"1:373875142366:web:a9a83e339272f29c825c4f",measurementId:"G-GZ4B2W7VVZ"},Hbe=gS(jbe),Jc=zB(Hbe),Vbe={apiKey:"AIzaSyCvcy9OZeMVQwVYWGbloqzuu376miD8TGc",authDomain:"zignaly-bb34b.firebaseapp.com",projectId:"zignaly-bb34b",storageBucket:"artsvese.appspot.com",messagingSenderId:"480858695453",appId:"1:480858695453:web:ca1ee0a583764eee7123f4"},qbe=gS(Vbe,"zignaly"),c1e=zB(qbe);async function l1e(n,e,t){return new Promise(async(r,s)=>{try{const i=Zs().value.walletAddress,o=By(Jc,"uht_crypto_profile",i),a={lastAnsweredQuestionID:n,lastAnswerID:e};t&&(a.points=u0e(50)),cv(o,a).then(()=>{Zs().value.lastAnsweredQuestionID=n,Zs().value.lastAnswerID=e,t&&(Zs().value.points=Zs().value.points?Zs().value.points+50:50),r()}).catch(s)}catch(i){s(i)}})}async function u1e(){return new Promise(async(n,e)=>{try{const t=Zs().value.walletAddress,r=By(Jc,"uht_crypto_profile",t);await cv(r,{hasClaimedPoints:!0,points:0}),await zbe(t);const s=await N6(t);Zs().value.hasClaimedPoints=!0,Zs().value.points=0,Zs().value.referrals=s||[],n()}catch(t){e(t)}})}async function T6(n){const e=n.toLowerCase(),t=pT(rv(Jc,"uht_crypto_profile"),gT("walletAddressLower","==",e)),r=await yT(t);return r.empty?null:r.docs[0].data()}async function h1e(n){return new Promise(async(e,t)=>{try{const r=By(Jc,"uht_crypto_profile",n),s={address:n,walletAddressLower:n.toLowerCase(),points:0,dateCreated:new ND().toJSON()};await n6(r,s),e(s)}catch(r){t(r)}})}async function d1e(n){return new Promise(async(e,t)=>{try{const r=Zs().value.walletAddress,s=By(Jc,"uht_crypto_profile",r);await cv(s,{...n});const i=Zs(),o=await T6(i.value.walletAddress);i.value.points=(o==null?void 0:o.points)||0,i.value.hasClaimedPoints=(o==null?void 0:o.hasClaimedPoints)||!1,i.value.lastAnsweredQuestionID=(o==null?void 0:o.lastAnsweredQuestionID)||null,i.value.lastAnswerID=(o==null?void 0:o.lastAnswerID)||null,i.value.email=(o==null?void 0:o.email)||"",i.value.username=(o==null?void 0:o.username)||"",e()}catch(r){t(r)}})}async function f1e(n,e){return new Promise(async(t,r)=>{try{const s=rv(Jc,"uht_crypto_referrals"),i=By(s),a={id:i.id,sender_id:n,receiver_id:e,dateCreated:new ND().toJSON()};await n6(i,a),t(a)}catch(s){r(s)}})}async function N6(n){return new Promise(async(e,t)=>{const r=rv(Jc,"uht_crypto_referrals"),s=pT(r,gT("sender_id","==",n)),i=await yT(s);let o=await Promise.all(i.docs.map(async a=>{const c=a.data(),l=c==null?void 0:c.receiver_id,u=await T6(l);let h=0;if(c.receiver_id==n){let f=Array.from(new Map(i.docs.map(p=>[p.data().receiver_id.toLowerCase(),p])).values())||[];f=f==null?void 0:f.filter(p=>!p.pointsClaimed),h=f.length}else{const f=await N6(c.receiver_id);let p=Array.from(new Map(f.map(g=>[g.address.toLowerCase(),g])).values())||[];p=p==null?void 0:p.filter(g=>!g.pointsClaimed),h=p.length}const d=(u==null?void 0:u.points)+h*200;return{address:l,email:u.email,username:u.username,points:d,allocation:u.allocation||0,hasClaimedPoints:u.hasClaimedPoints||!1,isAirdropEligible:u.isAirdropEligible,pointsClaimed:c.pointsClaimed||!1}}));e(o)})}async function zbe(n){try{const e=rv(Jc,"uht_crypto_referrals"),t=pT(e,gT("sender_id","==",n)),r=await yT(t);if(r.empty){console.log("No referrals found for:",n);return}const s=r.docs.map(i=>cv(i.ref,{pointsClaimed:!0}));await Promise.all(s),console.log(`Marked ${r.size} referrals as claimed for ${n}`)}catch(e){throw console.error("Error marking referrals claimed:",e),e}}export{ie as $,Mve as A,L1 as B,rd as C,ND as D,xn as E,Kve as F,Vt as G,Rs as H,st as I,Lr as J,Fr as K,I as L,ge as M,i9 as N,ye as O,LD as P,se as Q,pT as R,Di as S,H as T,uo as U,Pe as V,L9 as W,xe as X,XI as Y,wn as Z,rv as _,Jc as a,K9 as a$,ut as a0,Ns as a1,vn as a2,wce as a3,cv as a4,Yve as a5,f1e as a6,t1e as a7,a1e as a8,tt as a9,eEe as aA,_0 as aB,rEe as aC,iEe as aD,u1e as aE,l1e as aF,c1e as aG,bA as aH,Ci as aI,Cs as aJ,Se as aK,zve as aL,Et as aM,zw as aN,l9 as aO,mt as aP,Li as aQ,bN as aR,H9 as aS,VD as aT,QI as aU,Y9 as aV,A7 as aW,EN as aX,C7 as aY,Qbe as aZ,V9 as a_,$D as aa,Jr as ab,Tr as ac,z as ad,Q as ae,Is as af,_e as ag,Ne as ah,lf as ai,ii as aj,lt as ak,yce as al,lr as am,ia as an,zp as ao,AC as ap,vM as aq,u7 as ar,tEe as as,AN as at,GD as au,mg as av,s7 as aw,WD as ax,h7 as ay,nEe as az,gT as b,z9 as b0,zD as b1,su as b2,qD as b3,n0 as b4,I0 as b5,zn as b6,vC as b7,Th as b8,j7 as b9,RD as ba,Tp as bb,i1e as c,yT as d,e1e as e,n1e as f,By as g,Xve as h,wle as i,s1e as j,Lve as k,d1e as l,n6 as m,T6 as n,N6 as o,WM as p,h1e as q,Zve as r,r1e as s,Jve as t,Zs as u,sc as v,Wve as w,Gve as x,o1e as y,s0 as z};
